(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function pl(e){const r=Object.create(null);for(const t of e.split(","))r[t]=1;return t=>t in r}const De={},wr=[],Zt=()=>{},Dp=()=>!1,Xs=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),ml=e=>e.startsWith("onUpdate:"),at=Object.assign,vl=(e,r)=>{const t=e.indexOf(r);t>-1&&e.splice(t,1)},$p=Object.prototype.hasOwnProperty,Ie=(e,r)=>$p.call(e,r),fe=Array.isArray,Cr=e=>Ys(e)==="[object Map]",Rd=e=>Ys(e)==="[object Set]",ve=e=>typeof e=="function",Ye=e=>typeof e=="string",_n=e=>typeof e=="symbol",qe=e=>e!==null&&typeof e=="object",Pd=e=>(qe(e)||ve(e))&&ve(e.then)&&ve(e.catch),Nd=Object.prototype.toString,Ys=e=>Nd.call(e),jp=e=>Ys(e).slice(8,-1),Bd=e=>Ys(e)==="[object Object]",gl=e=>Ye(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,mi=pl(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Zs=e=>{const r=Object.create(null);return t=>r[t]||(r[t]=e(t))},Up=/-(\w)/g,$t=Zs(e=>e.replace(Up,(r,t)=>t?t.toUpperCase():"")),Hp=/\B([A-Z])/g,cr=Zs(e=>e.replace(Hp,"-$1").toLowerCase()),Qs=Zs(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ca=Zs(e=>e?`on${Qs(e)}`:""),Bn=(e,r)=>!Object.is(e,r),Ta=(e,...r)=>{for(let t=0;t<e.length;t++)e[t](...r)},Eo=(e,r,t,n=!1)=>{Object.defineProperty(e,r,{configurable:!0,enumerable:!1,writable:n,value:t})},zp=e=>{const r=parseFloat(e);return isNaN(r)?e:r},Wp=e=>{const r=Ye(e)?Number(e):NaN;return isNaN(r)?e:r};let Su;const ea=()=>Su||(Su=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Oe(e){if(fe(e)){const r={};for(let t=0;t<e.length;t++){const n=e[t],i=Ye(n)?Kp(n):Oe(n);if(i)for(const s in i)r[s]=i[s]}return r}else if(Ye(e)||qe(e))return e}const Vp=/;(?![^(]*\))/g,qp=/:([^]+)/,Gp=/\/\*[^]*?\*\//g;function Kp(e){const r={};return e.replace(Gp,"").split(Vp).forEach(t=>{if(t){const n=t.split(qp);n.length>1&&(r[n[0].trim()]=n[1].trim())}}),r}function oe(e){let r="";if(Ye(e))r=e;else if(fe(e))for(let t=0;t<e.length;t++){const n=oe(e[t]);n&&(r+=n+" ")}else if(qe(e))for(const t in e)e[t]&&(r+=t+" ");return r.trim()}function Aa(e){if(!e)return null;let{class:r,style:t}=e;return r&&!Ye(r)&&(e.class=oe(r)),t&&(e.style=Oe(t)),e}const Jp="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Xp=pl(Jp);function Fd(e){return!!e||e===""}const Dd=e=>!!(e&&e.__v_isRef===!0),Ht=e=>Ye(e)?e:e==null?"":fe(e)||qe(e)&&(e.toString===Nd||!ve(e.toString))?Dd(e)?Ht(e.value):JSON.stringify(e,$d,2):String(e),$d=(e,r)=>Dd(r)?$d(e,r.value):Cr(r)?{[`Map(${r.size})`]:[...r.entries()].reduce((t,[n,i],s)=>(t[Ma(n,s)+" =>"]=i,t),{})}:Rd(r)?{[`Set(${r.size})`]:[...r.values()].map(t=>Ma(t))}:_n(r)?Ma(r):qe(r)&&!fe(r)&&!Bd(r)?String(r):r,Ma=(e,r="")=>{var t;return _n(e)?`Symbol(${(t=e.description)!=null?t:r})`:e};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let mt;class jd{constructor(r=!1){this.detached=r,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=mt,!r&&mt&&(this.index=(mt.scopes||(mt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let r,t;if(this.scopes)for(r=0,t=this.scopes.length;r<t;r++)this.scopes[r].pause();for(r=0,t=this.effects.length;r<t;r++)this.effects[r].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let r,t;if(this.scopes)for(r=0,t=this.scopes.length;r<t;r++)this.scopes[r].resume();for(r=0,t=this.effects.length;r<t;r++)this.effects[r].resume()}}run(r){if(this._active){const t=mt;try{return mt=this,r()}finally{mt=t}}}on(){++this._on===1&&(this.prevScope=mt,mt=this)}off(){this._on>0&&--this._on===0&&(mt=this.prevScope,this.prevScope=void 0)}stop(r){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!r){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function Ud(e){return new jd(e)}function ta(){return mt}function yl(e,r=!1){mt&&mt.cleanups.push(e)}let ze;const xa=new WeakSet;class Hd{constructor(r){this.fn=r,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,mt&&mt.active&&mt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,xa.has(this)&&(xa.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Wd(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ku(this),Vd(this);const r=ze,t=zt;ze=this,zt=!0;try{return this.fn()}finally{qd(this),ze=r,zt=t,this.flags&=-3}}stop(){if(this.flags&1){for(let r=this.deps;r;r=r.nextDep)kl(r);this.deps=this.depsTail=void 0,ku(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?xa.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){wo(this)&&this.run()}get dirty(){return wo(this)}}let zd=0,vi,gi;function Wd(e,r=!1){if(e.flags|=8,r){e.next=gi,gi=e;return}e.next=vi,vi=e}function bl(){zd++}function Sl(){if(--zd>0)return;if(gi){let r=gi;for(gi=void 0;r;){const t=r.next;r.next=void 0,r.flags&=-9,r=t}}let e;for(;vi;){let r=vi;for(vi=void 0;r;){const t=r.next;if(r.next=void 0,r.flags&=-9,r.flags&1)try{r.trigger()}catch(n){e||(e=n)}r=t}}if(e)throw e}function Vd(e){for(let r=e.deps;r;r=r.nextDep)r.version=-1,r.prevActiveLink=r.dep.activeLink,r.dep.activeLink=r}function qd(e){let r,t=e.depsTail,n=t;for(;n;){const i=n.prevDep;n.version===-1?(n===t&&(t=i),kl(n),Yp(n)):r=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}e.deps=r,e.depsTail=t}function wo(e){for(let r=e.deps;r;r=r.nextDep)if(r.dep.version!==r.version||r.dep.computed&&(Gd(r.dep.computed)||r.dep.version!==r.version))return!0;return!!e._dirty}function Gd(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Li)||(e.globalVersion=Li,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!wo(e))))return;e.flags|=2;const r=e.dep,t=ze,n=zt;ze=e,zt=!0;try{Vd(e);const i=e.fn(e._value);(r.version===0||Bn(i,e._value))&&(e.flags|=128,e._value=i,r.version++)}catch(i){throw r.version++,i}finally{ze=t,zt=n,qd(e),e.flags&=-3}}function kl(e,r=!1){const{dep:t,prevSub:n,nextSub:i}=e;if(n&&(n.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=n,e.nextSub=void 0),t.subs===e&&(t.subs=n,!n&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)kl(s,!0)}!r&&!--t.sc&&t.map&&t.map.delete(t.key)}function Yp(e){const{prevDep:r,nextDep:t}=e;r&&(r.nextDep=t,e.prevDep=void 0),t&&(t.prevDep=r,e.nextDep=void 0)}let zt=!0;const Kd=[];function vn(){Kd.push(zt),zt=!1}function gn(){const e=Kd.pop();zt=e===void 0?!0:e}function ku(e){const{cleanup:r}=e;if(e.cleanup=void 0,r){const t=ze;ze=void 0;try{r()}finally{ze=t}}}let Li=0;class Zp{constructor(r,t){this.sub=r,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class na{constructor(r){this.computed=r,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(r){if(!ze||!zt||ze===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==ze)t=this.activeLink=new Zp(ze,this),ze.deps?(t.prevDep=ze.depsTail,ze.depsTail.nextDep=t,ze.depsTail=t):ze.deps=ze.depsTail=t,Jd(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const n=t.nextDep;n.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=n),t.prevDep=ze.depsTail,t.nextDep=void 0,ze.depsTail.nextDep=t,ze.depsTail=t,ze.deps===t&&(ze.deps=n)}return t}trigger(r){this.version++,Li++,this.notify(r)}notify(r){bl();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Sl()}}}function Jd(e){if(e.dep.sc++,e.sub.flags&4){const r=e.dep.computed;if(r&&!e.dep.subs){r.flags|=20;for(let n=r.deps;n;n=n.nextDep)Jd(n)}const t=e.dep.subs;t!==e&&(e.prevSub=t,t&&(t.nextSub=e)),e.dep.subs=e}}const Rs=new WeakMap,er=Symbol(""),Co=Symbol(""),Oi=Symbol("");function vt(e,r,t){if(zt&&ze){let n=Rs.get(e);n||Rs.set(e,n=new Map);let i=n.get(t);i||(n.set(t,i=new na),i.map=n,i.key=t),i.track()}}function cn(e,r,t,n,i,s){const a=Rs.get(e);if(!a){Li++;return}const o=l=>{l&&l.trigger()};if(bl(),r==="clear")a.forEach(o);else{const l=fe(e),u=l&&gl(t);if(l&&t==="length"){const c=Number(n);a.forEach((d,f)=>{(f==="length"||f===Oi||!_n(f)&&f>=c)&&o(d)})}else switch((t!==void 0||a.has(void 0))&&o(a.get(t)),u&&o(a.get(Oi)),r){case"add":l?u&&o(a.get("length")):(o(a.get(er)),Cr(e)&&o(a.get(Co)));break;case"delete":l||(o(a.get(er)),Cr(e)&&o(a.get(Co)));break;case"set":Cr(e)&&o(a.get(er));break}}Sl()}function Qp(e,r){const t=Rs.get(e);return t&&t.get(r)}function gr(e){const r=Ce(e);return r===e?r:(vt(r,"iterate",Oi),Ft(e)?r:r.map(lt))}function ra(e){return vt(e=Ce(e),"iterate",Oi),e}const em={__proto__:null,[Symbol.iterator](){return Ia(this,Symbol.iterator,lt)},concat(...e){return gr(this).concat(...e.map(r=>fe(r)?gr(r):r))},entries(){return Ia(this,"entries",e=>(e[1]=lt(e[1]),e))},every(e,r){return rn(this,"every",e,r,void 0,arguments)},filter(e,r){return rn(this,"filter",e,r,t=>t.map(lt),arguments)},find(e,r){return rn(this,"find",e,r,lt,arguments)},findIndex(e,r){return rn(this,"findIndex",e,r,void 0,arguments)},findLast(e,r){return rn(this,"findLast",e,r,lt,arguments)},findLastIndex(e,r){return rn(this,"findLastIndex",e,r,void 0,arguments)},forEach(e,r){return rn(this,"forEach",e,r,void 0,arguments)},includes(...e){return La(this,"includes",e)},indexOf(...e){return La(this,"indexOf",e)},join(e){return gr(this).join(e)},lastIndexOf(...e){return La(this,"lastIndexOf",e)},map(e,r){return rn(this,"map",e,r,void 0,arguments)},pop(){return Dr(this,"pop")},push(...e){return Dr(this,"push",e)},reduce(e,...r){return _u(this,"reduce",e,r)},reduceRight(e,...r){return _u(this,"reduceRight",e,r)},shift(){return Dr(this,"shift")},some(e,r){return rn(this,"some",e,r,void 0,arguments)},splice(...e){return Dr(this,"splice",e)},toReversed(){return gr(this).toReversed()},toSorted(e){return gr(this).toSorted(e)},toSpliced(...e){return gr(this).toSpliced(...e)},unshift(...e){return Dr(this,"unshift",e)},values(){return Ia(this,"values",lt)}};function Ia(e,r,t){const n=ra(e),i=n[r]();return n!==e&&!Ft(e)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.value&&(s.value=t(s.value)),s}),i}const tm=Array.prototype;function rn(e,r,t,n,i,s){const a=ra(e),o=a!==e&&!Ft(e),l=a[r];if(l!==tm[r]){const d=l.apply(e,s);return o?lt(d):d}let u=t;a!==e&&(o?u=function(d,f){return t.call(this,lt(d),f,e)}:t.length>2&&(u=function(d,f){return t.call(this,d,f,e)}));const c=l.call(a,u,n);return o&&i?i(c):c}function _u(e,r,t,n){const i=ra(e);let s=t;return i!==e&&(Ft(e)?t.length>3&&(s=function(a,o,l){return t.call(this,a,o,l,e)}):s=function(a,o,l){return t.call(this,a,lt(o),l,e)}),i[r](s,...n)}function La(e,r,t){const n=Ce(e);vt(n,"iterate",Oi);const i=n[r](...t);return(i===-1||i===!1)&&_l(t[0])?(t[0]=Ce(t[0]),n[r](...t)):i}function Dr(e,r,t=[]){vn(),bl();const n=Ce(e)[r].apply(e,t);return Sl(),gn(),n}const nm=pl("__proto__,__v_isRef,__isVue"),Xd=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(_n));function rm(e){_n(e)||(e=String(e));const r=Ce(this);return vt(r,"has",e),r.hasOwnProperty(e)}class Yd{constructor(r=!1,t=!1){this._isReadonly=r,this._isShallow=t}get(r,t,n){if(t==="__v_skip")return r.__v_skip;const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return n===(i?s?rf:nf:s?tf:ef).get(r)||Object.getPrototypeOf(r)===Object.getPrototypeOf(n)?r:void 0;const a=fe(r);if(!i){let l;if(a&&(l=em[t]))return l;if(t==="hasOwnProperty")return rm}const o=Reflect.get(r,t,Ke(r)?r:n);return(_n(t)?Xd.has(t):nm(t))||(i||vt(r,"get",t),s)?o:Ke(o)?a&&gl(t)?o:o.value:qe(o)?i?Nr(o):jt(o):o}}class Zd extends Yd{constructor(r=!1){super(!1,r)}set(r,t,n,i){let s=r[t];if(!this._isShallow){const l=Hn(s);if(!Ft(n)&&!Hn(n)&&(s=Ce(s),n=Ce(n)),!fe(r)&&Ke(s)&&!Ke(n))return l?!1:(s.value=n,!0)}const a=fe(r)&&gl(t)?Number(t)<r.length:Ie(r,t),o=Reflect.set(r,t,n,Ke(r)?r:i);return r===Ce(i)&&(a?Bn(n,s)&&cn(r,"set",t,n):cn(r,"add",t,n)),o}deleteProperty(r,t){const n=Ie(r,t);r[t];const i=Reflect.deleteProperty(r,t);return i&&n&&cn(r,"delete",t,void 0),i}has(r,t){const n=Reflect.has(r,t);return(!_n(t)||!Xd.has(t))&&vt(r,"has",t),n}ownKeys(r){return vt(r,"iterate",fe(r)?"length":er),Reflect.ownKeys(r)}}class Qd extends Yd{constructor(r=!1){super(!0,r)}set(r,t){return!0}deleteProperty(r,t){return!0}}const im=new Zd,sm=new Qd,am=new Zd(!0),om=new Qd(!0),To=e=>e,es=e=>Reflect.getPrototypeOf(e);function lm(e,r,t){return function(...n){const i=this.__v_raw,s=Ce(i),a=Cr(s),o=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,u=i[e](...n),c=t?To:r?Ps:lt;return!r&&vt(s,"iterate",l?Co:er),{next(){const{value:d,done:f}=u.next();return f?{value:d,done:f}:{value:o?[c(d[0]),c(d[1])]:c(d),done:f}},[Symbol.iterator](){return this}}}}function ts(e){return function(...r){return e==="delete"?!1:e==="clear"?void 0:this}}function um(e,r){const t={get(i){const s=this.__v_raw,a=Ce(s),o=Ce(i);e||(Bn(i,o)&&vt(a,"get",i),vt(a,"get",o));const{has:l}=es(a),u=r?To:e?Ps:lt;if(l.call(a,i))return u(s.get(i));if(l.call(a,o))return u(s.get(o));s!==a&&s.get(i)},get size(){const i=this.__v_raw;return!e&&vt(Ce(i),"iterate",er),Reflect.get(i,"size",i)},has(i){const s=this.__v_raw,a=Ce(s),o=Ce(i);return e||(Bn(i,o)&&vt(a,"has",i),vt(a,"has",o)),i===o?s.has(i):s.has(i)||s.has(o)},forEach(i,s){const a=this,o=a.__v_raw,l=Ce(o),u=r?To:e?Ps:lt;return!e&&vt(l,"iterate",er),o.forEach((c,d)=>i.call(s,u(c),u(d),a))}};return at(t,e?{add:ts("add"),set:ts("set"),delete:ts("delete"),clear:ts("clear")}:{add(i){!r&&!Ft(i)&&!Hn(i)&&(i=Ce(i));const s=Ce(this);return es(s).has.call(s,i)||(s.add(i),cn(s,"add",i,i)),this},set(i,s){!r&&!Ft(s)&&!Hn(s)&&(s=Ce(s));const a=Ce(this),{has:o,get:l}=es(a);let u=o.call(a,i);u||(i=Ce(i),u=o.call(a,i));const c=l.call(a,i);return a.set(i,s),u?Bn(s,c)&&cn(a,"set",i,s):cn(a,"add",i,s),this},delete(i){const s=Ce(this),{has:a,get:o}=es(s);let l=a.call(s,i);l||(i=Ce(i),l=a.call(s,i)),o&&o.call(s,i);const u=s.delete(i);return l&&cn(s,"delete",i,void 0),u},clear(){const i=Ce(this),s=i.size!==0,a=i.clear();return s&&cn(i,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=lm(i,e,r)}),t}function ia(e,r){const t=um(e,r);return(n,i,s)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?n:Reflect.get(Ie(t,i)&&i in n?t:n,i,s)}const cm={get:ia(!1,!1)},dm={get:ia(!1,!0)},fm={get:ia(!0,!1)},hm={get:ia(!0,!0)},ef=new WeakMap,tf=new WeakMap,nf=new WeakMap,rf=new WeakMap;function pm(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function mm(e){return e.__v_skip||!Object.isExtensible(e)?0:pm(jp(e))}function jt(e){return Hn(e)?e:sa(e,!1,im,cm,ef)}function vm(e){return sa(e,!1,am,dm,tf)}function Nr(e){return sa(e,!0,sm,fm,nf)}function gm(e){return sa(e,!0,om,hm,rf)}function sa(e,r,t,n,i){if(!qe(e)||e.__v_raw&&!(r&&e.__v_isReactive))return e;const s=mm(e);if(s===0)return e;const a=i.get(e);if(a)return a;const o=new Proxy(e,s===2?n:t);return i.set(e,o),o}function Fn(e){return Hn(e)?Fn(e.__v_raw):!!(e&&e.__v_isReactive)}function Hn(e){return!!(e&&e.__v_isReadonly)}function Ft(e){return!!(e&&e.__v_isShallow)}function _l(e){return e?!!e.__v_raw:!1}function Ce(e){const r=e&&e.__v_raw;return r?Ce(r):e}function El(e){return!Ie(e,"__v_skip")&&Object.isExtensible(e)&&Eo(e,"__v_skip",!0),e}const lt=e=>qe(e)?jt(e):e,Ps=e=>qe(e)?Nr(e):e;function Ke(e){return e?e.__v_isRef===!0:!1}function ee(e){return sf(e,!1)}function Dt(e){return sf(e,!0)}function sf(e,r){return Ke(e)?e:new ym(e,r)}class ym{constructor(r,t){this.dep=new na,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?r:Ce(r),this._value=t?r:lt(r),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(r){const t=this._rawValue,n=this.__v_isShallow||Ft(r)||Hn(r);r=n?r:Ce(r),Bn(r,t)&&(this._rawValue=r,this._value=n?r:lt(r),this.dep.trigger())}}function Lr(e){return Ke(e)?e.value:e}function Qt(e){return ve(e)?e():Lr(e)}const bm={get:(e,r,t)=>r==="__v_raw"?e:Lr(Reflect.get(e,r,t)),set:(e,r,t,n)=>{const i=e[r];return Ke(i)&&!Ke(t)?(i.value=t,!0):Reflect.set(e,r,t,n)}};function af(e){return Fn(e)?e:new Proxy(e,bm)}class Sm{constructor(r){this.__v_isRef=!0,this._value=void 0;const t=this.dep=new na,{get:n,set:i}=r(t.track.bind(t),t.trigger.bind(t));this._get=n,this._set=i}get value(){return this._value=this._get()}set value(r){this._set(r)}}function km(e){return new Sm(e)}function nn(e){const r=fe(e)?new Array(e.length):{};for(const t in e)r[t]=of(e,t);return r}class _m{constructor(r,t,n){this._object=r,this._key=t,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0}get value(){const r=this._object[this._key];return this._value=r===void 0?this._defaultValue:r}set value(r){this._object[this._key]=r}get dep(){return Qp(Ce(this._object),this._key)}}class Em{constructor(r){this._getter=r,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function Ao(e,r,t){return Ke(e)?e:ve(e)?new Em(e):qe(e)&&arguments.length>1?of(e,r,t):ee(e)}function of(e,r,t){const n=e[r];return Ke(n)?n:new _m(e,r,t)}class wm{constructor(r,t,n){this.fn=r,this.setter=t,this._value=void 0,this.dep=new na(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Li-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&ze!==this)return Wd(this,!0),!0}get value(){const r=this.dep.track();return Gd(this),r&&(r.version=this.dep.version),this._value}set value(r){this.setter&&this.setter(r)}}function Cm(e,r,t=!1){let n,i;return ve(e)?n=e:(n=e.get,i=e.set),new wm(n,i,t)}const ns={},Ns=new WeakMap;let Yn;function Tm(e,r=!1,t=Yn){if(t){let n=Ns.get(t);n||Ns.set(t,n=[]),n.push(e)}}function Am(e,r,t=De){const{immediate:n,deep:i,once:s,scheduler:a,augmentJob:o,call:l}=t,u=_=>i?_:Ft(_)||i===!1||i===0?dn(_,1):dn(_);let c,d,f,h,p=!1,m=!1;if(Ke(e)?(d=()=>e.value,p=Ft(e)):Fn(e)?(d=()=>u(e),p=!0):fe(e)?(m=!0,p=e.some(_=>Fn(_)||Ft(_)),d=()=>e.map(_=>{if(Ke(_))return _.value;if(Fn(_))return u(_);if(ve(_))return l?l(_,2):_()})):ve(e)?r?d=l?()=>l(e,2):e:d=()=>{if(f){vn();try{f()}finally{gn()}}const _=Yn;Yn=c;try{return l?l(e,3,[h]):e(h)}finally{Yn=_}}:d=Zt,r&&i){const _=d,E=i===!0?1/0:i;d=()=>dn(_(),E)}const v=ta(),y=()=>{c.stop(),v&&v.active&&vl(v.effects,c)};if(s&&r){const _=r;r=(...E)=>{_(...E),y()}}let b=m?new Array(e.length).fill(ns):ns;const M=_=>{if(!(!(c.flags&1)||!c.dirty&&!_))if(r){const E=c.run();if(i||p||(m?E.some((C,B)=>Bn(C,b[B])):Bn(E,b))){f&&f();const C=Yn;Yn=c;try{const B=[E,b===ns?void 0:m&&b[0]===ns?[]:b,h];b=E,l?l(r,3,B):r(...B)}finally{Yn=C}}}else c.run()};return o&&o(M),c=new Hd(d),c.scheduler=a?()=>a(M,!1):M,h=_=>Tm(_,!1,c),f=c.onStop=()=>{const _=Ns.get(c);if(_){if(l)l(_,4);else for(const E of _)E();Ns.delete(c)}},r?n?M(!0):b=c.run():a?a(M.bind(null,!0),!0):c.run(),y.pause=c.pause.bind(c),y.resume=c.resume.bind(c),y.stop=y,y}function dn(e,r=1/0,t){if(r<=0||!qe(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),r--,Ke(e))dn(e.value,r,t);else if(fe(e))for(let n=0;n<e.length;n++)dn(e[n],r,t);else if(Rd(e)||Cr(e))e.forEach(n=>{dn(n,r,t)});else if(Bd(e)){for(const n in e)dn(e[n],r,t);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&dn(e[n],r,t)}return e}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Gi(e,r,t,n){try{return n?e(...n):e()}catch(i){aa(i,r,t)}}function Wt(e,r,t,n){if(ve(e)){const i=Gi(e,r,t,n);return i&&Pd(i)&&i.catch(s=>{aa(s,r,t)}),i}if(fe(e)){const i=[];for(let s=0;s<e.length;s++)i.push(Wt(e[s],r,t,n));return i}}function aa(e,r,t,n=!0){const i=r?r.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:a}=r&&r.appContext.config||De;if(r){let o=r.parent;const l=r.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;o;){const c=o.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](e,l,u)===!1)return}o=o.parent}if(s){vn(),Gi(s,null,10,[e,l,u]),gn();return}}Mm(e,t,i,n,a)}function Mm(e,r,t,n=!0,i=!1){if(i)throw e;console.error(e)}const Ct=[];let Kt=-1;const Tr=[];let On=null,kr=0;const lf=Promise.resolve();let Bs=null;function sr(e){const r=Bs||lf;return e?r.then(this?e.bind(this):e):r}function xm(e){let r=Kt+1,t=Ct.length;for(;r<t;){const n=r+t>>>1,i=Ct[n],s=Ri(i);s<e||s===e&&i.flags&2?r=n+1:t=n}return r}function wl(e){if(!(e.flags&1)){const r=Ri(e),t=Ct[Ct.length-1];!t||!(e.flags&2)&&r>=Ri(t)?Ct.push(e):Ct.splice(xm(r),0,e),e.flags|=1,uf()}}function uf(){Bs||(Bs=lf.then(df))}function Im(e){fe(e)?Tr.push(...e):On&&e.id===-1?On.splice(kr+1,0,e):e.flags&1||(Tr.push(e),e.flags|=1),uf()}function Eu(e,r,t=Kt+1){for(;t<Ct.length;t++){const n=Ct[t];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;Ct.splice(t,1),t--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function cf(e){if(Tr.length){const r=[...new Set(Tr)].sort((t,n)=>Ri(t)-Ri(n));if(Tr.length=0,On){On.push(...r);return}for(On=r,kr=0;kr<On.length;kr++){const t=On[kr];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}On=null,kr=0}}const Ri=e=>e.id==null?e.flags&2?-1:1/0:e.id;function df(e){try{for(Kt=0;Kt<Ct.length;Kt++){const r=Ct[Kt];r&&!(r.flags&8)&&(r.flags&4&&(r.flags&=-2),Gi(r,r.i,r.i?15:14),r.flags&4||(r.flags&=-2))}}finally{for(;Kt<Ct.length;Kt++){const r=Ct[Kt];r&&(r.flags&=-2)}Kt=-1,Ct.length=0,cf(),Bs=null,(Ct.length||Tr.length)&&df()}}let ct=null,ff=null;function Fs(e){const r=ct;return ct=e,ff=e&&e.type.__scopeId||null,r}function Te(e,r=ct,t){if(!r||e._n)return e;const n=(...i)=>{n._d&&Fu(-1);const s=Fs(r);let a;try{a=e(...i)}finally{Fs(s),n._d&&Fu(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function yi(e,r){if(ct===null)return e;const t=fa(ct),n=e.dirs||(e.dirs=[]);for(let i=0;i<r.length;i++){let[s,a,o,l=De]=r[i];s&&(ve(s)&&(s={mounted:s,updated:s}),s.deep&&dn(a),n.push({dir:s,instance:t,value:a,oldValue:void 0,arg:o,modifiers:l}))}return e}function qn(e,r,t,n){const i=e.dirs,s=r&&r.dirs;for(let a=0;a<i.length;a++){const o=i[a];s&&(o.oldValue=s[a].value);let l=o.dir[n];l&&(vn(),Wt(l,t,8,[e.el,o,e,r]),gn())}}const hf=Symbol("_vte"),pf=e=>e.__isTeleport,bi=e=>e&&(e.disabled||e.disabled===""),wu=e=>e&&(e.defer||e.defer===""),Cu=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Tu=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Mo=(e,r)=>{const t=e&&e.to;return Ye(t)?r?r(t):null:t},mf={name:"Teleport",__isTeleport:!0,process(e,r,t,n,i,s,a,o,l,u){const{mc:c,pc:d,pbc:f,o:{insert:h,querySelector:p,createText:m,createComment:v}}=u,y=bi(r.props);let{shapeFlag:b,children:M,dynamicChildren:_}=r;if(e==null){const E=r.el=m(""),C=r.anchor=m("");h(E,t,n),h(C,t,n);const B=(R,L)=>{b&16&&(i&&i.isCE&&(i.ce._teleportTarget=R),c(M,R,L,i,s,a,o,l))},P=()=>{const R=r.target=Mo(r.props,p),L=gf(R,r,m,h);R&&(a!=="svg"&&Cu(R)?a="svg":a!=="mathml"&&Tu(R)&&(a="mathml"),y||(B(R,L),hs(r,!1)))};y&&(B(t,C),hs(r,!0)),wu(r.props)?(r.el.__isMounted=!1,_t(()=>{P(),delete r.el.__isMounted},s)):P()}else{if(wu(r.props)&&e.el.__isMounted===!1){_t(()=>{mf.process(e,r,t,n,i,s,a,o,l,u)},s);return}r.el=e.el,r.targetStart=e.targetStart;const E=r.anchor=e.anchor,C=r.target=e.target,B=r.targetAnchor=e.targetAnchor,P=bi(e.props),R=P?t:C,L=P?E:B;if(a==="svg"||Cu(C)?a="svg":(a==="mathml"||Tu(C))&&(a="mathml"),_?(f(e.dynamicChildren,_,R,i,s,a,o),xl(e,r,!0)):l||d(e,r,R,L,i,s,a,o,!1),y)P?r.props&&e.props&&r.props.to!==e.props.to&&(r.props.to=e.props.to):rs(r,t,E,u,1);else if((r.props&&r.props.to)!==(e.props&&e.props.to)){const x=r.target=Mo(r.props,p);x&&rs(r,x,null,u,0)}else P&&rs(r,C,B,u,1);hs(r,y)}},remove(e,r,t,{um:n,o:{remove:i}},s){const{shapeFlag:a,children:o,anchor:l,targetStart:u,targetAnchor:c,target:d,props:f}=e;if(d&&(i(u),i(c)),s&&i(l),a&16){const h=s||!bi(f);for(let p=0;p<o.length;p++){const m=o[p];n(m,r,t,h,!!m.dynamicChildren)}}},move:rs,hydrate:Lm};function rs(e,r,t,{o:{insert:n},m:i},s=2){s===0&&n(e.targetAnchor,r,t);const{el:a,anchor:o,shapeFlag:l,children:u,props:c}=e,d=s===2;if(d&&n(a,r,t),(!d||bi(c))&&l&16)for(let f=0;f<u.length;f++)i(u[f],r,t,2);d&&n(o,r,t)}function Lm(e,r,t,n,i,s,{o:{nextSibling:a,parentNode:o,querySelector:l,insert:u,createText:c}},d){const f=r.target=Mo(r.props,l);if(f){const h=bi(r.props),p=f._lpa||f.firstChild;if(r.shapeFlag&16)if(h)r.anchor=d(a(e),r,o(e),t,n,i,s),r.targetStart=p,r.targetAnchor=p&&a(p);else{r.anchor=a(e);let m=p;for(;m;){if(m&&m.nodeType===8){if(m.data==="teleport start anchor")r.targetStart=m;else if(m.data==="teleport anchor"){r.targetAnchor=m,f._lpa=r.targetAnchor&&a(r.targetAnchor);break}}m=a(m)}r.targetAnchor||gf(f,r,c,u),d(p&&a(p),r,f,t,n,i,s)}hs(r,h)}return r.anchor&&a(r.anchor)}const vf=mf;function hs(e,r){const t=e.ctx;if(t&&t.ut){let n,i;for(r?(n=e.el,i=e.anchor):(n=e.targetStart,i=e.targetAnchor);n&&n!==i;)n.nodeType===1&&n.setAttribute("data-v-owner",t.uid),n=n.nextSibling;t.ut()}}function gf(e,r,t,n){const i=r.targetStart=t(""),s=r.targetAnchor=t("");return i[hf]=s,e&&(n(i,e),n(s,e)),s}const Rn=Symbol("_leaveCb"),is=Symbol("_enterCb");function Om(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Rt(()=>{e.isMounted=!0}),Br(()=>{e.isUnmounting=!0}),e}const Bt=[Function,Array],yf={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Bt,onEnter:Bt,onAfterEnter:Bt,onEnterCancelled:Bt,onBeforeLeave:Bt,onLeave:Bt,onAfterLeave:Bt,onLeaveCancelled:Bt,onBeforeAppear:Bt,onAppear:Bt,onAfterAppear:Bt,onAppearCancelled:Bt},bf=e=>{const r=e.subTree;return r.component?bf(r.component):r},Rm={name:"BaseTransition",props:yf,setup(e,{slots:r}){const t=Vn(),n=Om();return()=>{const i=r.default&&_f(r.default(),!0);if(!i||!i.length)return;const s=Sf(i),a=Ce(e),{mode:o}=a;if(n.isLeaving)return Oa(s);const l=Au(s);if(!l)return Oa(s);let u=xo(l,a,n,t,d=>u=d);l.type!==ut&&Pi(l,u);let c=t.subTree&&Au(t.subTree);if(c&&c.type!==ut&&!Zn(l,c)&&bf(t).type!==ut){let d=xo(c,a,n,t);if(Pi(c,d),o==="out-in"&&l.type!==ut)return n.isLeaving=!0,d.afterLeave=()=>{n.isLeaving=!1,t.job.flags&8||t.update(),delete d.afterLeave,c=void 0},Oa(s);o==="in-out"&&l.type!==ut?d.delayLeave=(f,h,p)=>{const m=kf(n,c);m[String(c.key)]=c,f[Rn]=()=>{h(),f[Rn]=void 0,delete u.delayedLeave,c=void 0},u.delayedLeave=()=>{p(),delete u.delayedLeave,c=void 0}}:c=void 0}else c&&(c=void 0);return s}}};function Sf(e){let r=e[0];if(e.length>1){for(const t of e)if(t.type!==ut){r=t;break}}return r}const Pm=Rm;function kf(e,r){const{leavingVNodes:t}=e;let n=t.get(r.type);return n||(n=Object.create(null),t.set(r.type,n)),n}function xo(e,r,t,n,i){const{appear:s,mode:a,persisted:o=!1,onBeforeEnter:l,onEnter:u,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:f,onLeave:h,onAfterLeave:p,onLeaveCancelled:m,onBeforeAppear:v,onAppear:y,onAfterAppear:b,onAppearCancelled:M}=r,_=String(e.key),E=kf(t,e),C=(R,L)=>{R&&Wt(R,n,9,L)},B=(R,L)=>{const x=L[1];C(R,L),fe(R)?R.every(k=>k.length<=1)&&x():R.length<=1&&x()},P={mode:a,persisted:o,beforeEnter(R){let L=l;if(!t.isMounted)if(s)L=v||l;else return;R[Rn]&&R[Rn](!0);const x=E[_];x&&Zn(e,x)&&x.el[Rn]&&x.el[Rn](),C(L,[R])},enter(R){let L=u,x=c,k=d;if(!t.isMounted)if(s)L=y||u,x=b||c,k=M||d;else return;let F=!1;const I=R[is]=G=>{F||(F=!0,G?C(k,[R]):C(x,[R]),P.delayedLeave&&P.delayedLeave(),R[is]=void 0)};L?B(L,[R,I]):I()},leave(R,L){const x=String(e.key);if(R[is]&&R[is](!0),t.isUnmounting)return L();C(f,[R]);let k=!1;const F=R[Rn]=I=>{k||(k=!0,L(),I?C(m,[R]):C(p,[R]),R[Rn]=void 0,E[x]===e&&delete E[x])};E[x]=e,h?B(h,[R,F]):F()},clone(R){const L=xo(R,r,t,n,i);return i&&i(L),L}};return P}function Oa(e){if(oa(e))return e=yn(e),e.children=null,e}function Au(e){if(!oa(e))return pf(e.type)&&e.children?Sf(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:r,children:t}=e;if(t){if(r&16)return t[0];if(r&32&&ve(t.default))return t.default()}}function Pi(e,r){e.shapeFlag&6&&e.component?(e.transition=r,Pi(e.component.subTree,r)):e.shapeFlag&128?(e.ssContent.transition=r.clone(e.ssContent),e.ssFallback.transition=r.clone(e.ssFallback)):e.transition=r}function _f(e,r=!1,t){let n=[],i=0;for(let s=0;s<e.length;s++){let a=e[s];const o=t==null?a.key:String(t)+String(a.key!=null?a.key:s);a.type===Ge?(a.patchFlag&128&&i++,n=n.concat(_f(a.children,r,o))):(r||a.type!==ut)&&n.push(o!=null?yn(a,{key:o}):a)}if(i>1)for(let s=0;s<n.length;s++)n[s].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function _e(e,r){return ve(e)?at({name:e.name},r,{setup:e}):e}function Ef(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Si(e,r,t,n,i=!1){if(fe(e)){e.forEach((p,m)=>Si(p,r&&(fe(r)?r[m]:r),t,n,i));return}if(Ar(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Si(e,r,t,n.component.subTree);return}const s=n.shapeFlag&4?fa(n.component):n.el,a=i?null:s,{i:o,r:l}=e,u=r&&r.r,c=o.refs===De?o.refs={}:o.refs,d=o.setupState,f=Ce(d),h=d===De?()=>!1:p=>Ie(f,p);if(u!=null&&u!==l&&(Ye(u)?(c[u]=null,h(u)&&(d[u]=null)):Ke(u)&&(u.value=null)),ve(l))Gi(l,o,12,[a,c]);else{const p=Ye(l),m=Ke(l);if(p||m){const v=()=>{if(e.f){const y=p?h(l)?d[l]:c[l]:l.value;i?fe(y)&&vl(y,s):fe(y)?y.includes(s)||y.push(s):p?(c[l]=[s],h(l)&&(d[l]=c[l])):(l.value=[s],e.k&&(c[e.k]=l.value))}else p?(c[l]=a,h(l)&&(d[l]=a)):m&&(l.value=a,e.k&&(c[e.k]=a))};a?(v.id=-1,_t(v,t)):v()}}}ea().requestIdleCallback;ea().cancelIdleCallback;const Ar=e=>!!e.type.__asyncLoader,oa=e=>e.type.__isKeepAlive;function Nm(e,r){Cf(e,"a",r)}function wf(e,r){Cf(e,"da",r)}function Cf(e,r,t=gt){const n=e.__wdc||(e.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(la(r,n,t),t){let i=t.parent;for(;i&&i.parent;)oa(i.parent.vnode)&&Bm(n,r,t,i),i=i.parent}}function Bm(e,r,t,n){const i=la(r,e,n,!0);Tf(()=>{vl(n[r],i)},t)}function la(e,r,t=gt,n=!1){if(t){const i=t[e]||(t[e]=[]),s=r.__weh||(r.__weh=(...a)=>{vn();const o=Xi(t),l=Wt(r,t,e,a);return o(),gn(),l});return n?i.unshift(s):i.push(s),s}}const En=e=>(r,t=gt)=>{(!Fi||e==="sp")&&la(e,(...n)=>r(...n),t)},Fm=En("bm"),Rt=En("m"),Dm=En("bu"),Ki=En("u"),Br=En("bum"),Tf=En("um"),$m=En("sp"),jm=En("rtg"),Um=En("rtc");function Hm(e,r=gt){la("ec",e,r)}const zm="components";function We(e,r){return Vm(zm,e,!0,r)||e}const Wm=Symbol.for("v-ndc");function Vm(e,r,t=!0,n=!1){const i=ct||gt;if(i){const s=i.type;{const o=Iv(s,!1);if(o&&(o===r||o===$t(r)||o===Qs($t(r))))return s}const a=Mu(i[e]||s[e],r)||Mu(i.appContext[e],r);return!a&&n?s:a}}function Mu(e,r){return e&&(e[r]||e[$t(r)]||e[Qs($t(r))])}function Cl(e,r,t,n){let i;const s=t,a=fe(e);if(a||Ye(e)){const o=a&&Fn(e);let l=!1,u=!1;o&&(l=!Ft(e),u=Hn(e),e=ra(e)),i=new Array(e.length);for(let c=0,d=e.length;c<d;c++)i[c]=r(l?u?Ps(lt(e[c])):lt(e[c]):e[c],c,void 0,s)}else if(typeof e=="number"){i=new Array(e);for(let o=0;o<e;o++)i[o]=r(o+1,o,void 0,s)}else if(qe(e))if(e[Symbol.iterator])i=Array.from(e,(o,l)=>r(o,l,void 0,s));else{const o=Object.keys(e);i=new Array(o.length);for(let l=0,u=o.length;l<u;l++){const c=o[l];i[l]=r(e[c],c,l,s)}}else i=[];return i}function Ra(e,r){for(let t=0;t<r.length;t++){const n=r[t];if(fe(n))for(let i=0;i<n.length;i++)e[n[i].name]=n[i].fn;else n&&(e[n.name]=n.key?(...i)=>{const s=n.fn(...i);return s&&(s.key=n.key),s}:n.fn)}return e}function $e(e,r,t={},n,i){if(ct.ce||ct.parent&&Ar(ct.parent)&&ct.parent.ce)return r!=="default"&&(t.name=r),q(),Le(Ge,null,[ne("slot",t,n&&n())],64);let s=e[r];s&&s._c&&(s._d=!1),q();const a=s&&Af(s(t)),o=t.key||a&&a.key,l=Le(Ge,{key:(o&&!_n(o)?o:`_${r}`)+(!a&&n?"_fb":"")},a||(n?n():[]),a&&e._===1?64:-2);return l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),s&&s._c&&(s._d=!0),l}function Af(e){return e.some(r=>Bi(r)?!(r.type===ut||r.type===Ge&&!Af(r.children)):!0)?e:null}const Io=e=>e?Vf(e)?fa(e):Io(e.parent):null,ki=at(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Io(e.parent),$root:e=>Io(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>xf(e),$forceUpdate:e=>e.f||(e.f=()=>{wl(e.update)}),$nextTick:e=>e.n||(e.n=sr.bind(e.proxy)),$watch:e=>fv.bind(e)}),Pa=(e,r)=>e!==De&&!e.__isScriptSetup&&Ie(e,r),qm={get({_:e},r){if(r==="__v_skip")return!0;const{ctx:t,setupState:n,data:i,props:s,accessCache:a,type:o,appContext:l}=e;let u;if(r[0]!=="$"){const h=a[r];if(h!==void 0)switch(h){case 1:return n[r];case 2:return i[r];case 4:return t[r];case 3:return s[r]}else{if(Pa(n,r))return a[r]=1,n[r];if(i!==De&&Ie(i,r))return a[r]=2,i[r];if((u=e.propsOptions[0])&&Ie(u,r))return a[r]=3,s[r];if(t!==De&&Ie(t,r))return a[r]=4,t[r];Lo&&(a[r]=0)}}const c=ki[r];let d,f;if(c)return r==="$attrs"&&vt(e.attrs,"get",""),c(e);if((d=o.__cssModules)&&(d=d[r]))return d;if(t!==De&&Ie(t,r))return a[r]=4,t[r];if(f=l.config.globalProperties,Ie(f,r))return f[r]},set({_:e},r,t){const{data:n,setupState:i,ctx:s}=e;return Pa(i,r)?(i[r]=t,!0):n!==De&&Ie(n,r)?(n[r]=t,!0):Ie(e.props,r)||r[0]==="$"&&r.slice(1)in e?!1:(s[r]=t,!0)},has({_:{data:e,setupState:r,accessCache:t,ctx:n,appContext:i,propsOptions:s}},a){let o;return!!t[a]||e!==De&&Ie(e,a)||Pa(r,a)||(o=s[0])&&Ie(o,a)||Ie(n,a)||Ie(ki,a)||Ie(i.config.globalProperties,a)},defineProperty(e,r,t){return t.get!=null?e._.accessCache[r]=0:Ie(t,"value")&&this.set(e,r,t.value,null),Reflect.defineProperty(e,r,t)}};function xu(e){return fe(e)?e.reduce((r,t)=>(r[t]=null,r),{}):e}let Lo=!0;function Gm(e){const r=xf(e),t=e.proxy,n=e.ctx;Lo=!1,r.beforeCreate&&Iu(r.beforeCreate,e,"bc");const{data:i,computed:s,methods:a,watch:o,provide:l,inject:u,created:c,beforeMount:d,mounted:f,beforeUpdate:h,updated:p,activated:m,deactivated:v,beforeDestroy:y,beforeUnmount:b,destroyed:M,unmounted:_,render:E,renderTracked:C,renderTriggered:B,errorCaptured:P,serverPrefetch:R,expose:L,inheritAttrs:x,components:k,directives:F,filters:I}=r;if(u&&Km(u,n,null),a)for(const K in a){const te=a[K];ve(te)&&(n[K]=te.bind(t))}if(i){const K=i.call(t,t);qe(K)&&(e.data=jt(K))}if(Lo=!0,s)for(const K in s){const te=s[K],Se=ve(te)?te.bind(t,t):ve(te.get)?te.get.bind(t,t):Zt,Me=!ve(te)&&ve(te.set)?te.set.bind(t):Zt,Re=j({get:Se,set:Me});Object.defineProperty(n,K,{enumerable:!0,configurable:!0,get:()=>Re.value,set:Xe=>Re.value=Xe})}if(o)for(const K in o)Mf(o[K],n,t,K);if(l){const K=ve(l)?l.call(t):l;Reflect.ownKeys(K).forEach(te=>{Ji(te,K[te])})}c&&Iu(c,e,"c");function Z(K,te){fe(te)?te.forEach(Se=>K(Se.bind(t))):te&&K(te.bind(t))}if(Z(Fm,d),Z(Rt,f),Z(Dm,h),Z(Ki,p),Z(Nm,m),Z(wf,v),Z(Hm,P),Z(Um,C),Z(jm,B),Z(Br,b),Z(Tf,_),Z($m,R),fe(L))if(L.length){const K=e.exposed||(e.exposed={});L.forEach(te=>{Object.defineProperty(K,te,{get:()=>t[te],set:Se=>t[te]=Se,enumerable:!0})})}else e.exposed||(e.exposed={});E&&e.render===Zt&&(e.render=E),x!=null&&(e.inheritAttrs=x),k&&(e.components=k),F&&(e.directives=F),R&&Ef(e)}function Km(e,r,t=Zt){fe(e)&&(e=Oo(e));for(const n in e){const i=e[n];let s;qe(i)?"default"in i?s=Tt(i.from||n,i.default,!0):s=Tt(i.from||n):s=Tt(i),Ke(s)?Object.defineProperty(r,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):r[n]=s}}function Iu(e,r,t){Wt(fe(e)?e.map(n=>n.bind(r.proxy)):e.bind(r.proxy),r,t)}function Mf(e,r,t,n){let i=n.includes(".")?jf(t,n):()=>t[n];if(Ye(e)){const s=r[e];ve(s)&&Ve(i,s)}else if(ve(e))Ve(i,e.bind(t));else if(qe(e))if(fe(e))e.forEach(s=>Mf(s,r,t,n));else{const s=ve(e.handler)?e.handler.bind(t):r[e.handler];ve(s)&&Ve(i,s,e)}}function xf(e){const r=e.type,{mixins:t,extends:n}=r,{mixins:i,optionsCache:s,config:{optionMergeStrategies:a}}=e.appContext,o=s.get(r);let l;return o?l=o:!i.length&&!t&&!n?l=r:(l={},i.length&&i.forEach(u=>Ds(l,u,a,!0)),Ds(l,r,a)),qe(r)&&s.set(r,l),l}function Ds(e,r,t,n=!1){const{mixins:i,extends:s}=r;s&&Ds(e,s,t,!0),i&&i.forEach(a=>Ds(e,a,t,!0));for(const a in r)if(!(n&&a==="expose")){const o=Jm[a]||t&&t[a];e[a]=o?o(e[a],r[a]):r[a]}return e}const Jm={data:Lu,props:Ou,emits:Ou,methods:li,computed:li,beforeCreate:St,created:St,beforeMount:St,mounted:St,beforeUpdate:St,updated:St,beforeDestroy:St,beforeUnmount:St,destroyed:St,unmounted:St,activated:St,deactivated:St,errorCaptured:St,serverPrefetch:St,components:li,directives:li,watch:Ym,provide:Lu,inject:Xm};function Lu(e,r){return r?e?function(){return at(ve(e)?e.call(this,this):e,ve(r)?r.call(this,this):r)}:r:e}function Xm(e,r){return li(Oo(e),Oo(r))}function Oo(e){if(fe(e)){const r={};for(let t=0;t<e.length;t++)r[e[t]]=e[t];return r}return e}function St(e,r){return e?[...new Set([].concat(e,r))]:r}function li(e,r){return e?at(Object.create(null),e,r):r}function Ou(e,r){return e?fe(e)&&fe(r)?[...new Set([...e,...r])]:at(Object.create(null),xu(e),xu(r??{})):r}function Ym(e,r){if(!e)return r;if(!r)return e;const t=at(Object.create(null),e);for(const n in r)t[n]=St(e[n],r[n]);return t}function If(){return{app:null,config:{isNativeTag:Dp,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Zm=0;function Qm(e,r){return function(n,i=null){ve(n)||(n=at({},n)),i!=null&&!qe(i)&&(i=null);const s=If(),a=new WeakSet,o=[];let l=!1;const u=s.app={_uid:Zm++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:Rv,get config(){return s.config},set config(c){},use(c,...d){return a.has(c)||(c&&ve(c.install)?(a.add(c),c.install(u,...d)):ve(c)&&(a.add(c),c(u,...d))),u},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),u},component(c,d){return d?(s.components[c]=d,u):s.components[c]},directive(c,d){return d?(s.directives[c]=d,u):s.directives[c]},mount(c,d,f){if(!l){const h=u._ceVNode||ne(n,i);return h.appContext=s,f===!0?f="svg":f===!1&&(f=void 0),e(h,c,f),l=!0,u._container=c,c.__vue_app__=u,fa(h.component)}},onUnmount(c){o.push(c)},unmount(){l&&(Wt(o,u._instance,16),e(null,u._container),delete u._container.__vue_app__)},provide(c,d){return s.provides[c]=d,u},runWithContext(c){const d=tr;tr=u;try{return c()}finally{tr=d}}};return u}}let tr=null;function Ji(e,r){if(gt){let t=gt.provides;const n=gt.parent&&gt.parent.provides;n===t&&(t=gt.provides=Object.create(n)),t[e]=r}}function Tt(e,r,t=!1){const n=Vn();if(n||tr){let i=tr?tr._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return t&&ve(r)?r.call(n&&n.proxy):r}}function Tl(){return!!(Vn()||tr)}const Lf={},Of=()=>Object.create(Lf),Rf=e=>Object.getPrototypeOf(e)===Lf;function ev(e,r,t,n=!1){const i={},s=Of();e.propsDefaults=Object.create(null),Pf(e,r,i,s);for(const a in e.propsOptions[0])a in i||(i[a]=void 0);t?e.props=n?i:vm(i):e.type.props?e.props=i:e.props=s,e.attrs=s}function tv(e,r,t,n){const{props:i,attrs:s,vnode:{patchFlag:a}}=e,o=Ce(i),[l]=e.propsOptions;let u=!1;if((n||a>0)&&!(a&16)){if(a&8){const c=e.vnode.dynamicProps;for(let d=0;d<c.length;d++){let f=c[d];if(ca(e.emitsOptions,f))continue;const h=r[f];if(l)if(Ie(s,f))h!==s[f]&&(s[f]=h,u=!0);else{const p=$t(f);i[p]=Ro(l,o,p,h,e,!1)}else h!==s[f]&&(s[f]=h,u=!0)}}}else{Pf(e,r,i,s)&&(u=!0);let c;for(const d in o)(!r||!Ie(r,d)&&((c=cr(d))===d||!Ie(r,c)))&&(l?t&&(t[d]!==void 0||t[c]!==void 0)&&(i[d]=Ro(l,o,d,void 0,e,!0)):delete i[d]);if(s!==o)for(const d in s)(!r||!Ie(r,d))&&(delete s[d],u=!0)}u&&cn(e.attrs,"set","")}function Pf(e,r,t,n){const[i,s]=e.propsOptions;let a=!1,o;if(r)for(let l in r){if(mi(l))continue;const u=r[l];let c;i&&Ie(i,c=$t(l))?!s||!s.includes(c)?t[c]=u:(o||(o={}))[c]=u:ca(e.emitsOptions,l)||(!(l in n)||u!==n[l])&&(n[l]=u,a=!0)}if(s){const l=Ce(t),u=o||De;for(let c=0;c<s.length;c++){const d=s[c];t[d]=Ro(i,l,d,u[d],e,!Ie(u,d))}}return a}function Ro(e,r,t,n,i,s){const a=e[t];if(a!=null){const o=Ie(a,"default");if(o&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&ve(l)){const{propsDefaults:u}=i;if(t in u)n=u[t];else{const c=Xi(i);n=u[t]=l.call(null,r),c()}}else n=l;i.ce&&i.ce._setProp(t,n)}a[0]&&(s&&!o?n=!1:a[1]&&(n===""||n===cr(t))&&(n=!0))}return n}const nv=new WeakMap;function Nf(e,r,t=!1){const n=t?nv:r.propsCache,i=n.get(e);if(i)return i;const s=e.props,a={},o=[];let l=!1;if(!ve(e)){const c=d=>{l=!0;const[f,h]=Nf(d,r,!0);at(a,f),h&&o.push(...h)};!t&&r.mixins.length&&r.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!s&&!l)return qe(e)&&n.set(e,wr),wr;if(fe(s))for(let c=0;c<s.length;c++){const d=$t(s[c]);Ru(d)&&(a[d]=De)}else if(s)for(const c in s){const d=$t(c);if(Ru(d)){const f=s[c],h=a[d]=fe(f)||ve(f)?{type:f}:at({},f),p=h.type;let m=!1,v=!0;if(fe(p))for(let y=0;y<p.length;++y){const b=p[y],M=ve(b)&&b.name;if(M==="Boolean"){m=!0;break}else M==="String"&&(v=!1)}else m=ve(p)&&p.name==="Boolean";h[0]=m,h[1]=v,(m||Ie(h,"default"))&&o.push(d)}}const u=[a,o];return qe(e)&&n.set(e,u),u}function Ru(e){return e[0]!=="$"&&!mi(e)}const Al=e=>e==="_"||e==="__"||e==="_ctx"||e==="$stable",Ml=e=>fe(e)?e.map(Jt):[Jt(e)],rv=(e,r,t)=>{if(r._n)return r;const n=Te((...i)=>Ml(r(...i)),t);return n._c=!1,n},Bf=(e,r,t)=>{const n=e._ctx;for(const i in e){if(Al(i))continue;const s=e[i];if(ve(s))r[i]=rv(i,s,n);else if(s!=null){const a=Ml(s);r[i]=()=>a}}},Ff=(e,r)=>{const t=Ml(r);e.slots.default=()=>t},Df=(e,r,t)=>{for(const n in r)(t||!Al(n))&&(e[n]=r[n])},iv=(e,r,t)=>{const n=e.slots=Of();if(e.vnode.shapeFlag&32){const i=r.__;i&&Eo(n,"__",i,!0);const s=r._;s?(Df(n,r,t),t&&Eo(n,"_",s,!0)):Bf(r,n)}else r&&Ff(e,r)},sv=(e,r,t)=>{const{vnode:n,slots:i}=e;let s=!0,a=De;if(n.shapeFlag&32){const o=r._;o?t&&o===1?s=!1:Df(i,r,t):(s=!r.$stable,Bf(r,i)),a=r}else r&&(Ff(e,r),a={default:1});if(s)for(const o in i)!Al(o)&&a[o]==null&&delete i[o]},_t=bv;function av(e){return ov(e)}function ov(e,r){const t=ea();t.__VUE__=!0;const{insert:n,remove:i,patchProp:s,createElement:a,createText:o,createComment:l,setText:u,setElementText:c,parentNode:d,nextSibling:f,setScopeId:h=Zt,insertStaticContent:p}=e,m=(S,w,N,H=null,D=null,U=null,Y=void 0,J=null,W=!!w.dynamicChildren)=>{if(S===w)return;S&&!Zn(S,w)&&(H=Vt(S),Xe(S,D,U,!0),S=null),w.patchFlag===-2&&(W=!1,w.dynamicChildren=null);const{type:z,ref:ce,shapeFlag:X}=w;switch(z){case da:v(S,w,N,H);break;case ut:y(S,w,N,H);break;case ps:S==null&&b(w,N,H,Y);break;case Ge:k(S,w,N,H,D,U,Y,J,W);break;default:X&1?E(S,w,N,H,D,U,Y,J,W):X&6?F(S,w,N,H,D,U,Y,J,W):(X&64||X&128)&&z.process(S,w,N,H,D,U,Y,J,W,pt)}ce!=null&&D?Si(ce,S&&S.ref,U,w||S,!w):ce==null&&S&&S.ref!=null&&Si(S.ref,null,U,S,!0)},v=(S,w,N,H)=>{if(S==null)n(w.el=o(w.children),N,H);else{const D=w.el=S.el;w.children!==S.children&&u(D,w.children)}},y=(S,w,N,H)=>{S==null?n(w.el=l(w.children||""),N,H):w.el=S.el},b=(S,w,N,H)=>{[S.el,S.anchor]=p(S.children,w,N,H,S.el,S.anchor)},M=({el:S,anchor:w},N,H)=>{let D;for(;S&&S!==w;)D=f(S),n(S,N,H),S=D;n(w,N,H)},_=({el:S,anchor:w})=>{let N;for(;S&&S!==w;)N=f(S),i(S),S=N;i(w)},E=(S,w,N,H,D,U,Y,J,W)=>{w.type==="svg"?Y="svg":w.type==="math"&&(Y="mathml"),S==null?C(w,N,H,D,U,Y,J,W):R(S,w,D,U,Y,J,W)},C=(S,w,N,H,D,U,Y,J)=>{let W,z;const{props:ce,shapeFlag:X,transition:ae,dirs:pe}=S;if(W=S.el=a(S.type,U,ce&&ce.is,ce),X&8?c(W,S.children):X&16&&P(S.children,W,null,H,D,Na(S,U),Y,J),pe&&qn(S,null,H,"created"),B(W,S,S.scopeId,Y,H),ce){for(const Ne in ce)Ne!=="value"&&!mi(Ne)&&s(W,Ne,null,ce[Ne],U,H);"value"in ce&&s(W,"value",null,ce.value,U),(z=ce.onVnodeBeforeMount)&&Gt(z,H,S)}pe&&qn(S,null,H,"beforeMount");const Ee=lv(D,ae);Ee&&ae.beforeEnter(W),n(W,w,N),((z=ce&&ce.onVnodeMounted)||Ee||pe)&&_t(()=>{z&&Gt(z,H,S),Ee&&ae.enter(W),pe&&qn(S,null,H,"mounted")},D)},B=(S,w,N,H,D)=>{if(N&&h(S,N),H)for(let U=0;U<H.length;U++)h(S,H[U]);if(D){let U=D.subTree;if(w===U||Hf(U.type)&&(U.ssContent===w||U.ssFallback===w)){const Y=D.vnode;B(S,Y,Y.scopeId,Y.slotScopeIds,D.parent)}}},P=(S,w,N,H,D,U,Y,J,W=0)=>{for(let z=W;z<S.length;z++){const ce=S[z]=J?Pn(S[z]):Jt(S[z]);m(null,ce,w,N,H,D,U,Y,J)}},R=(S,w,N,H,D,U,Y)=>{const J=w.el=S.el;let{patchFlag:W,dynamicChildren:z,dirs:ce}=w;W|=S.patchFlag&16;const X=S.props||De,ae=w.props||De;let pe;if(N&&Gn(N,!1),(pe=ae.onVnodeBeforeUpdate)&&Gt(pe,N,w,S),ce&&qn(w,S,N,"beforeUpdate"),N&&Gn(N,!0),(X.innerHTML&&ae.innerHTML==null||X.textContent&&ae.textContent==null)&&c(J,""),z?L(S.dynamicChildren,z,J,N,H,Na(w,D),U):Y||te(S,w,J,null,N,H,Na(w,D),U,!1),W>0){if(W&16)x(J,X,ae,N,D);else if(W&2&&X.class!==ae.class&&s(J,"class",null,ae.class,D),W&4&&s(J,"style",X.style,ae.style,D),W&8){const Ee=w.dynamicProps;for(let Ne=0;Ne<Ee.length;Ne++){const $=Ee[Ne],se=X[$],xe=ae[$];(xe!==se||$==="value")&&s(J,$,se,xe,D,N)}}W&1&&S.children!==w.children&&c(J,w.children)}else!Y&&z==null&&x(J,X,ae,N,D);((pe=ae.onVnodeUpdated)||ce)&&_t(()=>{pe&&Gt(pe,N,w,S),ce&&qn(w,S,N,"updated")},H)},L=(S,w,N,H,D,U,Y)=>{for(let J=0;J<w.length;J++){const W=S[J],z=w[J],ce=W.el&&(W.type===Ge||!Zn(W,z)||W.shapeFlag&198)?d(W.el):N;m(W,z,ce,null,H,D,U,Y,!0)}},x=(S,w,N,H,D)=>{if(w!==N){if(w!==De)for(const U in w)!mi(U)&&!(U in N)&&s(S,U,w[U],null,D,H);for(const U in N){if(mi(U))continue;const Y=N[U],J=w[U];Y!==J&&U!=="value"&&s(S,U,J,Y,D,H)}"value"in N&&s(S,"value",w.value,N.value,D)}},k=(S,w,N,H,D,U,Y,J,W)=>{const z=w.el=S?S.el:o(""),ce=w.anchor=S?S.anchor:o("");let{patchFlag:X,dynamicChildren:ae,slotScopeIds:pe}=w;pe&&(J=J?J.concat(pe):pe),S==null?(n(z,N,H),n(ce,N,H),P(w.children||[],N,ce,D,U,Y,J,W)):X>0&&X&64&&ae&&S.dynamicChildren?(L(S.dynamicChildren,ae,N,D,U,Y,J),(w.key!=null||D&&w===D.subTree)&&xl(S,w,!0)):te(S,w,N,ce,D,U,Y,J,W)},F=(S,w,N,H,D,U,Y,J,W)=>{w.slotScopeIds=J,S==null?w.shapeFlag&512?D.ctx.activate(w,N,H,Y,W):I(w,N,H,D,U,Y,W):G(S,w,W)},I=(S,w,N,H,D,U,Y)=>{const J=S.component=Cv(S,H,D);if(oa(S)&&(J.ctx.renderer=pt),Tv(J,!1,Y),J.asyncDep){if(D&&D.registerDep(J,Z,Y),!S.el){const W=J.subTree=ne(ut);y(null,W,w,N),S.placeholder=W.el}}else Z(J,S,w,N,D,U,Y)},G=(S,w,N)=>{const H=w.component=S.component;if(gv(S,w,N))if(H.asyncDep&&!H.asyncResolved){K(H,w,N);return}else H.next=w,H.update();else w.el=S.el,H.vnode=w},Z=(S,w,N,H,D,U,Y)=>{const J=()=>{if(S.isMounted){let{next:X,bu:ae,u:pe,parent:Ee,vnode:Ne}=S;{const rt=$f(S);if(rt){X&&(X.el=Ne.el,K(S,X,Y)),rt.asyncDep.then(()=>{S.isUnmounted||J()});return}}let $=X,se;Gn(S,!1),X?(X.el=Ne.el,K(S,X,Y)):X=Ne,ae&&Ta(ae),(se=X.props&&X.props.onVnodeBeforeUpdate)&&Gt(se,Ee,X,Ne),Gn(S,!0);const xe=Nu(S),ot=S.subTree;S.subTree=xe,m(ot,xe,d(ot.el),Vt(ot),S,D,U),X.el=xe.el,$===null&&yv(S,xe.el),pe&&_t(pe,D),(se=X.props&&X.props.onVnodeUpdated)&&_t(()=>Gt(se,Ee,X,Ne),D)}else{let X;const{el:ae,props:pe}=w,{bm:Ee,m:Ne,parent:$,root:se,type:xe}=S,ot=Ar(w);Gn(S,!1),Ee&&Ta(Ee),!ot&&(X=pe&&pe.onVnodeBeforeMount)&&Gt(X,$,w),Gn(S,!0);{se.ce&&se.ce._def.shadowRoot!==!1&&se.ce._injectChildStyle(xe);const rt=S.subTree=Nu(S);m(null,rt,N,H,S,D,U),w.el=rt.el}if(Ne&&_t(Ne,D),!ot&&(X=pe&&pe.onVnodeMounted)){const rt=w;_t(()=>Gt(X,$,rt),D)}(w.shapeFlag&256||$&&Ar($.vnode)&&$.vnode.shapeFlag&256)&&S.a&&_t(S.a,D),S.isMounted=!0,w=N=H=null}};S.scope.on();const W=S.effect=new Hd(J);S.scope.off();const z=S.update=W.run.bind(W),ce=S.job=W.runIfDirty.bind(W);ce.i=S,ce.id=S.uid,W.scheduler=()=>wl(ce),Gn(S,!0),z()},K=(S,w,N)=>{w.component=S;const H=S.vnode.props;S.vnode=w,S.next=null,tv(S,w.props,H,N),sv(S,w.children,N),vn(),Eu(S),gn()},te=(S,w,N,H,D,U,Y,J,W=!1)=>{const z=S&&S.children,ce=S?S.shapeFlag:0,X=w.children,{patchFlag:ae,shapeFlag:pe}=w;if(ae>0){if(ae&128){Me(z,X,N,H,D,U,Y,J,W);return}else if(ae&256){Se(z,X,N,H,D,U,Y,J,W);return}}pe&8?(ce&16&&ht(z,D,U),X!==z&&c(N,X)):ce&16?pe&16?Me(z,X,N,H,D,U,Y,J,W):ht(z,D,U,!0):(ce&8&&c(N,""),pe&16&&P(X,N,H,D,U,Y,J,W))},Se=(S,w,N,H,D,U,Y,J,W)=>{S=S||wr,w=w||wr;const z=S.length,ce=w.length,X=Math.min(z,ce);let ae;for(ae=0;ae<X;ae++){const pe=w[ae]=W?Pn(w[ae]):Jt(w[ae]);m(S[ae],pe,N,null,D,U,Y,J,W)}z>ce?ht(S,D,U,!0,!1,X):P(w,N,H,D,U,Y,J,W,X)},Me=(S,w,N,H,D,U,Y,J,W)=>{let z=0;const ce=w.length;let X=S.length-1,ae=ce-1;for(;z<=X&&z<=ae;){const pe=S[z],Ee=w[z]=W?Pn(w[z]):Jt(w[z]);if(Zn(pe,Ee))m(pe,Ee,N,null,D,U,Y,J,W);else break;z++}for(;z<=X&&z<=ae;){const pe=S[X],Ee=w[ae]=W?Pn(w[ae]):Jt(w[ae]);if(Zn(pe,Ee))m(pe,Ee,N,null,D,U,Y,J,W);else break;X--,ae--}if(z>X){if(z<=ae){const pe=ae+1,Ee=pe<ce?w[pe].el:H;for(;z<=ae;)m(null,w[z]=W?Pn(w[z]):Jt(w[z]),N,Ee,D,U,Y,J,W),z++}}else if(z>ae)for(;z<=X;)Xe(S[z],D,U,!0),z++;else{const pe=z,Ee=z,Ne=new Map;for(z=Ee;z<=ae;z++){const Lt=w[z]=W?Pn(w[z]):Jt(w[z]);Lt.key!=null&&Ne.set(Lt.key,z)}let $,se=0;const xe=ae-Ee+1;let ot=!1,rt=0;const Nt=new Array(xe);for(z=0;z<xe;z++)Nt[z]=0;for(z=pe;z<=X;z++){const Lt=S[z];if(se>=xe){Xe(Lt,D,U,!0);continue}let qt;if(Lt.key!=null)qt=Ne.get(Lt.key);else for($=Ee;$<=ae;$++)if(Nt[$-Ee]===0&&Zn(Lt,w[$])){qt=$;break}qt===void 0?Xe(Lt,D,U,!0):(Nt[qt-Ee]=z+1,qt>=rt?rt=qt:ot=!0,m(Lt,w[qt],N,null,D,U,Y,J,W),se++)}const gu=ot?uv(Nt):wr;for($=gu.length-1,z=xe-1;z>=0;z--){const Lt=Ee+z,qt=w[Lt],yu=w[Lt+1],bu=Lt+1<ce?yu.el||yu.placeholder:H;Nt[z]===0?m(null,qt,N,bu,D,U,Y,J,W):ot&&($<0||z!==gu[$]?Re(qt,N,bu,2):$--)}}},Re=(S,w,N,H,D=null)=>{const{el:U,type:Y,transition:J,children:W,shapeFlag:z}=S;if(z&6){Re(S.component.subTree,w,N,H);return}if(z&128){S.suspense.move(w,N,H);return}if(z&64){Y.move(S,w,N,pt);return}if(Y===Ge){n(U,w,N);for(let X=0;X<W.length;X++)Re(W[X],w,N,H);n(S.anchor,w,N);return}if(Y===ps){M(S,w,N);return}if(H!==2&&z&1&&J)if(H===0)J.beforeEnter(U),n(U,w,N),_t(()=>J.enter(U),D);else{const{leave:X,delayLeave:ae,afterLeave:pe}=J,Ee=()=>{S.ctx.isUnmounted?i(U):n(U,w,N)},Ne=()=>{X(U,()=>{Ee(),pe&&pe()})};ae?ae(U,Ee,Ne):Ne()}else n(U,w,N)},Xe=(S,w,N,H=!1,D=!1)=>{const{type:U,props:Y,ref:J,children:W,dynamicChildren:z,shapeFlag:ce,patchFlag:X,dirs:ae,cacheIndex:pe}=S;if(X===-2&&(D=!1),J!=null&&(vn(),Si(J,null,N,S,!0),gn()),pe!=null&&(w.renderCache[pe]=void 0),ce&256){w.ctx.deactivate(S);return}const Ee=ce&1&&ae,Ne=!Ar(S);let $;if(Ne&&($=Y&&Y.onVnodeBeforeUnmount)&&Gt($,w,S),ce&6)Fe(S.component,N,H);else{if(ce&128){S.suspense.unmount(N,H);return}Ee&&qn(S,null,w,"beforeUnmount"),ce&64?S.type.remove(S,w,N,pt,H):z&&!z.hasOnce&&(U!==Ge||X>0&&X&64)?ht(z,w,N,!1,!0):(U===Ge&&X&384||!D&&ce&16)&&ht(W,w,N),H&&It(S)}(Ne&&($=Y&&Y.onVnodeUnmounted)||Ee)&&_t(()=>{$&&Gt($,w,S),Ee&&qn(S,null,w,"unmounted")},N)},It=S=>{const{type:w,el:N,anchor:H,transition:D}=S;if(w===Ge){He(N,H);return}if(w===ps){_(S);return}const U=()=>{i(N),D&&!D.persisted&&D.afterLeave&&D.afterLeave()};if(S.shapeFlag&1&&D&&!D.persisted){const{leave:Y,delayLeave:J}=D,W=()=>Y(N,U);J?J(S.el,U,W):W()}else U()},He=(S,w)=>{let N;for(;S!==w;)N=f(S),i(S),S=N;i(w)},Fe=(S,w,N)=>{const{bum:H,scope:D,job:U,subTree:Y,um:J,m:W,a:z,parent:ce,slots:{__:X}}=S;Pu(W),Pu(z),H&&Ta(H),ce&&fe(X)&&X.forEach(ae=>{ce.renderCache[ae]=void 0}),D.stop(),U&&(U.flags|=8,Xe(Y,S,w,N)),J&&_t(J,w),_t(()=>{S.isUnmounted=!0},w),w&&w.pendingBranch&&!w.isUnmounted&&S.asyncDep&&!S.asyncResolved&&S.suspenseId===w.pendingId&&(w.deps--,w.deps===0&&w.resolve())},ht=(S,w,N,H=!1,D=!1,U=0)=>{for(let Y=U;Y<S.length;Y++)Xe(S[Y],w,N,H,D)},Vt=S=>{if(S.shapeFlag&6)return Vt(S.component.subTree);if(S.shapeFlag&128)return S.suspense.next();const w=f(S.anchor||S.el),N=w&&w[hf];return N?f(N):w};let Ut=!1;const Tn=(S,w,N)=>{S==null?w._vnode&&Xe(w._vnode,null,null,!0):m(w._vnode||null,S,w,null,null,null,N),w._vnode=S,Ut||(Ut=!0,Eu(),cf(),Ut=!1)},pt={p:m,um:Xe,m:Re,r:It,mt:I,mc:P,pc:te,pbc:L,n:Vt,o:e};return{render:Tn,hydrate:void 0,createApp:Qm(Tn)}}function Na({type:e,props:r},t){return t==="svg"&&e==="foreignObject"||t==="mathml"&&e==="annotation-xml"&&r&&r.encoding&&r.encoding.includes("html")?void 0:t}function Gn({effect:e,job:r},t){t?(e.flags|=32,r.flags|=4):(e.flags&=-33,r.flags&=-5)}function lv(e,r){return(!e||e&&!e.pendingBranch)&&r&&!r.persisted}function xl(e,r,t=!1){const n=e.children,i=r.children;if(fe(n)&&fe(i))for(let s=0;s<n.length;s++){const a=n[s];let o=i[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[s]=Pn(i[s]),o.el=a.el),!t&&o.patchFlag!==-2&&xl(a,o)),o.type===da&&(o.el=a.el),o.type===ut&&!o.el&&(o.el=a.el)}}function uv(e){const r=e.slice(),t=[0];let n,i,s,a,o;const l=e.length;for(n=0;n<l;n++){const u=e[n];if(u!==0){if(i=t[t.length-1],e[i]<u){r[n]=i,t.push(n);continue}for(s=0,a=t.length-1;s<a;)o=s+a>>1,e[t[o]]<u?s=o+1:a=o;u<e[t[s]]&&(s>0&&(r[n]=t[s-1]),t[s]=n)}}for(s=t.length,a=t[s-1];s-- >0;)t[s]=a,a=r[a];return t}function $f(e){const r=e.subTree.component;if(r)return r.asyncDep&&!r.asyncResolved?r:$f(r)}function Pu(e){if(e)for(let r=0;r<e.length;r++)e[r].flags|=8}const cv=Symbol.for("v-scx"),dv=()=>Tt(cv);function ua(e,r){return Il(e,null,r)}function Ve(e,r,t){return Il(e,r,t)}function Il(e,r,t=De){const{immediate:n,deep:i,flush:s,once:a}=t,o=at({},t),l=r&&n||!r&&s!=="post";let u;if(Fi){if(s==="sync"){const h=dv();u=h.__watcherHandles||(h.__watcherHandles=[])}else if(!l){const h=()=>{};return h.stop=Zt,h.resume=Zt,h.pause=Zt,h}}const c=gt;o.call=(h,p,m)=>Wt(h,c,p,m);let d=!1;s==="post"?o.scheduler=h=>{_t(h,c&&c.suspense)}:s!=="sync"&&(d=!0,o.scheduler=(h,p)=>{p?h():wl(h)}),o.augmentJob=h=>{r&&(h.flags|=4),d&&(h.flags|=2,c&&(h.id=c.uid,h.i=c))};const f=Am(e,r,o);return Fi&&(u?u.push(f):l&&f()),f}function fv(e,r,t){const n=this.proxy,i=Ye(e)?e.includes(".")?jf(n,e):()=>n[e]:e.bind(n,n);let s;ve(r)?s=r:(s=r.handler,t=r);const a=Xi(this),o=Il(i,s.bind(n),t);return a(),o}function jf(e,r){const t=r.split(".");return()=>{let n=e;for(let i=0;i<t.length&&n;i++)n=n[t[i]];return n}}const hv=(e,r)=>r==="modelValue"||r==="model-value"?e.modelModifiers:e[`${r}Modifiers`]||e[`${$t(r)}Modifiers`]||e[`${cr(r)}Modifiers`];function pv(e,r,...t){if(e.isUnmounted)return;const n=e.vnode.props||De;let i=t;const s=r.startsWith("update:"),a=s&&hv(n,r.slice(7));a&&(a.trim&&(i=t.map(c=>Ye(c)?c.trim():c)),a.number&&(i=t.map(zp)));let o,l=n[o=Ca(r)]||n[o=Ca($t(r))];!l&&s&&(l=n[o=Ca(cr(r))]),l&&Wt(l,e,6,i);const u=n[o+"Once"];if(u){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,Wt(u,e,6,i)}}function Uf(e,r,t=!1){const n=r.emitsCache,i=n.get(e);if(i!==void 0)return i;const s=e.emits;let a={},o=!1;if(!ve(e)){const l=u=>{const c=Uf(u,r,!0);c&&(o=!0,at(a,c))};!t&&r.mixins.length&&r.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!s&&!o?(qe(e)&&n.set(e,null),null):(fe(s)?s.forEach(l=>a[l]=null):at(a,s),qe(e)&&n.set(e,a),a)}function ca(e,r){return!e||!Xs(r)?!1:(r=r.slice(2).replace(/Once$/,""),Ie(e,r[0].toLowerCase()+r.slice(1))||Ie(e,cr(r))||Ie(e,r))}function Nu(e){const{type:r,vnode:t,proxy:n,withProxy:i,propsOptions:[s],slots:a,attrs:o,emit:l,render:u,renderCache:c,props:d,data:f,setupState:h,ctx:p,inheritAttrs:m}=e,v=Fs(e);let y,b;try{if(t.shapeFlag&4){const _=i||n,E=_;y=Jt(u.call(E,_,c,d,h,f,p)),b=o}else{const _=r;y=Jt(_.length>1?_(d,{attrs:o,slots:a,emit:l}):_(d,null)),b=r.props?o:mv(o)}}catch(_){_i.length=0,aa(_,e,1),y=ne(ut)}let M=y;if(b&&m!==!1){const _=Object.keys(b),{shapeFlag:E}=M;_.length&&E&7&&(s&&_.some(ml)&&(b=vv(b,s)),M=yn(M,b,!1,!0))}return t.dirs&&(M=yn(M,null,!1,!0),M.dirs=M.dirs?M.dirs.concat(t.dirs):t.dirs),t.transition&&Pi(M,t.transition),y=M,Fs(v),y}const mv=e=>{let r;for(const t in e)(t==="class"||t==="style"||Xs(t))&&((r||(r={}))[t]=e[t]);return r},vv=(e,r)=>{const t={};for(const n in e)(!ml(n)||!(n.slice(9)in r))&&(t[n]=e[n]);return t};function gv(e,r,t){const{props:n,children:i,component:s}=e,{props:a,children:o,patchFlag:l}=r,u=s.emitsOptions;if(r.dirs||r.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return n?Bu(n,a,u):!!a;if(l&8){const c=r.dynamicProps;for(let d=0;d<c.length;d++){const f=c[d];if(a[f]!==n[f]&&!ca(u,f))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?Bu(n,a,u):!0:!!a;return!1}function Bu(e,r,t){const n=Object.keys(r);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(r[s]!==e[s]&&!ca(t,s))return!0}return!1}function yv({vnode:e,parent:r},t){for(;r;){const n=r.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=r.vnode).el=t,r=r.parent;else break}}const Hf=e=>e.__isSuspense;function bv(e,r){r&&r.pendingBranch?fe(e)?r.effects.push(...e):r.effects.push(e):Im(e)}const Ge=Symbol.for("v-fgt"),da=Symbol.for("v-txt"),ut=Symbol.for("v-cmt"),ps=Symbol.for("v-stc"),_i=[];let Ot=null;function q(e=!1){_i.push(Ot=e?null:[])}function Sv(){_i.pop(),Ot=_i[_i.length-1]||null}let Ni=1;function Fu(e,r=!1){Ni+=e,e<0&&Ot&&r&&(Ot.hasOnce=!0)}function zf(e){return e.dynamicChildren=Ni>0?Ot||wr:null,Sv(),Ni>0&&Ot&&Ot.push(e),e}function de(e,r,t,n,i,s){return zf(he(e,r,t,n,i,s,!0))}function Le(e,r,t,n,i){return zf(ne(e,r,t,n,i,!0))}function Bi(e){return e?e.__v_isVNode===!0:!1}function Zn(e,r){return e.type===r.type&&e.key===r.key}const Wf=({key:e})=>e??null,ms=({ref:e,ref_key:r,ref_for:t})=>(typeof e=="number"&&(e=""+e),e!=null?Ye(e)||Ke(e)||ve(e)?{i:ct,r:e,k:r,f:!!t}:e:null);function he(e,r=null,t=null,n=0,i=null,s=e===Ge?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:r,key:r&&Wf(r),ref:r&&ms(r),scopeId:ff,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:ct};return o?(Ll(l,t),s&128&&e.normalize(l)):t&&(l.shapeFlag|=Ye(t)?8:16),Ni>0&&!a&&Ot&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Ot.push(l),l}const ne=kv;function kv(e,r=null,t=null,n=0,i=null,s=!1){if((!e||e===Wm)&&(e=ut),Bi(e)){const o=yn(e,r,!0);return t&&Ll(o,t),Ni>0&&!s&&Ot&&(o.shapeFlag&6?Ot[Ot.indexOf(e)]=o:Ot.push(o)),o.patchFlag=-2,o}if(Lv(e)&&(e=e.__vccOpts),r){r=vs(r);let{class:o,style:l}=r;o&&!Ye(o)&&(r.class=oe(o)),qe(l)&&(_l(l)&&!fe(l)&&(l=at({},l)),r.style=Oe(l))}const a=Ye(e)?1:Hf(e)?128:pf(e)?64:qe(e)?4:ve(e)?2:0;return he(e,r,t,n,i,a,s,!0)}function vs(e){return e?_l(e)||Rf(e)?at({},e):e:null}function yn(e,r,t=!1,n=!1){const{props:i,ref:s,patchFlag:a,children:o,transition:l}=e,u=r?Mr(i||{},r):i,c={__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&Wf(u),ref:r&&r.ref?t&&s?fe(s)?s.concat(ms(r)):[s,ms(r)]:ms(r):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:r&&e.type!==Ge?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&yn(e.ssContent),ssFallback:e.ssFallback&&yn(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&n&&Pi(c,l.clone(c)),c}function dt(e=" ",r=0){return ne(da,null,e,r)}function _v(e,r){const t=ne(ps,null,e);return t.staticCount=r,t}function Be(e="",r=!1){return r?(q(),Le(ut,null,e)):ne(ut,null,e)}function Jt(e){return e==null||typeof e=="boolean"?ne(ut):fe(e)?ne(Ge,null,e.slice()):Bi(e)?Pn(e):ne(da,null,String(e))}function Pn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:yn(e)}function Ll(e,r){let t=0;const{shapeFlag:n}=e;if(r==null)r=null;else if(fe(r))t=16;else if(typeof r=="object")if(n&65){const i=r.default;i&&(i._c&&(i._d=!1),Ll(e,i()),i._c&&(i._d=!0));return}else{t=32;const i=r._;!i&&!Rf(r)?r._ctx=ct:i===3&&ct&&(ct.slots._===1?r._=1:(r._=2,e.patchFlag|=1024))}else ve(r)?(r={default:r,_ctx:ct},t=32):(r=String(r),n&64?(t=16,r=[dt(r)]):t=8);e.children=r,e.shapeFlag|=t}function Mr(...e){const r={};for(let t=0;t<e.length;t++){const n=e[t];for(const i in n)if(i==="class")r.class!==n.class&&(r.class=oe([r.class,n.class]));else if(i==="style")r.style=Oe([r.style,n.style]);else if(Xs(i)){const s=r[i],a=n[i];a&&s!==a&&!(fe(s)&&s.includes(a))&&(r[i]=s?[].concat(s,a):a)}else i!==""&&(r[i]=n[i])}return r}function Gt(e,r,t,n=null){Wt(e,r,7,[t,n])}const Ev=If();let wv=0;function Cv(e,r,t){const n=e.type,i=(r?r.appContext:e.appContext)||Ev,s={uid:wv++,vnode:e,type:n,parent:r,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new jd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:r?r.provides:Object.create(i.provides),ids:r?r.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Nf(n,i),emitsOptions:Uf(n,i),emit:null,emitted:null,propsDefaults:De,inheritAttrs:n.inheritAttrs,ctx:De,data:De,props:De,attrs:De,slots:De,refs:De,setupState:De,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=r?r.root:s,s.emit=pv.bind(null,s),e.ce&&e.ce(s),s}let gt=null;const Vn=()=>gt||ct;let $s,Po;{const e=ea(),r=(t,n)=>{let i;return(i=e[t])||(i=e[t]=[]),i.push(n),s=>{i.length>1?i.forEach(a=>a(s)):i[0](s)}};$s=r("__VUE_INSTANCE_SETTERS__",t=>gt=t),Po=r("__VUE_SSR_SETTERS__",t=>Fi=t)}const Xi=e=>{const r=gt;return $s(e),e.scope.on(),()=>{e.scope.off(),$s(r)}},Du=()=>{gt&&gt.scope.off(),$s(null)};function Vf(e){return e.vnode.shapeFlag&4}let Fi=!1;function Tv(e,r=!1,t=!1){r&&Po(r);const{props:n,children:i}=e.vnode,s=Vf(e);ev(e,n,s,r),iv(e,i,t||r);const a=s?Av(e,r):void 0;return r&&Po(!1),a}function Av(e,r){const t=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,qm);const{setup:n}=t;if(n){vn();const i=e.setupContext=n.length>1?xv(e):null,s=Xi(e),a=Gi(n,e,0,[e.props,i]),o=Pd(a);if(gn(),s(),(o||e.sp)&&!Ar(e)&&Ef(e),o){if(a.then(Du,Du),r)return a.then(l=>{$u(e,l)}).catch(l=>{aa(l,e,0)});e.asyncDep=a}else $u(e,a)}else qf(e)}function $u(e,r,t){ve(r)?e.type.__ssrInlineRender?e.ssrRender=r:e.render=r:qe(r)&&(e.setupState=af(r)),qf(e)}function qf(e,r,t){const n=e.type;e.render||(e.render=n.render||Zt);{const i=Xi(e);vn();try{Gm(e)}finally{gn(),i()}}}const Mv={get(e,r){return vt(e,"get",""),e[r]}};function xv(e){const r=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,Mv),slots:e.slots,emit:e.emit,expose:r}}function fa(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(af(El(e.exposed)),{get(r,t){if(t in r)return r[t];if(t in ki)return ki[t](e)},has(r,t){return t in r||t in ki}})):e.proxy}function Iv(e,r=!0){return ve(e)?e.displayName||e.name:e.name||r&&e.__name}function Lv(e){return ve(e)&&"__vccOpts"in e}const j=(e,r)=>Cm(e,r,Fi);function Ov(e,r,t){const n=arguments.length;return n===2?qe(r)&&!fe(r)?Bi(r)?ne(e,null,[r]):ne(e,r):ne(e,null,r):(n>3?t=Array.prototype.slice.call(arguments,2):n===3&&Bi(t)&&(t=[t]),ne(e,r,t))}const Rv="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let No;const ju=typeof window<"u"&&window.trustedTypes;if(ju)try{No=ju.createPolicy("vue",{createHTML:e=>e})}catch{}const Gf=No?e=>No.createHTML(e):e=>e,Pv="http://www.w3.org/2000/svg",Nv="http://www.w3.org/1998/Math/MathML",un=typeof document<"u"?document:null,Uu=un&&un.createElement("template"),Bv={insert:(e,r,t)=>{r.insertBefore(e,t||null)},remove:e=>{const r=e.parentNode;r&&r.removeChild(e)},createElement:(e,r,t,n)=>{const i=r==="svg"?un.createElementNS(Pv,e):r==="mathml"?un.createElementNS(Nv,e):t?un.createElement(e,{is:t}):un.createElement(e);return e==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:e=>un.createTextNode(e),createComment:e=>un.createComment(e),setText:(e,r)=>{e.nodeValue=r},setElementText:(e,r)=>{e.textContent=r},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>un.querySelector(e),setScopeId(e,r){e.setAttribute(r,"")},insertStaticContent(e,r,t,n,i,s){const a=t?t.previousSibling:r.lastChild;if(i&&(i===s||i.nextSibling))for(;r.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{Uu.innerHTML=Gf(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const o=Uu.content;if(n==="svg"||n==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}r.insertBefore(o,t)}return[a?a.nextSibling:r.firstChild,t?t.previousSibling:r.lastChild]}},Mn="transition",$r="animation",Di=Symbol("_vtc"),Kf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Fv=at({},yf,Kf),Dv=e=>(e.displayName="Transition",e.props=Fv,e),js=Dv((e,{slots:r})=>Ov(Pm,$v(e),r)),Kn=(e,r=[])=>{fe(e)?e.forEach(t=>t(...r)):e&&e(...r)},Hu=e=>e?fe(e)?e.some(r=>r.length>1):e.length>1:!1;function $v(e){const r={};for(const k in e)k in Kf||(r[k]=e[k]);if(e.css===!1)return r;const{name:t="v",type:n,duration:i,enterFromClass:s=`${t}-enter-from`,enterActiveClass:a=`${t}-enter-active`,enterToClass:o=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:u=a,appearToClass:c=o,leaveFromClass:d=`${t}-leave-from`,leaveActiveClass:f=`${t}-leave-active`,leaveToClass:h=`${t}-leave-to`}=e,p=jv(i),m=p&&p[0],v=p&&p[1],{onBeforeEnter:y,onEnter:b,onEnterCancelled:M,onLeave:_,onLeaveCancelled:E,onBeforeAppear:C=y,onAppear:B=b,onAppearCancelled:P=M}=r,R=(k,F,I,G)=>{k._enterCancelled=G,Jn(k,F?c:o),Jn(k,F?u:a),I&&I()},L=(k,F)=>{k._isLeaving=!1,Jn(k,d),Jn(k,h),Jn(k,f),F&&F()},x=k=>(F,I)=>{const G=k?B:b,Z=()=>R(F,k,I);Kn(G,[F,Z]),zu(()=>{Jn(F,k?l:s),sn(F,k?c:o),Hu(G)||Wu(F,n,m,Z)})};return at(r,{onBeforeEnter(k){Kn(y,[k]),sn(k,s),sn(k,a)},onBeforeAppear(k){Kn(C,[k]),sn(k,l),sn(k,u)},onEnter:x(!1),onAppear:x(!0),onLeave(k,F){k._isLeaving=!0;const I=()=>L(k,F);sn(k,d),k._enterCancelled?(sn(k,f),Gu()):(Gu(),sn(k,f)),zu(()=>{k._isLeaving&&(Jn(k,d),sn(k,h),Hu(_)||Wu(k,n,v,I))}),Kn(_,[k,I])},onEnterCancelled(k){R(k,!1,void 0,!0),Kn(M,[k])},onAppearCancelled(k){R(k,!0,void 0,!0),Kn(P,[k])},onLeaveCancelled(k){L(k),Kn(E,[k])}})}function jv(e){if(e==null)return null;if(qe(e))return[Ba(e.enter),Ba(e.leave)];{const r=Ba(e);return[r,r]}}function Ba(e){return Wp(e)}function sn(e,r){r.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e[Di]||(e[Di]=new Set)).add(r)}function Jn(e,r){r.split(/\s+/).forEach(n=>n&&e.classList.remove(n));const t=e[Di];t&&(t.delete(r),t.size||(e[Di]=void 0))}function zu(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Uv=0;function Wu(e,r,t,n){const i=e._endId=++Uv,s=()=>{i===e._endId&&n()};if(t!=null)return setTimeout(s,t);const{type:a,timeout:o,propCount:l}=Hv(e,r);if(!a)return n();const u=a+"end";let c=0;const d=()=>{e.removeEventListener(u,f),s()},f=h=>{h.target===e&&++c>=l&&d()};setTimeout(()=>{c<l&&d()},o+1),e.addEventListener(u,f)}function Hv(e,r){const t=window.getComputedStyle(e),n=p=>(t[p]||"").split(", "),i=n(`${Mn}Delay`),s=n(`${Mn}Duration`),a=Vu(i,s),o=n(`${$r}Delay`),l=n(`${$r}Duration`),u=Vu(o,l);let c=null,d=0,f=0;r===Mn?a>0&&(c=Mn,d=a,f=s.length):r===$r?u>0&&(c=$r,d=u,f=l.length):(d=Math.max(a,u),c=d>0?a>u?Mn:$r:null,f=c?c===Mn?s.length:l.length:0);const h=c===Mn&&/\b(transform|all)(,|$)/.test(n(`${Mn}Property`).toString());return{type:c,timeout:d,propCount:f,hasTransform:h}}function Vu(e,r){for(;e.length<r.length;)e=e.concat(e);return Math.max(...r.map((t,n)=>qu(t)+qu(e[n])))}function qu(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Gu(){return document.body.offsetHeight}function zv(e,r,t){const n=e[Di];n&&(r=(r?[r,...n]:[...n]).join(" ")),r==null?e.removeAttribute("class"):t?e.setAttribute("class",r):e.className=r}const Us=Symbol("_vod"),Jf=Symbol("_vsh"),Ei={beforeMount(e,{value:r},{transition:t}){e[Us]=e.style.display==="none"?"":e.style.display,t&&r?t.beforeEnter(e):jr(e,r)},mounted(e,{value:r},{transition:t}){t&&r&&t.enter(e)},updated(e,{value:r,oldValue:t},{transition:n}){!r!=!t&&(n?r?(n.beforeEnter(e),jr(e,!0),n.enter(e)):n.leave(e,()=>{jr(e,!1)}):jr(e,r))},beforeUnmount(e,{value:r}){jr(e,r)}};function jr(e,r){e.style.display=r?e[Us]:"none",e[Jf]=!r}const Wv=Symbol(""),Vv=/(^|;)\s*display\s*:/;function qv(e,r,t){const n=e.style,i=Ye(t);let s=!1;if(t&&!i){if(r)if(Ye(r))for(const a of r.split(";")){const o=a.slice(0,a.indexOf(":")).trim();t[o]==null&&gs(n,o,"")}else for(const a in r)t[a]==null&&gs(n,a,"");for(const a in t)a==="display"&&(s=!0),gs(n,a,t[a])}else if(i){if(r!==t){const a=n[Wv];a&&(t+=";"+a),n.cssText=t,s=Vv.test(t)}}else r&&e.removeAttribute("style");Us in e&&(e[Us]=s?n.display:"",e[Jf]&&(n.display="none"))}const Ku=/\s*!important$/;function gs(e,r,t){if(fe(t))t.forEach(n=>gs(e,r,n));else if(t==null&&(t=""),r.startsWith("--"))e.setProperty(r,t);else{const n=Gv(e,r);Ku.test(t)?e.setProperty(cr(n),t.replace(Ku,""),"important"):e[n]=t}}const Ju=["Webkit","Moz","ms"],Fa={};function Gv(e,r){const t=Fa[r];if(t)return t;let n=$t(r);if(n!=="filter"&&n in e)return Fa[r]=n;n=Qs(n);for(let i=0;i<Ju.length;i++){const s=Ju[i]+n;if(s in e)return Fa[r]=s}return r}const Xu="http://www.w3.org/1999/xlink";function Yu(e,r,t,n,i,s=Xp(r)){n&&r.startsWith("xlink:")?t==null?e.removeAttributeNS(Xu,r.slice(6,r.length)):e.setAttributeNS(Xu,r,t):t==null||s&&!Fd(t)?e.removeAttribute(r):e.setAttribute(r,s?"":_n(t)?String(t):t)}function Zu(e,r,t,n,i){if(r==="innerHTML"||r==="textContent"){t!=null&&(e[r]=r==="innerHTML"?Gf(t):t);return}const s=e.tagName;if(r==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?e.getAttribute("value")||"":e.value,l=t==null?e.type==="checkbox"?"on":"":String(t);(o!==l||!("_value"in e))&&(e.value=l),t==null&&e.removeAttribute(r),e._value=t;return}let a=!1;if(t===""||t==null){const o=typeof e[r];o==="boolean"?t=Fd(t):t==null&&o==="string"?(t="",a=!0):o==="number"&&(t=0,a=!0)}try{e[r]=t}catch{}a&&e.removeAttribute(i||r)}function Kv(e,r,t,n){e.addEventListener(r,t,n)}function Jv(e,r,t,n){e.removeEventListener(r,t,n)}const Qu=Symbol("_vei");function Xv(e,r,t,n,i=null){const s=e[Qu]||(e[Qu]={}),a=s[r];if(n&&a)a.value=n;else{const[o,l]=Yv(r);if(n){const u=s[r]=eg(n,i);Kv(e,o,u,l)}else a&&(Jv(e,o,a,l),s[r]=void 0)}}const ec=/(?:Once|Passive|Capture)$/;function Yv(e){let r;if(ec.test(e)){r={};let n;for(;n=e.match(ec);)e=e.slice(0,e.length-n[0].length),r[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):cr(e.slice(2)),r]}let Da=0;const Zv=Promise.resolve(),Qv=()=>Da||(Zv.then(()=>Da=0),Da=Date.now());function eg(e,r){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;Wt(tg(n,t.value),r,5,[n])};return t.value=e,t.attached=Qv(),t}function tg(e,r){if(fe(r)){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{t.call(e),e._stopped=!0},r.map(n=>i=>!i._stopped&&n&&n(i))}else return r}const tc=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,ng=(e,r,t,n,i,s)=>{const a=i==="svg";r==="class"?zv(e,n,a):r==="style"?qv(e,t,n):Xs(r)?ml(r)||Xv(e,r,t,n,s):(r[0]==="."?(r=r.slice(1),!0):r[0]==="^"?(r=r.slice(1),!1):rg(e,r,n,a))?(Zu(e,r,n),!e.tagName.includes("-")&&(r==="value"||r==="checked"||r==="selected")&&Yu(e,r,n,a,s,r!=="value")):e._isVueCE&&(/[A-Z]/.test(r)||!Ye(n))?Zu(e,$t(r),n,s,r):(r==="true-value"?e._trueValue=n:r==="false-value"&&(e._falseValue=n),Yu(e,r,n,a))};function rg(e,r,t,n){if(n)return!!(r==="innerHTML"||r==="textContent"||r in e&&tc(r)&&ve(t));if(r==="spellcheck"||r==="draggable"||r==="translate"||r==="autocorrect"||r==="form"||r==="list"&&e.tagName==="INPUT"||r==="type"&&e.tagName==="TEXTAREA")return!1;if(r==="width"||r==="height"){const i=e.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return tc(r)&&Ye(t)?!1:r in e}const ig=["ctrl","shift","alt","meta"],sg={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,r)=>ig.some(t=>e[`${t}Key`]&&!r.includes(t))},Hs=(e,r)=>{const t=e._withMods||(e._withMods={}),n=r.join(".");return t[n]||(t[n]=(i,...s)=>{for(let a=0;a<r.length;a++){const o=sg[r[a]];if(o&&o(i,r))return}return e(i,...s)})},ag=at({patchProp:ng},Bv);let nc;function Xf(){return nc||(nc=av(ag))}const rc=(...e)=>{Xf().render(...e)},og=(...e)=>{const r=Xf().createApp(...e),{mount:t}=r;return r.mount=n=>{const i=ug(n);if(!i)return;const s=r._component;!ve(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const a=t(i,!1,lg(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},r};function lg(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function ug(e){return Ye(e)?document.querySelector(e):e}/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let Yf;const ha=e=>Yf=e,Zf=Symbol();function Bo(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var wi;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(wi||(wi={}));function cg(){const e=Ud(!0),r=e.run(()=>ee({}));let t=[],n=[];const i=El({install(s){ha(i),i._a=s,s.provide(Zf,i),s.config.globalProperties.$pinia=i,n.forEach(a=>t.push(a)),n=[]},use(s){return this._a?t.push(s):n.push(s),this},_p:t,_a:null,_e:e,_s:new Map,state:r});return i}const Qf=()=>{};function ic(e,r,t,n=Qf){e.push(r);const i=()=>{const s=e.indexOf(r);s>-1&&(e.splice(s,1),n())};return!t&&ta()&&yl(i),i}function yr(e,...r){e.slice().forEach(t=>{t(...r)})}const dg=e=>e(),sc=Symbol(),$a=Symbol();function Fo(e,r){e instanceof Map&&r instanceof Map?r.forEach((t,n)=>e.set(n,t)):e instanceof Set&&r instanceof Set&&r.forEach(e.add,e);for(const t in r){if(!r.hasOwnProperty(t))continue;const n=r[t],i=e[t];Bo(i)&&Bo(n)&&e.hasOwnProperty(t)&&!Ke(n)&&!Fn(n)?e[t]=Fo(i,n):e[t]=n}return e}const fg=Symbol();function hg(e){return!Bo(e)||!Object.prototype.hasOwnProperty.call(e,fg)}const{assign:In}=Object;function pg(e){return!!(Ke(e)&&e.effect)}function mg(e,r,t,n){const{state:i,actions:s,getters:a}=r,o=t.state.value[e];let l;function u(){o||(t.state.value[e]=i?i():{});const c=nn(t.state.value[e]);return In(c,s,Object.keys(a||{}).reduce((d,f)=>(d[f]=El(j(()=>{ha(t);const h=t._s.get(e);return a[f].call(h,h)})),d),{}))}return l=eh(e,u,r,t,n,!0),l}function eh(e,r,t={},n,i,s){let a;const o=In({actions:{}},t),l={deep:!0};let u,c,d=[],f=[],h;const p=n.state.value[e];!s&&!p&&(n.state.value[e]={}),ee({});let m;function v(P){let R;u=c=!1,typeof P=="function"?(P(n.state.value[e]),R={type:wi.patchFunction,storeId:e,events:h}):(Fo(n.state.value[e],P),R={type:wi.patchObject,payload:P,storeId:e,events:h});const L=m=Symbol();sr().then(()=>{m===L&&(u=!0)}),c=!0,yr(d,R,n.state.value[e])}const y=s?function(){const{state:R}=t,L=R?R():{};this.$patch(x=>{In(x,L)})}:Qf;function b(){a.stop(),d=[],f=[],n._s.delete(e)}const M=(P,R="")=>{if(sc in P)return P[$a]=R,P;const L=function(){ha(n);const x=Array.from(arguments),k=[],F=[];function I(K){k.push(K)}function G(K){F.push(K)}yr(f,{args:x,name:L[$a],store:E,after:I,onError:G});let Z;try{Z=P.apply(this&&this.$id===e?this:E,x)}catch(K){throw yr(F,K),K}return Z instanceof Promise?Z.then(K=>(yr(k,K),K)).catch(K=>(yr(F,K),Promise.reject(K))):(yr(k,Z),Z)};return L[sc]=!0,L[$a]=R,L},_={_p:n,$id:e,$onAction:ic.bind(null,f),$patch:v,$reset:y,$subscribe(P,R={}){const L=ic(d,P,R.detached,()=>x()),x=a.run(()=>Ve(()=>n.state.value[e],k=>{(R.flush==="sync"?c:u)&&P({storeId:e,type:wi.direct,events:h},k)},In({},l,R)));return L},$dispose:b},E=jt(_);n._s.set(e,E);const B=(n._a&&n._a.runWithContext||dg)(()=>n._e.run(()=>(a=Ud()).run(()=>r({action:M}))));for(const P in B){const R=B[P];if(Ke(R)&&!pg(R)||Fn(R))s||(p&&hg(R)&&(Ke(R)?R.value=p[P]:Fo(R,p[P])),n.state.value[e][P]=R);else if(typeof R=="function"){const L=M(R,P);B[P]=L,o.actions[P]=R}}return In(E,B),In(Ce(E),B),Object.defineProperty(E,"$state",{get:()=>n.state.value[e],set:P=>{v(R=>{In(R,P)})}}),n._p.forEach(P=>{In(E,a.run(()=>P({store:E,app:n._a,pinia:n,options:o})))}),p&&s&&t.hydrate&&t.hydrate(E.$state,p),u=!0,c=!0,E}/*! #__NO_SIDE_EFFECTS__ */function vg(e,r,t){let n;const i=typeof r=="function";n=i?t:r;function s(a,o){const l=Tl();return a=a||(l?Tt(Zf,null):null),a&&ha(a),a=Yf,a._s.has(e)||(i?eh(e,r,n,a):mg(e,n,a)),a._s.get(e)}return s.$id=e,s}var gg=Object.defineProperty,yg=(e,r,t)=>r in e?gg(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,V=(e,r,t)=>(yg(e,typeof r!="symbol"?r+"":r,t),t),ac;const Ol=typeof window<"u",bg=e=>typeof e=="string",Sg=()=>{};Ol&&((ac=window?.navigator)!=null&&ac.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Ae(e){return typeof e=="function"?e():Lr(e)}function oc(e,r=!1,t="Timeout"){return new Promise((n,i)=>{setTimeout(r?()=>i(t):n,e)})}function kg(e){return e}function _g(e,...r){return r.some(t=>t in e)}function ja(){const e=[],r=t=>{const n=e.indexOf(t);n!==-1&&e.splice(n,1)};return{on:t=>(e.push(t),{off:()=>r(t)}),off:r,trigger:t=>{e.forEach(n=>n(t))}}}function Rl(e){return ta()?(yl(e),!0):!1}function Ua(e){return typeof e=="function"?j(e):ee(e)}function Do(e,r=!1){function t(d,{flush:f="sync",deep:h=!1,timeout:p,throwOnTimeout:m}={}){let v=null;const y=[new Promise(b=>{v=Ve(e,M=>{d(M)!==r&&(v?.(),b(M))},{flush:f,deep:h,immediate:!0})})];return p!=null&&y.push(oc(p,m).then(()=>Ae(e)).finally(()=>v?.())),Promise.race(y)}function n(d,f){if(!Ke(d))return t(M=>M===d,f);const{flush:h="sync",deep:p=!1,timeout:m,throwOnTimeout:v}=f??{};let y=null;const b=[new Promise(M=>{y=Ve([e,d],([_,E])=>{r!==(_===E)&&(y?.(),M(_))},{flush:h,deep:p,immediate:!0})})];return m!=null&&b.push(oc(m,v).then(()=>Ae(e)).finally(()=>(y?.(),Ae(e)))),Promise.race(b)}function i(d){return t(f=>!!f,d)}function s(d){return n(null,d)}function a(d){return n(void 0,d)}function o(d){return t(Number.isNaN,d)}function l(d,f){return t(h=>{const p=Array.from(h);return p.includes(d)||p.includes(Ae(d))},f)}function u(d){return c(1,d)}function c(d=1,f){let h=-1;return t(()=>(h+=1,h>=d),f)}return Array.isArray(Ae(e))?{toMatch:t,toContains:l,changed:u,changedTimes:c,get not(){return Do(e,!r)}}:{toMatch:t,toBe:n,toBeTruthy:i,toBeNull:s,toBeNaN:o,toBeUndefined:a,changed:u,changedTimes:c,get not(){return Do(e,!r)}}}function Eg(e){return Do(e)}function wg(e,r,t={}){const{immediate:n=!0}=t,i=ee(!1);let s=null;function a(){s&&(clearTimeout(s),s=null)}function o(){i.value=!1,a()}function l(...u){a(),i.value=!0,s=setTimeout(()=>{i.value=!1,s=null,e(...u)},Ae(r))}return n&&(i.value=!0,Ol&&l()),Rl(o),{isPending:i,start:l,stop:o}}function Cg(e){var r;const t=Ae(e);return(r=t?.$el)!=null?r:t}const Pl=Ol?window:void 0;function fn(...e){let r,t,n,i;if(bg(e[0])||Array.isArray(e[0])?([t,n,i]=e,r=Pl):[r,t,n,i]=e,!r)return Sg;Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);const s=[],a=()=>{s.forEach(c=>c()),s.length=0},o=(c,d,f)=>(c.addEventListener(d,f,i),()=>c.removeEventListener(d,f,i)),l=Ve(()=>Cg(r),c=>{a(),c&&s.push(...t.flatMap(d=>n.map(f=>o(c,d,f))))},{immediate:!0,flush:"post"}),u=()=>{l(),a()};return Rl(u),u}const lc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uc="__vueuse_ssr_handlers__";lc[uc]=lc[uc]||{};function Nl(e,r={}){const{immediate:t=!0,window:n=Pl}=r,i=ee(!1);let s=null;function a(){!i.value||!n||(e(),s=n.requestAnimationFrame(a))}function o(){!i.value&&n&&(i.value=!0,a())}function l(){i.value=!1,s!=null&&n&&(n.cancelAnimationFrame(s),s=null)}return t&&o(),Rl(l),{isActive:i,pause:l,resume:o}}var Tg=Object.defineProperty,Ag=Object.defineProperties,Mg=Object.getOwnPropertyDescriptors,cc=Object.getOwnPropertySymbols,xg=Object.prototype.hasOwnProperty,Ig=Object.prototype.propertyIsEnumerable,dc=(e,r,t)=>r in e?Tg(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Je=(e,r)=>{for(var t in r||(r={}))xg.call(r,t)&&dc(e,t,r[t]);if(cc)for(var t of cc(r))Ig.call(r,t)&&dc(e,t,r[t]);return e},Nn=(e,r)=>Ag(e,Mg(r));const Lg={json:"application/json",text:"text/plain",formData:"multipart/form-data"};function zs(e){return _g(e,"immediate","refetch","initialData","timeout","beforeFetch","afterFetch","onFetchError","fetch")}function Og(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Ci(e){return typeof Headers<"u"&&e instanceof Headers?Object.fromEntries([...e.entries()]):e}function br(e,...r){return e==="overwrite"?async t=>{const n=r[r.length-1];return n!==void 0&&await n(t),t}:async t=>(await r.reduce((n,i)=>n.then(async()=>{i&&(t=Je(Je({},t),await i(t)))}),Promise.resolve()),t)}function Rg(e={}){const r=e.combination||"chain",t=e.options||{},n=e.fetchOptions||{};function i(s,...a){const o=j(()=>{const c=Ae(e.baseUrl),d=Ae(s);return c&&!Og(d)?Ng(c,d):d});let l=t,u=n;return a.length>0&&(zs(a[0])?l=Nn(Je(Je({},l),a[0]),{beforeFetch:br(r,t.beforeFetch,a[0].beforeFetch),afterFetch:br(r,t.afterFetch,a[0].afterFetch),onFetchError:br(r,t.onFetchError,a[0].onFetchError)}):u=Nn(Je(Je({},u),a[0]),{headers:Je(Je({},Ci(u.headers)||{}),Ci(a[0].headers)||{})})),a.length>1&&zs(a[1])&&(l=Nn(Je(Je({},l),a[1]),{beforeFetch:br(r,t.beforeFetch,a[1].beforeFetch),afterFetch:br(r,t.afterFetch,a[1].afterFetch),onFetchError:br(r,t.onFetchError,a[1].onFetchError)})),Pg(o,u,l)}return i}function Pg(e,...r){var t;const n=typeof AbortController=="function";let i={},s={immediate:!0,refetch:!1,timeout:0};const a={method:"GET",type:"text",payload:void 0};r.length>0&&(zs(r[0])?s=Je(Je({},s),r[0]):i=r[0]),r.length>1&&zs(r[1])&&(s=Je(Je({},s),r[1]));const{fetch:o=(t=Pl)==null?void 0:t.fetch,initialData:l,timeout:u}=s,c=ja(),d=ja(),f=ja(),h=ee(!1),p=ee(!1),m=ee(!1),v=ee(null),y=Dt(null),b=Dt(null),M=Dt(l),_=j(()=>n&&p.value);let E,C;const B=()=>{n&&E&&E.abort()},P=G=>{p.value=G,h.value=!G};u&&(C=wg(B,u,{immediate:!1}));const R=async(G=!1)=>{var Z;P(!0),b.value=null,v.value=null,m.value=!1,E=void 0,n&&(E=new AbortController,E.signal.onabort=()=>m.value=!0,i=Nn(Je({},i),{signal:E.signal}));const K={method:a.method,headers:{}};if(a.payload){const Re=Ci(K.headers);a.payloadType&&(Re["Content-Type"]=(Z=Lg[a.payloadType])!=null?Z:a.payloadType);const Xe=Ae(a.payload);K.body=a.payloadType==="json"?JSON.stringify(Xe):Xe}let te=!1;const Se={url:Ae(e),options:Je(Je({},K),i),cancel:()=>{te=!0}};if(s.beforeFetch&&Object.assign(Se,await s.beforeFetch(Se)),te||!o)return P(!1),Promise.resolve(null);let Me=null;return C&&C.start(),new Promise((Re,Xe)=>{var It;o(Se.url,Nn(Je(Je({},K),Se.options),{headers:Je(Je({},Ci(K.headers)),Ci((It=Se.options)==null?void 0:It.headers))})).then(async He=>{if(y.value=He,v.value=He.status,Me=await He[a.type](),s.afterFetch&&v.value>=200&&v.value<300&&({data:Me}=await s.afterFetch({data:Me,response:He})),M.value=Me,!He.ok)throw new Error(He.statusText);return c.trigger(He),Re(He)}).catch(async He=>{let Fe=He.message||He.name;return s.onFetchError&&({data:Me,error:Fe}=await s.onFetchError({data:Me,error:He,response:y.value})),M.value=Me,b.value=Fe,d.trigger(He),G?Xe(He):Re(null)}).finally(()=>{P(!1),C&&C.stop(),f.trigger(null)})})},L=Ua(s.refetch);Ve([L,Ua(e)],([G])=>G&&R(),{deep:!0});const x={isFinished:h,statusCode:v,response:y,error:b,data:M,isFetching:p,canAbort:_,aborted:m,abort:B,execute:R,onFetchResponse:c.on,onFetchError:d.on,onFetchFinally:f.on,get:k("GET"),put:k("PUT"),post:k("POST"),delete:k("DELETE"),patch:k("PATCH"),head:k("HEAD"),options:k("OPTIONS"),json:I("json"),text:I("text"),blob:I("blob"),arrayBuffer:I("arrayBuffer"),formData:I("formData")};function k(G){return(Z,K)=>{if(!p.value){a.method=G,a.payload=Z,a.payloadType=K,Ke(a.payload)&&Ve([L,Ua(a.payload)],([Se])=>Se&&R(),{deep:!0});const te=Ae(a.payload);return!K&&te&&Object.getPrototypeOf(te)===Object.prototype&&(a.payloadType="json"),Nn(Je({},x),{then(Se,Me){return F().then(Se,Me)}})}}}function F(){return new Promise((G,Z)=>{Eg(h).toBe(!0).then(()=>G(x)).catch(K=>Z(K))})}function I(G){return()=>{if(!p.value)return a.type=G,Nn(Je({},x),{then(Z,K){return F().then(Z,K)}})}}return s.immediate&&setTimeout(R,0),Nn(Je({},x),{then(G,Z){return F().then(G,Z)}})}function Ng(e,r){return!e.endsWith("/")&&!r.startsWith("/")?`${e}/${r}`:`${e}${r}`}var fc;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(fc||(fc={}));var Bg=Object.defineProperty,hc=Object.getOwnPropertySymbols,Fg=Object.prototype.hasOwnProperty,Dg=Object.prototype.propertyIsEnumerable,pc=(e,r,t)=>r in e?Bg(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,$g=(e,r)=>{for(var t in r||(r={}))Fg.call(r,t)&&pc(e,t,r[t]);if(hc)for(var t of hc(r))Dg.call(r,t)&&pc(e,t,r[t]);return e};const jg={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};$g({linear:kg},jg);const hn=e=>e===void 0;function we(e,r){const t=Ae(e);return hn(t)?r:Number(t)}function ar(e,r){const t=Ae(e);return Array.isArray(t)?t:t?String(t):r}function st(e,r){const t=Ae(e);return hn(t)?r:String(t)}function yt(e,r){const t=Ae(e);return hn(t)?r:!!t}const pa={src:{type:String,default:null},audioControls:{type:Boolean,default:!0},corsAnonym:{type:Boolean,default:!1},canvWidth:{type:Number,default:300},canvHeight:{type:Number,default:80},canvFillColor:{type:[String,Array],default:""},placeholder:{type:Boolean,default:!0}},Ug={barWidth:{type:Number,default:5},barSpace:{type:Number,default:1},barColor:{type:[String,Array],default:"#0A0AFF"},capsHeight:{type:Number,default:0},capsDropSpeed:{type:Number,default:.9},capsColor:{type:String,default:"#A0A0FF"},brickHeight:{type:Number,default:0},brickSpace:{type:Number,default:1},symmetric:{type:Boolean,default:!1},fftSize:{type:Number,default:1024}},kt={...pa,...Ug};function Hg(){return kt}let th=class{constructor(r){V(this,"barColor"),V(this,"barSpace"),V(this,"barWidth"),V(this,"brickHeight"),V(this,"brickSpace"),V(this,"canvFillColor"),V(this,"canvHeight"),V(this,"canvWidth"),V(this,"capsColor"),V(this,"capsDropSpeed"),V(this,"capsHeight"),V(this,"fftSize"),V(this,"frqBits"),V(this,"placeholder"),V(this,"symmetric"),this.barColor=ar(r.barColor,kt.barColor.default),this.barSpace=we(r.barSpace,kt.barSpace.default),this.brickHeight=we(r.brickHeight,kt.brickHeight.default),this.brickSpace=we(r.brickSpace,kt.brickSpace.default),this.canvFillColor=ar(r.canvFillColor,kt.canvFillColor.default),this.canvHeight=we(r.canvHeight,kt.canvHeight.default),this.canvWidth=we(r.canvWidth,kt.canvWidth.default),this.capsColor=st(r.capsColor,kt.capsColor.default),this.capsDropSpeed=we(r.capsDropSpeed,kt.capsDropSpeed.default),this.capsHeight=we(r.capsHeight,kt.capsHeight.default),this.fftSize=we(r.fftSize,kt.fftSize.default),this.frqBits=this.fftSize>>1,this.placeholder=yt(r.placeholder,kt.placeholder.default),this.symmetric=yt(r.symmetric,kt.symmetric.default);const t=we(r.barWidth,kt.barWidth.default);this.barWidth=t>this.canvWidth?this.canvWidth:t}alignSym(r){return this.symmetric?(this.canvHeight-r)/2:0}};const zg={lineWidth:{type:Number,default:2},lineColor:{type:[String,Array],default:"#9F9"},fftSize:{type:Number,default:128}},nh={...pa,...zg};function Wg(){return nh}let mc=class{constructor(r){V(this,"canvWidth"),V(this,"canvHeight"),V(this,"canvFillColor"),V(this,"lineWidth"),V(this,"lineColor"),V(this,"fftSize"),V(this,"placeholder");const t=nh;this.canvWidth=we(r.canvWidth,t.canvWidth.default),this.canvHeight=we(r.canvHeight,t.canvHeight.default),this.canvFillColor=ar(r.canvFillColor,t.canvFillColor.default),this.lineWidth=we(r.lineWidth,t.lineWidth.default),this.lineColor=ar(r.lineColor,t.lineColor.default),this.fftSize=we(r.fftSize,t.fftSize.default),this.placeholder=yt(r.placeholder,t.placeholder.default)}};const Vg={fftSize:{type:Number,default:1024},canvWidth:{type:Number,default:100},canvHeight:{type:Number,default:100},radius:{type:Number,default:0},lineWidth:{type:Number,default:1},lineSpace:{type:Number,default:1},outlineColor:{type:String,default:"#0000FF"},outlineWidth:{type:Number,default:.3},barWidth:{type:Number,default:1},barLength:{type:Number,default:0},barColor:{type:[String,Array],default:["#FFFFFF","#0000FF"]},progress:{type:Boolean,default:!0},progressWidth:{type:Number,default:1},progressColor:{type:String,default:"#0000FF"},progressClockwise:{type:Boolean,default:!0},outlineMeterSpace:{type:Number,default:3},playtime:{type:Boolean,default:!1},playtimeFont:{type:String,default:"14px Monaco"},playtimeColor:{type:String,default:"#00f"},rotateGraph:{type:Boolean,default:!1},rotateSpeed:{type:Number,default:.001}},rh={...pa,...Vg};function qg(){return rh}let ss=1.5,vc=class{constructor(r){V(this,"barColor"),V(this,"barLength"),V(this,"barWidth"),V(this,"canvFillColor"),V(this,"canvHeight"),V(this,"canvWidth"),V(this,"fftSize"),V(this,"lineSpace"),V(this,"lineWidth"),V(this,"outlineColor"),V(this,"outlineMeterSpace"),V(this,"outlineWidth"),V(this,"placeholder"),V(this,"playtime"),V(this,"playtimeColor"),V(this,"playtimeFont"),V(this,"progress"),V(this,"progressClockwise"),V(this,"progressColor"),V(this,"progressWidth"),V(this,"radius"),V(this,"rotateGraph"),V(this,"rotateSpeed");const t=rh;this.barColor=ar(r.barColor,t.barColor.default),this.barLength=we(r.barLength,t.barLength.default),this.barWidth=we(r.barWidth,t.barWidth.default),this.canvFillColor=ar(r.canvFillColor,t.canvFillColor.default),this.canvHeight=we(r.canvHeight,t.canvHeight.default),this.canvWidth=we(r.canvWidth,t.canvWidth.default),this.fftSize=we(r.fftSize,t.fftSize.default),this.lineSpace=we(r.lineSpace,t.lineSpace.default),this.lineWidth=we(r.lineWidth,t.lineWidth.default),this.outlineColor=st(r.outlineColor,t.outlineColor.default),this.outlineMeterSpace=we(r.outlineMeterSpace,t.outlineMeterSpace.default),this.outlineWidth=we(r.outlineWidth,t.outlineWidth.default),this.lineWidth=we(r.lineWidth,t.lineWidth.default),this.placeholder=yt(r.placeholder,t.placeholder.default),this.playtime=yt(r.playtime,t.playtime.default),this.playtimeColor=st(r.playtimeColor,t.playtimeColor.default),this.playtimeFont=st(r.playtimeFont,t.playtimeFont.default),this.progress=yt(r.progress,t.progress.default),this.progressClockwise=yt(r.progressClockwise,t.progressClockwise.default),this.progressColor=st(r.progressColor,t.progressColor.default),this.progressWidth=we(r.progressWidth,t.progressWidth.default),this.radius=we(r.radius,t.radius.default),this.rotateGraph=yt(r.rotateGraph,t.rotateGraph.default),this.rotateSpeed=we(r.rotateSpeed,t.rotateSpeed.default)}get cx(){return this.canvWidth/2}get cy(){return this.canvHeight/2}get r(){return this.radius>0?this.radius:Math.round(this.canvWidth/2*.7)}get arcStep(){return Math.ceil(this.lineWidth+this.lineSpace)}get barLen(){return this.barLength>0?this.barLength:this.canvWidth/2-this.r}get angle(){const r=()=>ss===3.5?1.5:ss+this.rotateSpeed;return ss=this.rotateGraph?r():1.5,Math.PI*ss}};const Gg={canvWidth:{type:Number,default:500},canvHeight:{type:Number,default:80},playedLineWidth:{type:Number,default:.5},playedLineColor:{type:String,default:"navy"},noplayedLineWidth:{type:Number,default:.5},noplayedLineColor:{type:String,default:"lime"},playtime:{type:Boolean,default:!0},playtimeWithMs:{type:Boolean,default:!0},playtimeFontSize:{type:Number,default:12},playtimeFontFamily:{type:String,default:"monospace"},playtimeFontColor:{type:String,default:"grey"},playtimeTextBottom:{type:Boolean,default:!1},playtimeSlider:{type:Boolean,default:!0},playtimeSliderColor:{type:String,default:"red"},playtimeSliderWidth:{type:Number,default:1},playtimeClickable:{type:Boolean,default:!0},requester:{type:Function,default:fetch}},ih={...pa,...Gg};function Kg(){return ih}let Jg=class{constructor(r){V(this,"src"),V(this,"canvWidth"),V(this,"canvHeight"),V(this,"canvFillColor"),V(this,"currentTime"),V(this,"duration"),V(this,"playedLineWidth"),V(this,"playedLineColor"),V(this,"noplayedLineWidth"),V(this,"noplayedLineColor"),V(this,"playtime"),V(this,"playtimeWithMs"),V(this,"playtimeFontSize"),V(this,"playtimeFontFamily"),V(this,"playtimeFontColor"),V(this,"playtimeTextBottom"),V(this,"playtimeSlider"),V(this,"playtimeSliderColor"),V(this,"playtimeSliderWidth"),V(this,"playtimeClickable"),V(this,"peaks",[]);const t=ih;this.canvWidth=we(r.canvWidth,t.canvWidth.default),this.canvHeight=we(r.canvHeight,t.canvHeight.default),this.canvFillColor=ar(r.canvFillColor,t.canvFillColor.default),this.playedLineWidth=we(r.playedLineWidth,t.playedLineWidth.default),this.playedLineColor=st(r.playedLineColor,t.playedLineColor.default),this.noplayedLineWidth=we(r.noplayedLineWidth,t.noplayedLineWidth.default),this.noplayedLineColor=st(r.noplayedLineColor,t.noplayedLineColor.default),this.playtime=yt(r.playtime,t.playtime.default),this.playtimeWithMs=yt(r.playtimeWithMs,t.playtimeWithMs.default),this.playtimeFontSize=we(r.playtimeFontSize,t.playtimeFontSize.default),this.playtimeFontFamily=st(r.playtimeFontFamily,t.playtimeFontFamily.default),this.playtimeFontColor=st(r.playtimeFontColor,t.playtimeFontColor.default),this.playtimeTextBottom=yt(r.playtimeTextBottom,t.playtimeTextBottom.default),this.playtimeSlider=yt(r.playtimeSlider,t.playtimeSlider.default),this.playtimeSliderColor=st(r.playtimeSliderColor,t.playtimeSliderColor.default),this.playtimeSliderWidth=we(r.playtimeSliderWidth,t.playtimeSliderWidth.default),this.playtimeClickable=yt(r.playtimeClickable,t.playtimeClickable.default),this.src=hn(r.src)?null:String(r.src),this.currentTime=0,this.duration=0}get playX(){if(!this.duration)return 0;const r=~~(this.currentTime/this.duration*this.canvWidth);return r>this.canvWidth?this.canvWidth:r}get timePlayed(){const r=[this.currentTime/3600,this.currentTime/60%60,this.currentTime%60].map(n=>String(~~n).padStart(2,"0")).join(":");if(!this.playtimeWithMs)return r;const t=~~(this.currentTime%1*1e3);return[r,String(t).padStart(3,"0")].join(".")}setPeaks(r){this.peaks.slice(0);let t=0,n=0,i=0,s=0;const a=Math.ceil(r.length/this.canvWidth),o=this.canvWidth,l=this.canvHeight;for(let u=0;u<r.numberOfChannels;u++){const c=r.getChannelData(u);for(let d=0;d<o;d++){const f=~~(d*a),h=~~(f+a);t=0,n=0;for(let p=f;p<h;p++)t=c[p]<t?c[p]:t,n=c[p]>n?c[p]:n;this.peaks[d]&&(this.peaks[d][0]=this.peaks[d][0]<n?n:this.peaks[d][0],this.peaks[d][1]=this.peaks[d][1]>t?t:this.peaks[d][1]),this.peaks[d]=[n,t]}}for(let u=0;u<this.peaks.length;u++)n=this.peaks[u][0],t=this.peaks[u][1],i=l/2-n*l/2,s=l/2-t*l/2,this.peaks[u]=[i,s===i?i+1:s]}};const Xg={media:{type:Object,required:!1,default:null},canvWidth:{type:Number,default:0},canvClass:{type:String,default:""},canvHeight:{type:Number,default:0},canvFillColor:{type:String,default:""},circleGradient:{type:Array,default:[[0,"palegreen"],[.3,"lime"],[.7,"limegreen"],[1,"green"]]},fftSize:{type:Number},type:{type:String,default:"wform"},frequLnum:{type:Number,default:60},frequLineCap:{type:Boolean,default:!1},frequDirection:{type:String,default:"lr"},lineColor:{type:String,default:"lime"},lineWidth:{type:Number},radius:{type:Number,default:4},connectDestination:{type:Boolean,default:!1},vbarBgColor:{type:String,default:"#e1e1e1"},vbarCaps:{type:Boolean,default:!0},vbarSpace:{type:Number,default:1},vbarWidth:{type:Number,default:4},vbarFillColor:{type:String,default:"lime"},vbarRightColor:{type:String,default:"#c0c0c0"}},sh={...Xg};function Yg(){return sh}let Ha=class{constructor(r){V(this,"canvWidth"),V(this,"canvHeight"),V(this,"canvFillColor"),V(this,"canvClass"),V(this,"circleGradient"),V(this,"fftSize"),V(this,"type"),V(this,"frequLnum"),V(this,"frequLineCap"),V(this,"frequDirection"),V(this,"lineColor"),V(this,"lineWidth"),V(this,"radius"),V(this,"connectDestination"),V(this,"vbarBgColor"),V(this,"vbarCaps"),V(this,"vbarFillColor"),V(this,"vbarRightColor"),V(this,"vbarSpace"),V(this,"vbarWidth");const t=sh;this.canvFillColor=st(r.canvFillColor,t.canvFillColor.default),this.canvClass=st(r.canvClass,t.canvClass.default),this.circleGradient=hn(r.circleGradient)?t.circleGradient.default:r.circleGradient,this.type=st(r.type,t.type.default),this.fftSize=hn(r.fftSize)?this.type==="frequ"?1024:8192:Number(r.fftSize),this.frequLnum=we(r.frequLnum,t.frequLnum.default),this.frequLineCap=yt(r.frequLineCap,t.frequLineCap.default),this.frequDirection=st(r.frequDirection,t.frequDirection.default),this.lineColor=st(r.lineColor,t.lineColor.default),this.lineWidth=hn(r.lineWidth)?this.type==="frequ"?3:.5:Number(r.lineWidth),this.radius=we(r.radius,t.radius.default),this.connectDestination=yt(r.connectDestination,t.connectDestination.default),this.vbarBgColor=st(r.vbarBgColor,t.vbarBgColor.default),this.vbarCaps=yt(r.vbarCaps,t.vbarCaps.default),this.vbarFillColor=st(r.vbarFillColor,t.vbarFillColor.default),this.vbarRightColor=st(r.vbarRightColor,t.vbarRightColor.default),this.vbarSpace=we(r.vbarSpace,t.vbarSpace.default),this.vbarWidth=we(r.vbarWidth,t.vbarWidth.default),this.canvWidth=hn(r.canvWidth)||Number(r.canvWidth)===0?this.defaultWidth:Number(r.canvWidth),this.canvHeight=hn(r.canvHeight)||Number(r.canvHeight)===0?this.defaultHeight:Number(r.canvHeight)}get defaultWidth(){switch(this.type){case"vbar":return 50;case"frequ":return 300;case"circle":return 80;default:return 200}}get defaultHeight(){switch(this.type){case"vbar":return 20;case"frequ":return 80;case"circle":return 80;default:return 40}}};function Bl(e,r,t){let n=null,i=null,s=null;const a=r||1024,o=new Uint8Array(a/2),{pause:l,resume:u}=Nl(()=>{!i||(i.getByteFrequencyData(o),t(o))},{immediate:!1});fn(e,"play",()=>{const c=Ae(e);!c||(n||(n=new AudioContext,s=n.createMediaElementSource(c)),i=n.createAnalyser(),i.fftSize=a,s?.connect(i),i.connect(n.destination),n.resume(),u())}),fn(e,"pause",()=>{n?.suspend(),s?.disconnect(),i?.disconnect(),l()})}function Yi(e,r){const t=ee(null);return ua(()=>{const n=Ae(e);!n||(t.value=n.getContext("2d"),n.width=r.canvWidth,n.height=r.canvHeight)}),t}function Fl(e,r,t,n){e.clearRect(0,0,r,t),n&&(e.fillStyle=Dl(e,r,t,n),e.fillRect(0,0,r,t))}function Dl(e,r,t,n){if(!Array.isArray(n))return n||"";const i=e.createLinearGradient(r/2,0,r/2,t);let s=0;return n.forEach(a=>{i.addColorStop(s,a),s+=1/n.length}),i}const Ti=Array(16).fill(0);function Zg(e,r,t){const n=new th(t);Ti.length=n.fftSize/2,Ti.fill(0);const i=Yi(r,n);fn(e,"loadedmetadata",()=>{!n.placeholder||!i||gc(new Uint8Array(n.fftSize/2),i,t)}),Bl(e,n.fftSize,s=>{gc(s,i,t)})}function gc(e,r,t){const n=Ae(r);if(!n)return;const i=new th(t),s=Math.round((i.barWidth+i.barSpace)/i.frqBits*i.canvWidth),a=e.length;let o=0;Fl(n,i.canvWidth,i.canvHeight,i.canvFillColor);for(let l=0;l<a;l++){if(l%s)continue;const u=Math.round(e.slice(l,l+s).reduce((d,f)=>f+d,0)/s),c=u/255*i.canvHeight;Qg(n,i,u,l,o),n.fillStyle=Dl(n,i.canvWidth,i.canvHeight,i.barColor),i.brickHeight>0?ey(n,i,c,o):n.fillRect(o,i.canvHeight-c-i.alignSym(c),i.barWidth,c),o+=i.barWidth+i.barSpace}}function Qg(e,r,t,n,i){if(r.capsHeight===0)return;const s=Ti[n]<=t?t:Ti[n]-r.capsDropSpeed;Ti[n]=s;const a=s/255*r.canvHeight,o=r.canvHeight-a-r.capsHeight-r.alignSym(a);e.fillStyle=r.capsColor,e.fillRect(i,o,r.barWidth,r.capsHeight),r.symmetric&&e.fillRect(i,r.canvHeight-o-r.capsHeight,r.barWidth,r.capsHeight)}function ey(e,r,t,n){for(let i=0;i<t;i+=r.brickHeight+r.brickSpace)e.fillRect(n,r.canvHeight-t+i-r.alignSym(t),r.barWidth,r.brickHeight)}const ty=["controls","src"],ny=_e({__name:"AVBars",props:Hg(),setup(e){const r=e,t=ee(null),n=ee(null);return Zg(t,n,r),(i,s)=>(q(),de(Ge,null,[he("audio",{ref_key:"player",ref:t,controls:r.audioControls,src:r.src},null,8,ty),he("canvas",{ref_key:"canvas",ref:n},null,512)],64))}});function ry(e,r,t){const n=new vc(t),i=Yi(r,n);fn(e,"loadedmetadata",()=>{sy(i,n)}),Bl(e,n.fftSize,s=>{iy(s,i,e,new vc(t))})}function iy(e,r,t,n){const i=Ae(r);if(!i)return;const s=Ae(t);if(!s)return;const a=e.length,o=(n.lineWidth+n.lineSpace)/a*(2*Math.PI);Fl(i,n.canvWidth,n.canvHeight,n.canvFillColor),ah(i,n),ay(i,s,n),oy(i,s,n),i.lineWidth=n.barWidth,i.strokeStyle=ly(i,n);let l=n.angle;for(let u=0;u<a;u++){if(l+=o,u%n.arcStep)continue;const c=Math.round(e.slice(u,u+n.arcStep).reduce((f,h)=>h+f,0)/n.arcStep),d=n.r+c/255*n.barLen;i.beginPath(),i.moveTo(n.r*Math.cos(l)+n.cx,n.r*Math.sin(l)+n.cy),i.lineTo(d*Math.cos(l)+n.cx,d*Math.sin(l)+n.cy),i.stroke()}}function sy(e,r){const t=Ae(e);!t||(ah(t,r),oh(t,"0:00",r))}function ah(e,r){r.outlineWidth!==0&&(e.beginPath(),e.strokeStyle=r.outlineColor,e.lineWidth=r.outlineWidth,e.arc(r.cx,r.cy,r.r,0,2*Math.PI),e.stroke())}function ay(e,r,t){if(!t.progress)return;const{currentTime:n,duration:i}=r,s=n/i*2*Math.PI,a=Math.PI*1.5+s;!s||(e.lineWidth=t.progressWidth,e.strokeStyle=t.progressColor,e.beginPath(),e.arc(t.cx,t.cy,t.r-t.outlineWidth-t.outlineMeterSpace,1.5*Math.PI,a,t.progressClockwise),e.stroke())}function oy(e,r,t){const{currentTime:n}=r,i=Math.floor(n/60),s=Math.floor(n)%60,a=s<10?`0${s}`:`${s}`,o=`${i}:${a}`;oh(e,o,t)}function oh(e,r,t){e.font=t.playtimeFont,e.fillStyle=t.playtimeColor,e.textAlign="center",e.fillText(r,t.cx,t.cy+parseInt(t.playtimeFont)*.25)}function ly(e,r){if(!Array.isArray(r.barColor))return r.barColor;const t=e.createRadialGradient(r.cx,r.cy,r.canvWidth/2,r.cx,r.cy,0);let n=0;return r.barColor.forEach(i=>{t.addColorStop(n,i),n+=1/r.barColor.length}),t}const uy=["controls","src"],cy=_e({__name:"AVCircle",props:qg(),setup(e){const r=e,t=ee(null),n=ee(null);return ry(t,n,r),(i,s)=>(q(),de(Ge,null,[he("audio",{ref_key:"player",ref:t,controls:r.audioControls,src:r.src},null,8,uy),he("canvas",{ref_key:"canvas",ref:n},null,512)],64))}});function dy(e,r,t){const n=new mc(t),i=Yi(r,n);Ve(i,()=>{!n.placeholder||!Ae(i)||yc(new Uint8Array(n.fftSize),i,n)}),Bl(e,n.fftSize,s=>{yc(s,i,new mc(t))})}function yc(e,r,t){const n=Ae(r);if(!n)return;const i=t.canvWidth,s=t.canvHeight,a=t.lineWidth,o=e.length,l=~~i/2/o;let u=0;const c=()=>{let d=0;for(let f=0;f<o;f++){const h=e[f];d=s*(255-h)/510,f%2&&(d=s-d),n.lineTo(u,d),u+=l}return u};Fl(n,i,s,t.canvFillColor),n.lineWidth=a,n.strokeStyle=Dl(n,i,s,t.lineColor),n.beginPath(),e.reverse(),n.moveTo(u,s/2),u=c(),e.reverse(),c(),n.lineTo(i,s/2),n.stroke()}const fy=["controls","src"],hy=_e({__name:"AVLine",props:Wg(),setup(e){const r=e,t=ee(null),n=ee(null);return dy(t,n,r),(i,s)=>(q(),de(Ge,null,[he("audio",{ref_key:"player",ref:t,controls:r.audioControls,src:r.src},null,8,fy),he("canvas",{ref_key:"canvas",ref:n},null,512)],64))}});function py(e,r,t,n={}){const i=new Jg(t),s=Yi(r,i);my(s,i,n);const{pause:a,resume:o}=Nl(()=>{var l,u;i.currentTime=(u=(l=e?.value)==null?void 0:l.currentTime)!=null?u:0,ui(s,i)},{immediate:!1});fn(e,"play",o),fn(e,"pause",a),fn(e,"ended",()=>{const l=Ae(e);!l||l.duration===i.duration||(i.duration=l.duration,ui(s,i))}),fn(e,"timeupdate",()=>{const l=Ae(e);!l||(i.currentTime=l.currentTime,ui(s,i))}),fn(r,"click",l=>{if(!i.playtimeClickable)return;const u=Ae(e);!u||(u.currentTime=l.offsetX/i.canvWidth*i.duration,i.currentTime=u.currentTime,ui(s,i))})}function ui(e,r){const t=Ae(e);if(!t)return;let n=0;t.clearRect(0,0,r.canvWidth,r.canvHeight);const i=(s,a,o,l)=>{for(t.lineWidth=o,t.strokeStyle=l,a=a>r.peaks.length?r.peaks.length:a,t.beginPath();s<a;s++)t.moveTo(s,r.peaks[s][0]),t.lineTo(s,r.peaks[s][1]);return t.stroke(),s};n=i(n,r.playX,r.playedLineWidth,r.playedLineColor),i(n,r.peaks.length,r.noplayedLineWidth,r.noplayedLineColor),lh(t,r),r.playtime&&uh(t,r)}function lh(e,r){e.lineWidth=r.playtimeSliderWidth,e.strokeStyle=r.playtimeSliderColor,e.beginPath(),e.moveTo(r.playX,0),e.lineTo(r.playX,r.canvHeight),e.stroke()}function uh(e,r){const t=r.timePlayed,n=3,i=~~e.measureText(t).width,s=r.playX>r.canvWidth-i-n?r.playX-i-n:r.playX+n,a=r.playtimeTextBottom?r.canvHeight-r.playtimeFontSize+n:r.playtimeFontSize+n;e.fillStyle=r.playtimeFontColor,e.font=`${r.playtimeFontSize}px ${r.playtimeFontFamily}`,e.fillText(t,s,a)}function my(e,r,t){r.src&&(Rg(t)(r.src).arrayBuffer().then(({error:n,data:i})=>{const s=Ae(n);if(s!==null){console.error(`Failed get url '${r.src}': ${s}`);return}if(i.value===null){console.error("invalid arrayBuffer data received");return}new AudioContext().decodeAudioData(i.value).then(a=>{r.duration=a.duration,r.setPeaks(a),ui(e,r)}).catch(a=>{console.error("Failed to decode audio array buffer:",a)})}),ua(()=>{const n=Ae(e);!n||(n.lineWidth=r.noplayedLineWidth,n.strokeStyle=r.noplayedLineColor,n.beginPath(),n.moveTo(0,r.canvHeight/2),n.lineTo(r.canvWidth,r.canvHeight/2),n.stroke(),lh(n,r),r.playtime&&uh(n,r))}))}const vy=["controls","src"],gy=_e({__name:"AVWaveform",props:Kg(),setup(e){const r=e,t=ee(null),n=ee(null);return py(t,n,r,{options:{refetch:!0},fetchOptions:{mode:"cors"}}),(i,s)=>(q(),de(Ge,null,[he("audio",{ref_key:"player",ref:t,controls:r.audioControls,src:r.src},null,8,vy),he("canvas",{ref_key:"canvas",ref:n},null,512)],64))}});function yy(e,r){const t=r;let n;const i=Yi(e,new Ha(t)),{pause:s,resume:a}=Nl(()=>{!n||Sy(n,i,new Ha(t))},{immediate:!1});ua(()=>{const o=Ae(t.media);o?(n=by(o,new Ha(t)),a()):s()})}function by(e,r){const t=new AudioContext,n=t.createAnalyser();return t.createMediaStreamSource(e).connect(n),n.fftSize=r.fftSize,r.connectDestination&&n.connect(t.destination),n}function Sy(e,r,t){const n=Ae(r);if(!n)return;const i=new Uint8Array(e.fftSize);switch(t.canvFillColor&&(n.fillStyle=t.canvFillColor),n.clearRect(0,0,t.canvWidth,t.canvHeight),n.beginPath(),n.strokeStyle=t.lineColor,t.type){case"frequ":e.getByteFrequencyData(i),ky(i,n,t);break;case"circle":e.getByteFrequencyData(i),Ey(i,n,t);break;case"vbar":e.getByteFrequencyData(i),_y(i,n,t);break;default:e.getByteTimeDomainData(i),wy(i,n,t);break}}function ky(e,r,t){const n=t.frequDirection==="mo",i=n?t.canvWidth/2:0,s=n?t.frequLnum/2:t.frequLnum,a=n?t.canvWidth/s/2:t.canvWidth/s,o=t.canvHeight,l=t.lineWidth||2;for(let u=0;u<s;u++){const c=n?u*a:u*a+l,d=e.slice(c,c+a).reduce((h,p)=>h+p/255*o,0)/a,f=(o-d)/2+2;r.lineWidth=l,r.lineCap=t.frequLineCap?"round":"butt",r.moveTo(i+c,f),r.lineTo(i+c,o-f),r.stroke(),n&&u>0&&(r.moveTo(i-c,f),r.lineTo(i-c,o-f),r.stroke())}}function _y(e,r,t){const n=t.vbarWidth,i=t.vbarSpace,s=n<5?5:n/2;let a=0;for(let l=0;l<e.length;l++)a=a<e[l]?e[l]:a;const o=a/255*t.canvWidth;r.lineWidth=t.vbarWidth,r.lineCap=t.vbarCaps?"round":"butt",r.fillStyle=t.vbarBgColor,r.fillRect(0,0,t.canvWidth,t.canvHeight);for(let l=n/2;l+n+i<=t.canvWidth;l=l+n+i)r.strokeStyle=l>o?t.vbarRightColor:t.vbarFillColor,r.beginPath(),r.moveTo(l,s),r.lineTo(l,t.canvHeight-s),r.stroke()}function Ey(e,r,t){const n=t.canvWidth/2,i=t.canvHeight/2,s=n<i?n:i,a=Math.max(...e)/255*s,o=r.createRadialGradient(n,i,0,n,i,a);for(const[l,u]of t.circleGradient)o.addColorStop(l,u);r.fillStyle=o,r.arc(n,i,a,0,2*Math.PI),r.fill("evenodd")}function wy(e,r,t){const n=t.canvHeight,i=t.canvWidth/t.fftSize;let s=0;r.lineWidth=t.lineWidth||.5;for(let a=0;a<e.length;a++){const o=e[a]/255*n;r.lineTo(s,o),s+=i}r.stroke()}const Cy=_e({__name:"AVMedia",props:Yg(),setup(e){const r=e,t=ee(null);return yy(t,r),(n,i)=>(q(),de("canvas",{ref_key:"canvas",ref:t},null,512))}}),Ty={install(e){e.component("av-bars",ny),e.component("av-circle",cy),e.component("av-line",hy),e.component("av-waveform",gy),e.component("av-media",Cy)}},Fr=Object.prototype.toString;function Or(e){return Fr.call(e)==="[object Array]"}function bc(e){return Fr.call(e)==="[object Boolean]"}function ch(e){return Fr.call(e)==="[object Object]"}const Sc=e=>Fr.call(e)==="[object Promise]";function $l(e){return Fr.call(e)==="[object String]"}function bt(e){return Fr.call(e)==="[object Number]"&&e===e}function Ay(e){return e===void 0}function Dn(e){return typeof e=="function"}const ma=Symbol("ArcoConfigProvider"),as={formatYear:"YYYY 年",formatMonth:"YYYY 年 MM 月",today:"今天",view:{month:"月",year:"年",week:"周",day:"日"},month:{long:{January:"一月",February:"二月",March:"三月",April:"四月",May:"五月",June:"六月",July:"七月",August:"八月",September:"九月",October:"十月",November:"十一月",December:"十二月"},short:{January:"一月",February:"二月",March:"三月",April:"四月",May:"五月",June:"六月",July:"七月",August:"八月",September:"九月",October:"十月",November:"十一月",December:"十二月"}},week:{long:{self:"周",monday:"周一",tuesday:"周二",wednesday:"周三",thursday:"周四",friday:"周五",saturday:"周六",sunday:"周日"},short:{self:"周",monday:"一",tuesday:"二",wednesday:"三",thursday:"四",friday:"五",saturday:"六",sunday:"日"}}},My={locale:"zh-CN",empty:{description:"暂无数据"},drawer:{okText:"确定",cancelText:"取消"},popconfirm:{okText:"确定",cancelText:"取消"},modal:{okText:"确定",cancelText:"取消"},pagination:{goto:"前往",page:"页",countPerPage:"条/页",total:"共 {0} 条"},table:{okText:"确定",resetText:"重置"},upload:{start:"开始",cancel:"取消",delete:"删除",retry:"点击重试",buttonText:"点击上传",preview:"预览",drag:"点击或拖拽文件到此处上传",dragHover:"释放文件并开始上传",error:"上传失败"},calendar:as,datePicker:{view:as.view,month:as.month,week:as.week,placeholder:{date:"请选择日期",week:"请选择周",month:"请选择月份",year:"请选择年份",quarter:"请选择季度",time:"请选择时间"},rangePlaceholder:{date:["开始日期","结束日期"],week:["开始周","结束周"],month:["开始月份","结束月份"],year:["开始年份","结束年份"],quarter:["开始季度","结束季度"],time:["开始时间","结束时间"]},selectTime:"选择时间",today:"今天",now:"此刻",ok:"确定"},image:{loading:"加载中"},imagePreview:{fullScreen:"全屏",rotateRight:"向右旋转",rotateLeft:"向左旋转",zoomIn:"放大",zoomOut:"缩小",originalSize:"原始尺寸"},typography:{copied:"已复制",copy:"复制",expand:"展开",collapse:"折叠",edit:"编辑"},form:{validateMessages:{required:"#{field} 是必填项",type:{string:"#{field} 不是合法的文本类型",number:"#{field} 不是合法的数字类型",boolean:"#{field} 不是合法的布尔类型",array:"#{field} 不是合法的数组类型",object:"#{field} 不是合法的对象类型",url:"#{field} 不是合法的 url 地址",email:"#{field} 不是合法的邮箱地址",ip:"#{field} 不是合法的 IP 地址"},number:{min:"`#{value}` 小于最小值 `#{min}`",max:"`#{value}` 大于最大值 `#{max}`",equal:"`#{value}` 不等于 `#{equal}`",range:"`#{value}` 不在 `#{min} ~ #{max}` 范围内",positive:"`#{value}` 不是正数",negative:"`#{value}` 不是负数"},array:{length:"`#{field}` 个数不等于 #{length}",minLength:"`#{field}` 个数最少为 #{minLength}",maxLength:"`#{field}` 个数最多为 #{maxLength}",includes:"#{field} 不包含 #{includes}",deepEqual:"#{field} 不等于 #{deepEqual}",empty:"`#{field}` 不是空数组"},string:{minLength:"字符数最少为 #{minLength}",maxLength:"字符数最多为 #{maxLength}",length:"字符数必须是 #{length}",match:"`#{value}` 不符合模式 #{pattern}",uppercase:"`#{value}` 必须全大写",lowercase:"`#{value}` 必须全小写"},object:{deepEqual:"`#{field}` 不等于期望值",hasKeys:"`#{field}` 不包含必须字段",empty:"`#{field}` 不是对象"},boolean:{true:"期望是 `true`",false:"期望是 `false`"}}},colorPicker:{history:"最近使用颜色",preset:"系统预设颜色",empty:"暂无"}},xy=ee("zh-CN"),Iy=jt({"zh-CN":My}),Ly=()=>{const e=Tt(ma,void 0),r=j(()=>{var i;return(i=e?.locale)!=null?i:Iy[xy.value]}),t=j(()=>r.value.locale);return{i18nMessage:r,locale:t,t:(i,...s)=>{const a=i.split(".");let o=r.value;for(const l of a){if(!o[l])return i;o=o[l]}return $l(o)&&s.length>0?o.replace(/{(\d+)}/g,(l,u)=>{var c;return(c=s[u])!=null?c:l}):o}}},Oy="A",Ry="arco",$o="$arco",wn=e=>{var r;return(r=e?.componentPrefix)!=null?r:Oy},Cn=(e,r)=>{var t;r&&r.classPrefix&&(e.config.globalProperties[$o]={...(t=e.config.globalProperties[$o])!=null?t:{},classPrefix:r.classPrefix})},Ue=e=>{var r,t,n;const i=Vn(),s=Tt(ma,void 0),a=(n=(t=s?.prefixCls)!=null?t:(r=i?.appContext.config.globalProperties[$o])==null?void 0:r.classPrefix)!=null?n:Ry;return e?`${a}-${e}`:a};var dh=function(){if(typeof Map<"u")return Map;function e(r,t){var n=-1;return r.some(function(i,s){return i[0]===t?(n=s,!0):!1}),n}return function(){function r(){this.__entries__=[]}return Object.defineProperty(r.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),r.prototype.get=function(t){var n=e(this.__entries__,t),i=this.__entries__[n];return i&&i[1]},r.prototype.set=function(t,n){var i=e(this.__entries__,t);~i?this.__entries__[i][1]=n:this.__entries__.push([t,n])},r.prototype.delete=function(t){var n=this.__entries__,i=e(n,t);~i&&n.splice(i,1)},r.prototype.has=function(t){return!!~e(this.__entries__,t)},r.prototype.clear=function(){this.__entries__.splice(0)},r.prototype.forEach=function(t,n){n===void 0&&(n=null);for(var i=0,s=this.__entries__;i<s.length;i++){var a=s[i];t.call(n,a[1],a[0])}},r}()}(),jo=typeof window<"u"&&typeof document<"u"&&window.document===document,Ws=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),Py=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Ws):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),Ny=2;function By(e,r){var t=!1,n=!1,i=0;function s(){t&&(t=!1,e()),n&&o()}function a(){Py(s)}function o(){var l=Date.now();if(t){if(l-i<Ny)return;n=!0}else t=!0,n=!1,setTimeout(a,r);i=l}return o}var Fy=20,Dy=["top","right","bottom","left","width","height","size","weight"],$y=typeof MutationObserver<"u",jy=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=By(this.refresh.bind(this),Fy)}return e.prototype.addObserver=function(r){~this.observers_.indexOf(r)||this.observers_.push(r),this.connected_||this.connect_()},e.prototype.removeObserver=function(r){var t=this.observers_,n=t.indexOf(r);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var r=this.updateObservers_();r&&this.refresh()},e.prototype.updateObservers_=function(){var r=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return r.forEach(function(t){return t.broadcastActive()}),r.length>0},e.prototype.connect_=function(){!jo||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),$y?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!jo||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(r){var t=r.propertyName,n=t===void 0?"":t,i=Dy.some(function(s){return!!~n.indexOf(s)});i&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),fh=function(e,r){for(var t=0,n=Object.keys(r);t<n.length;t++){var i=n[t];Object.defineProperty(e,i,{value:r[i],enumerable:!1,writable:!1,configurable:!0})}return e},Rr=function(e){var r=e&&e.ownerDocument&&e.ownerDocument.defaultView;return r||Ws},hh=va(0,0,0,0);function Vs(e){return parseFloat(e)||0}function kc(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return r.reduce(function(n,i){var s=e["border-"+i+"-width"];return n+Vs(s)},0)}function Uy(e){for(var r=["top","right","bottom","left"],t={},n=0,i=r;n<i.length;n++){var s=i[n],a=e["padding-"+s];t[s]=Vs(a)}return t}function Hy(e){var r=e.getBBox();return va(0,0,r.width,r.height)}function zy(e){var r=e.clientWidth,t=e.clientHeight;if(!r&&!t)return hh;var n=Rr(e).getComputedStyle(e),i=Uy(n),s=i.left+i.right,a=i.top+i.bottom,o=Vs(n.width),l=Vs(n.height);if(n.boxSizing==="border-box"&&(Math.round(o+s)!==r&&(o-=kc(n,"left","right")+s),Math.round(l+a)!==t&&(l-=kc(n,"top","bottom")+a)),!Vy(e)){var u=Math.round(o+s)-r,c=Math.round(l+a)-t;Math.abs(u)!==1&&(o-=u),Math.abs(c)!==1&&(l-=c)}return va(i.left,i.top,o,l)}var Wy=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof Rr(e).SVGGraphicsElement}:function(e){return e instanceof Rr(e).SVGElement&&typeof e.getBBox=="function"}}();function Vy(e){return e===Rr(e).document.documentElement}function qy(e){return jo?Wy(e)?Hy(e):zy(e):hh}function Gy(e){var r=e.x,t=e.y,n=e.width,i=e.height,s=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(s.prototype);return fh(a,{x:r,y:t,width:n,height:i,top:t,right:r+n,bottom:i+t,left:r}),a}function va(e,r,t,n){return{x:e,y:r,width:t,height:n}}var Ky=function(){function e(r){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=va(0,0,0,0),this.target=r}return e.prototype.isActive=function(){var r=qy(this.target);return this.contentRect_=r,r.width!==this.broadcastWidth||r.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var r=this.contentRect_;return this.broadcastWidth=r.width,this.broadcastHeight=r.height,r},e}(),Jy=function(){function e(r,t){var n=Gy(t);fh(this,{target:r,contentRect:n})}return e}(),Xy=function(){function e(r,t,n){if(this.activeObservations_=[],this.observations_=new dh,typeof r!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=r,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(r instanceof Rr(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(r)||(t.set(r,new Ky(r)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(r instanceof Rr(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(r)&&(t.delete(r),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var r=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&r.activeObservations_.push(t)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var r=this.callbackCtx_,t=this.activeObservations_.map(function(n){return new Jy(n.target,n.broadcastRect())});this.callback_.call(r,t,r),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),ph=typeof WeakMap<"u"?new WeakMap:new dh,mh=function(){function e(r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=jy.getInstance(),n=new Xy(r,t,this);ph.set(this,n)}return e}();["observe","unobserve","disconnect"].forEach(function(e){mh.prototype[e]=function(){var r;return(r=ph.get(this))[e].apply(r,arguments)}});var vh=function(){return typeof Ws.ResizeObserver<"u"?Ws.ResizeObserver:mh}();const jl=e=>!!(e&&e.shapeFlag&1),Ul=(e,r)=>!!(e&&e.shapeFlag&6),Yy=(e,r)=>!!(e&&e.shapeFlag&8),gh=(e,r)=>!!(e&&e.shapeFlag&16),Zy=(e,r)=>!!(e&&e.shapeFlag&32),Qy=e=>{if(!e)return!0;for(const r of e)if(r.children)return!1;return!0},yh=(e,r)=>{if(e&&e.length>0)for(let t=0;t<e.length;t++){const n=e[t];if(jl(n)||Ul(n)){const s=Dn(r)?r(n):r;return e[t]=yn(n,s,!0),!0}const i=bh(n);if(i&&i.length>0&&yh(i,r))return!0}return!1},bh=e=>{if(gh(e,e.children))return e.children;if(Or(e))return e},Sh=e=>{var r,t;if(jl(e))return e.el;if(Ul(e)){if(((r=e.el)==null?void 0:r.nodeType)===1)return e.el;if((t=e.component)!=null&&t.subTree){const n=Sh(e.component.subTree);if(n)return n}}else{const n=bh(e);return kh(n)}},kh=e=>{if(e&&e.length>0)for(const r of e){const t=Sh(r);if(t)return t}},Ai=(e,r=!1)=>{var t,n;const i=[];for(const s of e??[])jl(s)||Ul(s)||r&&Yy(s,s.children)?i.push(s):gh(s,s.children)?i.push(...Ai(s.children,r)):Zy(s,s.children)?i.push(...Ai((n=(t=s.children).default)==null?void 0:n.call(t),r)):Or(s)&&i.push(...Ai(s,r));return i},za=e=>{if(e)return Dn(e)?e:()=>e},_h=typeof window>"u"?global:window,e0=_h.requestAnimationFrame,_c=_h.cancelAnimationFrame;function Ec(e){let r=0;const t=(...n)=>{r&&_c(r),r=e0(()=>{e(...n),r=0})};return t.cancel=()=>{_c(r),r=0},t}const Hl=()=>{},Eh=()=>{const{body:e}=document,r=document.documentElement;let t;try{t=(window.top||window.self||window).document.body}catch{}return{height:Math.max(e.scrollHeight,e.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight,t?.scrollHeight||0,t?.clientHeight||0),width:Math.max(e.scrollWidth,e.offsetWidth,r.clientWidth,r.scrollWidth,r.offsetWidth,t?.scrollWidth||0,t?.clientWidth||0)}},zl=(()=>{try{return!(typeof window<"u"&&document!==void 0)}catch{return!0}})(),nr=zl?Hl:(e,r,t,n=!1)=>{e.addEventListener(r,t,n)},$i=zl?Hl:(e,r,t,n=!1)=>{e.removeEventListener(r,t,n)},t0=(e,r)=>{if(!e||!r)return!1;let t=r;for(;t;){if(t===e)return!0;t=t.parentNode}return!1},n0=e=>{const r=document.createElement("div");return r.setAttribute("class",`arco-overlay arco-overlay-${e}`),r},r0=(e,r)=>{var t;return zl?Hl():(t=document.querySelector(e))!=null?t:void 0},Uo=(e,r)=>{if($l(e)){const t=e[0]==="#"?`[id='${e.slice(1)}']`:e;return r0(t)}return e},i0=e=>e.tagName==="BODY"?document.documentElement.scrollHeight>window.innerHeight:e.scrollHeight>e.offsetHeight,s0=e=>e.tagName==="BODY"?window.innerWidth-Eh().width:e.offsetWidth-e.clientWidth;var Ze=(e,r)=>{for(const[t,n]of r)e[t]=n;return e};const a0=_e({name:"IconHover",props:{prefix:{type:String},size:{type:String,default:"medium"},disabled:{type:Boolean,default:!1}},setup(){return{prefixCls:Ue("icon-hover")}}});function o0(e,r,t,n,i,s){return q(),de("span",{class:oe([e.prefixCls,{[`${e.prefix}-icon-hover`]:e.prefix,[`${e.prefixCls}-size-${e.size}`]:e.size!=="medium",[`${e.prefixCls}-disabled`]:e.disabled}])},[$e(e.$slots,"default")],2)}var Wl=Ze(a0,[["render",o0]]);const l0=_e({name:"IconClose",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-close`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),u0=["stroke-width","stroke-linecap","stroke-linejoin"];function c0(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[he("path",{d:"M9.857 9.858 24 24m0 0 14.142 14.142M24 24 38.142 9.858M24 24 9.857 38.142"},null,-1)]),14,u0)}var Wa=Ze(l0,[["render",c0]]);const wh=Object.assign(Wa,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+Wa.name,Wa)}}),d0=_e({name:"IconInfoCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-info-circle-fill`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),f0=["stroke-width","stroke-linecap","stroke-linejoin"];function h0(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[he("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm2-30a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2Zm0 17h1a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-6a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1h1v-8a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v11Z",fill:"currentColor",stroke:"none"},null,-1)]),14,f0)}var Va=Ze(d0,[["render",h0]]);const p0=Object.assign(Va,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+Va.name,Va)}}),m0=_e({name:"IconCheckCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-check-circle-fill`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),v0=["stroke-width","stroke-linecap","stroke-linejoin"];function g0(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[he("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm10.207-24.379a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0L22 26.172l-4.878-4.88a1 1 0 0 0-1.415 0l-1.414 1.415a1 1 0 0 0 0 1.414l7 7a1 1 0 0 0 1.414 0l11.5-11.5Z",fill:"currentColor",stroke:"none"},null,-1)]),14,v0)}var qa=Ze(m0,[["render",g0]]);const y0=Object.assign(qa,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+qa.name,qa)}}),b0=_e({name:"IconExclamationCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-exclamation-circle-fill`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),S0=["stroke-width","stroke-linecap","stroke-linejoin"];function k0(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[he("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm-2-11a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v2Zm4-18a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V15Z",fill:"currentColor",stroke:"none"},null,-1)]),14,S0)}var Ga=Ze(b0,[["render",k0]]);const Vl=Object.assign(Ga,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+Ga.name,Ga)}}),_0=_e({name:"IconCloseCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-close-circle-fill`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),E0=["stroke-width","stroke-linecap","stroke-linejoin"];function w0(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[he("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm4.955-27.771-4.95 4.95-4.95-4.95a1 1 0 0 0-1.414 0l-1.414 1.414a1 1 0 0 0 0 1.414l4.95 4.95-4.95 4.95a1 1 0 0 0 0 1.414l1.414 1.414a1 1 0 0 0 1.414 0l4.95-4.95 4.95 4.95a1 1 0 0 0 1.414 0l1.414-1.414a1 1 0 0 0 0-1.414l-4.95-4.95 4.95-4.95a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0Z",fill:"currentColor",stroke:"none"},null,-1)]),14,E0)}var Ka=Ze(_0,[["render",w0]]);const C0=Object.assign(Ka,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+Ka.name,Ka)}}),T0=["info","success","warning","error"],A0=_e({name:"IconLoading",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-loading`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),M0=["stroke-width","stroke-linecap","stroke-linejoin"];function x0(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[he("path",{d:"M42 24c0 9.941-8.059 18-18 18S6 33.941 6 24 14.059 6 24 6"},null,-1)]),14,M0)}var Ja=Ze(A0,[["render",x0]]);const ql=Object.assign(Ja,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+Ja.name,Ja)}}),Ch=(e,r)=>{const t={...e};for(const n of r)n in t&&delete t[n];return t},I0=Symbol("ArcoFormItemContext"),L0=({size:e,disabled:r,error:t,uninject:n}={})=>{const i=n?{}:Tt(I0,{}),s=j(()=>{var c;return(c=e?.value)!=null?c:i.size}),a=j(()=>r?.value||i.disabled),o=j(()=>t?.value||i.error),l=Ao(i,"feedback"),u=Ao(i,"eventHandlers");return{formItemCtx:i,mergedSize:s,mergedDisabled:a,mergedError:o,feedback:l,eventHandlers:u}},Gl=(e,{defaultValue:r="medium"}={})=>{const t=Tt(ma,void 0);return{mergedSize:j(()=>{var i,s;return(s=(i=e?.value)!=null?i:t?.size)!=null?s:r})}},Th=Symbol("ArcoButtonGroup"),O0=_e({name:"Button",components:{IconLoading:ql},props:{type:{type:String},shape:{type:String},status:{type:String},size:{type:String},long:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},disabled:{type:Boolean},htmlType:{type:String,default:"button"},autofocus:{type:Boolean,default:!1},href:String},emits:{click:e=>!0},setup(e,{emit:r}){const{size:t,disabled:n}=nn(e),i=Ue("btn"),s=Tt(Th,void 0),a=j(()=>{var h;return(h=t.value)!=null?h:s?.size}),o=j(()=>!!(n.value||s?.disabled)),{mergedSize:l,mergedDisabled:u}=L0({size:a,disabled:o}),{mergedSize:c}=Gl(l),d=j(()=>{var h,p,m,v,y,b;return[i,`${i}-${(p=(h=e.type)!=null?h:s?.type)!=null?p:"secondary"}`,`${i}-shape-${(v=(m=e.shape)!=null?m:s?.shape)!=null?v:"square"}`,`${i}-size-${c.value}`,`${i}-status-${(b=(y=e.status)!=null?y:s?.status)!=null?b:"normal"}`,{[`${i}-long`]:e.long,[`${i}-loading`]:e.loading,[`${i}-disabled`]:u.value,[`${i}-link`]:$l(e.href)}]});return{prefixCls:i,cls:d,mergedDisabled:u,handleClick:h=>{if(e.disabled||e.loading){h.preventDefault();return}r("click",h)}}}}),R0=["href"],P0=["type","disabled","autofocus"];function N0(e,r,t,n,i,s){const a=We("icon-loading");return e.href?(q(),de("a",{key:0,class:oe([e.cls,{[`${e.prefixCls}-only-icon`]:e.$slots.icon&&!e.$slots.default}]),href:e.mergedDisabled||e.loading?void 0:e.href,onClick:r[0]||(r[0]=(...o)=>e.handleClick&&e.handleClick(...o))},[e.loading||e.$slots.icon?(q(),de("span",{key:0,class:oe(`${e.prefixCls}-icon`)},[e.loading?(q(),Le(a,{key:0,spin:"true"})):$e(e.$slots,"icon",{key:1})],2)):Be("v-if",!0),$e(e.$slots,"default")],10,R0)):(q(),de("button",{key:1,class:oe([e.cls,{[`${e.prefixCls}-only-icon`]:e.$slots.icon&&!e.$slots.default}]),type:e.htmlType,disabled:e.mergedDisabled,autofocus:e.autofocus,onClick:r[1]||(r[1]=(...o)=>e.handleClick&&e.handleClick(...o))},[e.loading||e.$slots.icon?(q(),de("span",{key:0,class:oe(`${e.prefixCls}-icon`)},[e.loading?(q(),Le(a,{key:0,spin:!0})):$e(e.$slots,"icon",{key:1})],2)):Be("v-if",!0),$e(e.$slots,"default")],10,P0))}var Xa=Ze(O0,[["render",N0]]);const B0=_e({name:"ButtonGroup",props:{type:{type:String},status:{type:String},shape:{type:String},size:{type:String},disabled:{type:Boolean}},setup(e){const{type:r,size:t,status:n,disabled:i,shape:s}=nn(e),a=Ue("btn-group");return Ji(Th,jt({type:r,size:t,shape:s,status:n,disabled:i})),{prefixCls:a}}});function F0(e,r,t,n,i,s){return q(),de("div",{class:oe(e.prefixCls)},[$e(e.$slots,"default")],2)}var Ya=Ze(B0,[["render",F0]]);const Kl=Object.assign(Xa,{Group:Ya,install:(e,r)=>{Cn(e,r);const t=wn(r);e.component(t+Xa.name,Xa),e.component(t+Ya.name,Ya)}}),D0=()=>{const{height:e,width:r}=Eh();return{width:Math.min(r,window.innerWidth),height:Math.min(e,window.innerHeight)}},wc=(e,r)=>{var t,n;const i=e.getBoundingClientRect();return{top:i.top,bottom:i.bottom,left:i.left,right:i.right,scrollTop:i.top-r.top,scrollBottom:i.bottom-r.top,scrollLeft:i.left-r.left,scrollRight:i.right-r.left,width:(t=e.offsetWidth)!=null?t:e.clientWidth,height:(n=e.offsetHeight)!=null?n:e.clientHeight}},$0=e=>{switch(e){case"top":case"tl":case"tr":return"top";case"bottom":case"bl":case"br":return"bottom";case"left":case"lt":case"lb":return"left";case"right":case"rt":case"rb":return"right";default:return"top"}},os=(e,r)=>{switch(r){case"top":switch(e){case"bottom":return"top";case"bl":return"tl";case"br":return"tr";default:return e}case"bottom":switch(e){case"top":return"bottom";case"tl":return"bl";case"tr":return"br";default:return e}case"left":switch(e){case"right":return"left";case"rt":return"lt";case"rb":return"lb";default:return e}case"right":switch(e){case"left":return"right";case"lt":return"rt";case"lb":return"rb";default:return e}default:return e}},j0=(e,r,{containerRect:t,triggerRect:n,popupRect:i,offset:s,translate:a})=>{const o=$0(e),l=D0(),u={top:t.top+r.top,bottom:l.height-(t.top+r.top+i.height),left:t.left+r.left,right:l.width-(t.left+r.left+i.width)};let c=e;if(o==="top"&&u.top<0)if(n.top>i.height)r.top=-t.top;else{const d=ci("bottom",n,i,{offset:s,translate:a});l.height-(t.top+d.top+i.height)>0&&(c=os(e,"bottom"),r.top=d.top)}if(o==="bottom"&&u.bottom<0)if(l.height-n.bottom>i.height)r.top=-t.top+(l.height-i.height);else{const d=ci("top",n,i,{offset:s,translate:a});t.top+d.top>0&&(c=os(e,"top"),r.top=d.top)}if(o==="left"&&u.left<0)if(n.left>i.width)r.left=-t.left;else{const d=ci("right",n,i,{offset:s,translate:a});l.width-(t.left+d.left+i.width)>0&&(c=os(e,"right"),r.left=d.left)}if(o==="right"&&u.right<0)if(l.width-n.right>i.width)r.left=-t.left+(l.width-i.width);else{const d=ci("left",n,i,{offset:s,translate:a});t.left+d.left>0&&(c=os(e,"left"),r.left=d.left)}return(o==="top"||o==="bottom")&&(u.left<0?r.left=-t.left:u.right<0&&(r.left=-t.left+(l.width-i.width))),(o==="left"||o==="right")&&(u.top<0?r.top=-t.top:u.bottom<0&&(r.top=-t.top+(l.height-i.height))),{popupPosition:r,position:c}},ci=(e,r,t,{offset:n=0,translate:i=[0,0]}={})=>{var s;const a=(s=Or(i)?i:i[e])!=null?s:[0,0];switch(e){case"top":return{left:r.scrollLeft+Math.round(r.width/2)-Math.round(t.width/2)+a[0],top:r.scrollTop-t.height-n+a[1]};case"tl":return{left:r.scrollLeft+a[0],top:r.scrollTop-t.height-n+a[1]};case"tr":return{left:r.scrollRight-t.width+a[0],top:r.scrollTop-t.height-n+a[1]};case"bottom":return{left:r.scrollLeft+Math.round(r.width/2)-Math.round(t.width/2)+a[0],top:r.scrollBottom+n+a[1]};case"bl":return{left:r.scrollLeft+a[0],top:r.scrollBottom+n+a[1]};case"br":return{left:r.scrollRight-t.width+a[0],top:r.scrollBottom+n+a[1]};case"left":return{left:r.scrollLeft-t.width-n+a[0],top:r.scrollTop+Math.round(r.height/2)-Math.round(t.height/2)+a[1]};case"lt":return{left:r.scrollLeft-t.width-n+a[0],top:r.scrollTop+a[1]};case"lb":return{left:r.scrollLeft-t.width-n+a[0],top:r.scrollBottom-t.height+a[1]};case"right":return{left:r.scrollRight+n+a[0],top:r.scrollTop+Math.round(r.height/2)-Math.round(t.height/2)+a[1]};case"rt":return{left:r.scrollRight+n+a[0],top:r.scrollTop+a[1]};case"rb":return{left:r.scrollRight+n+a[0],top:r.scrollBottom-t.height+a[1]};default:return{left:0,top:0}}},U0=e=>{let r="0";["top","bottom"].includes(e)?r="50%":["left","lt","lb","tr","br"].includes(e)&&(r="100%");let t="0";return["left","right"].includes(e)?t="50%":["top","tl","tr","lb","rb"].includes(e)&&(t="100%"),`${r} ${t}`},H0=(e,r,t,n,{offset:i=0,translate:s=[0,0],customStyle:a={},autoFitPosition:o=!1}={})=>{let l=e,u=ci(e,t,n,{offset:i,translate:s});if(o){const d=j0(e,u,{containerRect:r,popupRect:n,triggerRect:t,offset:i,translate:s});u=d.popupPosition,l=d.position}return{style:{left:`${u.left}px`,top:`${u.top}px`,...a},position:l}},z0=(e,r,t,{customStyle:n={}})=>{if(["top","tl","tr","bottom","bl","br"].includes(e)){let s=Math.abs(r.scrollLeft+r.width/2-t.scrollLeft);return s>t.width-8&&(r.width>t.width?s=t.width/2:s=t.width-8),["top","tl","tr"].includes(e)?{left:`${s}px`,bottom:"0",transform:"translate(-50%,50%) rotate(45deg)",...n}:{left:`${s}px`,top:"0",transform:"translate(-50%,-50%) rotate(45deg)",...n}}let i=Math.abs(r.scrollTop+r.height/2-t.scrollTop);return i>t.height-8&&(r.height>t.height?i=t.height/2:i=t.height-8),["left","lt","lb"].includes(e)?{top:`${i}px`,right:"0",transform:"translate(50%,-50%) rotate(45deg)",...n}:{top:`${i}px`,left:"0",transform:"translate(-50%,-50%) rotate(45deg)",...n}},W0=e=>e.scrollHeight>e.offsetHeight||e.scrollWidth>e.offsetWidth,Cc=e=>{var r;const t=[];let n=e;for(;n&&n!==document.documentElement;)W0(n)&&t.push(n),n=(r=n.parentElement)!=null?r:void 0;return t},Ah=()=>{const e={},r=ee(),t=()=>{const n=kh(e.value);n!==r.value&&(r.value=n)};return Rt(()=>t()),Ki(()=>t()),{children:e,firstElement:r}};var Ho=_e({name:"ResizeObserver",props:{watchOnUpdated:Boolean},emits:["resize"],setup(e,{emit:r,slots:t}){const{children:n,firstElement:i}=Ah();let s;const a=l=>{l&&(s=new vh(u=>{const c=u[0];r("resize",c)}),s.observe(l))},o=()=>{s&&(s.disconnect(),s=null)};return Ve(i,l=>{s&&o(),l&&a(l)}),Br(()=>{s&&o()}),()=>{var l;return n.value=(l=t.default)==null?void 0:l.call(t),n.value}}});function V0(e,r){const t=ee(e[r]);return Ki(()=>{const n=e[r];t.value!==n&&(t.value=n)}),t}const Tc=Symbol("ArcoTrigger"),q0=1e3,G0=5e3,K0=1;class J0{constructor(){this.popupStack={popup:new Set,dialog:new Set,message:new Set},this.getNextZIndex=r=>(r==="message"?Array.from(this.popupStack.message).pop()||G0:Array.from(this.popupStack.popup).pop()||q0)+K0,this.add=r=>{const t=this.getNextZIndex(r);return this.popupStack[r].add(t),r==="dialog"&&this.popupStack.popup.add(t),t},this.delete=(r,t)=>{this.popupStack[t].delete(r),t==="dialog"&&this.popupStack.popup.delete(r)},this.isLastDialog=r=>this.popupStack.dialog.size>1?r===Array.from(this.popupStack.dialog).pop():!0}}const Za=new J0;function Mh(e,{visible:r,runOnMounted:t}={}){const n=ee(0),i=()=>{n.value=Za.add(e)},s=()=>{Za.delete(n.value,e)},a=()=>e==="dialog"?Za.isLastDialog(n.value):!1;return Ve(()=>r?.value,o=>{o?i():s()},{immediate:!0}),t&&(Rt(()=>{i()}),Br(()=>{s()})),{zIndex:Nr(n),open:i,close:s,isLastDialog:a}}const X0=({elementRef:e,onResize:r})=>{let t;return{createResizeObserver:()=>{e.value&&(t=new vh(s=>{const a=s[0];Dn(r)&&r(a)}),t.observe(e.value))},destroyResizeObserver:()=>{t&&(t.disconnect(),t=null)}}};var xh=_e({name:"ClientOnly",setup(e,{slots:r}){const t=ee(!1);return Rt(()=>t.value=!0),()=>{var n;return t.value?(n=r.default)==null?void 0:n.call(r):null}}});const Ih=({popupContainer:e,visible:r,defaultContainer:t="body",documentContainer:n})=>{const i=ee(e.value),s=ee(),a=()=>{const o=Uo(e.value),l=o?e.value:t,u=o??(n?document.documentElement:Uo(t));l!==i.value&&(i.value=l),u!==s.value&&(s.value=u)};return Rt(()=>a()),Ve(r,o=>{i.value!==e.value&&o&&a()}),{teleportContainer:i,containerRef:s}},Y0=["onClick","onMouseenter","onMouseleave","onFocusin","onFocusout","onContextmenu"];var Qa=_e({name:"Trigger",inheritAttrs:!1,props:{popupVisible:{type:Boolean,default:void 0},defaultPopupVisible:{type:Boolean,default:!1},trigger:{type:[String,Array],default:"hover"},position:{type:String,default:"bottom"},disabled:{type:Boolean,default:!1},popupOffset:{type:Number,default:0},popupTranslate:{type:[Array,Object]},showArrow:{type:Boolean,default:!1},alignPoint:{type:Boolean,default:!1},popupHoverStay:{type:Boolean,default:!0},blurToClose:{type:Boolean,default:!0},clickToClose:{type:Boolean,default:!0},clickOutsideToClose:{type:Boolean,default:!0},unmountOnClose:{type:Boolean,default:!0},contentClass:{type:[String,Array,Object]},contentStyle:{type:Object},arrowClass:{type:[String,Array,Object]},arrowStyle:{type:Object},popupStyle:{type:Object},animationName:{type:String,default:"fade-in"},duration:{type:[Number,Object]},mouseEnterDelay:{type:Number,default:100},mouseLeaveDelay:{type:Number,default:100},focusDelay:{type:Number,default:0},autoFitPopupWidth:{type:Boolean,default:!1},autoFitPopupMinWidth:{type:Boolean,default:!1},autoFixPosition:{type:Boolean,default:!0},popupContainer:{type:[String,Object]},updateAtScroll:{type:Boolean,default:!1},autoFitTransformOrigin:{type:Boolean,default:!1},hideEmpty:{type:Boolean,default:!1},openedClass:{type:[String,Array,Object]},autoFitPosition:{type:Boolean,default:!0},renderToBody:{type:Boolean,default:!0},preventFocus:{type:Boolean,default:!1},scrollToClose:{type:Boolean,default:!1},scrollToCloseDistance:{type:Number,default:0}},emits:{"update:popupVisible":e=>!0,popupVisibleChange:e=>!0,show:()=>!0,hide:()=>!0,resize:()=>!0},setup(e,{emit:r,slots:t,attrs:n}){const{popupContainer:i}=nn(e),s=Ue("trigger"),a=j(()=>Ch(n,Y0)),o=Tt(ma,void 0),l=j(()=>[].concat(e.trigger)),u=new Set,c=Tt(Tc,void 0),{children:d,firstElement:f}=Ah(),h=ee(),p=ee(e.defaultPopupVisible),m=ee(e.position),v=ee({}),y=ee({}),b=ee({}),M=ee(),_=ee({top:0,left:0});let E=null,C=null;const B=j(()=>{var $;return($=e.popupVisible)!=null?$:p.value}),{teleportContainer:P,containerRef:R}=Ih({popupContainer:i,visible:B,documentContainer:!0}),{zIndex:L}=Mh("popup",{visible:B});let x=0,k=!1,F=!1;const I=()=>{x&&(window.clearTimeout(x),x=0)},G=$=>{if(e.alignPoint){const{pageX:se,pageY:xe}=$;_.value={top:xe,left:se}}},Z=()=>{if(!f.value||!h.value||!R.value)return;const $=R.value.getBoundingClientRect(),se=e.alignPoint?{top:_.value.top,bottom:_.value.top,left:_.value.left,right:_.value.left,scrollTop:_.value.top,scrollBottom:_.value.top,scrollLeft:_.value.left,scrollRight:_.value.left,width:0,height:0}:wc(f.value,$),xe=()=>wc(h.value,$),ot=xe(),{style:rt,position:Nt}=H0(e.position,$,se,ot,{offset:e.popupOffset,translate:e.popupTranslate,customStyle:e.popupStyle,autoFitPosition:e.autoFitPosition});e.autoFitTransformOrigin&&(y.value={transformOrigin:U0(Nt)}),e.autoFitPopupMinWidth?rt.minWidth=`${se.width}px`:e.autoFitPopupWidth&&(rt.width=`${se.width}px`),m.value!==Nt&&(m.value=Nt),v.value=rt,e.showArrow&&sr(()=>{b.value=z0(Nt,se,xe(),{customStyle:e.arrowStyle})})},K=($,se)=>{if($===B.value&&x===0)return;const xe=()=>{p.value=$,r("update:popupVisible",$),r("popupVisibleChange",$),$&&sr(()=>{Z()})};$||(E=null,C=null),se?(I(),$!==B.value&&(x=window.setTimeout(xe,se))):xe()},te=$=>{var se;(se=n.onClick)==null||se.call(n,$),!(e.disabled||B.value&&!e.clickToClose)&&(l.value.includes("click")?(G($),K(!B.value)):l.value.includes("contextMenu")&&B.value&&K(!1))},Se=$=>{var se;(se=n.onMouseenter)==null||se.call(n,$),!(e.disabled||!l.value.includes("hover"))&&(G($),K(!0,e.mouseEnterDelay))},Me=$=>{c?.onMouseenter($),Se($)},Re=$=>{var se;(se=n.onMouseleave)==null||se.call(n,$),!(e.disabled||!l.value.includes("hover"))&&K(!1,e.mouseLeaveDelay)},Xe=$=>{c?.onMouseleave($),Re($)},It=$=>{var se;(se=n.onFocusin)==null||se.call(n,$),!(e.disabled||!l.value.includes("focus"))&&K(!0,e.focusDelay)},He=$=>{var se;(se=n.onFocusout)==null||se.call(n,$),!(e.disabled||!l.value.includes("focus"))&&e.blurToClose&&K(!1)},Fe=$=>{var se;(se=n.onContextmenu)==null||se.call(n,$),!(e.disabled||!l.value.includes("contextMenu")||B.value&&!e.clickToClose)&&(G($),K(!B.value),$.preventDefault())};Ji(Tc,jt({onMouseenter:Me,onMouseleave:Xe,addChildRef:$=>{u.add($),c?.addChildRef($)},removeChildRef:$=>{u.delete($),c?.removeChildRef($)}}));const Ut=()=>{$i(document.documentElement,"mousedown",An),k=!1},Tn=V0(t,"content"),pt=j(()=>{var $;return e.hideEmpty&&Qy(($=Tn.value)==null?void 0:$.call(Tn))}),An=$=>{var se,xe,ot;if(!((se=f.value)!=null&&se.contains($.target)||(xe=h.value)!=null&&xe.contains($.target))){for(const rt of u)if((ot=rt.value)!=null&&ot.contains($.target))return;Ut(),K(!1)}},S=($,se)=>{const[xe,ot]=$,{scrollTop:rt,scrollLeft:Nt}=se;return Math.abs(rt-xe)>=e.scrollToCloseDistance||Math.abs(Nt-ot)>=e.scrollToCloseDistance},w=Ec($=>{if(B.value)if(e.scrollToClose||o?.scrollToClose){const se=$.target;E||(E=[se.scrollTop,se.scrollLeft]),S(E,se)?K(!1):Z()}else Z()}),N=()=>{$i(window,"scroll",H),F=!1},H=Ec($=>{const se=$.target.documentElement;C||(C=[se.scrollTop,se.scrollLeft]),S(C,se)&&(K(!1),N())}),D=()=>{B.value&&Z()},U=()=>{D(),r("resize")},Y=$=>{e.preventFocus&&$.preventDefault()};c?.addChildRef(h);const J=j(()=>B.value?e.openedClass:void 0);let W;Ve(B,$=>{if(e.clickOutsideToClose&&(!$&&k?Ut():$&&!k&&(nr(document.documentElement,"mousedown",An),k=!0)),(e.scrollToClose||o?.scrollToClose)&&(nr(window,"scroll",H),F=!0),e.updateAtScroll||o?.updateAtScroll){if($){W=Cc(f.value);for(const se of W)se.addEventListener("scroll",w)}else if(W){for(const se of W)se.removeEventListener("scroll",w);W=void 0}}$&&(X.value=!0)}),Ve(()=>[e.autoFitPopupWidth,e.autoFitPopupMinWidth],()=>{B.value&&Z()});const{createResizeObserver:z,destroyResizeObserver:ce}=X0({elementRef:R,onResize:D});Rt(()=>{if(z(),B.value&&(Z(),e.clickOutsideToClose&&!k&&(nr(document.documentElement,"mousedown",An),k=!0),e.updateAtScroll||o?.updateAtScroll)){W=Cc(f.value);for(const $ of W)$.addEventListener("scroll",w)}}),Ki(()=>{B.value&&Z()}),wf(()=>{K(!1)}),Br(()=>{if(c?.removeChildRef(h),ce(),k&&Ut(),F&&N(),W){for(const $ of W)$.removeEventListener("scroll",w);W=void 0}});const X=ee(B.value),ae=ee(!1),pe=()=>{ae.value=!0},Ee=()=>{ae.value=!1,B.value&&r("show")},Ne=()=>{ae.value=!1,B.value||(X.value=!1,r("hide"))};return()=>{var $,se;return d.value=(se=($=t.default)==null?void 0:$.call(t))!=null?se:[],yh(d.value,{class:J.value,onClick:te,onMouseenter:Se,onMouseleave:Re,onFocusin:It,onFocusout:He,onContextmenu:Fe}),ne(Ge,null,[e.autoFixPosition?ne(Ho,{onResize:U},{default:()=>[d.value]}):d.value,ne(xh,null,{default:()=>[ne(vf,{to:P.value,disabled:!e.renderToBody},{default:()=>[(!e.unmountOnClose||B.value||X.value)&&!pt.value&&ne(Ho,{onResize:D},{default:()=>[ne("div",Mr({ref:h,class:[`${s}-popup`,`${s}-position-${m.value}`],style:{...v.value,zIndex:L.value,pointerEvents:ae.value?"none":"auto"},"trigger-placement":m.value,onMouseenter:Me,onMouseleave:Xe,onMousedown:Y},a.value),[ne(js,{name:e.animationName,duration:e.duration,appear:!0,onBeforeEnter:pe,onAfterEnter:Ee,onBeforeLeave:pe,onAfterLeave:Ne},{default:()=>{var xe;return[yi(ne("div",{class:`${s}-popup-wrapper`,style:y.value},[ne("div",{class:[`${s}-content`,e.contentClass],style:e.contentStyle},[(xe=t.content)==null?void 0:xe.call(t)]),e.showArrow&&ne("div",{ref:M,class:[`${s}-arrow`,e.arrowClass],style:b.value},null)]),[[Ei,B.value]])]}})])]})]})]})])}}});const Z0=Object.assign(Qa,{install:(e,r)=>{Cn(e,r);const t=wn(r);e.component(t+Qa.name,Qa)}}),Q0={ESC:"Escape"},eb=({itemRef:e,selector:r,index:t,parentClassName:n})=>{const i=ee(-1),s=j(()=>{var u;return(u=t?.value)!=null?u:i.value}),a=ee(),o=()=>{var u,c,d;let f=(c=(u=e.value)==null?void 0:u.parentElement)!=null?c:void 0;if(n)for(;f&&!f.className.includes(n);)f=(d=f.parentElement)!=null?d:void 0;return f},l=()=>{if(Ay(t?.value)&&a.value&&e.value){const u=Array.from(a.value.querySelectorAll(r)).indexOf(e.value);u!==i.value&&(i.value=u)}};return Ve(e,()=>{e.value&&!a.value&&(a.value=o())}),Rt(()=>{e.value&&(a.value=o()),l()}),Ki(()=>l()),{computedIndex:s}},Lh=Symbol("ArcoAvatarGroup"),tb=_e({name:"IconImageClose",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-image-close`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),nb=["stroke-width","stroke-linecap","stroke-linejoin"];function rb(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[_v('<path d="M41 26V9a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v30a2 2 0 0 0 2 2h17"></path><path d="m24 33 9-8.5V27s-2 1-3.5 2.5C27.841 31.159 27 33 27 33h-3Zm0 0-3.5-4.5L17 33h7Z"></path><path d="M20.5 28.5 17 33h7l-3.5-4.5ZM33 24.5 24 33h3s.841-1.841 2.5-3.5C31 28 33 27 33 27v-2.5Z" fill="currentColor" stroke="none"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M46 38a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm-4.95-4.782 1.74 1.74-3.045 3.046 3.046 3.046-1.74 1.74-3.047-3.045-3.046 3.046-1.74-1.74 3.046-3.047-3.046-3.046 1.74-1.74 3.046 3.046 3.046-3.046Z" fill="currentColor" stroke="none"></path><path d="M17 15h-2v2h2v-2Z"></path>',5)]),14,nb)}var eo=Ze(tb,[["render",rb]]);const ib=Object.assign(eo,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+eo.name,eo)}}),sb=_e({name:"Avatar",components:{ResizeObserver:Ho,IconImageClose:ib,IconLoading:ql},props:{shape:{type:String,default:"circle"},imageUrl:String,size:Number,autoFixFontSize:{type:Boolean,default:!0},triggerType:{type:String,default:"button"},triggerIconStyle:{type:Object},objectFit:{type:String}},emits:{click:e=>!0,error:()=>!0,load:()=>!0},setup(e,{slots:r,emit:t,attrs:n}){const{shape:i,size:s,autoFixFontSize:a,triggerType:o,triggerIconStyle:l}=nn(e),u=Ue("avatar"),c=Tt(Lh,void 0),d=ee(),f=ee(),h=j(()=>{var I;return(I=c?.shape)!=null?I:i.value}),p=j(()=>{var I;return(I=c?.size)!=null?I:s.value}),m=j(()=>{var I;return(I=c?.autoFixFontSize)!=null?I:a.value}),v=ee(!1),y=ee(!1),b=ee(!0),M=ee(!1),_=c?eb({itemRef:d,selector:`.${u}`}).computedIndex:ee(-1),E=j(()=>{var I;const G=bt(p.value)?{width:`${p.value}px`,height:`${p.value}px`,fontSize:`${p.value/2}px`}:{};return c&&(G.zIndex=c.zIndexAscend?_.value+1:c.total-_.value,G.marginLeft=_.value!==0?`-${((I=p.value)!=null?I:40)/4}px`:"0"),G}),C=ab({triggerIconStyle:l?.value,inlineStyle:n.style,triggerType:o.value}),B=()=>{!v.value&&!e.imageUrl&&sr(()=>{var I;if(!f.value||!d.value)return;const G=f.value.clientWidth,Z=(I=p.value)!=null?I:d.value.offsetWidth,K=Z/(G+8);Z&&K<1&&(f.value.style.transform=`scale(${K}) translateX(-50%)`),b.value=!0})};Rt(()=>{var I;(I=f.value)!=null&&I.firstElementChild&&["IMG","PICTURE"].includes(f.value.firstElementChild.tagName)&&(v.value=!0),m.value&&B()}),Ve(s,()=>{m.value&&B()});const P=j(()=>[u,`${u}-${h.value}`]),R=j(()=>v.value||e.imageUrl?`${u}-image`:`${u}-text`);return{prefixCls:u,itemRef:d,cls:P,outerStyle:E,wrapperRef:f,wrapperCls:R,computedTriggerIconStyle:C,isImage:v,shouldLoad:b,isLoaded:M,hasError:y,onClick:I=>{t("click",I)},handleResize:()=>{m.value&&B()},handleImgLoad:()=>{M.value=!0,t("load")},handleImgError:()=>{y.value=!0,t("error")}}}}),ab=({triggerType:e,inlineStyle:r={},triggerIconStyle:t={}})=>{let n={};return e==="button"&&(!t||t&&!t.color)&&r&&r.backgroundColor&&(n={color:r.backgroundColor}),{...t,...n}},ob=["src"];function lb(e,r,t,n,i,s){const a=We("IconImageClose"),o=We("IconLoading"),l=We("resize-observer");return q(),de("div",{ref:"itemRef",style:Oe(e.outerStyle),class:oe([e.cls,{[`${e.prefixCls}-with-trigger-icon`]:!!e.$slots["trigger-icon"]}]),onClick:r[2]||(r[2]=(...u)=>e.onClick&&e.onClick(...u))},[ne(l,{onResize:e.handleResize},{default:Te(()=>[he("span",{ref:"wrapperRef",class:oe(e.wrapperCls)},[e.imageUrl?(q(),de(Ge,{key:0},[e.hasError?$e(e.$slots,"error",{key:0},()=>[he("div",{class:oe(`${e.prefixCls}-image-icon`)},[ne(a)],2)]):Be("v-if",!0),!(e.hasError||!e.shouldLoad)&&!e.isLoaded?$e(e.$slots,"default",{key:1},()=>[he("div",{class:oe(`${e.prefixCls}-image-icon`)},[ne(o)],2)]):Be("v-if",!0),e.hasError||!e.shouldLoad?Be("v-if",!0):(q(),de("img",{key:2,src:e.imageUrl,style:Oe({width:e.size+"px",height:e.size+"px",objectFit:e.objectFit}),alt:"avatar",onLoad:r[0]||(r[0]=(...u)=>e.handleImgLoad&&e.handleImgLoad(...u)),onError:r[1]||(r[1]=(...u)=>e.handleImgError&&e.handleImgError(...u))},null,44,ob))],64)):$e(e.$slots,"default",{key:1})],2)]),_:3},8,["onResize"]),e.$slots["trigger-icon"]?(q(),de("div",{key:0,class:oe(`${e.prefixCls}-trigger-icon-${e.triggerType}`),style:Oe(e.computedTriggerIconStyle)},[$e(e.$slots,"trigger-icon")],6)):Be("v-if",!0)],6)}var ys=Ze(sb,[["render",lb]]);const ub=_e({name:"Popover",components:{Trigger:Z0},props:{popupVisible:{type:Boolean,default:void 0},defaultPopupVisible:{type:Boolean,default:!1},title:String,content:String,trigger:{type:[String,Array],default:"hover"},position:{type:String,default:"top"},contentClass:{type:[String,Array,Object]},contentStyle:{type:Object},arrowClass:{type:[String,Array,Object]},arrowStyle:{type:Object},popupContainer:{type:[String,Object]}},emits:{"update:popupVisible":e=>!0,popupVisibleChange:e=>!0},setup(e,{emit:r}){const t=Ue("popover"),n=ee(e.defaultPopupVisible),i=j(()=>{var l;return(l=e.popupVisible)!=null?l:n.value}),s=l=>{n.value=l,r("update:popupVisible",l),r("popupVisibleChange",l)},a=j(()=>[`${t}-popup-content`,e.contentClass]),o=j(()=>[`${t}-popup-arrow`,e.arrowClass]);return{prefixCls:t,computedPopupVisible:i,contentCls:a,arrowCls:o,handlePopupVisibleChange:s}}});function cb(e,r,t,n,i,s){const a=We("trigger");return q(),Le(a,{class:oe(e.prefixCls),trigger:e.trigger,position:e.position,"popup-visible":e.computedPopupVisible,"popup-offset":10,"content-class":e.contentCls,"content-style":e.contentStyle,"arrow-class":e.arrowCls,"arrow-style":e.arrowStyle,"show-arrow":"","popup-container":e.popupContainer,"animation-name":"zoom-in-fade-out","auto-fit-transform-origin":"",onPopupVisibleChange:e.handlePopupVisibleChange},{content:Te(()=>[he("div",{class:oe(`${e.prefixCls}-title`)},[$e(e.$slots,"title",{},()=>[dt(Ht(e.title),1)])],2),he("div",{class:oe(`${e.prefixCls}-content`)},[$e(e.$slots,"content",{},()=>[dt(Ht(e.content),1)])],2)]),default:Te(()=>[$e(e.$slots,"default")]),_:3},8,["class","trigger","position","popup-visible","content-class","content-style","arrow-class","arrow-style","popup-container","onPopupVisibleChange"])}var to=Ze(ub,[["render",cb]]);const db=Object.assign(to,{install:(e,r)=>{Cn(e,r);const t=wn(r);e.component(t+to.name,to)}}),no=_e({name:"AvatarGroup",props:{shape:{type:String,default:"circle"},size:Number,autoFixFontSize:{type:Boolean,default:!0},maxCount:{type:Number,default:0},zIndexAscend:{type:Boolean,default:!1},maxStyle:{type:Object},maxPopoverTriggerProps:{type:Object}},setup(e,{slots:r}){const{shape:t,size:n,autoFixFontSize:i,zIndexAscend:s}=nn(e),a=Ue("avatar-group"),o=ee(0);return Ji(Lh,jt({shape:t,size:n,autoFixFontSize:i,zIndexAscend:s,total:o})),()=>{var l,u;const c=Ai((u=(l=r.default)==null?void 0:l.call(r))!=null?u:[]),d=e.maxCount>0?c.slice(0,e.maxCount):c,f=e.maxCount>0?c.slice(e.maxCount):[];return o.value!==c.length&&(o.value=c.length),ne("div",{class:a},[d,f.length>0&&ne(db,e.maxPopoverTriggerProps,{default:()=>[ne(ys,{class:`${a}-max-count-avatar`,style:e.maxStyle},{default:()=>[dt("+"),f.length]})],content:()=>ne("div",null,[f])})])}}}),fb=Object.assign(ys,{Group:no,install:(e,r)=>{Cn(e,r);const t=wn(r);e.component(t+ys.name,ys),e.component(t+no.name,no)}}),Ac=["red","orangered","orange","gold","lime","green","cyan","blue","arcoblue","purple","pinkpurple","magenta","gray"],hb=_e({name:"Tag",components:{IconHover:Wl,IconClose:wh,IconLoading:ql},props:{color:{type:String},size:{type:String},bordered:{type:Boolean,default:!1},visible:{type:Boolean,default:void 0},defaultVisible:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},closable:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},checked:{type:Boolean,default:void 0},defaultChecked:{type:Boolean,default:!0},nowrap:{type:Boolean,default:!1}},emits:{"update:visible":e=>!0,"update:checked":e=>!0,close:e=>!0,check:(e,r)=>!0},setup(e,{emit:r}){const{size:t}=nn(e),n=Ue("tag"),i=j(()=>e.color&&Ac.includes(e.color)),s=j(()=>e.color&&!Ac.includes(e.color)),a=ee(e.defaultVisible),o=ee(e.defaultChecked),l=j(()=>{var v;return(v=e.visible)!=null?v:a.value}),u=j(()=>{var v;return e.checkable?(v=e.checked)!=null?v:o.value:!0}),{mergedSize:c}=Gl(t),d=j(()=>c.value==="mini"?"small":c.value),f=v=>{a.value=!1,r("update:visible",!1),r("close",v)},h=v=>{if(e.checkable){const y=!u.value;o.value=y,r("update:checked",y),r("check",y,v)}},p=j(()=>[n,`${n}-size-${d.value}`,{[`${n}-loading`]:e.loading,[`${n}-hide`]:!l.value,[`${n}-${e.color}`]:i.value,[`${n}-bordered`]:e.bordered,[`${n}-checkable`]:e.checkable,[`${n}-checked`]:u.value,[`${n}-custom-color`]:s.value}]),m=j(()=>{if(s.value)return{backgroundColor:e.color}});return{prefixCls:n,cls:p,style:m,computedVisible:l,computedChecked:u,handleClick:h,handleClose:f}}});function pb(e,r,t,n,i,s){const a=We("icon-close"),o=We("icon-hover"),l=We("icon-loading");return e.computedVisible?(q(),de("span",{key:0,class:oe(e.cls),style:Oe(e.style),onClick:r[0]||(r[0]=(...u)=>e.handleClick&&e.handleClick(...u))},[e.$slots.icon?(q(),de("span",{key:0,class:oe(`${e.prefixCls}-icon`)},[$e(e.$slots,"icon")],2)):Be("v-if",!0),e.nowrap?(q(),de("span",{key:1,class:oe(`${e.prefixCls}-text`)},[$e(e.$slots,"default")],2)):$e(e.$slots,"default",{key:2}),e.closable?(q(),Le(o,{key:3,role:"button","aria-label":"Close",prefix:e.prefixCls,class:oe(`${e.prefixCls}-close-btn`),onClick:Hs(e.handleClose,["stop"])},{default:Te(()=>[$e(e.$slots,"close-icon",{},()=>[ne(a)])]),_:3},8,["prefix","class","onClick"])):Be("v-if",!0),e.loading?(q(),de("span",{key:4,class:oe(`${e.prefixCls}-loading-icon`)},[ne(l)],2)):Be("v-if",!0)],6)):Be("v-if",!0)}var ro=Ze(hb,[["render",pb]]);const mb=Object.assign(ro,{install:(e,r)=>{Cn(e,r);const t=wn(r);e.component(t+ro.name,ro)}}),Oh=Symbol("collapseCtx"),vb=_e({name:"Collapse",props:{activeKey:{type:Array,default:void 0},defaultActiveKey:{type:Array,default:()=>[]},accordion:{type:Boolean,default:!1},showExpandIcon:{type:Boolean,default:void 0},expandIconPosition:{type:String,default:"left"},bordered:{type:Boolean,default:!0},destroyOnHide:{type:Boolean,default:!1}},emits:{"update:activeKey":e=>!0,change:(e,r)=>!0},setup(e,{emit:r,slots:t}){const{expandIconPosition:n,destroyOnHide:i,showExpandIcon:s}=nn(e),a=Ue("collapse"),o=ee(e.defaultActiveKey),l=j(()=>{var d;const f=(d=e.activeKey)!=null?d:o.value;return Or(f)?f:[f]});Ji(Oh,jt({activeKeys:l,slots:t,showExpandIcon:s,expandIconPosition:n,destroyOnHide:i,handleClick:(d,f)=>{let h=[];if(e.accordion)l.value.includes(d)||(h=[d]),o.value=h;else{h=[...l.value];const p=h.indexOf(d);p>-1?h.splice(p,1):e.accordion?h=[d]:h.push(d),o.value=h}r("update:activeKey",h),r("change",h,f)}}));const c=j(()=>[a,{[`${a}-borderless`]:!e.bordered}]);return{prefixCls:a,cls:c}}});function gb(e,r,t,n,i,s){return q(),de("div",{class:oe(e.cls)},[$e(e.$slots,"default")],2)}var io=Ze(vb,[["render",gb]]);const yb=_e({name:"IconCaretRight",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-caret-right`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),bb=["stroke-width","stroke-linecap","stroke-linejoin"];function Sb(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[he("path",{d:"M34.829 23.063c.6.48.6 1.394 0 1.874L17.949 38.44c-.785.629-1.949.07-1.949-.937V10.497c0-1.007 1.164-1.566 1.95-.937l16.879 13.503Z",fill:"currentColor",stroke:"none"},null,-1)]),14,bb)}var so=Ze(yb,[["render",Sb]]);const kb=Object.assign(so,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+so.name,so)}}),_b=_e({name:"IconCaretLeft",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-caret-left`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),Eb=["stroke-width","stroke-linecap","stroke-linejoin"];function wb(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[he("path",{d:"M13.171 24.937a1.2 1.2 0 0 1 0-1.874L30.051 9.56c.785-.629 1.949-.07 1.949.937v27.006c0 1.006-1.164 1.566-1.95.937L13.171 24.937Z",fill:"currentColor",stroke:"none"},null,-1)]),14,Eb)}var ao=Ze(_b,[["render",wb]]);const Cb=Object.assign(ao,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+ao.name,ao)}});var Mi=_e({name:"CollapseItem",components:{IconHover:Wl,IconCaretRight:kb,IconCaretLeft:Cb},props:{header:String,disabled:{type:Boolean,default:!1},showExpandIcon:{type:Boolean,default:!0},destroyOnHide:{type:Boolean,default:!1}},setup(e,{slots:r}){var t;const n=Vn(),i=Ue("collapse-item"),s=Tt(Oh,{}),a=n&&bt(n?.vnode.key)?n.vnode.key:String((t=n?.vnode.key)!=null?t:""),o=j(()=>{var _;return(_=s.activeKeys)==null?void 0:_.includes(a)}),l=j(()=>s.destroyOnHide||e.destroyOnHide),u=j(()=>{var _;return(_=s?.showExpandIcon)!=null?_:e.showExpandIcon}),c=ee(l.value?o.value:!0),d=j(()=>{var _;return(_=s?.expandIconPosition)!=null?_:"left"}),f=_=>{var E;e.disabled||(E=s.handleClick)==null||E.call(s,a,_)};Ve(o,_=>{_&&!c.value&&(c.value=!0)});const h={onEnter:_=>{_.style.height=`${_.scrollHeight}px`},onAfterEnter:_=>{_.style.height="auto"},onBeforeLeave:_=>{_.style.height=`${_.scrollHeight}px`},onLeave:_=>{_.style.height="0"},onAfterLeave:()=>{l.value&&(c.value=!1)}},p=j(()=>[i,{[`${i}-active`]:o.value}]),m=j(()=>[`${i}-header`,`${i}-header-${s?.expandIconPosition}`,{[`${i}-header-disabled`]:e.disabled}]),v=j(()=>[{[`${i}-icon-right`]:s?.expandIconPosition==="right"}]),y=j(()=>[`${i}-content`,{[`${i}-content-expend`]:o.value}]),b=()=>d.value==="right"?ne(We("icon-caret-left"),{class:`${i}-expand-icon`},null):ne(We("icon-caret-right"),{class:`${i}-expand-icon`},null),M=()=>u.value&&ne(We("icon-hover"),{prefix:i,class:v.value,disabled:e.disabled},{default:()=>{var _,E,C,B;return[(B=(C=(E=r["expand-icon"])!=null?E:(_=s?.slots)==null?void 0:_["expand-icon"])==null?void 0:C({active:o.value,disabled:e.disabled,position:d.value}))!=null?B:b()]}});return()=>{var _,E,C;return ne("div",{class:p.value},[ne("div",{role:"button","aria-disabled":e.disabled,"aria-expanded":o.value,tabindex:"0",class:m.value,onClick:f},[M(),ne("div",{class:`${i}-header-title`},[(E=(_=r.header)==null?void 0:_.call(r))!=null?E:e.header]),r.extra&&ne("div",{class:`${i}-header-extra`},[(C=r.extra)==null?void 0:C.call(r)])]),ne(js,Mr({name:"collapse-slider"},h),{default:()=>{var B;return[yi(ne("div",{role:"region",class:y.value},[c.value&&ne("div",{ref:"contentBoxRef",class:`${i}-content-box`},[(B=r.default)==null?void 0:B.call(r)])]),[[Ei,o.value]])]}})])}}});const Rh=Object.assign(io,{Item:Mi,install:(e,r)=>{Cn(e,r);const t=wn(r);e.component(t+io.name,io),e.component(t+Mi.name,Mi)}});function Jl(e,r){return r===void 0&&(r=15),+parseFloat(Number(e).toPrecision(r))}function tn(e){var r=e.toString().split(/[eE]/),t=(r[0].split(".")[1]||"").length-+(r[1]||0);return t>0?t:0}function ji(e){if(e.toString().indexOf("e")===-1)return Number(e.toString().replace(".",""));var r=tn(e);return r>0?Jl(Number(e)*Math.pow(10,r)):Number(e)}function zo(e){Nh&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&console.warn(e+" is beyond boundary when transfer to integer, the results may not be accurate")}function ga(e){return function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n=r[0],i=r.slice(1);return i.reduce(function(s,a){return e(s,a)},n)}}var zn=ga(function(e,r){var t=ji(e),n=ji(r),i=tn(e)+tn(r),s=t*n;return zo(s),s/Math.pow(10,i)}),Tb=ga(function(e,r){var t=Math.pow(10,Math.max(tn(e),tn(r)));return(zn(e,t)+zn(r,t))/t}),Ab=ga(function(e,r){var t=Math.pow(10,Math.max(tn(e),tn(r)));return(zn(e,t)-zn(r,t))/t}),Ph=ga(function(e,r){var t=ji(e),n=ji(r);return zo(t),zo(n),zn(t/n,Jl(Math.pow(10,tn(r)-tn(e))))});function Mb(e,r){var t=Math.pow(10,r),n=Ph(Math.round(Math.abs(zn(e,t))),t);return e<0&&n!==0&&(n=zn(n,-1)),n}var Nh=!0;function xb(e){e===void 0&&(e=!0),Nh=e}var Xl={strip:Jl,plus:Tb,minus:Ab,times:zn,divide:Ph,round:Mb,digitLength:tn,float2Fixed:ji,enableBoundaryChecking:xb};const Ib=e=>{const r=ee(!1),t={overflow:"",width:"",boxSizing:""};return{setOverflowHidden:()=>{if(e.value){const s=e.value;if(!r.value&&s.style.overflow!=="hidden"){const a=s0(s);(a>0||i0(s))&&(t.overflow=s.style.overflow,t.width=s.style.width,t.boxSizing=s.style.boxSizing,s.style.overflow="hidden",s.style.width=`${s.offsetWidth-a}px`,s.style.boxSizing="border-box",r.value=!0)}}},resetOverflow:()=>{if(e.value&&r.value){const s=e.value;s.style.overflow=t.overflow,s.style.width=t.width,s.style.boxSizing=t.boxSizing,r.value=!1}}}},Lb=({modalRef:e,wrapperRef:r,draggable:t,alignCenter:n})=>{const i=ee(!1),s=ee([0,0]),a=ee([0,0]),o=ee(),l=ee([0,0]),u=ee([0,0]),c=()=>{var p,m,v;if(r.value&&e.value){const{top:y,left:b}=r.value.getBoundingClientRect(),{clientWidth:M,clientHeight:_}=r.value,{top:E,left:C,width:B,height:P}=e.value.getBoundingClientRect(),R=n.value?0:(p=e.value)==null?void 0:p.offsetTop,L=C-b,x=E-y-R;(L!==((m=a.value)==null?void 0:m[0])||x!==((v=a.value)==null?void 0:v[1]))&&(a.value=[L,x]);const k=M>B?M-B:0,F=_>P?_-P-R:0;(k!==u.value[0]||F!==u.value[1])&&(u.value=[k,F]),R&&(l.value=[0,0-R])}},d=p=>{t.value&&(p.preventDefault(),i.value=!0,c(),s.value=[p.x,p.y],nr(window,"mousemove",f),nr(window,"mouseup",h),nr(window,"contextmenu",h))},f=p=>{if(i.value){const m=p.x-s.value[0],v=p.y-s.value[1];let y=a.value[0]+m,b=a.value[1]+v;y<l.value[0]&&(y=l.value[0]),y>u.value[0]&&(y=u.value[0]),b<l.value[1]&&(b=l.value[1]),b>u.value[1]&&(b=u.value[1]),o.value=[y,b]}},h=()=>{i.value=!1,$i(window,"mousemove",f),$i(window,"mouseup",h)};return{position:o,handleMoveDown:d}};var Ob=_e({name:"Modal",components:{ClientOnly:xh,ArcoButton:Kl,IconHover:Wl,IconClose:wh,IconInfoCircleFill:p0,IconCheckCircleFill:y0,IconExclamationCircleFill:Vl,IconCloseCircleFill:C0},inheritAttrs:!1,props:{visible:{type:Boolean,default:void 0},defaultVisible:{type:Boolean,default:!1},width:{type:[Number,String]},top:{type:[Number,String]},mask:{type:Boolean,default:!0},title:{type:String},titleAlign:{type:String,default:"center"},alignCenter:{type:Boolean,default:!0},unmountOnClose:Boolean,maskClosable:{type:Boolean,default:!0},hideCancel:{type:Boolean,default:!1},simple:{type:Boolean,default:e=>e.notice},closable:{type:Boolean,default:!0},okText:String,cancelText:String,okLoading:{type:Boolean,default:!1},okButtonProps:{type:Object},cancelButtonProps:{type:Object},footer:{type:Boolean,default:!0},renderToBody:{type:Boolean,default:!0},popupContainer:{type:[String,Object],default:"body"},maskStyle:{type:Object},modalClass:{type:[String,Array]},modalStyle:{type:Object},onBeforeOk:{type:Function},onBeforeCancel:{type:Function},escToClose:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},maskAnimationName:{type:String,default:e=>e.fullscreen?"fade-in-standard":"fade-modal"},modalAnimationName:{type:String,default:e=>e.fullscreen?"zoom-in":"zoom-modal"},bodyClass:{type:[String,Array]},bodyStyle:{type:[String,Object,Array]},messageType:{type:String},hideTitle:{type:Boolean,default:!1}},emits:{"update:visible":e=>!0,ok:e=>!0,cancel:e=>!0,open:()=>!0,close:()=>!0,beforeOpen:()=>!0,beforeClose:()=>!0},setup(e,{emit:r}){const{fullscreen:t,popupContainer:n,alignCenter:i}=nn(e),s=Ue("modal"),{t:a}=Ly(),o=ee(),l=ee(),u=ee(e.defaultVisible),c=j(()=>{var Fe;return(Fe=e.visible)!=null?Fe:u.value}),d=ee(!1),f=j(()=>e.okLoading||d.value),h=j(()=>e.draggable&&!e.fullscreen),{teleportContainer:p,containerRef:m}=Ih({popupContainer:n,visible:c}),v=ee(c.value),y=j(()=>e.okText||a("modal.okText")),b=j(()=>e.cancelText||a("modal.cancelText")),{zIndex:M,isLastDialog:_}=Mh("dialog",{visible:c});let E=!1;const C=Fe=>{e.escToClose&&Fe.key===Q0.ESC&&_()&&I(Fe)},B=()=>{e.escToClose&&!E&&(E=!0,nr(document.documentElement,"keydown",C))},P=()=>{E=!1,$i(document.documentElement,"keydown",C)};let R=0;const{position:L,handleMoveDown:x}=Lb({wrapperRef:o,modalRef:l,draggable:h,alignCenter:i}),k=()=>{R++,d.value&&(d.value=!1),u.value=!1,r("update:visible",!1)},F=async Fe=>{const ht=R,Vt=await new Promise(async Ut=>{var Tn;if(Dn(e.onBeforeOk)){let pt=e.onBeforeOk((An=!0)=>Ut(An));if((Sc(pt)||!bc(pt))&&(d.value=!0),Sc(pt))try{pt=(Tn=await pt)!=null?Tn:!0}catch(An){throw pt=!1,An}bc(pt)&&Ut(pt)}else Ut(!0)});ht===R&&(Vt?(r("ok",Fe),k()):d.value&&(d.value=!1))},I=Fe=>{var ht;let Vt=!0;Dn(e.onBeforeCancel)&&(Vt=(ht=e.onBeforeCancel())!=null?ht:!1),Vt&&(r("cancel",Fe),k())},G=ee(!1),Z=Fe=>{Fe.target===o.value&&(G.value=!0)},K=Fe=>{e.mask&&e.maskClosable&&G.value&&I(Fe)},te=()=>{c.value&&(!t0(o.value,document.activeElement)&&document.activeElement instanceof HTMLElement&&document.activeElement.blur(),r("open"))},Se=()=>{c.value||(h.value&&(L.value=void 0),v.value=!1,Re(),r("close"))},{setOverflowHidden:Me,resetOverflow:Re}=Ib(m);Rt(()=>{m.value=Uo(e.popupContainer),c.value&&(Me(),e.escToClose&&B())}),Br(()=>{Re(),P()}),Ve(c,Fe=>{u.value!==Fe&&(u.value=Fe),Fe?(r("beforeOpen"),v.value=!0,G.value=!1,Me(),B()):(r("beforeClose"),P())}),Ve(t,()=>{L.value&&(L.value=void 0)});const Xe=j(()=>[`${s}-wrapper`,{[`${s}-wrapper-align-center`]:e.alignCenter&&!e.fullscreen,[`${s}-wrapper-moved`]:!!L.value}]),It=j(()=>[`${s}`,e.modalClass,{[`${s}-simple`]:e.simple,[`${s}-draggable`]:h.value,[`${s}-fullscreen`]:e.fullscreen}]),He=j(()=>{var Fe;const ht={...(Fe=e.modalStyle)!=null?Fe:{}};return e.width&&!e.fullscreen&&(ht.width=bt(e.width)?`${e.width}px`:e.width),!e.alignCenter&&e.top&&(ht.top=bt(e.top)?`${e.top}px`:e.top),L.value&&(ht.transform=`translate(${L.value[0]}px, ${L.value[1]}px)`),ht});return{prefixCls:s,mounted:v,computedVisible:c,containerRef:m,wrapperRef:o,mergedModalStyle:He,okDisplayText:y,cancelDisplayText:b,zIndex:M,handleOk:F,handleCancel:I,handleMaskClick:K,handleMaskMouseDown:Z,handleOpen:te,handleClose:Se,mergedOkLoading:f,modalRef:l,wrapperCls:Xe,modalCls:It,teleportContainer:p,handleMoveDown:x}}});function Rb(e,r,t,n,i,s){const a=We("icon-info-circle-fill"),o=We("icon-check-circle-fill"),l=We("icon-exclamation-circle-fill"),u=We("icon-close-circle-fill"),c=We("icon-close"),d=We("icon-hover"),f=We("arco-button"),h=We("client-only");return q(),Le(h,null,{default:Te(()=>[(q(),Le(vf,{to:e.teleportContainer,disabled:!e.renderToBody},[!e.unmountOnClose||e.computedVisible||e.mounted?yi((q(),de("div",Mr({key:0,class:`${e.prefixCls}-container`,style:{zIndex:e.zIndex}},e.$attrs),[ne(js,{name:e.maskAnimationName,appear:""},{default:Te(()=>[e.mask?yi((q(),de("div",{key:0,ref:"maskRef",class:oe(`${e.prefixCls}-mask`),style:Oe(e.maskStyle)},null,6)),[[Ei,e.computedVisible]]):Be("v-if",!0)]),_:1},8,["name"]),he("div",{ref:"wrapperRef",class:oe(e.wrapperCls),onClick:r[2]||(r[2]=Hs((...p)=>e.handleMaskClick&&e.handleMaskClick(...p),["self"])),onMousedown:r[3]||(r[3]=Hs((...p)=>e.handleMaskMouseDown&&e.handleMaskMouseDown(...p),["self"]))},[ne(js,{name:e.modalAnimationName,appear:"",onAfterEnter:e.handleOpen,onAfterLeave:e.handleClose,persisted:""},{default:Te(()=>[yi(he("div",{ref:"modalRef",class:oe(e.modalCls),style:Oe(e.mergedModalStyle)},[!e.hideTitle&&(e.$slots.title||e.title||e.closable)?(q(),de("div",{key:0,class:oe(`${e.prefixCls}-header`),onMousedown:r[1]||(r[1]=(...p)=>e.handleMoveDown&&e.handleMoveDown(...p))},[e.$slots.title||e.title?(q(),de("div",{key:0,class:oe([`${e.prefixCls}-title`,`${e.prefixCls}-title-align-${e.titleAlign}`])},[e.messageType?(q(),de("div",{key:0,class:oe(`${e.prefixCls}-title-icon`)},[e.messageType==="info"?(q(),Le(a,{key:0})):Be("v-if",!0),e.messageType==="success"?(q(),Le(o,{key:1})):Be("v-if",!0),e.messageType==="warning"?(q(),Le(l,{key:2})):Be("v-if",!0),e.messageType==="error"?(q(),Le(u,{key:3})):Be("v-if",!0)],2)):Be("v-if",!0),$e(e.$slots,"title",{},()=>[dt(Ht(e.title),1)])],2)):Be("v-if",!0),!e.simple&&e.closable?(q(),de("div",{key:1,tabindex:"-1",role:"button","aria-label":"Close",class:oe(`${e.prefixCls}-close-btn`),onClick:r[0]||(r[0]=(...p)=>e.handleCancel&&e.handleCancel(...p))},[ne(d,null,{default:Te(()=>[ne(c)]),_:1})],2)):Be("v-if",!0)],34)):Be("v-if",!0),he("div",{class:oe([`${e.prefixCls}-body`,e.bodyClass]),style:Oe(e.bodyStyle)},[$e(e.$slots,"default")],6),e.footer?(q(),de("div",{key:1,class:oe(`${e.prefixCls}-footer`)},[$e(e.$slots,"footer",{},()=>[e.hideCancel?Be("v-if",!0):(q(),Le(f,Mr({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:Te(()=>[dt(Ht(e.cancelDisplayText),1)]),_:1},16,["onClick"])),ne(f,Mr({type:"primary"},e.okButtonProps,{loading:e.mergedOkLoading,onClick:e.handleOk}),{default:Te(()=>[dt(Ht(e.okDisplayText),1)]),_:1},16,["loading","onClick"])])],2)):Be("v-if",!0)],6),[[Ei,e.computedVisible]])]),_:3},8,["name","onAfterEnter","onAfterLeave"])],34)],16)),[[Ei,e.computedVisible||e.mounted]]):Be("v-if",!0)],8,["to","disabled"]))]),_:3})}var bs=Ze(Ob,[["render",Rb]]);const oo=(e,r)=>{let t=n0("modal");const n=()=>{u.component&&(u.component.props.visible=!1),Dn(e.onOk)&&e.onOk()},i=()=>{u.component&&(u.component.props.visible=!1),Dn(e.onCancel)&&e.onCancel()},s=async()=>{await sr(),t&&(rc(null,t),document.body.removeChild(t)),t=null,Dn(e.onClose)&&e.onClose()},a=()=>{u.component&&(u.component.props.visible=!1)},o=c=>{u.component&&Object.entries(c).forEach(([d,f])=>{u.component.props[d]=f})},u=ne(bs,{...{visible:!0,renderToBody:!1,unmountOnClose:!0,onOk:n,onCancel:i,onClose:s},...Ch(e,["content","title","footer","visible","unmountOnClose","onOk","onCancel","onClose"]),footer:typeof e.footer=="boolean"?e.footer:void 0},{default:za(e.content),title:za(e.title),footer:typeof e.footer!="boolean"?za(e.footer):void 0});return(r??Wo._context)&&(u.appContext=r??Wo._context),rc(u,t),document.body.appendChild(t),{close:a,update:o}},lo={open:oo,confirm:(e,r)=>{const t={simple:!0,messageType:"warning",...e};return oo(t,r)},...T0.reduce((e,r)=>(e[r]=(t,n)=>{const i={simple:!0,hideCancel:!0,messageType:r,...t};return oo(i,n)},e),{})},Wo=Object.assign(bs,{...lo,install:(e,r)=>{Cn(e,r);const t=wn(r);e.component(t+bs.name,bs);const n={};for(const i of Object.keys(lo))n[i]=(s,a=e._context)=>lo[i](s,a);e.config.globalProperties.$modal=n},_context:null}),Pb={small:3,medium:4,large:8},Nb=e=>{if(e)return ch(e)?{backgroundImage:`linear-gradient(to right, ${Object.keys(e).map(t=>`${e[t]} ${t}`).join(",")})`}:{backgroundColor:e}},Bb=_e({name:"ProgressLine",components:{IconExclamationCircleFill:Vl},props:{percent:{type:Number,default:0},animation:{type:Boolean,default:!1},size:{type:String,default:"medium"},strokeWidth:{type:Number,default:4},width:{type:[Number,String],default:"100%"},color:{type:[String,Object],default:void 0},trackColor:String,formatText:{type:Function,default:void 0},status:{type:String},showText:Boolean},setup(e){const r=Ue("progress-line"),t=j(()=>e.strokeWidth!==4?e.strokeWidth:Pb[e.size]),n=j(()=>`${Xl.times(e.percent,100)}%`),i=j(()=>({width:e.width,height:`${t.value}px`,backgroundColor:e.trackColor})),s=j(()=>({width:`${e.percent*100}%`,...Nb(e.color)}));return{prefixCls:r,style:i,barStyle:s,text:n}}}),Fb=["aria-valuenow"];function Db(e,r,t,n,i,s){const a=We("icon-exclamation-circle-fill");return q(),de("div",{role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.percent,class:oe(`${e.prefixCls}-wrapper`)},[he("div",{class:oe(e.prefixCls),style:Oe(e.style)},[he("div",{class:oe(`${e.prefixCls}-bar-buffer`)},null,2),he("div",{class:oe([`${e.prefixCls}-bar`]),style:Oe(e.barStyle)},null,6)],6),e.showText?(q(),de("div",{key:0,class:oe(`${e.prefixCls}-text`)},[$e(e.$slots,"text",{percent:e.percent},()=>[dt(Ht(e.text)+" ",1),e.status==="danger"?(q(),Le(a,{key:0})):Be("v-if",!0)])],2)):Be("v-if",!0)],10,Fb)}var $b=Ze(Bb,[["render",Db]]);const jb=_e({name:"IconExclamation",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-exclamation`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),Ub=["stroke-width","stroke-linecap","stroke-linejoin"];function Hb(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[he("path",{d:"M23 9h2v21h-2z"},null,-1),he("path",{fill:"currentColor",stroke:"none",d:"M23 9h2v21h-2z"},null,-1),he("path",{d:"M23 37h2v2h-2z"},null,-1),he("path",{fill:"currentColor",stroke:"none",d:"M23 37h2v2h-2z"},null,-1)]),14,Ub)}var uo=Ze(jb,[["render",Hb]]);const zb=Object.assign(uo,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+uo.name,uo)}}),Wb=_e({name:"IconCheck",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:r}){const t=Ue("icon"),n=j(()=>[t,`${t}-check`,{[`${t}-spin`]:e.spin}]),i=j(()=>{const a={};return e.size&&(a.fontSize=bt(e.size)?`${e.size}px`:e.size),e.rotate&&(a.transform=`rotate(${e.rotate}deg)`),a});return{cls:n,innerStyle:i,onClick:a=>{r("click",a)}}}}),Vb=["stroke-width","stroke-linecap","stroke-linejoin"];function qb(e,r,t,n,i,s){return q(),de("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:Oe(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:r[0]||(r[0]=(...a)=>e.onClick&&e.onClick(...a))},r[1]||(r[1]=[he("path",{d:"M41.678 11.05 19.05 33.678 6.322 20.95"},null,-1)]),14,Vb)}var co=Ze(Wb,[["render",qb]]);const Gb=Object.assign(co,{install:(e,r)=>{var t;const n=(t=r?.iconPrefix)!=null?t:"";e.component(n+co.name,co)}});let Mc=0;const Kb={mini:16,small:48,medium:64,large:80},Jb={mini:4,small:3,medium:4,large:4},Xb=_e({name:"ProgressCircle",components:{IconExclamation:zb,IconCheck:Gb},props:{percent:{type:Number,default:0},type:{type:String},size:{type:String,default:"medium"},strokeWidth:{type:Number},width:{type:Number,default:void 0},color:{type:[String,Object],default:void 0},trackColor:String,status:{type:String,default:void 0},showText:{type:Boolean,default:!0},pathStrokeWidth:{type:Number}},setup(e){const r=Ue("progress-circle"),t=ch(e.color),n=j(()=>{var d;return(d=e.width)!=null?d:Kb[e.size]}),i=j(()=>{var d;return(d=e.strokeWidth)!=null?d:e.size==="mini"?n.value/2:Jb[e.size]}),s=j(()=>{var d;return(d=e.pathStrokeWidth)!=null?d:e.size==="mini"?i.value:Math.max(2,i.value-2)}),a=j(()=>(n.value-i.value)/2),o=j(()=>Math.PI*2*a.value),l=j(()=>n.value/2),u=j(()=>(Mc+=1,`${r}-linear-gradient-${Mc}`)),c=j(()=>`${Xl.times(e.percent,100)}%`);return{prefixCls:r,isLinearGradient:t,radius:a,text:c,perimeter:o,center:l,mergedWidth:n,mergedStrokeWidth:i,mergedPathStrokeWidth:s,linearGradientId:u}}}),Yb=["aria-valuenow"],Zb=["viewBox"],Qb={key:0},e1=["id"],t1=["offset","stop-color"],n1=["cx","cy","r","stroke-width"],r1=["cx","cy","r","stroke-width"];function i1(e,r,t,n,i,s){const a=We("icon-check"),o=We("icon-exclamation");return q(),de("div",{role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.percent,class:oe(`${e.prefixCls}-wrapper`),style:Oe({width:`${e.mergedWidth}px`,height:`${e.mergedWidth}px`})},[e.type==="circle"&&e.size==="mini"&&e.status==="success"?(q(),Le(a,{key:0,style:Oe({fontSize:e.mergedWidth-2,color:e.color})},null,8,["style"])):(q(),de("svg",{key:1,viewBox:`0 0 ${e.mergedWidth} ${e.mergedWidth}`,class:oe(`${e.prefixCls}-svg`)},[e.isLinearGradient?(q(),de("defs",Qb,[he("linearGradient",{id:e.linearGradientId,x1:"0",y1:"1",x2:"0",y2:"0"},[(q(!0),de(Ge,null,Cl(Object.keys(e.color),l=>(q(),de("stop",{key:l,offset:l,"stop-color":e.color[l]},null,8,t1))),128))],8,e1)])):Be("v-if",!0),he("circle",{class:oe(`${e.prefixCls}-bg`),fill:"none",cx:e.center,cy:e.center,r:e.radius,"stroke-width":e.mergedPathStrokeWidth,style:Oe({stroke:e.trackColor})},null,14,n1),he("circle",{class:oe(`${e.prefixCls}-bar`),fill:"none",cx:e.center,cy:e.center,r:e.radius,"stroke-width":e.mergedStrokeWidth,style:Oe({stroke:e.isLinearGradient?`url(#${e.linearGradientId})`:e.color,strokeDasharray:e.perimeter,strokeDashoffset:(e.percent>=1?0:1-e.percent)*e.perimeter})},null,14,r1)],10,Zb)),e.showText&&e.size!=="mini"?(q(),de("div",{key:2,class:oe(`${e.prefixCls}-text`)},[$e(e.$slots,"text",{percent:e.percent},()=>[e.status==="danger"?(q(),Le(o,{key:0})):e.status==="success"?(q(),Le(a,{key:1})):(q(),de(Ge,{key:2},[dt(Ht(e.text),1)],64))])],2)):Be("v-if",!0)],14,Yb)}var s1=Ze(Xb,[["render",i1]]);const a1=_e({name:"ProgressSteps",components:{IconExclamationCircleFill:Vl},props:{steps:{type:Number,default:0},percent:{type:Number,default:0},size:{type:String},color:{type:[String,Object],default:void 0},trackColor:String,strokeWidth:{type:Number},status:{type:String,default:void 0},showText:{type:Boolean,default:!0}},setup(e){const r=Ue("progress-steps"),t=j(()=>{var s;return((s=e.strokeWidth)!=null?s:e.size==="small")?8:4}),n=j(()=>[...Array(e.steps)].map((s,a)=>e.percent>0&&e.percent>1/e.steps*a)),i=j(()=>`${Xl.times(e.percent,100)}%`);return{prefixCls:r,stepList:n,mergedStrokeWidth:t,text:i}}}),o1=["aria-valuenow"];function l1(e,r,t,n,i,s){const a=We("icon-exclamation-circle-fill");return q(),de("div",{role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.percent,class:oe(`${e.prefixCls}-wrapper`)},[he("div",{class:oe(e.prefixCls),style:Oe({height:`${e.mergedStrokeWidth}px`})},[(q(!0),de(Ge,null,Cl(e.stepList,(o,l)=>(q(),de("div",{key:l,class:oe([`${e.prefixCls}-item`,{[`${e.prefixCls}-item-active`]:o}]),style:Oe({backgroundColor:o?e.color:e.trackColor})},null,6))),128))],6),e.showText?(q(),de("div",{key:0,class:oe(`${e.prefixCls}-text`)},[$e(e.$slots,"text",{percent:e.percent},()=>[dt(Ht(e.text)+" ",1),e.status==="danger"?(q(),Le(a,{key:0})):Be("v-if",!0)])],2)):Be("v-if",!0)],10,o1)}var u1=Ze(a1,[["render",l1]]);const c1=_e({name:"Progress",components:{ProgressLine:$b,ProgressCircle:s1,ProgressSteps:u1},props:{type:{type:String,default:"line"},size:{type:String},percent:{type:Number,default:0},steps:{type:Number,default:0},animation:{type:Boolean,default:!1},strokeWidth:{type:Number},width:{type:[Number,String]},color:{type:[String,Object]},trackColor:String,bufferColor:{type:[String,Object]},showText:{type:Boolean,default:!0},status:{type:String}},setup(e){const r=Ue("progress"),{size:t}=nn(e),n=j(()=>e.steps>0?"steps":e.type),i=j(()=>e.status||(e.percent>=1?"success":"normal")),{mergedSize:s}=Gl(t);return{cls:j(()=>[r,`${r}-type-${n.value}`,`${r}-size-${s.value}`,`${r}-status-${i.value}`]),computedStatus:i,mergedSize:s}}});function d1(e,r,t,n,i,s){const a=We("progress-steps"),o=We("progress-line"),l=We("progress-circle");return q(),de("div",{class:oe(e.cls)},[e.steps>0?(q(),Le(a,{key:0,"stroke-width":e.strokeWidth,percent:e.percent,color:e.color,"track-color":e.trackColor,width:e.width,steps:e.steps,size:e.mergedSize,"show-text":e.showText},Ra({_:2},[e.$slots.text?{name:"text",fn:Te(u=>[$e(e.$slots,"text",Aa(vs(u)))]),key:"0"}:void 0]),1032,["stroke-width","percent","color","track-color","width","steps","size","show-text"])):e.type==="line"&&e.mergedSize!=="mini"?(q(),Le(o,{key:1,"stroke-width":e.strokeWidth,animation:e.animation,percent:e.percent,color:e.color,"track-color":e.trackColor,size:e.mergedSize,"buffer-color":e.bufferColor,width:e.width,"show-text":e.showText,status:e.computedStatus},Ra({_:2},[e.$slots.text?{name:"text",fn:Te(u=>[$e(e.$slots,"text",Aa(vs(u)))]),key:"0"}:void 0]),1032,["stroke-width","animation","percent","color","track-color","size","buffer-color","width","show-text","status"])):(q(),Le(l,{key:2,type:e.type,"stroke-width":e.type==="line"?e.strokeWidth||4:e.strokeWidth,"path-stroke-width":e.type==="line"?e.strokeWidth||4:e.strokeWidth,width:e.width,percent:e.percent,color:e.color,"track-color":e.trackColor,size:e.mergedSize,"show-text":e.showText,status:e.computedStatus},Ra({_:2},[e.$slots.text?{name:"text",fn:Te(u=>[$e(e.$slots,"text",Aa(vs(u)))]),key:"0"}:void 0]),1032,["type","stroke-width","path-stroke-width","width","percent","color","track-color","size","show-text","status"]))],2)}var fo=Ze(c1,[["render",d1]]);const f1=Object.assign(fo,{install:(e,r)=>{Cn(e,r);const t=wn(r);e.component(t+fo.name,fo)}});var ho=_e({name:"Space",props:{align:{type:String},direction:{type:String,default:"horizontal"},size:{type:[Number,String,Array],default:"small"},wrap:{type:Boolean},fill:{type:Boolean}},setup(e,{slots:r}){const t=Ue("space"),n=j(()=>{var o;return(o=e.align)!=null?o:e.direction==="horizontal"?"center":""}),i=j(()=>[t,{[`${t}-${e.direction}`]:e.direction,[`${t}-align-${n.value}`]:n.value,[`${t}-wrap`]:e.wrap,[`${t}-fill`]:e.fill}]);function s(o){if(bt(o))return o;switch(o){case"mini":return 4;case"small":return 8;case"medium":return 16;case"large":return 24;default:return 8}}const a=o=>{const l={},u=`${s(Or(e.size)?e.size[0]:e.size)}px`,c=`${s(Or(e.size)?e.size[1]:e.size)}px`;return o?e.wrap?{marginBottom:c}:{}:(e.direction==="horizontal"&&(l.marginRight=u),(e.direction==="vertical"||e.wrap)&&(l.marginBottom=c),l)};return()=>{var o;const l=Ai((o=r.default)==null?void 0:o.call(r),!0).filter(u=>u.type!==ut);return ne("div",{class:i.value},[l.map((u,c)=>{var d,f;const h=r.split&&c>0;return ne(Ge,{key:(d=u.key)!=null?d:`item-${c}`},[h&&ne("div",{class:`${t}-item-split`,style:a(!1)},[(f=r.split)==null?void 0:f.call(r)]),ne("div",{class:`${t}-item`,style:a(c===l.length-1)},[u])])})])}}});const h1=Object.assign(ho,{install:(e,r)=>{Cn(e,r);const t=wn(r);e.component(t+ho.name,ho)}}),p1="/assets/cdi-logo-black-C7BzyQdC.png";function m1(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Yl(e))||r){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){t=t.call(e)},n:function(){var u=t.next();return a=u.done,u},e:function(u){o=!0,s=u},f:function(){try{a||t.return==null||t.return()}finally{if(o)throw s}}}}function Vo(e){var r=typeof Map=="function"?new Map:void 0;return Vo=function(n){if(n===null||!g1(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(r!==void 0){if(r.has(n))return r.get(n);r.set(n,i)}function i(){return v1(n,arguments,Ui(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Hi(i,n)},Vo(e)}function v1(e,r,t){if(Zl())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,r);var i=new(e.bind.apply(e,n));return t&&Hi(i,t.prototype),i}function g1(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function or(e,r){return S1(e)||b1(e,r)||Yl(e,r)||y1()}function y1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b1(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n,i,s,a,o=[],l=!0,u=!1;try{if(s=(t=t.call(e)).next,r===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=s.call(t)).done)&&(o.push(n.value),o.length!==r);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function S1(e){if(Array.isArray(e))return e}function Zi(e){return E1(e)||_1(e)||Yl(e)||k1()}function k1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yl(e,r){if(e){if(typeof e=="string")return qo(e,r);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?qo(e,r):void 0}}function _1(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function E1(e){if(Array.isArray(e))return qo(e)}function qo(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function le(e,r,t){return r=Ui(r),w1(e,Zl()?Reflect.construct(r,t||[],Ui(e).constructor):r.apply(e,t))}function w1(e,r){if(r&&(Q(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pr(e)}function Pr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zl(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zl=function(){return!!e})()}function Ui(e){return Ui=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ui(e)}function ue(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&Hi(e,r)}function Hi(e,r){return Hi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Hi(e,r)}function g(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */g=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,i=typeof Symbol=="function"?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function l(L,x,k,F){return Object.defineProperty(L,x,{value:k,enumerable:!F,configurable:!F,writable:!F})}try{l({},"")}catch{l=function(k,F,I){return k[F]=I}}function u(L,x,k,F){var I=x&&x.prototype instanceof f?x:f,G=Object.create(I.prototype);return l(G,"_invoke",function(Z,K,te){var Se=1;return function(Me,Re){if(Se===3)throw Error("Generator is already running");if(Se===4){if(Me==="throw")throw Re;return{value:e,done:!0}}for(te.method=Me,te.arg=Re;;){var Xe=te.delegate;if(Xe){var It=E(Xe,te);if(It){if(It===d)continue;return It}}if(te.method==="next")te.sent=te._sent=te.arg;else if(te.method==="throw"){if(Se===1)throw Se=4,te.arg;te.dispatchException(te.arg)}else te.method==="return"&&te.abrupt("return",te.arg);Se=3;var He=c(Z,K,te);if(He.type==="normal"){if(Se=te.done?4:2,He.arg===d)continue;return{value:He.arg,done:te.done}}He.type==="throw"&&(Se=4,te.method="throw",te.arg=He.arg)}}}(L,k,new P(F||[])),!0),G}function c(L,x,k){try{return{type:"normal",arg:L.call(x,k)}}catch(F){return{type:"throw",arg:F}}}r.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};l(m,s,function(){return this});var v=Object.getPrototypeOf,y=v&&v(v(R([])));y&&y!==t&&n.call(y,s)&&(m=y);var b=p.prototype=f.prototype=Object.create(m);function M(L){["next","throw","return"].forEach(function(x){l(L,x,function(k){return this._invoke(x,k)})})}function _(L,x){function k(I,G,Z,K){var te=c(L[I],L,G);if(te.type!=="throw"){var Se=te.arg,Me=Se.value;return Me&&Q(Me)=="object"&&n.call(Me,"__await")?x.resolve(Me.__await).then(function(Re){k("next",Re,Z,K)},function(Re){k("throw",Re,Z,K)}):x.resolve(Me).then(function(Re){Se.value=Re,Z(Se)},function(Re){return k("throw",Re,Z,K)})}K(te.arg)}var F;l(this,"_invoke",function(I,G){function Z(){return new x(function(K,te){k(I,G,K,te)})}return F=F?F.then(Z,Z):Z()},!0)}function E(L,x){var k=x.method,F=L.i[k];if(F===e)return x.delegate=null,k==="throw"&&L.i.return&&(x.method="return",x.arg=e,E(L,x),x.method==="throw")||k!=="return"&&(x.method="throw",x.arg=new TypeError("The iterator does not provide a '"+k+"' method")),d;var I=c(F,L.i,x.arg);if(I.type==="throw")return x.method="throw",x.arg=I.arg,x.delegate=null,d;var G=I.arg;return G?G.done?(x[L.r]=G.value,x.next=L.n,x.method!=="return"&&(x.method="next",x.arg=e),x.delegate=null,d):G:(x.method="throw",x.arg=new TypeError("iterator result is not an object"),x.delegate=null,d)}function C(L){this.tryEntries.push(L)}function B(L){var x=L[4]||{};x.type="normal",x.arg=e,L[4]=x}function P(L){this.tryEntries=[[-1]],L.forEach(C,this),this.reset(!0)}function R(L){if(L!=null){var x=L[s];if(x)return x.call(L);if(typeof L.next=="function")return L;if(!isNaN(L.length)){var k=-1,F=function I(){for(;++k<L.length;)if(n.call(L,k))return I.value=L[k],I.done=!1,I;return I.value=e,I.done=!0,I};return F.next=F}}throw new TypeError(Q(L)+" is not iterable")}return h.prototype=p,l(b,"constructor",p),l(p,"constructor",h),h.displayName=l(p,o,"GeneratorFunction"),r.isGeneratorFunction=function(L){var x=typeof L=="function"&&L.constructor;return!!x&&(x===h||(x.displayName||x.name)==="GeneratorFunction")},r.mark=function(L){return Object.setPrototypeOf?Object.setPrototypeOf(L,p):(L.__proto__=p,l(L,o,"GeneratorFunction")),L.prototype=Object.create(b),L},r.awrap=function(L){return{__await:L}},M(_.prototype),l(_.prototype,a,function(){return this}),r.AsyncIterator=_,r.async=function(L,x,k,F,I){I===void 0&&(I=Promise);var G=new _(u(L,x,k,F),I);return r.isGeneratorFunction(x)?G:G.next().then(function(Z){return Z.done?Z.value:G.next()})},M(b),l(b,o,"Generator"),l(b,s,function(){return this}),l(b,"toString",function(){return"[object Generator]"}),r.keys=function(L){var x=Object(L),k=[];for(var F in x)k.unshift(F);return function I(){for(;k.length;)if((F=k.pop())in x)return I.value=F,I.done=!1,I;return I.done=!0,I}},r.values=R,P.prototype={constructor:P,reset:function(x){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(B),!x)for(var k in this)k.charAt(0)==="t"&&n.call(this,k)&&!isNaN(+k.slice(1))&&(this[k]=e)},stop:function(){this.done=!0;var x=this.tryEntries[0][4];if(x.type==="throw")throw x.arg;return this.rval},dispatchException:function(x){if(this.done)throw x;var k=this;function F(Me){Z.type="throw",Z.arg=x,k.next=Me}for(var I=k.tryEntries.length-1;I>=0;--I){var G=this.tryEntries[I],Z=G[4],K=this.prev,te=G[1],Se=G[2];if(G[0]===-1)return F("end"),!1;if(!te&&!Se)throw Error("try statement without catch or finally");if(G[0]!=null&&G[0]<=K){if(K<te)return this.method="next",this.arg=e,F(te),!0;if(K<Se)return F(Se),!1}}},abrupt:function(x,k){for(var F=this.tryEntries.length-1;F>=0;--F){var I=this.tryEntries[F];if(I[0]>-1&&I[0]<=this.prev&&this.prev<I[2]){var G=I;break}}G&&(x==="break"||x==="continue")&&G[0]<=k&&k<=G[2]&&(G=null);var Z=G?G[4]:{};return Z.type=x,Z.arg=k,G?(this.method="next",this.next=G[2],d):this.complete(Z)},complete:function(x,k){if(x.type==="throw")throw x.arg;return x.type==="break"||x.type==="continue"?this.next=x.arg:x.type==="return"?(this.rval=this.arg=x.arg,this.method="return",this.next="end"):x.type==="normal"&&k&&(this.next=k),d},finish:function(x){for(var k=this.tryEntries.length-1;k>=0;--k){var F=this.tryEntries[k];if(F[2]===x)return this.complete(F[4],F[3]),B(F),d}},catch:function(x){for(var k=this.tryEntries.length-1;k>=0;--k){var F=this.tryEntries[k];if(F[0]===x){var I=F[4];if(I.type==="throw"){var G=I.arg;B(F)}return G}}throw Error("illegal catch attempt")},delegateYield:function(x,k,F){return this.delegate={i:R(x),r:k,n:F},this.method==="next"&&(this.arg=e),d}},r}function xc(e,r,t,n,i,s,a){try{var o=e[s](a),l=o.value}catch(u){return void t(u)}o.done?r(l):Promise.resolve(l).then(n,i)}function O(e){return function(){var r=this,t=arguments;return new Promise(function(n,i){var s=e.apply(r,t);function a(l){xc(s,n,i,a,o,"next",l)}function o(l){xc(s,n,i,a,o,"throw",l)}a(void 0)})}}function Ic(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function ke(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ic(Object(t),!0).forEach(function(n){qs(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ic(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function qs(e,r,t){return(r=Bh(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Q(e){"@babel/helpers - typeof";return Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Q(e)}function T(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Lc(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bh(n.key),n)}}function A(e,r,t){return r&&Lc(e.prototype,r),t&&Lc(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bh(e){var r=C1(e,"string");return Q(r)=="symbol"?r:r+""}function C1(e,r){if(Q(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(Q(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var T1=function(){function e(){T(this,e)}return A(e,null,[{key:"render",value:function(t,n){var i=document.createElement("div");i.id="error-view",i.innerText=n,t.replaceChildren(i)}}])}(),A1=function(){function e(){T(this,e)}return A(e,null,[{key:"onLoad",value:function(t){t.innerHTML='<div id="loading-validate-key-property"></div>'}},{key:"createElements",value:function(){var t=document.createElement("div");return t.id="validate-property-key-view",t}},{key:"render",value:function(t,n,i){var s=e.createElements(),a={onSuccess:n,onFail:T1.render.bind(this,t,"Your 'key' has failed authentication"),onLoad:e.onLoad.bind(this,s)};i.key&&i.verifyKey(i.key,a),t.replaceChildren(s)}}])}(),nt=function(){function e(){T(this,e)}return A(e,null,[{key:"unsetStyle",value:function(t,n){var i=Object.keys(n).reduce(function(s,a){return s[a]="",s},{});Object.assign(t.style,i)}},{key:"unsetActivityCSSMouseStates",value:function(t,n){n.click&&e.unsetStyle(t,n.click),n.hover&&e.unsetStyle(t,n.hover)}},{key:"unsetAllCSSMouseStates",value:function(t,n){e.unsetActivityCSSMouseStates(t,n),n.default&&e.unsetStyle(t,n.default)}},{key:"processStateful",value:function(t){var n=t.default||{},i=Object.assign(JSON.parse(JSON.stringify(n)),t?.hover),s=Object.assign(JSON.parse(JSON.stringify(i)),t?.click);return{default:n,hover:i,click:s}}},{key:"mergeStatefulStyles",value:function(t){var n={default:{},hover:{},click:{}};return t.forEach(function(i){n.default=Object.assign(n.default,i.default),n.hover=Object.assign(n.hover,i.hover),n.click=Object.assign(n.click,i.click)}),n}},{key:"overwriteDefaultWithAlreadyApplied",value:function(t,n){Object.keys(t.default||[]).forEach(function(i){var s,a=i;n.style[a]&&(s=t.default)!=null&&s[a]&&(t.default[i]=n.style[a])})}},{key:"applyToStyleIfNotDefined",value:function(t,n){for(var i in n){var s=n[i];t[i]===""&&s&&(t[i]=s)}}}])}(),Go=function(){function e(){T(this,e)}return A(e,null,[{key:"attemptAppendStyleSheetToHead",value:function(t){if(!(t.fontFamily&&t.fontFamily!==e.DEFAULT_FONT_FAMILY)){var n=document.getElementsByTagName("head")[0];if(!Array.from(n.getElementsByTagName("link")).some(function(s){return s.getAttribute("href")===e.FONT_URL})){var i=document.createElement("link");i.rel="stylesheet",i.href=e.FONT_URL,n.appendChild(i)}}}}])}();Go.FONT_URL="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap",Go.DEFAULT_FONT_FAMILY="'Inter', sans-serif, Avenir, Helvetica, Arial";var Fh=Go,Dh=function(){function e(){T(this,e)}return A(e,null,[{key:"apply",value:function(t,n){if(n)try{e.applyStyleSheet(t,n)}catch{e.addStyleElement(t,n)}}},{key:"applyStyleSheet",value:function(t,n){var i=new CSSStyleSheet;i.replaceSync(t),n.adoptedStyleSheets.push(i)}},{key:"addStyleElement",value:function(t,n){var i=document.createElement("style");i.innerHTML=t,n.appendChild(i)}},{key:"applyDefaultStyleToComponent",value:function(t,n){n&&nt.applyToStyleIfNotDefined(t,n),nt.applyToStyleIfNotDefined(t,e.DEFAULT_COMPONENT_STYLE)}}])}();Dh.DEFAULT_COMPONENT_STYLE={height:"350px",width:"320px",borderTop:"1px solid #cacaca",borderRight:"1px solid #cacaca",borderLeft:"1px solid #cacaca",borderBottom:"1px solid #cacaca",fontFamily:Fh.DEFAULT_FONT_FAMILY,fontSize:"0.9rem",backgroundColor:"white",position:"relative",overflow:"hidden"};var po=Dh,$h=function(){function e(){T(this,e)}return A(e,null,[{key:"buildElement",value:function(){var t=document.createElement("div");t.classList.add("tooltip");var n=document.createElement("span");return n.classList.add("tooltip-text"),t.appendChild(n),t}},{key:"tryCreateConfig",value:function(t,n){if(n)return typeof n=="boolean"?{text:t}:{text:n.text||t,timeout:n.timeout||0,style:n.style}}},{key:"traverseParentUntilContainer",value:function(t){for(var n=t;n.parentElement;)n=n.parentElement;return n}},{key:"setPosition",value:function(t,n){var i=n.getRootNode().host.getBoundingClientRect(),s=t.getBoundingClientRect(),a=n.getBoundingClientRect().width/2,o=s.left+s.width/2;n.style.left="".concat(o-a-i.left,"px"),n.style.top="".concat(s.top-36-i.top,"px");var l=n.getBoundingClientRect();l.left<i.left?n.style.left="".concat(e.OVERFLOW_NEW_POSITION_PX,"px"):l.right>i.right&&(n.style.left="".concat(i.width-l.width-e.OVERFLOW_NEW_POSITION_PX,"px"))}},{key:"display",value:function(t,n,i){return i||(i=e.traverseParentUntilContainer(t).nextSibling),n.text&&(i.children[0].textContent=n.text),{timeout:setTimeout(function(){i.style.visibility="visible",e.setPosition(t,i),n.style&&Object.assign(i.style,n.style)},n.timeout||0),element:i}}},{key:"hide",value:function(t,n){clearTimeout(t.timeout),t.element.style.visibility="hidden",n.style&&nt.unsetStyle(t.element,n.style),t.element.style.left="",t.element.style.top=""}}])}();$h.OVERFLOW_NEW_POSITION_PX=4;var bn=$h,Ss=A(function e(){T(this,e)});Ss.IS_SAFARI=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Ss.IS_CHROMIUM=window.chrome,Ss.IS_MOBILE=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);var rr=Ss,it=function(e){return e.ESCAPE="Escape",e.ENTER="Enter",e.TAB="Tab",e.ARROW_UP="ArrowUp",e.ARROW_DOWN="ArrowDown",e.ARROW_RIGHT="ArrowRight",e.ARROW_LEFT="ArrowLeft",e.BACKSPACE="Backspace",e.DELETE="Delete",e.META="Meta",e.CONTROL="Control",e}(it||{}),jh=function(){function e(){T(this,e)}return A(e,null,[{key:"add",value:function(t,n,i,s){i!==void 0&&t.addEventListener("keydown",e.onKeyDown.bind(this,i)),t.oninput=e.onInput.bind(this,i,s),t.addEventListener("paste",function(a){var o;a.preventDefault(),(o=a.clipboardData)!=null&&o.files.length&&n.addFilesToAnyType(Array.from(a.clipboardData.files))})}},{key:"onKeyDown",value:function(t,n){var i=n.target.textContent;i&&i.length>=t&&!e.PERMITTED_KEYS.has(n.key)&&!e.isKeyCombinationPermitted(n)&&n.preventDefault()}},{key:"isKeyCombinationPermitted",value:function(t){return t.key==="a"?t.ctrlKey||t.metaKey:!1}},{key:"onInput",value:function(t,n,i){var s=i.target,a=s.textContent||"";t!==void 0&&a.length>t&&(s.textContent=a.substring(0,t),Ql.focusEndOfInput(s)),n?.()}}])}();jh.PERMITTED_KEYS=new Set([it.BACKSPACE,it.DELETE,it.ARROW_RIGHT,it.ARROW_LEFT,it.ARROW_DOWN,it.ARROW_UP,it.META,it.CONTROL,it.ENTER]);var M1=jh,x1=function(){function e(){T(this,e)}return A(e,null,[{key:"sanitizePastedTextContent",value:function(t){var n,i;t.preventDefault();var s=(n=t.clipboardData)==null?void 0:n.getData("text/plain");s&&((i=document.execCommand)==null||i.call(document,"insertText",!1,s))}}])}(),Uh=function(){function e(r,t,n){var i=this;T(this,e);var s,a;this._isComposing=!1;var o=e.processConfig(t,r.textInput);this.elementRef=e.createContainerElement((s=o?.styles)==null?void 0:s.container),this._config=o,this.inputElementRef=this.createInputElement(),this.elementRef.appendChild(this.inputElementRef),r.setPlaceholderText=this.setPlaceholderText.bind(this),r.setPlaceholderText(((a=this._config.placeholder)==null?void 0:a.text)||"Ask me anything!"),setTimeout(function(){M1.add(i.inputElementRef,n,i._config.characterLimit,r._validationHandler),i._onInput=t.onInput})}return A(e,[{key:"clear",value:function(){var t,n,i=window.scrollY;this.inputElementRef.classList.contains("text-input-disabled")||(Object.assign(this.inputElementRef.style,(t=this._config.placeholder)==null?void 0:t.style),this.inputElementRef.textContent="",Ql.focusEndOfInput(this.inputElementRef),(n=this._onInput)==null||n.call(this,!1)),rr.IS_CHROMIUM&&window.scrollTo({top:i})}},{key:"createInputElement",value:function(){var t,n,i,s,a=document.createElement("div");return a.id=e.TEXT_INPUT_ID,a.classList.add("text-input-styling"),a.role="textbox",rr.IS_CHROMIUM&&e.preventAutomaticScrollUpOnNewLine(a),typeof this._config.disabled=="boolean"&&this._config.disabled===!0?(a.contentEditable="false",a.classList.add("text-input-disabled"),a.setAttribute("aria-disabled","true")):(a.contentEditable="true",a.removeAttribute("aria-disabled"),this.addEventListeners(a)),Object.assign(a.style,(t=this._config.styles)==null?void 0:t.text),Object.assign(a.style,(n=this._config.placeholder)==null?void 0:n.style),(s=(i=this._config.placeholder)==null?void 0:i.style)!=null&&s.color||a.setAttribute("textcolor",""),a}},{key:"removePlaceholderStyle",value:function(){var t,n,i,s;!this.inputElementRef.classList.contains("text-input-disabled")&&(t=this._config.placeholder)!=null&&t.style&&(nt.unsetStyle(this.inputElementRef,(n=this._config.placeholder)==null?void 0:n.style),Object.assign(this.inputElementRef.style,(s=(i=this._config)==null?void 0:i.styles)==null?void 0:s.text))}},{key:"addEventListeners",value:function(t){var n=this,i,s;(i=this._config.styles)!=null&&i.focus&&(t.onfocus=function(){var a;return Object.assign(n.elementRef.style,(a=n._config.styles)==null?void 0:a.focus)},t.onblur=this.onBlur.bind(this,this._config.styles.focus,(s=this._config.styles)==null?void 0:s.container)),t.addEventListener("keydown",this.onKeydown.bind(this)),t.addEventListener("input",this.onInput.bind(this)),t.addEventListener("paste",x1.sanitizePastedTextContent),t.addEventListener("compositionstart",function(){return n._isComposing=!0}),t.addEventListener("compositionend",function(){return n._isComposing=!1})}},{key:"onBlur",value:function(t,n){nt.unsetStyle(this.elementRef,t),n&&Object.assign(this.elementRef.style,n)}},{key:"onKeydown",value:function(t){var n;t.key===it.ENTER&&!rr.IS_MOBILE&&!this._isComposing&&!t.ctrlKey&&!t.shiftKey&&(t.preventDefault(),(n=this.submit)==null||n.call(this))}},{key:"onInput",value:function(){var t,n;this.isTextInputEmpty()?Object.assign(this.inputElementRef.style,(t=this._config.placeholder)==null?void 0:t.style):this.removePlaceholderStyle(),(n=this._onInput)==null||n.call(this,!0)}},{key:"setPlaceholderText",value:function(t){this.inputElementRef.setAttribute("deep-chat-placeholder-text",t),this.inputElementRef.setAttribute("aria-label",t)}},{key:"isTextInputEmpty",value:function(){return this.inputElementRef.textContent===""}}],[{key:"processConfig",value:function(t,n){var i,s,a,o;return n??(n={}),(i=n.disabled)!==null&&i!==void 0||(n.disabled=t.isTextInputDisabled),(s=n.placeholder)!==null&&s!==void 0||(n.placeholder={}),(a=(o=n.placeholder).text)!==null&&a!==void 0||(o.text=t.textInputPlaceholderText),n}},{key:"createContainerElement",value:function(t){var n=document.createElement("div");return n.id="text-input-container",Object.assign(n.style,t),n}},{key:"preventAutomaticScrollUpOnNewLine",value:function(t){var n;t.addEventListener("keydown",function(){n=window.scrollY}),t.addEventListener("input",function(){n!==window.scrollY&&window.scrollTo({top:n})})}}])}();Uh.TEXT_INPUT_ID="text-input";var Hh=Uh,Ql=function(){function e(){T(this,e)}return A(e,null,[{key:"focusEndOfInput",value:function(t){var n=document.createRange();n.selectNodeContents(t),n.collapse(!1);var i=window.getSelection();i?.removeAllRanges(),i?.addRange(n)}},{key:"focusFromParentElement",value:function(t){var n=t.querySelector("#".concat(Hh.TEXT_INPUT_ID));n&&(rr.IS_SAFARI&&n.focus(),e.focusEndOfInput(n))}}])}();function Oc(e){return e.charAt(0).toUpperCase()+e.slice(1)}function I1(e){return e&&JSON.stringify(e)}function eu(e,r,t,n){var i=`
`.concat(Oc(r)," message: ").concat(JSON.stringify(e),` 
`),s=t?"".concat(Oc(r)," message after interceptor: ").concat(I1(n),` 
`):"";return i+s}function L1(e,r,t,n){return"".concat(eu(e,r,t,n),"Make sure the ").concat(r,` message is using the Response format: https://deepchat.dev/docs/connect/#Response 
You can also augment it using the responseInterceptor property: https://deepchat.dev/docs/interceptors#responseInterceptor`)}function O1(e,r,t){var n="response";return"".concat(eu(e,n,r,t),"Make sure the ").concat(n,' message is using the {text: string} format, e.g: {text: "Model Response"}')}function R1(e,r){var t="request";return"".concat(eu(e,t,r),"Make sure the ").concat(t,' message is using the {body: {text: string}} format, e.g: {body: {text: "Model Response"}}')}var Rc=`Make sure the events are using {text: string} or {html: string} format.
You can also augment them using the responseInterceptor property: https://deepchat.dev/docs/interceptors#responseInterceptor`,Pe={INVALID_KEY:"Invalid API Key",CONNECTION_FAILED:"Failed to connect",INVALID_RESPONSE:L1,INVALID_MODEL_REQUEST:R1,INVALID_MODEL_RESPONSE:O1,INVALID_STREAM_ARRAY_RESPONSE:"Multi-response arrays are not supported for streaming",INVALID_STREAM_EVENT:Rc,INVALID_STREAM_EVENT_MIX:"Cannot mix {text: string} and {html: string} responses.",NO_VALID_STREAM_EVENTS_SENT:`No valid stream events were sent.
`.concat(Rc),READABLE_STREAM_CONNECTION_ERROR:"Readable Stream connection error."},zh=function(){function e(){T(this,e)}return A(e,null,[{key:"addElements",value:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];i.forEach(function(a){return t.appendChild(a)})}},{key:"isScrollbarAtBottomOfElement",value:function(t){var n=t.scrollHeight,i=t.clientHeight,s=t.scrollTop,a=n-i;return s>=a-e.CODE_SNIPPET_GENERATION_JUMP}},{key:"cloneElement",value:function(t){var n=t.cloneNode(!0);return t.parentNode.replaceChild(n,t),n}},{key:"scrollToBottom",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n?t.scrollTo({left:0,top:t.scrollHeight,behavior:"smooth"}):t.scrollTop=t.scrollHeight}},{key:"scrollToTop",value:function(t){t.scrollTop=0}}])}();zh.CODE_SNIPPET_GENERATION_JUMP=.5;var At=zh,Wh=function(){function e(){T(this,e)}return A(e,null,[{key:"speak",value:function(t,n){if(window.SpeechSynthesisUtterance){var i=new SpeechSynthesisUtterance(t);Object.assign(i,n),speechSynthesis.speak(i)}}},{key:"processConfig",value:function(t,n){var i={};setTimeout(function(){if(Q(t)=="object"&&(t.lang&&(i.lang=t.lang),t.pitch&&(i.pitch=t.pitch),t.rate&&(i.rate=t.rate),t.volume&&(i.volume=t.volume),t.voiceName)){var s=window.speechSynthesis.getVoices().find(function(a){var o;return a.name.toLocaleLowerCase()===((o=t.voiceName)==null?void 0:o.toLocaleLowerCase())});s&&(i.voice=s)}n(i)},e.LOAD_VOICES_MS)}}])}();Wh.LOAD_VOICES_MS=200;var ks=Wh,Ko=function(){function e(){T(this,e)}return A(e,null,[{key:"colorToHex",value:function(t){var n=document.createElement("div");return n.style.color=t,document.body.appendChild(n),"#".concat(window.getComputedStyle(n).color.match(/\d+/g).map(function(i){return parseInt(i).toString(16).padStart(2,"0")}).join(""))}},{key:"setDots",value:function(t,n){var i,s,a,o;if((o=(a=(s=(i=n?.loading)==null?void 0:i.message)==null?void 0:s.styles)==null?void 0:a.bubble)!=null&&o.color){var l=e.colorToHex(n.loading.message.styles.bubble.color);t.style.setProperty("--loading-message-color",l),t.style.setProperty("--loading-message-color-fade","".concat(l,"33"))}else t.style.setProperty("--loading-message-color","#848484"),t.style.setProperty("--loading-message-color-fade","#55555533")}},{key:"setRing",value:function(t,n){var i=n||{},s=i.color,a=i.width,o=i.height,l=i.margin,u=i.border;if(s){var c=e.colorToHex(s);t.style.setProperty("--loading-history-color",c)}else t.style.setProperty("--loading-history-color","#dbdbdb");t.style.setProperty("--loading-history-height",o||"57px"),t.style.setProperty("--loading-history-width",a||"57px"),t.style.setProperty("--loading-history-margin",l||"7px"),t.style.setProperty("--loading-history-border",u||"6px solid")}}])}();Ko.BUBBLE_CLASS="deep-chat-loading-message-bubble",Ko.DOTS_CONTAINER_CLASS="deep-chat-loading-message-dots-container";var Qn=Ko,Jo=function(){function e(){T(this,e)}return A(e,null,[{key:"setElementProps",value:function(t,n,i,s){var a;i!=="loading"&&(t.applyCustomStyles(n,s,!0,(a=t.messageStyles)==null?void 0:a[i]),n.bubbleElement.classList.add(e.FILE_BUBBLE_CLASS))}},{key:"addMessage",value:function(t,n,i,s,a){e.setElementProps(t,n,i,s),a||(t.appendOuterContainerElemet(n.outerContainer),t.focusMode||(t.elementRef.scrollTop=t.elementRef.scrollHeight))}},{key:"wrapInLink",value:function(t,n,i){var s=document.createElement("a");return s.href=n,s.download=i||e.DEFAULT_FILE_NAME,s.target="_blank",s.appendChild(t),s}},{key:"isNonLinkableDataUrl",value:function(t,n){return!n.startsWith("data")||t==="image"?!1:t==="any"&&n.startsWith("data:text/javascript")||!n.startsWith("data:image")&&!n.startsWith("data:application")}},{key:"processContent",value:function(t,n,i,s){return!i||e.isNonLinkableDataUrl(t,i)?n:e.wrapInLink(n,i,s)}},{key:"waitToLoadThenScroll",value:function(t){setTimeout(function(){t.scrollTop=t.scrollHeight},60)}},{key:"scrollDownOnImageLoad",value:function(t,n){if(t.startsWith("data"))e.waitToLoadThenScroll(n);else try{fetch(t,{mode:"no-cors"}).catch(function(){}).finally(function(){e.waitToLoadThenScroll(n)})}catch{n.scrollTop=n.scrollHeight}}},{key:"reAddFileRefToObject",value:function(t,n){var i;(i=t.files)==null||i.forEach(function(s,a){var o;s.ref&&(o=n.files)!=null&&o[a]&&(n.files[a].ref=s.ref)})}},{key:"removeFileRef",value:function(t){var n=ke({},t);return delete n.ref,n}},{key:"isAudioFile",value:function(t){var n=/\.(mp3|ogg|wav|aac|webm|4a)$/i,i=t.type,s=t.src;return i==="audio"||s?.startsWith("data:audio")||s&&n.test(s)}},{key:"isImageFile",value:function(t){var n=t.type,i=t.src;return n==="image"||i?.startsWith("data:image")||i&&e.isImageFileExtension(i)}},{key:"isImageFileExtension",value:function(t){return/\.(jpg|jpeg|png|gif|bmp)$/i.test(t)}}])}();Jo.DEFAULT_FILE_NAME="file",Jo.FILE_BUBBLE_CLASS="file-message";var Et=Jo,xt=function(){function e(){T(this,e)}return A(e,null,[{key:"checkForContainerStyles",value:function(t,n){var i=t.containerStyle;i&&(Object.assign(n.style,i),console.error("The containerStyle property is deprecated since version 1.3.14."),console.error("Please change to using the style property instead: https://deepchat.dev/docs/styles#style"))}},{key:"handleResponseProperty",value:function(t){return console.error("The {result: ....} response object type is deprecated since version 1.3.0."),console.error("Please change to using the new response object: https://deepchat.dev/docs/connect#Response"),t.result}},{key:"processHistory",value:function(t){var n=t.initialMessages;if(n)return console.error("The initialMessages property is deprecated since version 2.0.0."),console.error("Please change to using the history property instead: https://deepchat.dev/docs/messages/#history"),n}},{key:"processHistoryFile",value:function(t){var n=t.file;n&&(console.error("The file property in MessageContent is deprecated since version 1.3.17."),console.error("Please change to using the files array property: https://deepchat.dev/docs/messages/#MessageContent"),t.files=[n])}},{key:"processValidateInput",value:function(t){var n=t.validateMessageBeforeSending;if(n)return console.error("The validateMessageBeforeSending property is deprecated since version 1.3.24."),console.error("Please change to using validateInput: https://deepchat.dev/docs/interceptors#validateInput"),n}},{key:"processSubmitUserMessage",value:function(t){return console.error("The submitUserMessage(text: string) argument string type is deprecated since version 1.4.4."),console.error("Please change to using the new argument type: https://deepchat.dev/docs/methods#submitUserMessage"),{text:t}}},{key:"flagHTMLUpdateClass",value:function(t){var n;(n=t.children[0])!=null&&n.classList.contains("deep-chat-update-message")&&(console.error('The "deep-chat-update-message" html class is deprecated since version 1.4.4.'),console.error("Please change to using {..., overwrite: true} object: https://deepchat.dev/docs/connect#Response"))}},{key:"processConnect",value:function(t){var n=t;n.request&&(n.connect?Object.assign(n.connect,n.request):n.connect=n.request,console.error("The request property is deprecated since version 2.0.0."),console.error("Please see the connect object: https://deepchat.dev/docs/connect#connect-1"))}},{key:"checkForStream",value:function(t){var n=t.stream;if(n)return console.error("The stream property has been moved to the connect object in version 2.0.0."),console.error("Please see the connect object: https://deepchat.dev/docs/connect#connect-1"),n}},{key:"fireOnNewMessage",value:function(t,n){var i,s=t;s.onNewMessage&&(console.error("The onNewMessage event has been deprecated since version 2.0.0."),console.error("Please see the onMessage event: https://deepchat.dev/docs/events#onMessage"),(i=s.onNewMessage)==null||i.call(s,n)),t.dispatchEvent(new CustomEvent("new-message",{detail:n}))}},{key:"processFileConfigConnect",value:function(t){var n=t;n.request&&(console.error("The request property in file configuration is deprecated since version 2.0.0."),console.error("Please use the connect property instead: https://deepchat.dev/docs/files"),n.connect||(n.connect=n.request))}},{key:"processMessageStyles",value:function(t){if(t){var n=JSON.parse(JSON.stringify(t)),i=n.loading;return i&&(i.outerContainer||i.innerContainer||i.bubble||i.media)&&(console.error("The loading message styles are defined using LoadingMessageStyles interface since version 2.1.0."),console.error("Check it out here: https://deepchat.dev/docs/messages/styles#LoadingMessageStyles"),n.loading={message:{styles:i}}),n}}},{key:"processDemo",value:function(t){return typeof t=="boolean"||t.displayLoadingBubble&&(console.error("The demo displayLoadingBubble property is deprecated since version 2.1.0."),console.error("Please use displayLoading instead: https://deepchat.dev/docs/modes#demo"),t.displayLoading={message:!0}),t}}])}(),tu=function(){function e(){T(this,e)}return A(e,null,[{key:"mouseUp",value:function(t,n){nt.unsetAllCSSMouseStates(t,n),Object.assign(t.style,n.default),Object.assign(t.style,n.hover)}},{key:"mouseDown",value:function(t,n){Object.assign(t.style,n.click)}},{key:"mouseLeave",value:function(t,n){nt.unsetAllCSSMouseStates(t,n),Object.assign(t.style,n.default)}},{key:"mouseEnter",value:function(t,n){Object.assign(t.style,n.hover)}},{key:"add",value:function(t,n){t.addEventListener("mouseenter",e.mouseEnter.bind(this,t,n)),t.addEventListener("mouseleave",e.mouseLeave.bind(this,t,n)),t.addEventListener("mousedown",e.mouseDown.bind(this,t,n)),t.addEventListener("mouseup",e.mouseUp.bind(this,t,n))}}])}(),P1="deep-chat-temporary-message",N1="deep-chat-suggestion-button",Xo={"deep-chat-button":{styles:{default:{backgroundColor:"white",padding:"5px",paddingLeft:"7px",paddingRight:"7px",border:"1px solid #c2c2c2",borderRadius:"6px",cursor:"pointer"},hover:{backgroundColor:"#fafafa"},click:{backgroundColor:"#f1f1f1"}}}},Pc=Object.keys(Xo),xr=function(){function e(){T(this,e)}return A(e,null,[{key:"applySuggestionEvent",value:function(t,n){setTimeout(function(){n.addEventListener("click",function(){var i,s;(s=t.submitUserMessage)==null||s.call(t,{text:((i=n.textContent)==null?void 0:i.trim())||""})})})}},{key:"isElementTemporary",value:function(t){var n;return t?(n=t.bubbleElement.children[0])==null?void 0:n.classList.contains(P1):!1}},{key:"doesElementContainDeepChatClass",value:function(t){return Pc.find(function(n){return t.classList.contains(n)})}},{key:"applyEvents",value:function(t,n){var i=Xo[n].events;Object.keys(i||[]).forEach(function(s){t.addEventListener(s,i?.[s])})}},{key:"getProcessedStyles",value:function(t,n,i){var s=Array.from(n.classList).reduce(function(u,c){var d,f=(d=t[c])==null?void 0:d.styles;return f&&t[c].styles&&u.push(f),u},[]),a=Xo[i].styles;if(a){var o=JSON.parse(JSON.stringify(a));o.default&&nt.overwriteDefaultWithAlreadyApplied(o,n),s.unshift(o)}var l=nt.mergeStatefulStyles(s);return nt.processStateful(l)}},{key:"applyDeepChatUtilities",value:function(t,n,i){Pc.forEach(function(a){var o=i.getElementsByClassName(a);Array.from(o||[]).forEach(function(l){var u=e.getProcessedStyles(n,l,a);pn.applyStylesToElement(l,u),e.applyEvents(l,a)})});var s=i.getElementsByClassName(N1);Array.from(s).forEach(function(a){return e.applySuggestionEvent(t,a)})}}])}(),pn=function(){function e(){T(this,e)}return A(e,null,[{key:"applyStylesToElement",value:function(t,n){var i=nt.processStateful(n);tu.add(t,i),Object.assign(t.style,i.default)}},{key:"applyEventsToElement",value:function(t,n){Object.keys(n).forEach(function(i){var s=n[i];s&&t.addEventListener(i,s)})}},{key:"applyClassUtilitiesToElement",value:function(t,n){var i=n.events,s=n.styles;i&&e.applyEventsToElement(t,i),s&&!xr.doesElementContainDeepChatClass(t)&&e.applyStylesToElement(t,s)}},{key:"applyCustomClassUtilities",value:function(t,n){Object.keys(t).forEach(function(i){var s=n.getElementsByClassName(i);Array.from(s).forEach(function(a){t[i]&&e.applyClassUtilitiesToElement(a,t[i])})})}},{key:"apply",value:function(t,n){xr.applyDeepChatUtilities(t,t.htmlClassUtilities,n),e.applyCustomClassUtilities(t.htmlClassUtilities,n)}},{key:"traverseNodes",value:function(t,n){t.nodeType===Node.ELEMENT_NODE&&n.push(t.outerHTML),t.childNodes.forEach(function(i){e.traverseNodes(i,n)})}},{key:"splitHTML",value:function(t){var n=new DOMParser().parseFromString(t,"text/html"),i=[];return n.body.childNodes.forEach(function(s){e.traverseNodes(s,i)}),i}},{key:"isTemporaryBasedOnHTML",value:function(t){var n=document.createElement("div");return n.innerHTML=t,xr.isElementTemporary({outerContainer:n,bubbleElement:n,innerContainer:n})}},{key:"replaceElementWithNewClone",value:function(t,n){var i,s=(n||t).cloneNode(!0);return(i=t.parentNode)==null||i.replaceChild(s,t),s}}])}(),Vh=function(){function e(){T(this,e)}return A(e,null,[{key:"addElement",value:function(t,n){t.appendOuterContainerElemet(n),t.focusMode||(t.elementRef.scrollTop=t.elementRef.scrollHeight)}},{key:"createElements",value:function(t,n,i,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,o=t.createMessageElementsOnOrientation("",i,s,a);return o.bubbleElement.classList.add(e.HTML_BUBBLE_CLASS),o.bubbleElement.innerHTML=n,o}},{key:"overwriteElements",value:function(t,n,i){i.bubbleElement.innerHTML=n,pn.apply(t,i.outerContainer),xt.flagHTMLUpdateClass(i.bubbleElement)}},{key:"overwrite",value:function(t,n,i,s){var a=t.messageToElements,o=ie.overwriteMessage(a,s,n,i,"html",e.HTML_BUBBLE_CLASS);return o&&e.overwriteElements(t,n,o),o}},{key:"create",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a,o=e.createElements(t,n,i,s);return ie.fillEmptyMessageElement(o.bubbleElement,n),pn.apply(t,o.outerContainer),xt.flagHTMLUpdateClass(o.bubbleElement),t.applyCustomStyles(o,i,!1,(a=t.messageStyles)==null?void 0:a.html),o}},{key:"add",value:function(t,n,i,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(s!=null&&s.status){var o=this.overwrite(t,n,i,t.messageElementRefs);if(o)return o;s.status=!1}if(!(a&&t.messageElementRefs.length>0&&pn.isTemporaryBasedOnHTML(n))){var l=e.create(t,n,i,a);return a||e.addElement(t,l.outerContainer),l}}}])}();Vh.HTML_BUBBLE_CLASS="html-message";var $n=Vh,ls;function qh(e){return ls=ls||document.createElement("textarea"),ls.innerHTML="&"+e+";",ls.value}var B1=Object.prototype.hasOwnProperty;function F1(e,r){return e?B1.call(e,r):!1}function Gh(e){var r=[].slice.call(arguments,1);return r.forEach(function(t){if(t){if(Q(t)!="object")throw new TypeError(t+"must be object");Object.keys(t).forEach(function(n){e[n]=t[n]})}}),e}var D1=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function zi(e){return e.indexOf("\\")<0?e:e.replace(D1,"$1")}function Kh(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function Yo(e){if(e>65535){e-=65536;var r=55296+(e>>10),t=56320+(e&1023);return String.fromCharCode(r,t)}return String.fromCharCode(e)}var $1=/&([a-z#][a-z0-9]{1,31});/gi,j1=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;function U1(e,r){var t=0,n=qh(r);return r!==n?n:r.charCodeAt(0)===35&&j1.test(r)&&(t=r[1].toLowerCase()==="x"?parseInt(r.slice(2),16):parseInt(r.slice(1),10),Kh(t))?Yo(t):e}function lr(e){return e.indexOf("&")<0?e:e.replace($1,U1)}var H1=/[&<>"]/,z1=/[&<>"]/g,W1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function V1(e){return W1[e]}function Mt(e){return H1.test(e)?e.replace(z1,V1):e}var re={};re.blockquote_open=function(){return`<blockquote>
`};re.blockquote_close=function(e,r){return"</blockquote>"+dr(e,r)};re.code=function(e,r){return e[r].block?"<pre><code>"+Mt(e[r].content)+"</code></pre>"+dr(e,r):"<code>"+Mt(e[r].content)+"</code>"};re.fence=function(e,r,t,n,i){var s=e[r],a="",o=t.langPrefix,l="",u,c,d;if(s.params){if(u=s.params.split(/\s+/g),c=u.join(" "),F1(i.rules.fence_custom,u[0]))return i.rules.fence_custom[u[0]](e,r,t,n,i);l=Mt(lr(zi(c))),a=' class="'+o+l+'"'}return t.highlight?d=t.highlight.apply(t.highlight,[s.content].concat(u))||Mt(s.content):d=Mt(s.content),"<pre><code"+a+">"+d+"</code></pre>"+dr(e,r)};re.fence_custom={};re.heading_open=function(e,r){return"<h"+e[r].hLevel+">"};re.heading_close=function(e,r){return"</h"+e[r].hLevel+`>
`};re.hr=function(e,r,t){return(t.xhtmlOut?"<hr />":"<hr>")+dr(e,r)};re.bullet_list_open=function(){return`<ul>
`};re.bullet_list_close=function(e,r){return"</ul>"+dr(e,r)};re.list_item_open=function(){return"<li>"};re.list_item_close=function(){return`</li>
`};re.ordered_list_open=function(e,r){var t=e[r],n=t.order>1?' start="'+t.order+'"':"";return"<ol"+n+`>
`};re.ordered_list_close=function(e,r){return"</ol>"+dr(e,r)};re.paragraph_open=function(e,r){return e[r].tight?"":"<p>"};re.paragraph_close=function(e,r){var t=!(e[r].tight&&r&&e[r-1].type==="inline"&&!e[r-1].content);return(e[r].tight?"":"</p>")+(t?dr(e,r):"")};re.link_open=function(e,r,t){var n=e[r].title?' title="'+Mt(lr(e[r].title))+'"':"",i=t.linkTarget?' target="'+t.linkTarget+'"':"";return'<a href="'+Mt(e[r].href)+'"'+n+i+">"};re.link_close=function(){return"</a>"};re.image=function(e,r,t){var n=' src="'+Mt(e[r].src)+'"',i=e[r].title?' title="'+Mt(lr(e[r].title))+'"':"",s=' alt="'+(e[r].alt?Mt(lr(zi(e[r].alt))):"")+'"',a=t.xhtmlOut?" /":"";return"<img"+n+s+i+a+">"};re.table_open=function(){return`<table>
`};re.table_close=function(){return`</table>
`};re.thead_open=function(){return`<thead>
`};re.thead_close=function(){return`</thead>
`};re.tbody_open=function(){return`<tbody>
`};re.tbody_close=function(){return`</tbody>
`};re.tr_open=function(){return"<tr>"};re.tr_close=function(){return`</tr>
`};re.th_open=function(e,r){var t=e[r];return"<th"+(t.align?' style="text-align:'+t.align+'"':"")+">"};re.th_close=function(){return"</th>"};re.td_open=function(e,r){var t=e[r];return"<td"+(t.align?' style="text-align:'+t.align+'"':"")+">"};re.td_close=function(){return"</td>"};re.strong_open=function(){return"<strong>"};re.strong_close=function(){return"</strong>"};re.em_open=function(){return"<em>"};re.em_close=function(){return"</em>"};re.del_open=function(){return"<del>"};re.del_close=function(){return"</del>"};re.ins_open=function(){return"<ins>"};re.ins_close=function(){return"</ins>"};re.mark_open=function(){return"<mark>"};re.mark_close=function(){return"</mark>"};re.sub=function(e,r){return"<sub>"+Mt(e[r].content)+"</sub>"};re.sup=function(e,r){return"<sup>"+Mt(e[r].content)+"</sup>"};re.hardbreak=function(e,r,t){return t.xhtmlOut?`<br />
`:`<br>
`};re.softbreak=function(e,r,t){return t.breaks?t.xhtmlOut?`<br />
`:`<br>
`:`
`};re.text=function(e,r){return Mt(e[r].content)};re.htmlblock=function(e,r){return e[r].content};re.htmltag=function(e,r){return e[r].content};re.abbr_open=function(e,r){return'<abbr title="'+Mt(lr(e[r].title))+'">'};re.abbr_close=function(){return"</abbr>"};re.footnote_ref=function(e,r){var t=Number(e[r].id+1).toString(),n="fnref"+t;return e[r].subId>0&&(n+=":"+e[r].subId),'<sup class="footnote-ref"><a href="#fn'+t+'" id="'+n+'">['+t+"]</a></sup>"};re.footnote_block_open=function(e,r,t){var n=t.xhtmlOut?`<hr class="footnotes-sep" />
`:`<hr class="footnotes-sep">
`;return n+`<section class="footnotes">
<ol class="footnotes-list">
`};re.footnote_block_close=function(){return`</ol>
</section>
`};re.footnote_open=function(e,r){var t=Number(e[r].id+1).toString();return'<li id="fn'+t+'"  class="footnote-item">'};re.footnote_close=function(){return`</li>
`};re.footnote_anchor=function(e,r){var t=Number(e[r].id+1).toString(),n="fnref"+t;return e[r].subId>0&&(n+=":"+e[r].subId),' <a href="#'+n+'" class="footnote-backref">↩</a>'};re.dl_open=function(){return`<dl>
`};re.dt_open=function(){return"<dt>"};re.dd_open=function(){return"<dd>"};re.dl_close=function(){return`</dl>
`};re.dt_close=function(){return`</dt>
`};re.dd_close=function(){return`</dd>
`};function Jh(e,r){return++r>=e.length-2?r:e[r].type==="paragraph_open"&&e[r].tight&&e[r+1].type==="inline"&&e[r+1].content.length===0&&e[r+2].type==="paragraph_close"&&e[r+2].tight?Jh(e,r+2):r}var dr=re.getBreak=function(e,r){return r=Jh(e,r),r<e.length&&e[r].type==="list_item_close"?"":`
`};function nu(){this.rules=Gh({},re),this.getBreak=re.getBreak}nu.prototype.renderInline=function(e,r,t){for(var n=this.rules,i=e.length,s=0,a="";i--;)a+=n[e[s].type](e,s++,r,t,this);return a};nu.prototype.render=function(e,r,t){for(var n=this.rules,i=e.length,s=-1,a="";++s<i;)e[s].type==="inline"?a+=this.renderInline(e[s].children,r,t):a+=n[e[s].type](e,s,r,t,this);return a};function Pt(){this.__rules__=[],this.__cache__=null}Pt.prototype.__find__=function(e){for(var r=this.__rules__.length,t=-1;r--;)if(this.__rules__[++t].name===e)return t;return-1};Pt.prototype.__compile__=function(){var e=this,r=[""];e.__rules__.forEach(function(t){t.enabled&&t.alt.forEach(function(n){r.indexOf(n)<0&&r.push(n)})}),e.__cache__={},r.forEach(function(t){e.__cache__[t]=[],e.__rules__.forEach(function(n){n.enabled&&(t&&n.alt.indexOf(t)<0||e.__cache__[t].push(n.fn))})})};Pt.prototype.at=function(e,r,t){var n=this.__find__(e),i=t||{};if(n===-1)throw new Error("Parser rule not found: "+e);this.__rules__[n].fn=r,this.__rules__[n].alt=i.alt||[],this.__cache__=null};Pt.prototype.before=function(e,r,t,n){var i=this.__find__(e),s=n||{};if(i===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i,0,{name:r,enabled:!0,fn:t,alt:s.alt||[]}),this.__cache__=null};Pt.prototype.after=function(e,r,t,n){var i=this.__find__(e),s=n||{};if(i===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i+1,0,{name:r,enabled:!0,fn:t,alt:s.alt||[]}),this.__cache__=null};Pt.prototype.push=function(e,r,t){var n=t||{};this.__rules__.push({name:e,enabled:!0,fn:r,alt:n.alt||[]}),this.__cache__=null};Pt.prototype.enable=function(e,r){e=Array.isArray(e)?e:[e],r&&this.__rules__.forEach(function(t){t.enabled=!1}),e.forEach(function(t){var n=this.__find__(t);if(n<0)throw new Error("Rules manager: invalid rule name "+t);this.__rules__[n].enabled=!0},this),this.__cache__=null};Pt.prototype.disable=function(e){e=Array.isArray(e)?e:[e],e.forEach(function(r){var t=this.__find__(r);if(t<0)throw new Error("Rules manager: invalid rule name "+r);this.__rules__[t].enabled=!1},this),this.__cache__=null};Pt.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function q1(e){e.inlineMode?e.tokens.push({type:"inline",content:e.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):e.block.parse(e.src,e.options,e.env,e.tokens)}function fr(e,r,t,n,i){this.src=e,this.env=n,this.options=t,this.parser=r,this.tokens=i,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}fr.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""};fr.prototype.push=function(e){this.pending&&this.pushPending(),this.tokens.push(e),this.pendingLevel=this.level};fr.prototype.cacheSet=function(e,r){for(var t=this.cache.length;t<=e;t++)this.cache.push(0);this.cache[e]=r};fr.prototype.cacheGet=function(e){return e<this.cache.length?this.cache[e]:0};function Wi(e,r){var t,n,i,s=-1,a=e.posMax,o=e.pos,l=e.isInLabel;if(e.isInLabel)return-1;if(e.labelUnmatchedScopes)return e.labelUnmatchedScopes--,-1;for(e.pos=r+1,e.isInLabel=!0,t=1;e.pos<a;){if(i=e.src.charCodeAt(e.pos),i===91)t++;else if(i===93&&(t--,t===0)){n=!0;break}e.parser.skipToken(e)}return n?(s=e.pos,e.labelUnmatchedScopes=0):e.labelUnmatchedScopes=t-1,e.pos=o,e.isInLabel=l,s}function G1(e,r,t,n){var i,s,a,o,l,u;if(e.charCodeAt(0)!==42||e.charCodeAt(1)!==91||e.indexOf("]:")===-1||(i=new fr(e,r,t,n,[]),s=Wi(i,1),s<0||e.charCodeAt(s+1)!==58))return-1;for(o=i.posMax,a=s+2;a<o&&i.src.charCodeAt(a)!==10;a++);return l=e.slice(2,s),u=e.slice(s+2,a).trim(),u.length===0?-1:(n.abbreviations||(n.abbreviations={}),Q(n.abbreviations[":"+l])>"u"&&(n.abbreviations[":"+l]=u),a)}function K1(e){var r=e.tokens,t,n,i,s;if(!e.inlineMode){for(t=1,n=r.length-1;t<n;t++)if(r[t-1].type==="paragraph_open"&&r[t].type==="inline"&&r[t+1].type==="paragraph_close"){for(i=r[t].content;i.length&&(s=G1(i,e.inline,e.options,e.env),!(s<0));)i=i.slice(s).trim();r[t].content=i,i.length||(r[t-1].tight=!0,r[t+1].tight=!0)}}}function Zo(e){var r=lr(e);try{r=decodeURI(r)}catch{}return encodeURI(r)}function Xh(e,r){var t,n,i,s=r,a=e.posMax;if(e.src.charCodeAt(r)===60){for(r++;r<a;){if(t=e.src.charCodeAt(r),t===10)return!1;if(t===62)return i=Zo(zi(e.src.slice(s+1,r))),e.parser.validateLink(i)?(e.pos=r+1,e.linkContent=i,!0):!1;if(t===92&&r+1<a){r+=2;continue}r++}return!1}for(n=0;r<a&&(t=e.src.charCodeAt(r),!(t===32||t<32||t===127));){if(t===92&&r+1<a){r+=2;continue}if(t===40&&(n++,n>1)||t===41&&(n--,n<0))break;r++}return s===r||(i=zi(e.src.slice(s,r)),!e.parser.validateLink(i))?!1:(e.linkContent=i,e.pos=r,!0)}function Yh(e,r){var t,n=r,i=e.posMax,s=e.src.charCodeAt(r);if(s!==34&&s!==39&&s!==40)return!1;for(r++,s===40&&(s=41);r<i;){if(t=e.src.charCodeAt(r),t===s)return e.pos=r+1,e.linkContent=zi(e.src.slice(n+1,r)),!0;if(t===92&&r+1<i){r+=2;continue}r++}return!1}function Zh(e){return e.trim().replace(/\s+/g," ").toUpperCase()}function J1(e,r,t,n){var i,s,a,o,l,u,c,d,f;if(e.charCodeAt(0)!==91||e.indexOf("]:")===-1||(i=new fr(e,r,t,n,[]),s=Wi(i,0),s<0||e.charCodeAt(s+1)!==58))return-1;for(o=i.posMax,a=s+2;a<o&&(l=i.src.charCodeAt(a),!(l!==32&&l!==10));a++);if(!Xh(i,a))return-1;for(c=i.linkContent,a=i.pos,u=a,a=a+1;a<o&&(l=i.src.charCodeAt(a),!(l!==32&&l!==10));a++);for(a<o&&u!==a&&Yh(i,a)?(d=i.linkContent,a=i.pos):(d="",a=u);a<o&&i.src.charCodeAt(a)===32;)a++;return a<o&&i.src.charCodeAt(a)!==10?-1:(f=Zh(e.slice(1,s)),Q(n.references[f])>"u"&&(n.references[f]={title:d,href:c}),a)}function X1(e){var r=e.tokens,t,n,i,s;if(e.env.references=e.env.references||{},!e.inlineMode){for(t=1,n=r.length-1;t<n;t++)if(r[t].type==="inline"&&r[t-1].type==="paragraph_open"&&r[t+1].type==="paragraph_close"){for(i=r[t].content;i.length&&(s=J1(i,e.inline,e.options,e.env),!(s<0));)i=i.slice(s).trim();r[t].content=i,i.length||(r[t-1].tight=!0,r[t+1].tight=!0)}}}function Y1(e){var r=e.tokens,t,n,i;for(n=0,i=r.length;n<i;n++)t=r[n],t.type==="inline"&&e.inline.parse(t.content,e.options,e.env,t.children)}function Z1(e){var r,t,n,i,s,a,o,l,u,c=0,d=!1,f={};if(e.env.footnotes&&(e.tokens=e.tokens.filter(function(h){return h.type==="footnote_reference_open"?(d=!0,l=[],u=h.label,!1):h.type==="footnote_reference_close"?(d=!1,f[":"+u]=l,!1):(d&&l.push(h),!d)}),!!e.env.footnotes.list)){for(a=e.env.footnotes.list,e.tokens.push({type:"footnote_block_open",level:c++}),r=0,t=a.length;r<t;r++){for(e.tokens.push({type:"footnote_open",id:r,level:c++}),a[r].tokens?(o=[],o.push({type:"paragraph_open",tight:!1,level:c++}),o.push({type:"inline",content:"",level:c,children:a[r].tokens}),o.push({type:"paragraph_close",tight:!1,level:--c})):a[r].label&&(o=f[":"+a[r].label]),e.tokens=e.tokens.concat(o),e.tokens[e.tokens.length-1].type==="paragraph_close"?s=e.tokens.pop():s=null,i=a[r].count>0?a[r].count:1,n=0;n<i;n++)e.tokens.push({type:"footnote_anchor",id:r,subId:n,level:c});s&&e.tokens.push(s),e.tokens.push({type:"footnote_close",level:--c})}e.tokens.push({type:"footnote_block_close",level:--c})}}var Nc=` 
()[]'".,!?-`;function mo(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}function Q1(e){var r,t,n,i,s,a,o,l,u,c,d,f,h=e.tokens;if(e.env.abbreviations){for(e.env.abbrRegExp||(f="(^|["+Nc.split("").map(mo).join("")+"])("+Object.keys(e.env.abbreviations).map(function(p){return p.substr(1)}).sort(function(p,m){return m.length-p.length}).map(mo).join("|")+")($|["+Nc.split("").map(mo).join("")+"])",e.env.abbrRegExp=new RegExp(f,"g")),c=e.env.abbrRegExp,t=0,n=h.length;t<n;t++)if(h[t].type==="inline"){for(i=h[t].children,r=i.length-1;r>=0;r--)if(s=i[r],s.type==="text"){for(l=0,a=s.content,c.lastIndex=0,u=s.level,o=[];d=c.exec(a);)c.lastIndex>l&&o.push({type:"text",content:a.slice(l,d.index+d[1].length),level:u}),o.push({type:"abbr_open",title:e.env.abbreviations[":"+d[2]],level:u++}),o.push({type:"text",content:d[2],level:u}),o.push({type:"abbr_close",level:--u}),l=c.lastIndex-d[3].length;o.length&&(l<a.length&&o.push({type:"text",content:a.slice(l),level:u}),h[t].children=i=[].concat(i.slice(0,r),o,i.slice(r+1)))}}}}var eS=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,tS=/\((c|tm|r|p)\)/ig,nS={c:"©",r:"®",p:"§",tm:"™"};function rS(e){return e.indexOf("(")<0?e:e.replace(tS,function(r,t){return nS[t.toLowerCase()]})}function iS(e){var r,t,n,i,s;if(e.options.typographer){for(s=e.tokens.length-1;s>=0;s--)if(e.tokens[s].type==="inline")for(i=e.tokens[s].children,r=i.length-1;r>=0;r--)t=i[r],t.type==="text"&&(n=t.content,n=rS(n),eS.test(n)&&(n=n.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/mg,"$1—$2").replace(/(^|\s)--(\s|$)/mg,"$1–$2").replace(/(^|[^-\s])--([^-\s]|$)/mg,"$1–$2")),t.content=n)}}var sS=/['"]/,Bc=/['"]/g,aS=/[-\s()\[\]]/,Fc="’";function Dc(e,r){return r<0||r>=e.length?!1:!aS.test(e[r])}function Sr(e,r,t){return e.substr(0,r)+t+e.substr(r+1)}function oS(e){var r,t,n,i,s,a,o,l,u,c,d,f,h,p,m,v,y;if(e.options.typographer){for(y=[],m=e.tokens.length-1;m>=0;m--)if(e.tokens[m].type==="inline"){for(v=e.tokens[m].children,y.length=0,r=0;r<v.length;r++)if(t=v[r],!(t.type!=="text"||sS.test(t.text))){for(o=v[r].level,h=y.length-1;h>=0&&!(y[h].level<=o);h--);y.length=h+1,n=t.content,s=0,a=n.length;e:for(;s<a&&(Bc.lastIndex=s,i=Bc.exec(n),!!i);){if(l=!Dc(n,i.index-1),s=i.index+1,p=i[0]==="'",u=!Dc(n,s),!u&&!l){p&&(t.content=Sr(t.content,i.index,Fc));continue}if(d=!u,f=!l,f){for(h=y.length-1;h>=0&&(c=y[h],!(y[h].level<o));h--)if(c.single===p&&y[h].level===o){c=y[h],p?(v[c.token].content=Sr(v[c.token].content,c.pos,e.options.quotes[2]),t.content=Sr(t.content,i.index,e.options.quotes[3])):(v[c.token].content=Sr(v[c.token].content,c.pos,e.options.quotes[0]),t.content=Sr(t.content,i.index,e.options.quotes[1])),y.length=h;continue e}}d?y.push({token:r,pos:i.index,single:p,level:o}):f&&p&&(t.content=Sr(t.content,i.index,Fc))}}}}}var vo=[["block",q1],["abbr",K1],["references",X1],["inline",Y1],["footnote_tail",Z1],["abbr2",Q1],["replacements",iS],["smartquotes",oS]];function Qh(){this.options={},this.ruler=new Pt;for(var e=0;e<vo.length;e++)this.ruler.push(vo[e][0],vo[e][1])}Qh.prototype.process=function(e){var r,t,n;for(n=this.ruler.getRules(""),r=0,t=n.length;r<t;r++)n[r](e)};function hr(e,r,t,n,i){var s,a,o,l,u,c,d;for(this.src=e,this.parser=r,this.options=t,this.env=n,this.tokens=i,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",a=this.src,c=0,d=!1,o=l=c=0,u=a.length;l<u;l++){if(s=a.charCodeAt(l),!d)if(s===32){c++;continue}else d=!0;(s===10||l===u-1)&&(s!==10&&l++,this.bMarks.push(o),this.eMarks.push(l),this.tShift.push(c),d=!1,c=0,o=l+1)}this.bMarks.push(a.length),this.eMarks.push(a.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}hr.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};hr.prototype.skipEmptyLines=function(e){for(var r=this.lineMax;e<r&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};hr.prototype.skipSpaces=function(e){for(var r=this.src.length;e<r&&this.src.charCodeAt(e)===32;e++);return e};hr.prototype.skipChars=function(e,r){for(var t=this.src.length;e<t&&this.src.charCodeAt(e)===r;e++);return e};hr.prototype.skipCharsBack=function(e,r,t){if(e<=t)return e;for(;e>t;)if(r!==this.src.charCodeAt(--e))return e+1;return e};hr.prototype.getLines=function(e,r,t,n){var i,s,a,o,l,u=e;if(e>=r)return"";if(u+1===r)return s=this.bMarks[u]+Math.min(this.tShift[u],t),a=n?this.eMarks[u]+1:this.eMarks[u],this.src.slice(s,a);for(o=new Array(r-e),i=0;u<r;u++,i++)l=this.tShift[u],l>t&&(l=t),l<0&&(l=0),s=this.bMarks[u]+l,u+1<r||n?a=this.eMarks[u]+1:a=this.eMarks[u],o[i]=this.src.slice(s,a);return o.join("")};function lS(e,r,t){var n,i;if(e.tShift[r]-e.blkIndent<4)return!1;for(i=n=r+1;n<t;){if(e.isEmpty(n)){n++;continue}if(e.tShift[n]-e.blkIndent>=4){n++,i=n;continue}break}return e.line=n,e.tokens.push({type:"code",content:e.getLines(r,i,4+e.blkIndent,!0),block:!0,lines:[r,e.line],level:e.level}),!0}function uS(e,r,t,n){var i,s,a,o,l,u=!1,c=e.bMarks[r]+e.tShift[r],d=e.eMarks[r];if(c+3>d||(i=e.src.charCodeAt(c),i!==126&&i!==96)||(l=c,c=e.skipChars(c,i),s=c-l,s<3)||(a=e.src.slice(c,d).trim(),a.indexOf("`")>=0))return!1;if(n)return!0;for(o=r;o++,!(o>=t||(c=l=e.bMarks[o]+e.tShift[o],d=e.eMarks[o],c<d&&e.tShift[o]<e.blkIndent));)if(e.src.charCodeAt(c)===i&&!(e.tShift[o]-e.blkIndent>=4)&&(c=e.skipChars(c,i),!(c-l<s)&&(c=e.skipSpaces(c),!(c<d)))){u=!0;break}return s=e.tShift[r],e.line=o+(u?1:0),e.tokens.push({type:"fence",params:a,content:e.getLines(r+1,o,s,!0),lines:[r,e.line],level:e.level}),!0}function cS(e,r,t,n){var i,s,a,o,l,u,c,d,f,h,p,m=e.bMarks[r]+e.tShift[r],v=e.eMarks[r];if(m>v||e.src.charCodeAt(m++)!==62||e.level>=e.options.maxNesting)return!1;if(n)return!0;for(e.src.charCodeAt(m)===32&&m++,l=e.blkIndent,e.blkIndent=0,o=[e.bMarks[r]],e.bMarks[r]=m,m=m<v?e.skipSpaces(m):m,s=m>=v,a=[e.tShift[r]],e.tShift[r]=m-e.bMarks[r],d=e.parser.ruler.getRules("blockquote"),i=r+1;i<t&&(m=e.bMarks[i]+e.tShift[i],v=e.eMarks[i],!(m>=v));i++){if(e.src.charCodeAt(m++)===62){e.src.charCodeAt(m)===32&&m++,o.push(e.bMarks[i]),e.bMarks[i]=m,m=m<v?e.skipSpaces(m):m,s=m>=v,a.push(e.tShift[i]),e.tShift[i]=m-e.bMarks[i];continue}if(s)break;for(p=!1,f=0,h=d.length;f<h;f++)if(d[f](e,i,t,!0)){p=!0;break}if(p)break;o.push(e.bMarks[i]),a.push(e.tShift[i]),e.tShift[i]=-1337}for(u=e.parentType,e.parentType="blockquote",e.tokens.push({type:"blockquote_open",lines:c=[r,0],level:e.level++}),e.parser.tokenize(e,r,i),e.tokens.push({type:"blockquote_close",level:--e.level}),e.parentType=u,c[1]=e.line,f=0;f<a.length;f++)e.bMarks[f+r]=o[f],e.tShift[f+r]=a[f];return e.blkIndent=l,!0}function dS(e,r,t,n){var i,s,a,o=e.bMarks[r],l=e.eMarks[r];if(o+=e.tShift[r],o>l||(i=e.src.charCodeAt(o++),i!==42&&i!==45&&i!==95))return!1;for(s=1;o<l;){if(a=e.src.charCodeAt(o++),a!==i&&a!==32)return!1;a===i&&s++}return s<3?!1:(n||(e.line=r+1,e.tokens.push({type:"hr",lines:[r,e.line],level:e.level})),!0)}function $c(e,r){var t,n,i;return n=e.bMarks[r]+e.tShift[r],i=e.eMarks[r],n>=i||(t=e.src.charCodeAt(n++),t!==42&&t!==45&&t!==43)||n<i&&e.src.charCodeAt(n)!==32?-1:n}function jc(e,r){var t,n=e.bMarks[r]+e.tShift[r],i=e.eMarks[r];if(n+1>=i||(t=e.src.charCodeAt(n++),t<48||t>57))return-1;for(;;){if(n>=i)return-1;if(t=e.src.charCodeAt(n++),!(t>=48&&t<=57)){if(t===41||t===46)break;return-1}}return n<i&&e.src.charCodeAt(n)!==32?-1:n}function fS(e,r){var t,n,i=e.level+2;for(t=r+2,n=e.tokens.length-2;t<n;t++)e.tokens[t].level===i&&e.tokens[t].type==="paragraph_open"&&(e.tokens[t+2].tight=!0,e.tokens[t].tight=!0,t+=2)}function hS(e,r,t,n){var i,s,a,o,l,u,c,d,f,h,p,m,v,y,b,M,_,E,C=!0,B,P,R,L;if((d=jc(e,r))>=0)v=!0;else if((d=$c(e,r))>=0)v=!1;else return!1;if(e.level>=e.options.maxNesting)return!1;if(m=e.src.charCodeAt(d-1),n)return!0;for(b=e.tokens.length,v?(c=e.bMarks[r]+e.tShift[r],p=Number(e.src.substr(c,d-c-1)),e.tokens.push({type:"ordered_list_open",order:p,lines:_=[r,0],level:e.level++})):e.tokens.push({type:"bullet_list_open",lines:_=[r,0],level:e.level++}),i=r,M=!1,B=e.parser.ruler.getRules("list");i<t&&(y=e.skipSpaces(d),f=e.eMarks[i],y>=f?h=1:h=y-d,h>4&&(h=1),h<1&&(h=1),s=d-e.bMarks[i]+h,e.tokens.push({type:"list_item_open",lines:E=[r,0],level:e.level++}),o=e.blkIndent,l=e.tight,a=e.tShift[r],u=e.parentType,e.tShift[r]=y-e.bMarks[r],e.blkIndent=s,e.tight=!0,e.parentType="list",e.parser.tokenize(e,r,t,!0),(!e.tight||M)&&(C=!1),M=e.line-r>1&&e.isEmpty(e.line-1),e.blkIndent=o,e.tShift[r]=a,e.tight=l,e.parentType=u,e.tokens.push({type:"list_item_close",level:--e.level}),i=r=e.line,E[1]=i,y=e.bMarks[r],!(i>=t||e.isEmpty(i)||e.tShift[i]<e.blkIndent));){for(L=!1,P=0,R=B.length;P<R;P++)if(B[P](e,i,t,!0)){L=!0;break}if(L)break;if(v){if(d=jc(e,i),d<0)break}else if(d=$c(e,i),d<0)break;if(m!==e.src.charCodeAt(d-1))break}return e.tokens.push({type:v?"ordered_list_close":"bullet_list_close",level:--e.level}),_[1]=i,e.line=i,C&&fS(e,b),!0}function pS(e,r,t,n){var i,s,a,o,l,u=e.bMarks[r]+e.tShift[r],c=e.eMarks[r];if(u+4>c||e.src.charCodeAt(u)!==91||e.src.charCodeAt(u+1)!==94||e.level>=e.options.maxNesting)return!1;for(o=u+2;o<c;o++){if(e.src.charCodeAt(o)===32)return!1;if(e.src.charCodeAt(o)===93)break}return o===u+2||o+1>=c||e.src.charCodeAt(++o)!==58?!1:(n||(o++,e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.refs||(e.env.footnotes.refs={}),l=e.src.slice(u+2,o-2),e.env.footnotes.refs[":"+l]=-1,e.tokens.push({type:"footnote_reference_open",label:l,level:e.level++}),i=e.bMarks[r],s=e.tShift[r],a=e.parentType,e.tShift[r]=e.skipSpaces(o)-o,e.bMarks[r]=o,e.blkIndent+=4,e.parentType="footnote",e.tShift[r]<e.blkIndent&&(e.tShift[r]+=e.blkIndent,e.bMarks[r]-=e.blkIndent),e.parser.tokenize(e,r,t,!0),e.parentType=a,e.blkIndent-=4,e.tShift[r]=s,e.bMarks[r]=i,e.tokens.push({type:"footnote_reference_close",level:--e.level})),!0)}function mS(e,r,t,n){var i,s,a,o=e.bMarks[r]+e.tShift[r],l=e.eMarks[r];if(o>=l||(i=e.src.charCodeAt(o),i!==35||o>=l))return!1;for(s=1,i=e.src.charCodeAt(++o);i===35&&o<l&&s<=6;)s++,i=e.src.charCodeAt(++o);return s>6||o<l&&i!==32?!1:(n||(l=e.skipCharsBack(l,32,o),a=e.skipCharsBack(l,35,o),a>o&&e.src.charCodeAt(a-1)===32&&(l=a),e.line=r+1,e.tokens.push({type:"heading_open",hLevel:s,lines:[r,e.line],level:e.level}),o<l&&e.tokens.push({type:"inline",content:e.src.slice(o,l).trim(),level:e.level+1,lines:[r,e.line],children:[]}),e.tokens.push({type:"heading_close",hLevel:s,level:e.level})),!0)}function vS(e,r,t){var n,i,s,a=r+1;return a>=t||e.tShift[a]<e.blkIndent||e.tShift[a]-e.blkIndent>3||(i=e.bMarks[a]+e.tShift[a],s=e.eMarks[a],i>=s)||(n=e.src.charCodeAt(i),n!==45&&n!==61)||(i=e.skipChars(i,n),i=e.skipSpaces(i),i<s)?!1:(i=e.bMarks[r]+e.tShift[r],e.line=a+1,e.tokens.push({type:"heading_open",hLevel:n===61?1:2,lines:[r,e.line],level:e.level}),e.tokens.push({type:"inline",content:e.src.slice(i,e.eMarks[r]).trim(),level:e.level+1,lines:[r,e.line-1],children:[]}),e.tokens.push({type:"heading_close",hLevel:n===61?1:2,level:e.level}),!0)}var ep={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach(function(e){ep[e]=!0});var gS=/^<([a-zA-Z]{1,15})[\s\/>]/,yS=/^<\/([a-zA-Z]{1,15})[\s>]/;function bS(e){var r=e|32;return r>=97&&r<=122}function SS(e,r,t,n){var i,s,a,o=e.bMarks[r],l=e.eMarks[r],u=e.tShift[r];if(o+=u,!e.options.html||u>3||o+2>=l||e.src.charCodeAt(o)!==60)return!1;if(i=e.src.charCodeAt(o+1),i===33||i===63){if(n)return!0}else if(i===47||bS(i)){if(i===47){if(s=e.src.slice(o,l).match(yS),!s)return!1}else if(s=e.src.slice(o,l).match(gS),!s)return!1;if(ep[s[1].toLowerCase()]!==!0)return!1;if(n)return!0}else return!1;for(a=r+1;a<e.lineMax&&!e.isEmpty(a);)a++;return e.line=a,e.tokens.push({type:"htmlblock",level:e.level,lines:[r,e.line],content:e.getLines(r,a,0,!0)}),!0}function go(e,r){var t=e.bMarks[r]+e.blkIndent,n=e.eMarks[r];return e.src.substr(t,n-t)}function kS(e,r,t,n){var i,s,a,o,l,u,c,d,f,h,p;if(r+2>t||(l=r+1,e.tShift[l]<e.blkIndent)||(a=e.bMarks[l]+e.tShift[l],a>=e.eMarks[l])||(i=e.src.charCodeAt(a),i!==124&&i!==45&&i!==58)||(s=go(e,r+1),!/^[-:| ]+$/.test(s))||(u=s.split("|"),u<=2))return!1;for(d=[],o=0;o<u.length;o++){if(f=u[o].trim(),!f){if(o===0||o===u.length-1)continue;return!1}if(!/^:?-+:?$/.test(f))return!1;f.charCodeAt(f.length-1)===58?d.push(f.charCodeAt(0)===58?"center":"right"):f.charCodeAt(0)===58?d.push("left"):d.push("")}if(s=go(e,r).trim(),s.indexOf("|")===-1||(u=s.replace(/^\||\|$/g,"").split("|"),d.length!==u.length))return!1;if(n)return!0;for(e.tokens.push({type:"table_open",lines:h=[r,0],level:e.level++}),e.tokens.push({type:"thead_open",lines:[r,r+1],level:e.level++}),e.tokens.push({type:"tr_open",lines:[r,r+1],level:e.level++}),o=0;o<u.length;o++)e.tokens.push({type:"th_open",align:d[o],lines:[r,r+1],level:e.level++}),e.tokens.push({type:"inline",content:u[o].trim(),lines:[r,r+1],level:e.level,children:[]}),e.tokens.push({type:"th_close",level:--e.level});for(e.tokens.push({type:"tr_close",level:--e.level}),e.tokens.push({type:"thead_close",level:--e.level}),e.tokens.push({type:"tbody_open",lines:p=[r+2,0],level:e.level++}),l=r+2;l<t&&!(e.tShift[l]<e.blkIndent||(s=go(e,l).trim(),s.indexOf("|")===-1));l++){for(u=s.replace(/^\||\|$/g,"").split("|"),e.tokens.push({type:"tr_open",level:e.level++}),o=0;o<u.length;o++)e.tokens.push({type:"td_open",align:d[o],level:e.level++}),c=u[o].substring(u[o].charCodeAt(0)===124?1:0,u[o].charCodeAt(u[o].length-1)===124?u[o].length-1:u[o].length).trim(),e.tokens.push({type:"inline",content:c,level:e.level,children:[]}),e.tokens.push({type:"td_close",level:--e.level});e.tokens.push({type:"tr_close",level:--e.level})}return e.tokens.push({type:"tbody_close",level:--e.level}),e.tokens.push({type:"table_close",level:--e.level}),h[1]=p[1]=l,e.line=l,!0}function us(e,r){var t,n,i=e.bMarks[r]+e.tShift[r],s=e.eMarks[r];return i>=s||(n=e.src.charCodeAt(i++),n!==126&&n!==58)||(t=e.skipSpaces(i),i===t)||t>=s?-1:t}function _S(e,r){var t,n,i=e.level+2;for(t=r+2,n=e.tokens.length-2;t<n;t++)e.tokens[t].level===i&&e.tokens[t].type==="paragraph_open"&&(e.tokens[t+2].tight=!0,e.tokens[t].tight=!0,t+=2)}function ES(e,r,t,n){var i,s,a,o,l,u,c,d,f,h,p,m,v,y;if(n)return e.ddIndent<0?!1:us(e,r)>=0;if(c=r+1,e.isEmpty(c)&&++c>t||e.tShift[c]<e.blkIndent||(i=us(e,c),i<0)||e.level>=e.options.maxNesting)return!1;u=e.tokens.length,e.tokens.push({type:"dl_open",lines:l=[r,0],level:e.level++}),a=r,s=c;e:for(;;){for(y=!0,v=!1,e.tokens.push({type:"dt_open",lines:[a,a],level:e.level++}),e.tokens.push({type:"inline",content:e.getLines(a,a+1,e.blkIndent,!1).trim(),level:e.level+1,lines:[a,a],children:[]}),e.tokens.push({type:"dt_close",level:--e.level});;){if(e.tokens.push({type:"dd_open",lines:o=[c,0],level:e.level++}),m=e.tight,f=e.ddIndent,d=e.blkIndent,p=e.tShift[s],h=e.parentType,e.blkIndent=e.ddIndent=e.tShift[s]+2,e.tShift[s]=i-e.bMarks[s],e.tight=!0,e.parentType="deflist",e.parser.tokenize(e,s,t,!0),(!e.tight||v)&&(y=!1),v=e.line-s>1&&e.isEmpty(e.line-1),e.tShift[s]=p,e.tight=m,e.parentType=h,e.blkIndent=d,e.ddIndent=f,e.tokens.push({type:"dd_close",level:--e.level}),o[1]=c=e.line,c>=t||e.tShift[c]<e.blkIndent)break e;if(i=us(e,c),i<0)break;s=c}if(c>=t||(a=c,e.isEmpty(a))||e.tShift[a]<e.blkIndent||(s=a+1,s>=t)||(e.isEmpty(s)&&s++,s>=t)||e.tShift[s]<e.blkIndent||(i=us(e,s),i<0))break}return e.tokens.push({type:"dl_close",level:--e.level}),l[1]=c,e.line=c,y&&_S(e,u),!0}function wS(e,r){var t,n,i,s,a,o=r+1,l;if(t=e.lineMax,o<t&&!e.isEmpty(o)){for(l=e.parser.ruler.getRules("paragraph");o<t&&!e.isEmpty(o);o++)if(!(e.tShift[o]-e.blkIndent>3)){for(i=!1,s=0,a=l.length;s<a;s++)if(l[s](e,o,t,!0)){i=!0;break}if(i)break}}return n=e.getLines(r,o,e.blkIndent,!1).trim(),e.line=o,n.length&&(e.tokens.push({type:"paragraph_open",tight:!1,lines:[r,e.line],level:e.level}),e.tokens.push({type:"inline",content:n,level:e.level+1,lines:[r,e.line],children:[]}),e.tokens.push({type:"paragraph_close",tight:!1,level:e.level})),!0}var cs=[["code",lS],["fences",uS,["paragraph","blockquote","list"]],["blockquote",cS,["paragraph","blockquote","list"]],["hr",dS,["paragraph","blockquote","list"]],["list",hS,["paragraph","blockquote"]],["footnote",pS,["paragraph"]],["heading",mS,["paragraph","blockquote"]],["lheading",vS],["htmlblock",SS,["paragraph","blockquote"]],["table",kS,["paragraph"]],["deflist",ES,["paragraph"]],["paragraph",wS]];function ru(){this.ruler=new Pt;for(var e=0;e<cs.length;e++)this.ruler.push(cs[e][0],cs[e][1],{alt:(cs[e][2]||[]).slice()})}ru.prototype.tokenize=function(e,r,t){for(var n=this.ruler.getRules(""),i=n.length,s=r,a=!1,o,l;s<t&&(e.line=s=e.skipEmptyLines(s),!(s>=t||e.tShift[s]<e.blkIndent));){for(l=0;l<i&&(o=n[l](e,s,t,!1),!o);l++);if(e.tight=!a,e.isEmpty(e.line-1)&&(a=!0),s=e.line,s<t&&e.isEmpty(s)){if(a=!0,s++,s<t&&e.parentType==="list"&&e.isEmpty(s))break;e.line=s}}};var CS=/[\n\t]/g,TS=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,AS=/\u00a0/g;ru.prototype.parse=function(e,r,t,n){var i,s=0,a=0;if(!e)return[];e=e.replace(AS," "),e=e.replace(TS,`
`),e.indexOf("	")>=0&&(e=e.replace(CS,function(o,l){var u;return e.charCodeAt(l)===10?(s=l+1,a=0,o):(u="    ".slice((l-s-a)%4),a=l-s+1,u)})),i=new hr(e,this,r,t,n),this.tokenize(i,i.line,i.lineMax)};function MS(e){switch(e){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}function xS(e,r){for(var t=e.pos;t<e.posMax&&!MS(e.src.charCodeAt(t));)t++;return t===e.pos?!1:(r||(e.pending+=e.src.slice(e.pos,t)),e.pos=t,!0)}function IS(e,r){var t,n,i=e.pos;if(e.src.charCodeAt(i)!==10)return!1;if(t=e.pending.length-1,n=e.posMax,!r)if(t>=0&&e.pending.charCodeAt(t)===32)if(t>=1&&e.pending.charCodeAt(t-1)===32){for(var s=t-2;s>=0;s--)if(e.pending.charCodeAt(s)!==32){e.pending=e.pending.substring(0,s+1);break}e.push({type:"hardbreak",level:e.level})}else e.pending=e.pending.slice(0,-1),e.push({type:"softbreak",level:e.level});else e.push({type:"softbreak",level:e.level});for(i++;i<n&&e.src.charCodeAt(i)===32;)i++;return e.pos=i,!0}var iu=[];for(var Uc=0;Uc<256;Uc++)iu.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){iu[e.charCodeAt(0)]=1});function LS(e,r){var t,n=e.pos,i=e.posMax;if(e.src.charCodeAt(n)!==92)return!1;if(n++,n<i){if(t=e.src.charCodeAt(n),t<256&&iu[t]!==0)return r||(e.pending+=e.src[n]),e.pos+=2,!0;if(t===10){for(r||e.push({type:"hardbreak",level:e.level}),n++;n<i&&e.src.charCodeAt(n)===32;)n++;return e.pos=n,!0}}return r||(e.pending+="\\"),e.pos++,!0}function OS(e,r){var t,n,i,s,a,o=e.pos,l=e.src.charCodeAt(o);if(l!==96)return!1;for(t=o,o++,n=e.posMax;o<n&&e.src.charCodeAt(o)===96;)o++;for(i=e.src.slice(t,o),s=a=o;(s=e.src.indexOf("`",a))!==-1;){for(a=s+1;a<n&&e.src.charCodeAt(a)===96;)a++;if(a-s===i.length)return r||e.push({type:"code",content:e.src.slice(o,s).replace(/[ \n]+/g," ").trim(),block:!1,level:e.level}),e.pos=a,!0}return r||(e.pending+=i),e.pos+=i.length,!0}function RS(e,r){var t,n,i,s=e.posMax,a=e.pos,o,l;if(e.src.charCodeAt(a)!==126||r||a+4>=s||e.src.charCodeAt(a+1)!==126||e.level>=e.options.maxNesting||(o=a>0?e.src.charCodeAt(a-1):-1,l=e.src.charCodeAt(a+2),o===126)||l===126||l===32||l===10)return!1;for(n=a+2;n<s&&e.src.charCodeAt(n)===126;)n++;if(n>a+3)return e.pos+=n-a,r||(e.pending+=e.src.slice(a,n)),!0;for(e.pos=a+2,i=1;e.pos+1<s;){if(e.src.charCodeAt(e.pos)===126&&e.src.charCodeAt(e.pos+1)===126&&(o=e.src.charCodeAt(e.pos-1),l=e.pos+2<s?e.src.charCodeAt(e.pos+2):-1,l!==126&&o!==126&&(o!==32&&o!==10?i--:l!==32&&l!==10&&i++,i<=0))){t=!0;break}e.parser.skipToken(e)}return t?(e.posMax=e.pos,e.pos=a+2,r||(e.push({type:"del_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"del_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=s,!0):(e.pos=a,!1)}function PS(e,r){var t,n,i,s=e.posMax,a=e.pos,o,l;if(e.src.charCodeAt(a)!==43||r||a+4>=s||e.src.charCodeAt(a+1)!==43||e.level>=e.options.maxNesting||(o=a>0?e.src.charCodeAt(a-1):-1,l=e.src.charCodeAt(a+2),o===43)||l===43||l===32||l===10)return!1;for(n=a+2;n<s&&e.src.charCodeAt(n)===43;)n++;if(n!==a+2)return e.pos+=n-a,r||(e.pending+=e.src.slice(a,n)),!0;for(e.pos=a+2,i=1;e.pos+1<s;){if(e.src.charCodeAt(e.pos)===43&&e.src.charCodeAt(e.pos+1)===43&&(o=e.src.charCodeAt(e.pos-1),l=e.pos+2<s?e.src.charCodeAt(e.pos+2):-1,l!==43&&o!==43&&(o!==32&&o!==10?i--:l!==32&&l!==10&&i++,i<=0))){t=!0;break}e.parser.skipToken(e)}return t?(e.posMax=e.pos,e.pos=a+2,r||(e.push({type:"ins_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"ins_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=s,!0):(e.pos=a,!1)}function NS(e,r){var t,n,i,s=e.posMax,a=e.pos,o,l;if(e.src.charCodeAt(a)!==61||r||a+4>=s||e.src.charCodeAt(a+1)!==61||e.level>=e.options.maxNesting||(o=a>0?e.src.charCodeAt(a-1):-1,l=e.src.charCodeAt(a+2),o===61)||l===61||l===32||l===10)return!1;for(n=a+2;n<s&&e.src.charCodeAt(n)===61;)n++;if(n!==a+2)return e.pos+=n-a,r||(e.pending+=e.src.slice(a,n)),!0;for(e.pos=a+2,i=1;e.pos+1<s;){if(e.src.charCodeAt(e.pos)===61&&e.src.charCodeAt(e.pos+1)===61&&(o=e.src.charCodeAt(e.pos-1),l=e.pos+2<s?e.src.charCodeAt(e.pos+2):-1,l!==61&&o!==61&&(o!==32&&o!==10?i--:l!==32&&l!==10&&i++,i<=0))){t=!0;break}e.parser.skipToken(e)}return t?(e.posMax=e.pos,e.pos=a+2,r||(e.push({type:"mark_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"mark_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=s,!0):(e.pos=a,!1)}function Hc(e){return e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122}function zc(e,r){var t=r,n,i,s,a=!0,o=!0,l=e.posMax,u=e.src.charCodeAt(r);for(n=r>0?e.src.charCodeAt(r-1):-1;t<l&&e.src.charCodeAt(t)===u;)t++;return t>=l&&(a=!1),s=t-r,s>=4?a=o=!1:(i=t<l?e.src.charCodeAt(t):-1,(i===32||i===10)&&(a=!1),(n===32||n===10)&&(o=!1),u===95&&(Hc(n)&&(a=!1),Hc(i)&&(o=!1))),{can_open:a,can_close:o,delims:s}}function BS(e,r){var t,n,i,s,a,o,l,u=e.posMax,c=e.pos,d=e.src.charCodeAt(c);if(d!==95&&d!==42||r)return!1;if(l=zc(e,c),t=l.delims,!l.can_open)return e.pos+=t,r||(e.pending+=e.src.slice(c,e.pos)),!0;if(e.level>=e.options.maxNesting)return!1;for(e.pos=c+t,o=[t];e.pos<u;){if(e.src.charCodeAt(e.pos)===d){if(l=zc(e,e.pos),n=l.delims,l.can_close){for(s=o.pop(),a=n;s!==a;){if(a<s){o.push(s-a);break}if(a-=s,o.length===0)break;e.pos+=s,s=o.pop()}if(o.length===0){t=s,i=!0;break}e.pos+=n;continue}l.can_open&&o.push(n),e.pos+=n;continue}e.parser.skipToken(e)}return i?(e.posMax=e.pos,e.pos=c+t,r||((t===2||t===3)&&e.push({type:"strong_open",level:e.level++}),(t===1||t===3)&&e.push({type:"em_open",level:e.level++}),e.parser.tokenize(e),(t===1||t===3)&&e.push({type:"em_close",level:--e.level}),(t===2||t===3)&&e.push({type:"strong_close",level:--e.level})),e.pos=e.posMax+t,e.posMax=u,!0):(e.pos=c,!1)}var FS=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function DS(e,r){var t,n,i=e.posMax,s=e.pos;if(e.src.charCodeAt(s)!==126||r||s+2>=i||e.level>=e.options.maxNesting)return!1;for(e.pos=s+1;e.pos<i;){if(e.src.charCodeAt(e.pos)===126){t=!0;break}e.parser.skipToken(e)}return!t||s+1===e.pos||(n=e.src.slice(s+1,e.pos),n.match(/(^|[^\\])(\\\\)*\s/))?(e.pos=s,!1):(e.posMax=e.pos,e.pos=s+1,r||e.push({type:"sub",level:e.level,content:n.replace(FS,"$1")}),e.pos=e.posMax+1,e.posMax=i,!0)}var $S=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function jS(e,r){var t,n,i=e.posMax,s=e.pos;if(e.src.charCodeAt(s)!==94||r||s+2>=i||e.level>=e.options.maxNesting)return!1;for(e.pos=s+1;e.pos<i;){if(e.src.charCodeAt(e.pos)===94){t=!0;break}e.parser.skipToken(e)}return!t||s+1===e.pos||(n=e.src.slice(s+1,e.pos),n.match(/(^|[^\\])(\\\\)*\s/))?(e.pos=s,!1):(e.posMax=e.pos,e.pos=s+1,r||e.push({type:"sup",level:e.level,content:n.replace($S,"$1")}),e.pos=e.posMax+1,e.posMax=i,!0)}function US(e,r){var t,n,i,s,a,o,l,u,c=!1,d=e.pos,f=e.posMax,h=e.pos,p=e.src.charCodeAt(h);if(p===33&&(c=!0,p=e.src.charCodeAt(++h)),p!==91||e.level>=e.options.maxNesting||(t=h+1,n=Wi(e,h),n<0))return!1;if(o=n+1,o<f&&e.src.charCodeAt(o)===40){for(o++;o<f&&(u=e.src.charCodeAt(o),!(u!==32&&u!==10));o++);if(o>=f)return!1;for(h=o,Xh(e,o)?(s=e.linkContent,o=e.pos):s="",h=o;o<f&&(u=e.src.charCodeAt(o),!(u!==32&&u!==10));o++);if(o<f&&h!==o&&Yh(e,o))for(a=e.linkContent,o=e.pos;o<f&&(u=e.src.charCodeAt(o),!(u!==32&&u!==10));o++);else a="";if(o>=f||e.src.charCodeAt(o)!==41)return e.pos=d,!1;o++}else{if(e.linkLevel>0)return!1;for(;o<f&&(u=e.src.charCodeAt(o),!(u!==32&&u!==10));o++);if(o<f&&e.src.charCodeAt(o)===91&&(h=o+1,o=Wi(e,o),o>=0?i=e.src.slice(h,o++):o=h-1),i||(Q(i)>"u"&&(o=n+1),i=e.src.slice(t,n)),l=e.env.references[Zh(i)],!l)return e.pos=d,!1;s=l.href,a=l.title}return r||(e.pos=t,e.posMax=n,c?e.push({type:"image",src:s,title:a,alt:e.src.substr(t,n-t),level:e.level}):(e.push({type:"link_open",href:s,title:a,level:e.level++}),e.linkLevel++,e.parser.tokenize(e),e.linkLevel--,e.push({type:"link_close",level:--e.level}))),e.pos=o,e.posMax=f,!0}function HS(e,r){var t,n,i,s,a=e.posMax,o=e.pos;return o+2>=a||e.src.charCodeAt(o)!==94||e.src.charCodeAt(o+1)!==91||e.level>=e.options.maxNesting||(t=o+2,n=Wi(e,o+1),n<0)?!1:(r||(e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.list||(e.env.footnotes.list=[]),i=e.env.footnotes.list.length,e.pos=t,e.posMax=n,e.push({type:"footnote_ref",id:i,level:e.level}),e.linkLevel++,s=e.tokens.length,e.parser.tokenize(e),e.env.footnotes.list[i]={tokens:e.tokens.splice(s)},e.linkLevel--),e.pos=n+1,e.posMax=a,!0)}function zS(e,r){var t,n,i,s,a=e.posMax,o=e.pos;if(o+3>a||!e.env.footnotes||!e.env.footnotes.refs||e.src.charCodeAt(o)!==91||e.src.charCodeAt(o+1)!==94||e.level>=e.options.maxNesting)return!1;for(n=o+2;n<a;n++){if(e.src.charCodeAt(n)===32||e.src.charCodeAt(n)===10)return!1;if(e.src.charCodeAt(n)===93)break}return n===o+2||n>=a||(n++,t=e.src.slice(o+2,n-1),Q(e.env.footnotes.refs[":"+t])>"u")?!1:(r||(e.env.footnotes.list||(e.env.footnotes.list=[]),e.env.footnotes.refs[":"+t]<0?(i=e.env.footnotes.list.length,e.env.footnotes.list[i]={label:t,count:0},e.env.footnotes.refs[":"+t]=i):i=e.env.footnotes.refs[":"+t],s=e.env.footnotes.list[i].count,e.env.footnotes.list[i].count++,e.push({type:"footnote_ref",id:i,subId:s,level:e.level})),e.pos=n,e.posMax=a,!0)}var WS=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"],VS=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,qS=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;function GS(e,r){var t,n,i,s,a,o=e.pos;return e.src.charCodeAt(o)!==60||(t=e.src.slice(o),t.indexOf(">")<0)?!1:(n=t.match(qS),n?WS.indexOf(n[1].toLowerCase())<0||(s=n[0].slice(1,-1),a=Zo(s),!e.parser.validateLink(s))?!1:(r||(e.push({type:"link_open",href:a,level:e.level}),e.push({type:"text",content:s,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=n[0].length,!0):(i=t.match(VS),i?(s=i[0].slice(1,-1),a=Zo("mailto:"+s),e.parser.validateLink(a)?(r||(e.push({type:"link_open",href:a,level:e.level}),e.push({type:"text",content:s,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=i[0].length,!0):!1):!1))}function ya(e,r){return e=e.source,r=r||"",function t(n,i){return n?(i=i.source||i,e=e.replace(n,i),t):new RegExp(e,r)}}var KS=/[a-zA-Z_:][a-zA-Z0-9:._-]*/,JS=/[^"'=<>`\x00-\x20]+/,XS=/'[^']*'/,YS=/"[^"]*"/,ZS=ya(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",JS)("single_quoted",XS)("double_quoted",YS)(),QS=ya(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",KS)("attr_value",ZS)(),ek=ya(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",QS)(),tk=/<\/[A-Za-z][A-Za-z0-9]*\s*>/,nk=/<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->/,rk=/<[?].*?[?]>/,ik=/<![A-Z]+\s+[^>]*>/,sk=/<!\[CDATA\[[\s\S]*?\]\]>/,ak=ya(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",ek)("close_tag",tk)("comment",nk)("processing",rk)("declaration",ik)("cdata",sk)();function ok(e){var r=e|32;return r>=97&&r<=122}function lk(e,r){var t,n,i,s=e.pos;return!e.options.html||(i=e.posMax,e.src.charCodeAt(s)!==60||s+2>=i)||(t=e.src.charCodeAt(s+1),t!==33&&t!==63&&t!==47&&!ok(t))||(n=e.src.slice(s).match(ak),!n)?!1:(r||e.push({type:"htmltag",content:e.src.slice(s,s+n[0].length),level:e.level}),e.pos+=n[0].length,!0)}var uk=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,ck=/^&([a-z][a-z0-9]{1,31});/i;function dk(e,r){var t,n,i,s=e.pos,a=e.posMax;if(e.src.charCodeAt(s)!==38)return!1;if(s+1<a){if(t=e.src.charCodeAt(s+1),t===35){if(i=e.src.slice(s).match(uk),i)return r||(n=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),e.pending+=Kh(n)?Yo(n):Yo(65533)),e.pos+=i[0].length,!0}else if(i=e.src.slice(s).match(ck),i){var o=qh(i[1]);if(i[1]!==o)return r||(e.pending+=o),e.pos+=i[0].length,!0}}return r||(e.pending+="&"),e.pos++,!0}var yo=[["text",xS],["newline",IS],["escape",LS],["backticks",OS],["del",RS],["ins",PS],["mark",NS],["emphasis",BS],["sub",DS],["sup",jS],["links",US],["footnote_inline",HS],["footnote_ref",zS],["autolink",GS],["htmltag",lk],["entity",dk]];function ba(){this.ruler=new Pt;for(var e=0;e<yo.length;e++)this.ruler.push(yo[e][0],yo[e][1]);this.validateLink=fk}ba.prototype.skipToken=function(e){var r=this.ruler.getRules(""),t=r.length,n=e.pos,i,s;if((s=e.cacheGet(n))>0){e.pos=s;return}for(i=0;i<t;i++)if(r[i](e,!0)){e.cacheSet(n,e.pos);return}e.pos++,e.cacheSet(n,e.pos)};ba.prototype.tokenize=function(e){for(var r=this.ruler.getRules(""),t=r.length,n=e.posMax,i,s;e.pos<n;){for(s=0;s<t&&(i=r[s](e,!1),!i);s++);if(i){if(e.pos>=n)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};ba.prototype.parse=function(e,r,t,n){var i=new fr(e,this,r,t,n);this.tokenize(i)};function fk(e){var r=["vbscript","javascript","file","data"],t=e.trim().toLowerCase();return t=lr(t),!(t.indexOf(":")!==-1&&r.indexOf(t.split(":")[0])!==-1)}var hk={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","smartquotes","references","abbr2","footnote_tail"]},block:{rules:["blockquote","code","fences","footnote","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","footnote_ref","htmltag","links","newline","text"]}}},pk={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}},mk={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}},vk={default:hk,full:pk,commonmark:mk};function tp(e,r,t){this.src=r,this.env=t,this.options=e.options,this.tokens=[],this.inlineMode=!1,this.inline=e.inline,this.block=e.block,this.renderer=e.renderer,this.typographer=e.typographer}function en(e,r){typeof e!="string"&&(r=e,e="default"),r&&r.linkify!=null&&console.warn(`linkify option is removed. Use linkify plugin instead:

import Remarkable from 'remarkable';
import linkify from 'remarkable/linkify';
new Remarkable().use(linkify)
`),this.inline=new ba,this.block=new ru,this.core=new Qh,this.renderer=new nu,this.ruler=new Pt,this.options={},this.configure(vk[e]),this.set(r||{})}en.prototype.set=function(e){Gh(this.options,e)};en.prototype.configure=function(e){var r=this;if(!e)throw new Error("Wrong `remarkable` preset, check name/content");e.options&&r.set(e.options),e.components&&Object.keys(e.components).forEach(function(t){e.components[t].rules&&r[t].ruler.enable(e.components[t].rules,!0)})};en.prototype.use=function(e,r){return e(this,r),this};en.prototype.parse=function(e,r){var t=new tp(this,e,r);return this.core.process(t),t.tokens};en.prototype.render=function(e,r){return r=r||{},this.renderer.render(this.parse(e,r),this.options,r)};en.prototype.parseInline=function(e,r){var t=new tp(this,e,r);return t.inlineMode=!0,this.core.process(t),t.tokens};en.prototype.renderInline=function(e,r){return r=r||{},this.renderer.render(this.parseInline(e,r),this.options,r)};var np=function(){function e(){T(this,e)}return A(e,null,[{key:"instantiate",value:function(t){if(t)return new en(ke(ke({},e.DEFAULT_PROPERTIES),t));if(window.hljs){var n=window.hljs;return new en({highlight:function(s,a){if(a&&n.getLanguage(a))try{return n.highlight(s,{language:a}).value}catch{console.error("failed to setup the highlight dependency")}try{return n.highlightAuto(s).value}catch{console.error("failed to automatically highlight messages")}return""},html:!1,xhtmlOut:!1,breaks:!0,langPrefix:"language-",linkTarget:"_blank",typographer:!0})}else return new en(e.DEFAULT_PROPERTIES)}},{key:"createNew",value:function(t){var n=e.instantiate(t);return n.inline.validateLink=function(){return!0},n}}])}();np.DEFAULT_PROPERTIES={breaks:!0,linkTarget:"_blank"};var Qo=np,gk=function(){function e(r){T(this,e),this.storageKey="deep-chat-storage",this.maxMessages=1e3,Q(r)=="object"&&(r.key&&(this.storageKey=r.key),r.maxMessages&&(this.maxMessages=r.maxMessages),r.clear=this.clear.bind(this))}return A(e,[{key:"get",value:function(){var t=localStorage.getItem(this.storageKey);return t?JSON.parse(t):[]}},{key:"addMessages",value:function(t){var n=t.length-this.maxMessages;n<0&&(n=0);var i=t.slice(n,t.length);localStorage.setItem(this.storageKey,JSON.stringify(i))}},{key:"clear",value:function(){localStorage.removeItem(this.storageKey)}}])}(),_s=function(){function e(){T(this,e)}return A(e,null,[{key:"applyCustomStylesToElements",value:function(t,n,i){if(i&&(Object.assign(t.outerContainer.style,i.outerContainer),Object.assign(t.innerContainer.style,i.innerContainer),Object.assign(t.bubbleElement.style,i.bubble),n)){var s=t.bubbleElement.children[0],a=s.tagName.toLocaleLowerCase()!=="a"?s:s.children[0];Object.assign(a.style,i.media)}}},{key:"applySideStyles",value:function(t,n,i,s){s&&(e.applyCustomStylesToElements(t,i,s.shared),n===ie.USER_ROLE?e.applyCustomStylesToElements(t,i,s.user):(e.applyCustomStylesToElements(t,i,s.ai),e.applyCustomStylesToElements(t,i,s[n])))}},{key:"isElementsStyles",value:function(t){return!!(t.outerContainer||t.innerContainer||t.bubble||t.media)}},{key:"applyCustomStyles",value:function(t,n,i,s,a){var o;a&&t.default!==a?e.isElementsStyles(a)?(e.applyCustomStylesToElements(n,s,(o=t.default)==null?void 0:o.shared),e.applyCustomStylesToElements(n,s,a)):(e.applySideStyles(n,i,s,t.default),e.applySideStyles(n,i,s,a)):e.applySideStyles(n,i,s,t.default)}},{key:"extractParticularSharedStyles",value:function(t,n){if(n!=null&&n.shared){var i=n.shared,s={outerContainer:{},innerContainer:{},bubble:{},media:{}};return t.forEach(function(a){var o,l,u,c;s.outerContainer[a]=((o=i.outerContainer)==null?void 0:o[a])||"",s.innerContainer[a]=((l=i.innerContainer)==null?void 0:l[a])||"",s.bubble[a]=((u=i.bubble)==null?void 0:u[a])||"",s.media[a]=((c=i.media)==null?void 0:c[a])||""}),s}}}])}(),Vi=function(){function e(){T(this,e)}return A(e,null,[{key:"onMessage",value:function(t,n,i){var s,a=JSON.parse(JSON.stringify({message:n,isHistory:i,isInitial:i}));Et.reAddFileRefToObject(n,a.message),(s=t.onMessage)==null||s.call(t,a),t.dispatchEvent(new CustomEvent("message",{detail:a})),xt.fireOnNewMessage(t,a)}},{key:"onClearMessages",value:function(t){var n;(n=t.onClearMessages)==null||n.call(t),t.dispatchEvent(new CustomEvent("clear-messages"))}},{key:"onRender",value:function(t){var n;(n=t.onComponentRender)==null||n.call(t,t),t.dispatchEvent(new CustomEvent("render",{detail:t}))}},{key:"onInput",value:function(t,n,i){var s,a,o=JSON.parse(JSON.stringify({content:n,isUser:i}));n.files&&Et.reAddFileRefToObject({files:(s=n.files)==null?void 0:s.map(function(l){return{ref:l}})},o.content),(a=t.onInput)==null||a.call(t,o),t.dispatchEvent(new CustomEvent("input",{detail:o}))}},{key:"onError",value:function(t,n){var i;(i=t.onError)==null||i.call(t,n),t.dispatchEvent(new CustomEvent("error",{detail:n}))}}])}(),Es=function(){function e(){T(this,e)}return A(e,null,[{key:"generateLoadingRingElement",value:function(){var t=document.createElement("div");return t.classList.add("loading-history"),t.appendChild(document.createElement("div")),t.appendChild(document.createElement("div")),t.appendChild(document.createElement("div")),t.appendChild(document.createElement("div")),t}},{key:"apply",value:function(t,n,i){Qn.setRing(n.bubbleElement,i?.bubble),i!=null&&i.bubble&&(i=JSON.parse(JSON.stringify(i)),delete i.bubble),t.applyCustomStyles(n,"history",!1,i)}},{key:"addLoadHistoryMessage",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s,a,o,l,u,c,d,f;t.bubbleElement.classList.add(e.CLASS);var h=i?e.FULL_VIEW_CLASS:e.SMALL_CLASS;t.outerContainer.classList.add(h);var p=i?(l=(o=(a=(s=n.messageStyles)==null?void 0:s.loading)==null?void 0:a.history)==null?void 0:o.full)==null?void 0:l.styles:(f=(d=(c=(u=n.messageStyles)==null?void 0:u.loading)==null?void 0:c.history)==null?void 0:d.small)==null?void 0:f.styles;e.apply(n,t,p),n.elementRef.prepend(t.outerContainer)}},{key:"createDefaultElements",value:function(t){var n=t.createMessageElements("",ie.AI_ROLE),i=n.bubbleElement,s=e.generateLoadingRingElement();return i.appendChild(s),n}},{key:"addMessage",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i,s,a,o,l=(o=(a=(s=(i=t.messageStyles)==null?void 0:i.loading)==null?void 0:s.history)==null?void 0:a.full)==null?void 0:o.html,u=l?$n.createElements(t,l,ie.AI_ROLE,!0,!0):e.createDefaultElements(t);return e.addLoadHistoryMessage(u,t,n),ie.softRemRoleElements(u.innerContainer,t.avatar,t.name),u}},{key:"tryChangeViewToSmall",value:function(t,n){var i,s,a,o,l,u,c,d;if(n!=null&&n.outerContainer.classList.contains(e.FULL_VIEW_CLASS)){n.outerContainer.classList.replace(e.FULL_VIEW_CLASS,e.SMALL_CLASS);var f=(o=(a=(s=(i=t.messageStyles)==null?void 0:i.loading)==null?void 0:s.history)==null?void 0:a.small)==null?void 0:o.styles;f&&e.apply(t,n,f);var h=(d=(c=(u=(l=t.messageStyles)==null?void 0:l.loading)==null?void 0:u.history)==null?void 0:c.small)==null?void 0:d.html;return h&&(n.bubbleElement.innerHTML=h),!0}return!1}},{key:"changeFullViewToSmall",value:function(t){var n=t.messageElementRefs[t.messageElementRefs.length-1];e.tryChangeViewToSmall(t,n)||e.tryChangeViewToSmall(t,t.messageElementRefs[0])}}])}();Es.CLASS="loading-history-message",Es.FULL_VIEW_CLASS="loading-history-message-full-view",Es.SMALL_CLASS="loading-history-message-small";var ir=Es,rp=function(){function e(){T(this,e)}return A(e,null,[{key:"setFade",value:function(t,n){t.style.transitionDuration=typeof n=="number"?"".concat(n,"ms"):"".concat(e.DEFAULT_FADE_MS,"ms")}},{key:"fadeAnimation",value:function(){var r=O(g().mark(function n(i,s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return i.style.opacity="0",a=typeof s=="number"?s:e.DEFAULT_FADE_MS,l.next=4,new Promise(function(u){setTimeout(function(){return u()},a)});case 4:i.style.opacity="1";case 5:case"end":return l.stop()}},n)}));function t(n,i){return r.apply(this,arguments)}return t}()}])}();rp.DEFAULT_FADE_MS=500;var ip=rp,Wc="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='iso-8859-1'?%3e%3csvg%20fill='%23000000'%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%2032%2032'%20xml:space='preserve'%3e%3cpath%20d='M23,30.36H9c-2.404,0-4.36-1.956-4.36-4.36V15c0-2.404,1.956-4.36,4.36-4.36h3.659%20c0.167-1.566,1.415-2.813,2.981-2.981V5.333c-1.131-0.174-2-1.154-2-2.333c0-1.301,1.059-2.36,2.36-2.36%20c1.302,0,2.36,1.059,2.36,2.36c0,1.179-0.869,2.159-2,2.333V7.66c1.566,0.167,2.814,1.415,2.981,2.981H23%20c2.404,0,4.36,1.956,4.36,4.36v11C27.36,28.404,25.404,30.36,23,30.36z%20M9,11.36c-2.007,0-3.64,1.633-3.64,3.64v11%20c0,2.007,1.633,3.64,3.64,3.64h14c2.007,0,3.64-1.633,3.64-3.64V15c0-2.007-1.633-3.64-3.64-3.64H9z%20M13.384,10.64h5.231%20C18.439,9.354,17.334,8.36,16,8.36C14.667,8.36,13.561,9.354,13.384,10.64z%20M16,1.36c-0.904,0-1.64,0.736-1.64,1.64%20S15.096,4.64,16,4.64c0.904,0,1.64-0.736,1.64-1.64S16.904,1.36,16,1.36z%20M20,27.36h-8c-1.301,0-2.36-1.059-2.36-2.36%20s1.059-2.36,2.36-2.36h8c1.302,0,2.36,1.059,2.36,2.36S21.302,27.36,20,27.36z%20M12,23.36c-0.904,0-1.64,0.735-1.64,1.64%20s0.736,1.64,1.64,1.64h8c0.904,0,1.64-0.735,1.64-1.64s-0.735-1.64-1.64-1.64H12z%20M31,23.86h-2c-0.199,0-0.36-0.161-0.36-0.36V15%20c0-0.199,0.161-0.36,0.36-0.36h2c0.199,0,0.36,0.161,0.36,0.36v8.5C31.36,23.699,31.199,23.86,31,23.86z%20M29.36,23.14h1.279v-7.78%20H29.36V23.14z%20M3,23.86H1c-0.199,0-0.36-0.161-0.36-0.36V15c0-0.199,0.161-0.36,0.36-0.36h2c0.199,0,0.36,0.161,0.36,0.36v8.5%20C3.36,23.699,3.199,23.86,3,23.86z%20M1.36,23.14h1.28v-7.78H1.36V23.14z%20M20,20.36c-1.302,0-2.36-1.059-2.36-2.36%20s1.059-2.36,2.36-2.36s2.36,1.059,2.36,2.36C22.36,19.302,21.302,20.36,20,20.36z%20M20,16.36c-0.904,0-1.64,0.736-1.64,1.64%20s0.735,1.64,1.64,1.64s1.64-0.735,1.64-1.64S20.904,16.36,20,16.36z%20M12,20.36c-1.301,0-2.36-1.059-2.36-2.36s1.059-2.36,2.36-2.36%20s2.36,1.059,2.36,2.36C14.36,19.302,13.301,20.36,12,20.36z%20M12,16.36c-0.904,0-1.64,0.736-1.64,1.64s0.736,1.64,1.64,1.64%20s1.64-0.735,1.64-1.64S12.904,16.36,12,16.36z'/%3e%3crect%20style='fill:none;'%20width='32'%20height='32'/%3e%3c/svg%3e",el="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAMAAAC/MqoPAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAADNQTFRF////9vX18vLy/Pz86enp4+Li2tnZ1tbWzczM+fn57Ozs4N/f09LS0M/P5uXl7+/v3dzcwtncCAAAAAFiS0dEAIgFHUgAAAAJcEhZcwAAAEgAAABIAEbJaz4AAAZNSURBVHja7d3bdtsqEABQYABZSLH9/3+ZpnUsIcF5iOM6PfElNoMHMfPQdq3GmL0GkLhEUqLaUExnOtOZznSmM53pTGc605nOdKYznelMZzrTmV4LXSqllKyJDkob26xWq8Zae/iH0QoWTm9d1xur4WuypQJtTd+5dqn0VjcxzNO5/57mEBvdLo8Oron6aseWOjYOFkVvjQs3DmgyONMuht52EfztP+4hdu0i6LCO808/M8c1lE/fuPGej41uUzgdtoO/75N+2ELJ9I3b3//hPXbiMenm3pR/Jt4USgcLBIp4Bh10gqKVhvLo0klCxeSky96nKcj3siw6pJIL4XsoiQ7apyvMY/V3HHrSRioLopvEhSpTCn2TPEuwKYMOIX0tAxRBf/Hpa+lfSqBv9gi1FPsNfTrMAiVmIE/vJhz61FGnQxRIEYE4vfNYdN8Rp6MlHaHotHTn8ejekaZPAjEmyvQWdZFTtYTpXqCGJ0zvcek9Yfoel76nS0ffv1NMp1ca+pkgyfRCGind4L7OWWc605l+cxjsyhqy9AGbPpClc1/nvl5VX0c/3Alk6RU3+Am7shNZ+h6bvidLr7jBB+zKBrL0irOOudmIUDzTmf5gIP+iEuXtRuTVaEmY/oZLfyNMrzjryPc0gerMTdpVg0tvjJUU6bLPcGOoUv46SLL6Wi8yhLf06C7TUyekI0efRaaYqdFltkeNpPumRPSMDxgBYvSM035FrKAmH72hRW99PrpvSdEHkTEGUvSsK3yKVDkuJ92RohcZaehzzirPpOg+J92Tolfc4Cumx5xVXpGiZ34+ICX6W84qv5GiR5NPbiIpOv6BCoSvSkTX+eiaGP092zINvBOj4x8mSf9FqejvNo/cvpOji19ZbmviL0GPLsYMFzgzCor0+Bv/ePDvSJKOb9dJ5UlnbnEHiHgzv6cdTpJOWuc/u3FEucLDOL75xGtBiefrcwgoC9NDSH/jkH6pAuXmBqPQ9HSUPVdZBH1GGOrMXAQdYxcKZfxAoK+KKBKFLosoEoX+u4giUehz8jlcnAuhp78I46yDYNAd+QLR6K+pr+yvxdBTHyVDubQh0UfSxaHSd0lbvNkVRE87JGOtc+PQd2QLQ6fHhJkKsSh6yg13tO08JPprsgrrXWH0dJd2vH1MLPprot4eXoujpzrdhngiD40ek2y92lggPcnWa8qN1Yz0BFuvZhRl0uOfR0v4Ewuli/Bg4Qr3lArqGdndQ3UPO1EunXYwnelMZzrTmc50pjOd6UxnOtOZznSmM53pTGf6kuj6oedFKV0s3fX6sX1S3bsi6a4PD7+/YAqYeBw6pIB/4qEgOqxdSPbGiim4NRRCbzs3Jj0L4UfXtQXQVRfn5IdA/Bw7RZzurEV6EtdsLeGXkIPuA+K1UoVeA0l62zmN/LqfSSft9KkepmoRuvi3nd5uKNFB9zbbXEANqdr941XO0NJx2v2jdJenpf+/3bvn0ts16ph+sd6hX7dPo2+2cZzE02Ia43bzDHqr+2Evnhz74ZHU30ffbKOeng1/NPV30Ns1gYQnSP2P6e65Pfxc6h02XZqXQCjhJ6kPL6bFo4NrGvAU4UII4SE2P1vQuZkuOxckVfehisF1MjUddN/MZBN+kvq5uf0O/xa66gyNS9ktMWlz44rO1Z8C19i5FPdHzPamXn+F3hryPfxMr78+4F+kq22kO6Rf6fUQt+puuustyWv4rbG3l/duztFB96GYoe1cTBdXMr+nw9qVM6ZfxOvzezff0nXi/ZOndvrR6Zvpm0c3h6nhdb+5iS7tsIim/qXZD9+97/Jf+rpZ5BET1ayv0GUzLhEuhBBjIy/RdVPgndutIRt9nt7p5cKFEEJ3Z+jQFDZL+XnMDXxHB73gxn5s9Kc3d3/pFciFkN/QTSXHJpX5l66gDrkQoP6hL3xsPw39la4qOiV8tH78XeSbue6N9mvWa6J/ybpc1CT1Wnh5Qq9meP8IOKH3ddH7E/ri1iYux/SXDrXR4UiPdck/wUpU+FtPf6/orja6O9KL3l56LOvVxe5Ib2qjN0d6Vbex4ghWlU3bPqI90If66MNng680FNpbJijH6kCvaF3uMzQ3+IrpFerV4Y9dffQdN3im10ivbuImhD3Qq5u4HdZkua8znelMZ/pS4z9CPVKkxowNxgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0wMy0yN1QxNTo0NToxNSswMDowMN1xSg4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMDMtMjdUMTU6NDU6MTUrMDA6MDCsLPKyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAABJRU5ErkJggg==",sp=function(){function e(r){T(this,e),this.className=r}return A(e,[{key:"tryHide",value:function(t){var n;(n=t.getElementsByClassName(this.className)[0].style).visibility||(n.visibility="hidden")}},{key:"tryReveal",value:function(t){t.getElementsByClassName(this.className)[0].style.visibility=""}},{key:"trySoftRem",value:function(t){t.getElementsByClassName(this.className)[0].classList.add("role-hidden")}}])}(),yk=function(e){function r(t){var n;return T(this,r),n=le(this,r,["avatar-container"]),n._avatars=t,n}return ue(r,e),A(r,[{key:"addBesideMsg",value:function(n,i){var s=typeof this._avatars=="boolean"?void 0:this._avatars,a=this.createAvatar(i,s),o=this.getPosition(i,s);a.classList.add(o==="left"?"left-item-position":"right-item-position"),n.insertAdjacentElement(o==="left"?"beforebegin":"afterend",a)}},{key:"createAvatar",value:function(n,i){var s,a,o,l,u,c=document.createElement("img");n===ie.USER_ROLE?(c.src=((s=i?.user)==null?void 0:s.src)||((a=i?.default)==null?void 0:a.src)||el,c.onerror=r.errorFallback.bind(this,el)):(c.src=((o=i?.[n])==null?void 0:o.src)||((l=i?.ai)==null?void 0:l.src)||((u=i?.default)==null?void 0:u.src)||Wc,c.onerror=r.errorFallback.bind(this,Wc)),c.classList.add("avatar"),c.alt="".concat(n," avatar");var d=document.createElement("div");return d.classList.add(this.className),d.appendChild(c),i&&r.applyCustomStyles(d,c,i,n),d}},{key:"getPosition",value:function(n,i){var s,a,o,l,u,c,d=(a=(s=i?.[n])==null?void 0:s.styles)==null?void 0:a.position;return n!==ie.USER_ROLE&&(d??(d=(l=(o=i?.ai)==null?void 0:o.styles)==null?void 0:l.position)),d??(d=(c=(u=i?.default)==null?void 0:u.styles)==null?void 0:c.position),d??(d=n===ie.USER_ROLE?"right":"left"),d}}],[{key:"errorFallback",value:function(n,i){var s=i.target;s.onerror=null,s.src=n}},{key:"applyCustomStylesToElements",value:function(n,i,s){Object.assign(n.style,s.container),Object.assign(i.style,s.avatar)}},{key:"applyCustomStyles",value:function(n,i,s,a){var o,l,u,c;if((o=s.default)!=null&&o.styles&&r.applyCustomStylesToElements(n,i,s.default.styles),a===ie.USER_ROLE)(l=s.user)!=null&&l.styles&&r.applyCustomStylesToElements(n,i,s.user.styles);else{(u=s.ai)!=null&&u.styles&&r.applyCustomStylesToElements(n,i,s.ai.styles);var d=(c=s[a])==null?void 0:c.styles;d&&r.applyCustomStylesToElements(n,i,d)}}}])}(sp),bk=function(e){function r(t){var n;return T(this,r),n=le(this,r,["name"]),n._names=t,n}return ue(r,e),A(r,[{key:"addBesideMsg",value:function(n,i){var s=typeof this._names=="boolean"?{}:this._names,a=this.createName(i,s),o=r.getPosition(i,s);a.classList.add(o==="left"?"left-item-position":"right-item-position"),n.insertAdjacentElement(o==="left"?"beforebegin":"afterend",a)}},{key:"createName",value:function(n,i){var s=document.createElement("div");return s.classList.add(this.className),s.textContent=r.getNameText(n,i),r.applyStyle(s,n,i),s}}],[{key:"getPosition",value:function(n,i){var s,a,o,l=(s=i?.[n])==null?void 0:s.position;return n!==ie.USER_ROLE&&(l??(l=(a=i?.ai)==null?void 0:a.position)),l??(l=(o=i?.default)==null?void 0:o.position),l??(l=n===ie.USER_ROLE?"right":"left"),l}},{key:"applyStyle",value:function(n,i,s){var a,o,l,u;Object.assign(n.style,(a=s.default)==null?void 0:a.style),i===ie.USER_ROLE?Object.assign(n.style,(o=s.user)==null?void 0:o.style):(Object.assign(n.style,(l=s.ai)==null?void 0:l.style),Object.assign(n.style,(u=s[i])==null?void 0:u.style))}},{key:"getNameText",value:function(n,i){var s,a,o,l,u,c;return n===ie.USER_ROLE?((s=i.user)==null?void 0:s.text)||((a=i.default)==null?void 0:a.text)||"User":n===ie.AI_ROLE?((o=i.ai)==null?void 0:o.text)||((l=i.default)==null?void 0:l.text)||"AI":((u=i[n])==null?void 0:u.text)||((c=i.default)==null?void 0:c.text)||n}}])}(sp),ws=function(){function e(r){var t=this;T(this,e);var n;this.messageElementRefs=[],this.htmlClassUtilities={},this.messageToElements=[],this.elementRef=e.createContainerElement(),this.messageStyles=xt.processMessageStyles(r.messageStyles),this._remarkable=Qo.createNew(r.remarkable),r.avatars&&(this.avatar=new yk(r.avatars)),r.names&&(this.name=new bk(r.names)),r.browserStorage&&(this.browserStorage=new gk(r.browserStorage)),this._onMessage=Vi.onMessage.bind(this,r),r.htmlClassUtilities&&(this.htmlClassUtilities=r.htmlClassUtilities),this.focusMode=r.focusMode,this.focusMode||(this._lastGroupMessagesElement=document.createElement("div")),typeof this.focusMode!="boolean"&&(n=this.focusMode)!=null&&n.fade&&ip.setFade(this.elementRef,this.focusMode.fade),setTimeout(function(){t.submitUserMessage=r.submitUserMessage})}return A(e,[{key:"addNewTextMessage",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(i!=null&&i.status){var a=this.overwriteText(n,t,this.messageElementRefs);if(a)return a;i.status=!1}var o=s?this.createAndPrependNewMessageElement(t,n,s):this.createAndAppendNewMessageElement(t,n);return o.bubbleElement.classList.add(e.TEXT_BUBBLE_CLASS),this.applyCustomStyles(o,n,!1),ie.fillEmptyMessageElement(o.bubbleElement,t),o}},{key:"overwriteText",value:function(t,n,i){var s=ie.overwriteMessage(this.messageToElements,i,n,t,"text",e.TEXT_BUBBLE_CLASS);return s&&this.renderText(s.bubbleElement,n),s}},{key:"createAndAppendNewMessageElement",value:function(t,n){return this.focusMode?this.appendNewMessageElementFocusMode(t,n):this.createAndAppendNewMessageElementDefault(t,n)}},{key:"appendNewMessageElementFocusMode",value:function(t,n){var i,s=this.createNewMessageElement(t,n);if(this.appendOuterContainerElemet(s.outerContainer,n),n==="user"){var a=typeof this.focusMode!="boolean"&&((i=this.focusMode)==null?void 0:i.scroll);At.scrollToBottom(this.elementRef,a)}return s}},{key:"createNewGroupElementFocusMode",value:function(){var t;(t=this._lastGroupMessagesElement)==null||t.classList.remove(e.LAST_GROUP_MESSAGES_ACTIVE);var n=document.createElement("div");this._lastGroupMessagesElement&&n.classList.add(e.LAST_GROUP_MESSAGES_ACTIVE),this._lastGroupMessagesElement=n}},{key:"createAndAppendNewMessageElementDefault",value:function(t,n){var i=this,s=this.createNewMessageElement(t,n);return this.appendOuterContainerElemet(s.outerContainer),setTimeout(function(){return At.scrollToBottom(i.elementRef)}),s}},{key:"appendOuterContainerElemet",value:function(t,n){var i;this.focusMode&&(n==="user"||!this._lastGroupMessagesElement)&&this.createNewGroupElementFocusMode(),(i=this._lastGroupMessagesElement)==null||i.appendChild(t),this.elementRef.appendChild(this._lastGroupMessagesElement)}},{key:"createAndPrependNewMessageElement",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a,o=this.createNewMessageElement(t,n,i,s);if(i&&(a=this.elementRef.firstChild)!=null&&a.classList.contains(e.INTRO_CLASS)){this.elementRef.firstChild.insertAdjacentElement("afterend",o.outerContainer);var l=this.messageElementRefs[0];this.messageElementRefs[0]=this.messageElementRefs[1],this.messageElementRefs[1]=l}else this.elementRef.insertBefore(o.outerContainer,this.elementRef.firstChild);return o}},{key:"createMessageElementsOnOrientation",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return i?this.createAndPrependNewMessageElement(t,n,!0,s):this.createNewMessageElement(t,n,s)}},{key:"createNewMessageElement",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a;s||(a=this._introPanel)==null||a.hide();var o=this.messageElementRefs[this.messageElementRefs.length-1];return ir.changeFullViewToSmall(this),!i&&e.isTemporaryElement(o)&&(this.revealRoleElementsIfTempRemoved(o,n),this.removeLastMessage()),this.createMessageElements(t,n,i)}},{key:"revealRoleElementsIfTempRemoved",value:function(t,n){if((this.avatar||this.name)&&xr.isElementTemporary(t)){var i=this.messageElementRefs[this.messageElementRefs.length-2];i&&this.messageToElements.length>0&&!t.bubbleElement.classList.contains(ie.getRoleClass(n))&&ie.revealRoleElements(i.innerContainer,this.avatar,this.name)}}},{key:"createElements",value:function(t,n){var i=e.createBaseElements(n),s=i.outerContainer,a=i.innerContainer,o=i.bubbleElement;return s.appendChild(a),this.addInnerContainerElements(o,t,n),i}},{key:"createMessageElements",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this.createElements(t,n);return ie.updateRefArr(this.messageElementRefs,s,i),ie.classifyRoleMessages(this.messageElementRefs,n),s}},{key:"addInnerContainerElements",value:function(t,n,i){var s=this.messageElementRefs[this.messageElementRefs.length-1];return ie.areOuterContainerClassRolesSame(i,s)&&!this.isLastMessageError()&&ie.hideRoleElements(s.innerContainer,this.avatar,this.name),t.classList.add("message-bubble",ie.getRoleClass(i),i===ie.USER_ROLE?"user-message-text":"ai-message-text"),this.renderText(t,n),ie.addRoleElements(t,i,this.avatar,this.name),{bubbleElement:t}}},{key:"applyCustomStyles",value:function(t,n,i,s){t&&this.messageStyles&&_s.applyCustomStyles(this.messageStyles,t,n,i,s)}},{key:"removeMessage",value:function(t){t.outerContainer.remove();var n=this.messageElementRefs.findIndex(function(i){return i===t});this.messageElementRefs.splice(n,1)}},{key:"removeLastMessage",value:function(){this.messageElementRefs[this.messageElementRefs.length-1].outerContainer.remove(),this.messageElementRefs.pop()}},{key:"isLastMessageError",value:function(){var t;return(t=ie.getLastMessageBubbleElement(this.elementRef))==null?void 0:t.classList.contains(ie.ERROR_MESSAGE_TEXT_CLASS)}},{key:"sendClientUpdate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i;(i=this._onMessage)==null||i.call(this,t,n)}},{key:"renderText",value:function(t,n){t.innerHTML=this._remarkable.render(n),t.innerText.trim().length===0&&(t.innerText=n)}},{key:"refreshTextMessages",value:function(t){var n=this;this._remarkable=Qo.createNew(t),this.messageToElements.forEach(function(i){i[1].text&&i[0].text&&n.renderText(i[1].text.bubbleElement,i[0].text)})}}],[{key:"createContainerElement",value:function(){var t=document.createElement("div");return t.id="messages",t}},{key:"isTemporaryElement",value:function(t){return e.isLoadingMessage(t)||xr.isElementTemporary(t)}},{key:"createBaseElements",value:function(t){var n=document.createElement("div"),i=document.createElement("div");i.classList.add("inner-message-container"),n.appendChild(i),n.classList.add("outer-message-container"),n.classList.add(ie.buildRoleOuterContainerClass(t));var s=document.createElement("div");return s.classList.add("message-bubble"),i.appendChild(s),{outerContainer:n,innerContainer:i,bubbleElement:s}}},{key:"createMessageContent",value:function(t){var n=t.text,i=t.files,s=t.html,a=t.custom,o=t._sessionId,l=t.role,u={role:l||ie.AI_ROLE};return n&&(u.text=n),i&&(u.files=i),s&&(u.html=s),!n&&!i&&!s&&(u.text=""),a&&(u.custom=a),o&&(u._sessionId=o),u}},{key:"isLoadingMessage",value:function(t){return t?.bubbleElement.classList.contains(Qn.BUBBLE_CLASS)}}])}();ws.TEXT_BUBBLE_CLASS="text-message",ws.INTRO_CLASS="deep-chat-intro",ws.LAST_GROUP_MESSAGES_ACTIVE="deep-chat-last-group-messages-active";var Xt=ws,an=function(){function e(){T(this,e)}return A(e,null,[{key:"getLastElementsByClass",value:function(t,n,i){for(var s=function(){var u=t[o];if(u.bubbleElement.classList.contains(n[0])&&!n.slice(1).find(function(c){return!u.bubbleElement.classList.contains(c)}))if(i){if(!i.find(function(c){return u.bubbleElement.classList.contains(c)}))return{v:u}}else return{v:u}},a,o=t.length-1;o>=0;o-=1)if(a=s(),a)return a.v}},{key:"getLastMessage",value:function(t,n,i){for(var s=t.length-1;s>=0;s-=1)if(t[s][0].role===n)if(i){if(t[s][0][i])return t[s][0]}else return t[s][0]}},{key:"getLastTextToElement",value:function(t,n){for(var i=t.length-1;i>=0;i-=1)if(t[i][0]===n)return t[i]}},{key:"overwriteMessage",value:function(t,n,i,s,a,o){var l=e.getLastElementsByClass(n,[e.getRoleClass(s),o],[Qn.BUBBLE_CLASS]),u=e.getLastMessage(t,s,a);return u&&(u[a]=i),l}},{key:"getRoleClass",value:function(t){return"".concat(t,"-message")}},{key:"fillEmptyMessageElement",value:function(t,n){n.trim().length===0&&(t.classList.add(e.EMPTY_MESSAGE_CLASS),t.innerHTML='<div style="color:#00000000">.</div>')}},{key:"unfillEmptyMessageElement",value:function(t,n){t.classList.contains(e.EMPTY_MESSAGE_CLASS)&&n.trim().length>0&&t.replaceChildren()}},{key:"getLastMessageBubbleElement",value:function(t){var n,i,s,a;return(a=Array.from(((s=(i=(n=e.getLastMessageElement(t))==null?void 0:n.children)==null?void 0:i[0])==null?void 0:s.children)||[]).map(function(o){return Array.from(o?.children||[]).find(function(l){return l.classList.contains("message-bubble")})}))==null?void 0:a[0]}},{key:"getLastMessageElement",value:function(t){return t.children[t.children.length-1]}},{key:"addRoleElements",value:function(t,n,i,s){i?.addBesideMsg(t,n),s?.addBesideMsg(t,n)}},{key:"hideRoleElements",value:function(t,n,i){n?.tryHide(t),i?.tryHide(t)}},{key:"revealRoleElements",value:function(t,n,i){n?.tryReveal(t),i?.tryReveal(t)}},{key:"softRemRoleElements",value:function(t,n,i){n?.trySoftRem(t),i?.trySoftRem(t)}},{key:"updateRefArr",value:function(t,n,i){i?t.unshift(n):t.push(n)}},{key:"buildRoleOuterContainerClass",value:function(t){return"".concat(e.OUTER_CONTAINER_CLASS_ROLE_PREFIX).concat(t)}},{key:"addNewPositionClasses",value:function(t,n){var i;t.outerContainer.classList.remove(e.POSITION_TOP_MESSAGE_CLASS,e.POSITION_MIDDLE_MESSAGE_CLASS,e.POSITION_BOTTOM_MESSAGE_CLASS),(i=t.outerContainer.classList).add.apply(i,Zi(n))}},{key:"getNumberOfElements",value:function(t){var n=0;return t.text!==void 0&&(n+=1),t.html!==void 0&&(n+=1),t.files&&(n+=t.files.length),n}},{key:"filterdMessageElements",value:function(t,n){return t.filter(function(i){return i.bubbleElement.classList.contains(n)})}},{key:"findMessageElements",value:function(t,n){return t.find(function(i){return i.bubbleElement.classList.contains(n)})}},{key:"generateMessageBodyElements",value:function(t,n){var i={};return t.text&&(i.text=e.findMessageElements(n,Xt.TEXT_BUBBLE_CLASS)),t.html&&(i.html=e.findMessageElements(n,$n.HTML_BUBBLE_CLASS)),t.files&&(i.files=e.filterdMessageElements(n,Et.FILE_BUBBLE_CLASS)),i}},{key:"generateMessageBody",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=e.getNumberOfElements(t),a=i?n.slice(0,s):n.slice(n.length-s);return e.generateMessageBodyElements(t,a)}},{key:"classifyRoleMessages",value:function(t,n){for(var i=n?e.buildRoleOuterContainerClass(n):void 0,s=t.length-1;s>=0;s-=1)if(n||(i=Array.from(t[s].outerContainer.classList).find(function(f){return f.startsWith(e.OUTER_CONTAINER_CLASS_ROLE_PREFIX)})),!!i){var a=t[s],o=a.outerContainer.classList.contains(i),l=t[s-1],u=t[s+1],c=l?.outerContainer.classList.contains(i),d=u?.outerContainer.classList.contains(i);if(o)!c&&d?e.addNewPositionClasses(a,[e.POSITION_TOP_MESSAGE_CLASS]):c&&d?e.addNewPositionClasses(a,[e.POSITION_MIDDLE_MESSAGE_CLASS]):c&&!d?e.addNewPositionClasses(a,[e.POSITION_BOTTOM_MESSAGE_CLASS]):!c&&!d&&e.addNewPositionClasses(a,[e.POSITION_TOP_MESSAGE_CLASS,e.POSITION_BOTTOM_MESSAGE_CLASS]);else if(n)break}}},{key:"areOuterContainerClassRolesSame",value:function(t,n){return n?Array.from(n.outerContainer.classList).find(function(i){return i.startsWith(e.OUTER_CONTAINER_CLASS_ROLE_PREFIX)})===e.buildRoleOuterContainerClass(t):!1}},{key:"resetAllRoleElements",value:function(t,n,i){if(!(!n&&!i)){var s="";t.forEach(function(a,o){a.bubbleElement.classList.contains(e.ERROR_MESSAGE_TEXT_CLASS)||e.revealRoleElements(a.innerContainer,n,i);var l=Array.from(a.outerContainer.classList).find(function(u){return u.startsWith(e.OUTER_CONTAINER_CLASS_ROLE_PREFIX)});s===l&&e.hideRoleElements(t[o-1].innerContainer,n,i),s=l})}}},{key:"deepCloneMessagesWithReferences",value:function(t){return t.map(function(n){return e.processMessageContent(n)})}},{key:"processMessageContent",value:function(t){if(t==null||Q(t)!="object")return t;if(Array.isArray(t))return t.map(function(i){return e.processMessageContent(i)});var n={};return Object.entries(t).forEach(function(i){var s=or(i,2),a=s[0],o=s[1];a==="ref"&&o instanceof File||a==="custom"?n[a]=o:o!==null&&Q(o)=="object"?n[a]=e.processMessageContent(o):n[a]=o}),n}}])}();an.AI_ROLE="ai",an.USER_ROLE="user",an.ERROR_MESSAGE_TEXT_CLASS="error-message-text",an.OUTER_CONTAINER_CLASS_ROLE_PREFIX="deep-chat-outer-container-role-",an.EMPTY_MESSAGE_CLASS="empty-message",an.POSITION_TOP_MESSAGE_CLASS="deep-chat-top-message",an.POSITION_MIDDLE_MESSAGE_CLASS="deep-chat-middle-message",an.POSITION_BOTTOM_MESSAGE_CLASS="deep-chat-bottom-message";var ie=an,Cs=function(){function e(r,t){T(this,e),this._fileAdded=!1,this._streamType="",this._hasStreamEnded=!1,this._partialText="",this._messages=r,Q(t)=="object"&&(this._partialRender=t.partialRender,this._customWrappers=t.htmlWrappers)}return A(e,[{key:"upsertStreamedMessage",value:function(t){if(!this._hasStreamEnded){if(t?.text===void 0&&t?.html===void 0)return console.error(Pe.INVALID_STREAM_EVENT);t!=null&&t.custom&&this._message&&(this._message.custom=t.custom);var n=t?.text||t?.html||"",i=At.isScrollbarAtBottomOfElement(this._messages.elementRef),s=t?.text!==void 0?"text":"html";if(!this._elements&&!this._message)this.setInitialState(s,n,t?.role);else{if(this._streamType!==s)return console.error(Pe.INVALID_STREAM_EVENT_MIX);this.updateBasedOnType(n,s,t?.overwrite)}i&&At.scrollToBottom(this._messages.elementRef)}}},{key:"setInitialState",value:function(t,n,i){var s,a,o;this._streamType=t,i??(i=ie.AI_ROLE);var l=((s=this._customWrappers)==null?void 0:s[i])||((a=this._customWrappers)==null?void 0:a.default),u=l?"":n;this._elements=t==="text"?this._messages.addNewTextMessage(u,i):$n.add(this._messages,u,i),this._elements&&(this._elements.bubbleElement.classList.add(e.MESSAGE_CLASS),this._activeMessageRole=i,this._message=qs({role:this._activeMessageRole},t,u),this._messages.messageToElements.push([this._message,qs({},t,this._elements)]),(o=this._messages.browserStorage)==null||o.addMessages(this._messages.messageToElements.map(function(c){var d=or(c,1),f=d[0];return f})),l&&this.setTargetWrapperIfNeeded(this._elements,n,this._streamType,l))}},{key:"setTargetWrapperIfNeeded",value:function(t,n,i,s){t.bubbleElement.innerHTML=s,this._targetWrapper=t.bubbleElement.getElementsByClassName(e.TARGET_WRAPPER_CLASS)[0],this._elements&&pn.apply(this._messages,this._elements.bubbleElement),this.updateBasedOnType(n,i)}},{key:"updateBasedOnType",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s,a=this._targetWrapper||((s=this._elements)==null?void 0:s.bubbleElement);this._partialRender||ie.unfillEmptyMessageElement(a,t),(n==="text"?this.updateText:this.updateHTML).bind(this)(t,a,i)}},{key:"updateText",value:function(t,n,i){this._message&&(this._message.text=i?t:this._message.text+t,this._partialRender&&this.isNewPartialRenderParagraph(n,i)&&this.partialRenderNewParagraph(n),this._partialBubble?this.partialRenderBubbleUpdate(t):this._messages.renderText(n,this._message.text))}},{key:"isNewPartialRenderParagraph",value:function(t,n){var i,s;return n?(t.innerHTML="",!0):this._partialBubble?this._partialText&&((s=this._partialText)==null?void 0:s.indexOf(e.PARTIAL_RENDER_TEXT_MARK))>-1:((i=this._message)==null?void 0:i.text)&&this._message.text.indexOf(e.PARTIAL_RENDER_TEXT_MARK)>-1}},{key:"partialRenderNewParagraph",value:function(t){this._partialText="",this._partialBubble=document.createElement("div"),this._partialBubble.classList.add("partial-render-message"),t.appendChild(this._partialBubble)}},{key:"partialRenderBubbleUpdate",value:function(t){this._partialText+=t,this._messages.renderText(this._partialBubble,this._partialText)}},{key:"updateHTML",value:function(t,n,i){if(this._message)if(i)this._message.html=t,n.innerHTML=t;else{var s=document.createElement("span");s.innerHTML=t,n.appendChild(s),this._message.html=n?.innerHTML||""}}},{key:"finaliseStreamedMessage",value:function(){var t;if(!(this._endStreamAfterOperation||!this._message)&&!(this._fileAdded&&!this._elements)){if(!this._elements)throw Error(Pe.NO_VALID_STREAM_EVENTS_SENT);(t=this._elements.bubbleElement)!=null&&t.classList.contains(e.MESSAGE_CLASS)&&(this._streamType==="text"?this._messages.textToSpeech&&ks.speak(this._message.text||"",this._messages.textToSpeech):this._streamType==="html"&&this._elements&&pn.apply(this._messages,this._elements.outerContainer),this._elements.bubbleElement.classList.remove(e.MESSAGE_CLASS),this._message&&(this._targetWrapper&&(this._message.html=this._elements.bubbleElement.children[0].outerHTML,this._streamType==="text"&&delete this._message.text),this._messages.sendClientUpdate(Xt.createMessageContent(this._message),!1)),this._hasStreamEnded=!0)}}},{key:"markFileAdded",value:function(){this._fileAdded=!0}},{key:"newMessage",value:function(){this.finaliseStreamedMessage(),this._elements=void 0,delete this._message,this._fileAdded=!1,this._hasStreamEnded=!1,this._activeMessageRole=void 0}},{key:"endStreamAfterFileDownloaded",value:function(){var r=O(g().mark(function n(i,s){var a,o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this._endStreamAfterOperation=!0,c.next=3,s();case 3:a=c.sent,o=a.text,l=a.files,o&&this.updateBasedOnType(o,"text",!0),this._endStreamAfterOperation=!1,this.finaliseStreamedMessage(),l&&i.addNewMessage({files:l});case 7:case"end":return c.stop()}},n,this)}));function t(n,i){return r.apply(this,arguments)}return t}()}])}();Cs.MESSAGE_CLASS="streamed-message",Cs.PARTIAL_RENDER_TEXT_MARK=`

`,Cs.TARGET_WRAPPER_CLASS="stream-wrapper";var jn=Cs,ap=function(){function e(){T(this,e)}return A(e,null,[{key:"tempRemoveContentHeader",value:function(){var r=O(g().mark(function n(i,s,a){var o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(i!=null&&i.headers){c.next=2;break}throw new Error("Request settings have not been set up");case 2:return o=i.headers[e.CONTENT_TYPE],delete i.headers[e.CONTENT_TYPE],c.prev=4,c.next=7,s(a);case 7:l=c.sent,c.next=13;break;case 10:throw c.prev=10,c.t0=c.catch(4),i.headers[e.CONTENT_TYPE]=o,c.t0;case 13:return c.abrupt("return",(i.headers[e.CONTENT_TYPE]=o,l));case 14:case"end":return c.stop()}},n,null,[[4,10]])}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"displayError",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Service error, please try again.";if(console.error(n),Q(n)=="object")return n instanceof Error?t.addNewErrorMessage("service",n.message):Array.isArray(n)||typeof n.error=="string"?t.addNewErrorMessage("service",n):Object.keys(n).length===0?t.addNewErrorMessage("service",i):t.addNewErrorMessage("service",JSON.stringify(n));t.addNewErrorMessage("service",n)}},{key:"fetch",value:function(r){function t(n,i,s,a){return r.apply(this,arguments)}return t.toString=function(){return r.toString()},t}(function(r,t,n,i){var s,a,o={method:((s=r.connectSettings)==null?void 0:s.method)||"POST",headers:t};return o.method!=="GET"&&(o.body=n?JSON.stringify(i):i),r.connectSettings.credentials&&(o.credentials=r.connectSettings.credentials),fetch(((a=r.connectSettings)==null?void 0:a.url)||r.url||"",o)})},{key:"processResponseByType",value:function(t){var n=t.headers.get("content-type");return n!=null&&n.includes("application/json")?t.json():n!=null&&n.includes("text/plain")||!n?t:t.blob()}},{key:"processRequestInterceptor",value:function(){var r=O(g().mark(function n(i,s){var a,o,l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(a=i.requestInterceptor)==null?void 0:a.call(i,s);case 2:if(d.t0=d.sent,d.t0){d.next=5;break}d.t0=s;case 5:return o=d.t0,l=o,u=o,d.abrupt("return",{body:l.body,headers:l.headers,error:u.error});case 9:case"end":return d.stop()}},n)}));function t(n,i){return r.apply(this,arguments)}return t}()},{key:"validateResponseFormat",value:function(t,n){if(!t)return!1;var i=Array.isArray(t)?t:[t];return n&&i.length>1?(console.error(Pe.INVALID_STREAM_ARRAY_RESPONSE),!1):!i.find(function(s){return Q(s)!="object"||!(typeof s.error=="string"||typeof s.text=="string"||typeof s.html=="string"||Array.isArray(s.files))})}},{key:"onInterceptorError",value:function(t,n,i){t.addNewErrorMessage("service",n),i?.()}},{key:"basicResponseProcessing",value:function(){var r=O(g().mark(function n(i,s){var a,o,l,u,c,d,f,h,p,m,v=arguments;return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(a=v.length>2&&v[2]!==void 0?v[2]:{},o=a.io,l=a.displayError,u=l===void 0?!0:l,c=a.useRI,d=c===void 0?!0:c,o!=null&&o.extractResultData){b.next=4;break}return b.abrupt("return",s);case 4:return f=d?o.deepChat.responseInterceptor:void 0,b.next=7,f?.(s);case 7:if(b.t0=b.sent,b.t0){b.next=10;break}b.t0=s;case 10:return h=b.t0,b.next=13,o.extractResultData(h);case 13:if(p=b.sent,!(!p||Q(p)!="object"&&!Array.isArray(p))){b.next=17;break}return u&&(m=Pe.INVALID_RESPONSE(s,"response",!!f,h),e.displayError(i,m)),b.abrupt("return");case 17:return b.abrupt("return",p);case 18:case"end":return b.stop()}},n)}));function t(n,i){return r.apply(this,arguments)}return t}()}])}();ap.CONTENT_TYPE="Content-Type";var me=ap;function Sk(e,r){return tl.apply(this,arguments)}function tl(){return tl=O(g().mark(function e(r,t){var n,i;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:n=r.getReader();case 1:return a.next=3,n.read();case 3:if((i=a.sent).done){a.next=7;break}t(i.value);case 5:a.next=1;break;case 7:case"end":return a.stop()}},e)})),tl.apply(this,arguments)}function kk(e){var r,t,n,i=!1;return function(s){r===void 0?(r=s,t=0,n=-1):r=Ek(r,s);for(var a=r.length,o=0;t<a;){i&&(r[t]===10&&(o=++t),i=!1);for(var l=-1;t<a&&l===-1;++t)switch(r[t]){case 58:n===-1&&(n=t-o);break;case 13:i=!0;case 10:l=t;break}if(l===-1)break;e(r.subarray(o,l),n),o=t,n=-1}o===a?r=void 0:o!==0&&(r=r.subarray(o),t-=o)}}function _k(e,r,t){var n=Vc(),i=new TextDecoder;return function(s,a){if(s.length===0)t?.(n),n=Vc();else if(a>0){var o=i.decode(s.subarray(0,a)),l=a+(s[a+1]===32?2:1),u=i.decode(s.subarray(l));switch(o){case"data":n.data=n.data?n.data+`
`+u:u;break;case"event":n.event=u;break;case"id":e(n.id=u);break;case"retry":var c=parseInt(u,10);isNaN(c)||r(n.retry=c);break}}}}function Ek(e,r){var t=new Uint8Array(e.length+r.length);return t.set(e),t.set(r,e.length),t}function Vc(){return{data:"",event:"",id:"",retry:void 0}}var wk=function(r,t){var n={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t.indexOf(i)<0&&(n[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(r);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(r,i[s])&&(n[i[s]]=r[i[s]]);return n},nl="text/event-stream",Ck=1e3,qc="last-event-id";function Tk(e,r){var t=r.signal,n=r.headers,i=r.onopen,s=r.onmessage,a=r.onclose,o=r.onerror,l=r.openWhenHidden,u=r.fetch,c=wk(r,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise(function(d,f){var h=Object.assign({},n);h.accept||(h.accept=nl);var p;function m(){p.abort(),document.hidden||E()}l||document.addEventListener("visibilitychange",m);var v=Ck,y=0;function b(){document.removeEventListener("visibilitychange",m),window.clearTimeout(y),p.abort()}t?.addEventListener("abort",function(){b(),d()});var M=u??window.fetch,_=i??Ak;function E(){return C.apply(this,arguments)}function C(){return C=O(g().mark(function B(){var P,R,L;return g().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return p=new AbortController,k.prev=1,k.next=4,M(e,Object.assign(Object.assign({},c),{headers:h,signal:p.signal}));case 4:return R=k.sent,k.next=7,_(R);case 7:return k.next=9,Sk(R.body,kk(_k(function(F){F?h[qc]=F:delete h[qc]},function(F){v=F},s)));case 9:a?.(),b(),d(),k.next=17;break;case 14:if(k.prev=14,k.t0=k.catch(1),!p.signal.aborted)try{L=(P=o?.(k.t0))!==null&&P!==void 0?P:v,window.clearTimeout(y),y=window.setTimeout(E,L)}catch(F){b(),f(F)}case 17:case"end":return k.stop()}},B,null,[[1,14]])})),C.apply(this,arguments)}E()})}function Ak(e){var r=e.headers.get("content-type");if(!(r!=null&&r.startsWith(nl)))throw new Error("Expected content-type to be ".concat(nl,", Actual: ").concat(r))}var et=function(){function e(){T(this,e)}return A(e,null,[{key:"request",value:function(){var r=O(g().mark(function n(i,s,a){var o,l,u,c,d,f,h,p,m,v,y,b,M,_,E,C=arguments;return g().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return o=C.length>3&&C[3]!==void 0?C[3]:!0,l=C.length>4&&C[4]!==void 0?C[4]:!1,p={body:s,headers:(u=i.connectSettings)==null?void 0:u.headers},P.next=5,me.processRequestInterceptor(i.deepChat,p);case 5:if(m=P.sent,v=m.body,y=m.headers,b=m.error,!b){P.next=11;break}return P.abrupt("return",me.onInterceptorError(a,b,i.streamHandlers.onClose));case 11:if(!((c=i.connectSettings)!=null&&c.handler)){P.next=13;break}return P.abrupt("return",su.stream(i,v,a));case 13:if(((d=i.connectSettings)==null?void 0:d.url)!==Sn.URL){P.next=15;break}return P.abrupt("return",Sn.requestStream(a,i));case 15:return M=new jn(a,i.stream),_=me.fetch.bind(this,i,y,o),E={method:((f=i.connectSettings)==null?void 0:f.method)||"POST",headers:y,credentials:(h=i.connectSettings)==null?void 0:h.credentials,body:o?JSON.stringify(v):v},P.abrupt("return",(Q(i.stream)=="object"&&i.stream.readable?e.handleReadableStream(i,a,M,E,l,_,v):e.handleEventStream(i,a,M,E,l,_,v),M));case 17:case"end":return P.stop()}},n,this)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"handleReadableStream",value:function(t,n,i,s,a,o,l){var u,c=t.streamHandlers,d=c.onOpen,f=c.onClose,h=c.abortStream,p=!1;fetch(((u=t.connectSettings)==null?void 0:u.url)||t.url||"",s).then(function(){var m=O(g().mark(function v(y){var b,M,_,E,C,B,P,R,L,x,k;return g().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(y.body){I.next=2;break}throw new Error(Pe.READABLE_STREAM_CONNECTION_ERROR);case 2:_=y.body.getReader(),E=new TextDecoder,d(),C=!1;case 5:if(!(!C&&!p)){I.next=26;break}return I.next=8,_.read();case 8:if(B=I.sent,P=B.value,R=B.done,C=R,!C){I.next=15;break}e.handleClose(t,i,f,a),I.next=24;break;case 15:return L=E.decode(P,{stream:!0}),I.next=18,(M=(b=t.deepChat).responseInterceptor)==null?void 0:M.call(b,L);case 18:if(I.t0=I.sent,I.t0){I.next=21;break}I.t0=L;case 21:x=I.t0,k=Q(x)=="object"?x:{text:L},e.handleMessage(t,n,i,f,k,o,l);case 24:I.next=5;break;case 26:case"end":return I.stop()}},v)}));return function(v){return m.apply(this,arguments)}}()).catch(function(m){e.handleError(t,n,m)}),h.abort=function(){p=!0}}},{key:"handleEventStream",value:function(t,n,i,s,a,o,l){var u,c=t.streamHandlers,d=c.onOpen,f=c.onClose,h=c.abortStream;Tk(((u=t.connectSettings)==null?void 0:u.url)||t.url||"",ke(ke({},s),{},{openWhenHidden:!0,onopen:function(m){return O(g().mark(function v(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!m.ok){b.next=2;break}return b.abrupt("return",d());case 2:return b.next=4,me.processResponseByType(m);case 4:throw b.sent;case 5:case"end":return b.stop()}},v)}))()},onmessage:function(m){return O(g().mark(function v(){var y,b,M,_;return g().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(JSON.stringify(m.data)===JSON.stringify("[DONE]")){C.next=9;break}try{M=JSON.parse(m.data)}catch{M={}}return C.next=4,(b=(y=t.deepChat).responseInterceptor)==null?void 0:b.call(y,M);case 4:if(C.t0=C.sent,C.t0){C.next=7;break}C.t0=M;case 7:_=C.t0,e.handleMessage(t,n,i,f,_,o,l);case 9:case"end":return C.stop()}},v)}))()},onerror:function(m){throw f(),m},onclose:function(){e.handleClose(t,i,f,a)},signal:h.signal})).catch(function(p){e.handleError(t,n,p)})}},{key:"handleMessage",value:function(t,n,i,s,a,o,l){var u;(u=t.extractResultData)==null||u.call(t,a,o,l).then(function(c){t.asyncCallInProgress&&c&&c.text!==""?(e.simulate(n,t.streamHandlers,c),s(),t.asyncCallInProgress=!1):e.upsertWFiles(n,i.upsertStreamedMessage.bind(i),i,c)}).catch(function(c){return me.displayError(n,c)})}},{key:"handleError",value:function(t,n,i){var s;n.isLastMessageError()||(s=t.extractResultData)==null||s.call(t,i).then(function(){me.displayError(n,i)}).catch(function(a){me.displayError(n,a)})}},{key:"handleClose",value:function(t,n,i,s){if(!t.asyncCallInProgress)try{n.finaliseStreamedMessage(),i()}catch(a){if(!s)throw a}}},{key:"simulate",value:function(){var r=O(g().mark(function n(i,s,a,o){var l,u,c,d,f,h;return g().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return l=s,m.next=3,me.basicResponseProcessing(i,a,{io:o,useRI:!1});case 3:if(m.sent){m.next=5;break}return m.abrupt("return",s.onClose());case 5:if(Array.isArray(a)&&(a=a[0]),!a.files){m.next=10;break}return m.next=8,me.basicResponseProcessing(i,{files:a.files},{io:o});case 8:u=m.sent,i.addNewMessage(ke({sendUpdate:!1,ignoreText:!0},u),!1);case 10:a.text&&(s.onOpen(),c=a.text.split(""),d=new jn(i,o?.stream),e.populateMessages(i,c,d,l,"text",0,o)),a.html&&(s.onOpen(),f=pn.splitHTML(a.html),f.length===0&&(f=a.html.split("")),h=new jn(i,o?.stream),e.populateMessages(i,f,h,l,"html",0,o)),a.error&&(me.displayError(i,a.error),s.onClose());case 13:case"end":return m.stop()}},n)}));function t(n,i,s,a){return r.apply(this,arguments)}return t}()},{key:"populateMessages",value:function(){var r=O(g().mark(function n(i,s,a,o,l,u,c){var d,f,h;return g().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(d=s[u],!d){m.next=10;break}return m.next=4,me.basicResponseProcessing(i,qs({},l,d),{io:c});case 4:f=m.sent,e.upsertWFiles(i,a.upsertStreamedMessage.bind(a),a,f),h=setTimeout(function(){e.populateMessages(i,s,a,o,l,u+1,c)},o.simulationInterim||6),o.abortStream.abort=function(){e.abort(h,a,o.onClose)},m.next=11;break;case 10:a.finaliseStreamedMessage(),o.onClose();case 11:case"end":return m.stop()}},n)}));function t(n,i,s,a,o,l,u){return r.apply(this,arguments)}return t}()},{key:"isSimulation",value:function(t){return Q(t)=="object"&&!!t.simulation}},{key:"isSimulatable",value:function(t,n){return e.isSimulation(t)&&n&&(n.text||n.html)}},{key:"abort",value:function(t,n,i){clearTimeout(t),n.finaliseStreamedMessage(),i()}},{key:"upsertWFiles",value:function(t,n,i,s){if(s&&Array.isArray(s)&&(s=s[0]),s!=null&&s.text||s!=null&&s.html){var a=n(s);i??(i=a||void 0)}s!=null&&s.files&&(t.addNewMessage({files:s.files}),i?.markFileAdded())}}])}(),op=function(){function e(){T(this,e)}return A(e,null,[{key:"generateResponse",value:function(t){var n=t[t.length-1][0];if(n.files&&n.files.length>0){if(n.files.length>1)return"These are interesting files!";var i=n.files[0];return i.src&&i.src.startsWith("data:image/gif")?"That is a nice gif!":i.type==="image"?"That is a nice image!":i.type==="audio"?"I like the sound of that!":"That is an interesting file!"}if(n.text){if(n.text.charAt(n.text.length-1)==="?")return"I'm sorry but I can't answer that question...";if(n.text.includes("updog"))return"What's updog?"}return"Hi there! This is a demo response!"}},{key:"getCustomResponse",value:function(t,n){return typeof t=="function"?t(n):t}},{key:"getResponse",value:function(t){var n=t.customDemoResponse,i=t.messageToElements;return n?e.getCustomResponse(n,i[i.length-1][0]):{text:e.generateResponse(i)}}},{key:"request",value:function(t,n){var i=e.getResponse(n);setTimeout(O(g().mark(function s(){var a,o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,me.basicResponseProcessing(n,i,{io:t});case 2:if(a=c.sent,a){c.next=5;break}return c.abrupt("return",t.completionsHandlers.onFinish());case 5:o=Array.isArray(a)?a:[a],l=o.find(function(d){return typeof d.error=="string"}),l?(n.addNewErrorMessage("service",l.error),t.completionsHandlers.onFinish()):et.isSimulatable(t.stream,a)?et.simulate(n,t.streamHandlers,a):(o.forEach(function(d){return n.addNewMessage(d)}),t.completionsHandlers.onFinish());case 7:case"end":return c.stop()}},s)})),400)}},{key:"requestStream",value:function(t,n){setTimeout(function(){var i=e.getResponse(t);et.simulate(t,n.streamHandlers,i,n)},400)}}])}();op.URL="deep-chat-demo";var Sn=op,qi=function(){function e(){T(this,e)}return A(e,null,[{key:"setup",value:function(t){t.permittedErrorPrefixes=["Connection error","Error in server message"],t.websocket="pending"}},{key:"isElementPresentInDOM",value:function(t){return t.getRootNode({composed:!0})instanceof Document}},{key:"createConnection",value:function(t,n){if(e.isElementPresentInDOM(t.deepChat)){var i=t.connectSettings.websocket;if(i){if(t.connectSettings.handler)return su.websocket(t,n);try{var s=typeof i!="boolean"?i:void 0,a=new WebSocket(t.connectSettings.url||"",s);t.websocket=a,t.websocket.onopen=function(){var o,l;n.removeError(),t.websocket&&Q(t.websocket)=="object"&&e.assignListeners(t,a,n),(l=(o=t.deepChat)._validationHandler)==null||l.call(o)},t.websocket.onerror=function(o){console.error(o),e.retryConnection(t,n)}}catch(o){console.error(o),e.retryConnection(t,n)}}}}},{key:"retryConnection",value:function(t,n){var i,s;(s=(i=t.deepChat)._validationHandler)==null||s.call(i),e.isElementPresentInDOM(t.deepChat)&&(t.websocket="pending",n.isLastMessageError()||n.addNewErrorMessage("service","Connection error"),setTimeout(function(){e.createConnection(t,n)},5e3))}},{key:"assignListeners",value:function(t,n,i){var s=this,a={};n.onmessage=function(){var o=O(g().mark(function l(u){var c,d,f,h,p,m;return g().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!t.extractResultData){y.next=22;break}return y.prev=1,c=JSON.parse(u.data),y.next=5,me.basicResponseProcessing(i,c,{io:t,displayError:!1});case 5:if(d=y.sent,d){y.next=8;break}throw Error(Pe.INVALID_RESPONSE(c,"server",!!t.deepChat.responseInterceptor,d));case 8:if(!et.isSimulation(t.stream)){y.next=13;break}f=e.stream.bind(s,t,i,a),h=a[c.role||ie.AI_ROLE],et.upsertWFiles(i,f,h,d),y.next=17;break;case 13:if(p=Array.isArray(d)?d:[d],m=p.find(function(b){return typeof b.error=="string"}),!m){y.next=16;break}throw m.error;case 16:p.forEach(function(b){return i.addNewMessage(b)});case 17:y.next=22;break;case 19:y.prev=19,y.t0=y.catch(1),me.displayError(i,y.t0,"Error in server message");case 22:case"end":return y.stop()}},l,null,[[1,19]])}));return function(l){return o.apply(this,arguments)}}(),n.onclose=function(){console.error("Connection closed"),i.isLastMessageError()||i.addNewErrorMessage("service","Connection error"),t.stream&&t.streamHandlers.abortStream.abort(),e.createConnection(t,i)}}},{key:"sendWebsocket",value:function(){var r=O(g().mark(function n(i,s,a){var o,l,u,c,d,f,h,p,m,v=arguments;return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(o=v.length>3&&v[3]!==void 0?v[3]:!0,((l=i.connectSettings)==null?void 0:l.url)!==Sn.URL){b.next=3;break}return b.abrupt("return",Sn.request(i,a));case 3:if(c=i.websocket,!(!c||c==="pending")){b.next=6;break}return b.abrupt("return");case 6:return d={body:s,headers:(u=i.connectSettings)==null?void 0:u.headers},b.next=9,me.processRequestInterceptor(i.deepChat,d);case 9:if(f=b.sent,h=f.body,p=f.error,!p){b.next=14;break}return b.abrupt("return",a.addNewErrorMessage("service",p));case 14:if(e.isWebSocket(c)){b.next=16;break}return b.abrupt("return",c.newUserMessage.listener(h));case 16:m=o?JSON.stringify(h):h,c.readyState===void 0||c.readyState!==c.OPEN?(console.error("Connection is not open"),a.isLastMessageError()||a.addNewErrorMessage("service","Connection error")):(c.send(JSON.stringify(m)),i.completionsHandlers.onFinish());case 18:case"end":return b.stop()}},n)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"canSendMessage",value:function(t){return t?t==="pending"?!1:e.isWebSocket(t)?t.readyState!==void 0&&t.readyState===t.OPEN:t.isOpen:!0}},{key:"isWebSocket",value:function(t){return t.send!==void 0}},{key:"stream",value:function(t,n,i,s){if(s){var a=t.stream.simulation;if(typeof a=="string"){var o,l=s.role||ie.AI_ROLE,u=i[l];s.text===a||s.html===a?(u?.finaliseStreamedMessage(),delete i[l]):((o=i[l])!==null&&o!==void 0||(i[l]=new jn(n,t.stream)),i[l].upsertStreamedMessage(s))}else et.simulate(n,t.streamHandlers,s)}}}])}(),su=function(){function e(){T(this,e)}return A(e,null,[{key:"request",value:function(){var r=O(g().mark(function n(i,s,a){var o,l,u,c,d;return g().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:u=!0,c=function(){var p=O(g().mark(function m(v){var y,b,M;return g().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(u){E.next=2;break}return E.abrupt("return");case 2:return u=!1,E.next=5,me.basicResponseProcessing(a,v,{io:i,displayError:!1});case 5:y=E.sent,y?(b=Array.isArray(y)?y:[y],M=b.find(function(C){return typeof C.error=="string"}),M?(console.error(M.error),a.addNewErrorMessage("service",M.error),i.completionsHandlers.onFinish()):et.isSimulatable(i.stream,y)?et.simulate(a,i.streamHandlers,y):(b.forEach(function(C){return a.addNewMessage(C)}),i.completionsHandlers.onFinish())):(console.error(Pe.INVALID_RESPONSE(v,"server",!!i.deepChat.responseInterceptor,y)),a.addNewErrorMessage("service","Error in server message"),i.completionsHandlers.onFinish());case 7:case"end":return E.stop()}},m)}));return function(v){return p.apply(this,arguments)}}(),d=e.generateOptionalSignals(),(l=(o=i.connectSettings).handler)==null||l.call(o,s,ke(ke({},d),{},{onResponse:c}));case 3:case"end":return h.stop()}},n)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"attemptToFinaliseStream",value:function(t,n){try{var i=n.messageElementRefs[n.messageElementRefs.length-1];Xt.isLoadingMessage(i)?n.removeLastMessage():t.finaliseStreamedMessage()}catch(s){console.error(s),n.addNewErrorMessage("service",s)}}},{key:"stream",value:function(t,n,i){var s,a,o=!0,l=!1,u=new jn(i,t.stream),c=function(){l||!o||(t.streamHandlers.onOpen(),l=!0)},d=function(){o&&(e.attemptToFinaliseStream(u,i),t.streamHandlers.onClose(),o=!1)},f=function(){var p=O(g().mark(function m(v){var y,b;return g().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(o){_.next=2;break}return _.abrupt("return");case 2:return _.next=4,me.basicResponseProcessing(i,v,{io:t,displayError:!1});case 4:y=_.sent,y?y.error?(e.streamError(y.error,u,t,i),o=!1):et.upsertWFiles(i,u.upsertStreamedMessage.bind(u),u,y):(b=Pe.INVALID_RESPONSE(v,"server",!!t.deepChat.responseInterceptor,y),e.streamError(b,u,t,i),o=!1);case 6:case"end":return _.stop()}},m)}));return function(v){return p.apply(this,arguments)}}();t.streamHandlers.abortStream.abort=function(){e.attemptToFinaliseStream(u,i),t.streamHandlers.onClose(),o=!1};var h=e.generateOptionalSignals();(a=(s=t.connectSettings).handler)==null||a.call(s,n,ke(ke({},h),{},{onOpen:c,onResponse:f,onClose:d,stopClicked:t.streamHandlers.stopClicked}))}},{key:"streamError",value:function(t,n,i,s){console.error(t),n.finaliseStreamedMessage(),s.addNewErrorMessage("service",t),i.streamHandlers.onClose()}},{key:"websocket",value:function(t,n){var i=this,s,a,o={isOpen:!1,newUserMessage:{listener:function(){}},roleToStream:{}};t.websocket=o;var l=function(){n.removeError(),o.isOpen=!0},u=function(){o.isOpen=!1},c=function(){var f=O(g().mark(function h(p){var m,v,y,b,M,_;return g().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(o.isOpen){C.next=2;break}return C.abrupt("return");case 2:return C.next=4,me.basicResponseProcessing(n,p,{io:t,displayError:!1});case 4:m=C.sent,m?(v=Array.isArray(m)?m:[m],y=v.find(function(B){return typeof B.error=="string"}),y?(console.error(y.error),n.isLastMessageError()||n.addNewErrorMessage("service",y.error)):et.isSimulation(t.stream)?(b=m,M=qi.stream.bind(i,t,n,o.roleToStream),_=o.roleToStream[b.role||ie.AI_ROLE],et.upsertWFiles(n,M,_,b)):v.forEach(function(B){return n.addNewMessage(B)})):(console.error(Pe.INVALID_RESPONSE(p,"server",!!t.deepChat.responseInterceptor,m)),n.addNewErrorMessage("service","Error in server message"));case 6:case"end":return C.stop()}},h)}));return function(p){return f.apply(this,arguments)}}(),d=e.generateOptionalSignals();(a=(s=t.connectSettings).handler)==null||a.call(s,void 0,ke(ke({},d),{},{onOpen:l,onResponse:c,onClose:u,newUserMessage:o.newUserMessage}))}},{key:"generateOptionalSignals",value:function(){return{onClose:function(){},onOpen:function(){},stopClicked:{listener:function(){}},newUserMessage:{listener:function(){}}}}}])}(),je=function(){function e(){T(this,e)}return A(e,null,[{key:"request",value:function(){var r=O(g().mark(function n(i,s,a){var o,l,u,c,d,f,h,p,m,v,y,b,M=arguments;return g().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return o=M.length>3&&M[3]!==void 0?M[3]:!0,d={body:s,headers:(l=i.connectSettings)==null?void 0:l.headers},E.next=4,me.processRequestInterceptor(i.deepChat,d);case 4:if(f=E.sent,h=f.body,p=f.headers,m=f.error,v=i.completionsHandlers.onFinish,!m){E.next=11;break}return E.abrupt("return",me.onInterceptorError(a,m,v));case 11:if(!((u=i.connectSettings)!=null&&u.handler)){E.next=13;break}return E.abrupt("return",su.request(i,h,a));case 13:if(((c=i.connectSettings)==null?void 0:c.url)!==Sn.URL){E.next=15;break}return E.abrupt("return",Sn.request(i,a));case 15:y=!0,b=me.fetch.bind(this,i,p,o),b(h).then(function(C){return y=!!C.ok,C}).then(function(C){return me.processResponseByType(C)}).then(function(){var C=O(g().mark(function B(P){var R,L,x,k;return g().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(i.extractResultData){I.next=2;break}return I.abrupt("return");case 2:return I.next=4,(L=(R=i.deepChat).responseInterceptor)==null?void 0:L.call(R,P);case 4:if(I.t0=I.sent,I.t0){I.next=7;break}I.t0=P;case 7:return x=I.t0,I.next=10,i.extractResultData(x,b,h);case 10:if(k=I.sent,y){I.next=13;break}throw P;case 13:if(!(!k||Q(k)!="object"&&!Array.isArray(k))){I.next=15;break}throw Error(Pe.INVALID_RESPONSE(P,"response",!!i.deepChat.responseInterceptor,x));case 15:k.makingAnotherRequest||(et.isSimulatable(i.stream,k)?et.simulate(a,i.streamHandlers,k):((Array.isArray(k)?k:[k]).forEach(function(G){return a.addNewMessage(G)}),v()));case 16:case"end":return I.stop()}},B)}));return function(B){return C.apply(this,arguments)}}()).catch(function(C){me.displayError(a,C),v()});case 18:case"end":return E.stop()}},n,this)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"executePollRequest",value:function(t,n,i,s){var a=t.completionsHandlers.onFinish;fetch(n,i).then(function(o){return o.json()}).then(function(){var o=O(g().mark(function l(u){var c,d,f;return g().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(t.extractPollResultData){p.next=2;break}return p.abrupt("return");case 2:return p.t0=t,p.next=5,(d=(c=t.deepChat).responseInterceptor)==null?void 0:d.call(c,u);case 5:if(p.t1=p.sent,p.t1){p.next=8;break}p.t1=u;case 8:return p.t2=p.t1,p.next=11,p.t0.extractPollResultData.call(p.t0,p.t2);case 11:f=p.sent,f.timeoutMS?setTimeout(function(){e.executePollRequest(t,n,i,s)},f.timeoutMS):et.isSimulatable(t.stream,f)?et.simulate(s,t.streamHandlers,f):(s.addNewMessage(f),a());case 13:case"end":return p.stop()}},l)}));return function(l){return o.apply(this,arguments)}}()).catch(function(o){me.displayError(s,o),a()})}},{key:"poll",value:function(){var r=O(g().mark(function n(i,s,a){var o,l,u,c,d,f,h,p,m,v,y,b,M,_=arguments;return g().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return o=_.length>3&&_[3]!==void 0?_[3]:!0,d={body:s,headers:(l=i.connectSettings)==null?void 0:l.headers},C.next=4,me.processRequestInterceptor(i.deepChat,d);case 4:if(f=C.sent,h=f.body,p=f.headers,m=f.error,!m){C.next=10;break}return C.abrupt("return",me.onInterceptorError(a,m));case 10:v=((u=i.connectSettings)==null?void 0:u.url)||i.url||"",y=((c=i.connectSettings)==null?void 0:c.method)||"POST",b=o?JSON.stringify(h):h,M={method:y,body:b,headers:p},i.connectSettings.credentials&&(M.credentials=i.connectSettings.credentials),e.executePollRequest(i,v,M,a);case 12:case"end":return C.stop()}},n)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"verifyKey",value:function(t,n,i,s,a,o,l,u,c){if(t==="")return o(Pe.INVALID_KEY);l(),fetch(n,{method:s,headers:i,body:c||null}).then(function(d){return me.processResponseByType(d)}).then(function(d){u(d,t,a,o)}).catch(function(d){o(Pe.CONNECTION_FAILED),console.error(d)})}}])}(),lp=function(){function e(r,t,n){T(this,e),this._isLoading=!1,this._isPaginationComplete=!1,this._index=0,this._messages=t,n.fetchHistory&&this.fetchHistory(n.fetchHistory),r.loadHistory&&this.setupLoadHistoryOnScroll(r.loadHistory),this.setupInitialHistory(r)}return A(e,[{key:"fetchHistory",value:function(){var r=O(g().mark(function n(i){var s=this,a,o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=ir.addMessage(this._messages),u.next=3,i();case 3:o=u.sent,this._messages.removeMessage(a),e.displayIntroMessages(this._messages.messageElementRefs),o.forEach(function(c){return s._messages.addAnyMessage(c,!0)}),setTimeout(function(){return At.scrollToBottom(s._messages.elementRef)},0);case 5:case"end":return u.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"processLoadedHistory",value:function(t){var n=this,i,s=this._messages,a=s.messageElementRefs,o=s.messageToElements,l=s.elementRef,u=(i=a.find(function(d){return!d.outerContainer.classList.contains(Xt.INTRO_CLASS)}))==null?void 0:i.outerContainer,c=l.scrollTop;t?.reverse().map(function(d){var f=n._messages.addAnyMessage(ke(ke({},d),{},{sendUpdate:!0}),!0,!0);if(f){var h=ie.generateMessageBody(f,a,!0);o.unshift([f,h])}return f}).filter(function(d){return!!d}).reverse().forEach(function(d){return n._messages.sendClientUpdate(d,!0)}),u&&(l.scrollTop=c+u.offsetTop-40)}},{key:"populateMessages",value:function(t,n){this._messages.removeMessage(t),this._isPaginationComplete=n.findIndex(function(u){return!u})<0;var i=n.filter(function(u){return!!u});this.processLoadedHistory(i);var s=this._messages,a=s.messageElementRefs,o=s.avatar,l=s.name;ie.resetAllRoleElements(a,o,l)}},{key:"setupLoadHistoryOnScroll",value:function(){var r=O(g().mark(function n(i){var s=this;return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:this._messages.elementRef.onscroll=O(g().mark(function l(){var u,c;return g().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(!s._isLoading&&!s._isPaginationComplete&&s._messages.elementRef.scrollTop===0)){f.next=13;break}return s._isLoading=!0,u=ir.addMessage(s._messages,!1),f.prev=3,f.next=6,i(s._index++);case 6:c=f.sent,s.populateMessages(u,c),s._isLoading=!1,f.next=13;break;case 10:f.prev=10,f.t0=f.catch(3),s._messages.removeMessage(u),s._isPaginationComplete=!0,s._messages.addNewErrorMessage("service",e.FAILED_ERROR_MESSAGE,!0),console.error(f.t0);case 13:case"end":return f.stop()}},l,null,[[3,10]])}));case 1:case"end":return o.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"populateInitialHistory",value:function(t){var n=this;t.forEach(function(i){xt.processHistoryFile(i),n._messages.addAnyMessage(i,!0)})}},{key:"loadInitialHistory",value:function(){var r=O(g().mark(function n(i){var s=this,a,o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this._isLoading=!0,a=ir.addMessage(this._messages),c.prev=2,c.next=5,i(this._index++);case 5:o=c.sent,l=this._messages.elementRef.scrollTop,this.populateMessages(a,o),l===0&&setTimeout(function(){return At.scrollToBottom(s._messages.elementRef)},0),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(2),this._messages.removeMessage(a),this._isPaginationComplete=!0,this._messages.addNewErrorMessage("service",e.FAILED_ERROR_MESSAGE,!0),console.error(c.t0);case 13:e.displayIntroMessages(this._messages.messageElementRefs),this._isLoading=!1;case 14:case"end":return c.stop()}},n,this,[[2,10]])}));function t(n){return r.apply(this,arguments)}return t}()},{key:"setupInitialHistory",value:function(){var r=O(g().mark(function n(i){var s,a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:i.loadHistory&&this.loadInitialHistory(i.loadHistory),a=i.history||xt.processHistory(i)||((s=this._messages.browserStorage)==null?void 0:s.get()),a&&(this.populateInitialHistory(a),this._index+=1);case 3:case"end":return l.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()}],[{key:"addErrorPrefix",value:function(t){var n;(n=t.permittedErrorPrefixes)!==null&&n!==void 0||(t.permittedErrorPrefixes=[]),t.permittedErrorPrefixes.push(e.FAILED_ERROR_MESSAGE)}},{key:"displayIntroMessages",value:function(t){for(var n=0;n<t.length;n+=1){var i=t[0];if(i.outerContainer.classList.contains(Xt.INTRO_CLASS))i.outerContainer.style.display="";else break}}}])}();lp.FAILED_ERROR_MESSAGE="Failed to load history";var au=lp,Sa=function(){function e(){T(this,e)}return A(e,null,[{key:"getCharacterLimitMessages",value:function(t,n){var i;if(n===-1)return t;var s=0,a=t.length-1;for(a;a>=0;a-=1){var o=(i=t[a])==null?void 0:i.text;if(o!==void 0&&(s+=o.length,s>n)){t[a].text=o.substring(0,o.length-(s-n));break}}return t.slice(Math.max(a,0))}},{key:"getMaxMessages",value:function(t,n){return t.slice(Math.max(t.length-n,0))}},{key:"processMessages",value:function(t,n,i){return n!==void 0?n>0&&(t=e.getMaxMessages(t,n)):t=[t[t.length-1]],t=JSON.parse(JSON.stringify(t)),i===void 0?t:e.getCharacterLimitMessages(t,i)}}])}(),Mk=function(){function e(){T(this,e)}return A(e,null,[{key:"parseConfig",value:function(t,n,i,s){var a,o={files:n};if(Q(s)=="object"){xt.processFileConfigConnect(s);var l=s.files,u=s.connect,c=s.button;l&&(l.infoModal&&(o.files.infoModal=l.infoModal,(a=l.infoModal)!=null&&a.textMarkDown&&(o.infoModalTextMarkUp=i.render(l.infoModal.textMarkDown))),l.acceptedFormats&&(o.files.acceptedFormats=l.acceptedFormats),l.maxNumberOfFiles&&(o.files.maxNumberOfFiles=l.maxNumberOfFiles)),o.button=c,u&&(u.headers||u.method||u.url||u.credentials||t.headers||t.method||t.url||t.credentials)&&(o.connect={url:u?.url||t.url,method:u?.method||t.method,headers:u?.headers||t.headers,credentials:u?.credentials||t.credentials})}return o}},{key:"processMixedFiles",value:function(t,n,i){if(i){var s={acceptedFormats:""};t.fileTypes.mixedFiles=e.parseConfig(t.connectSettings,s,n,i)}}},{key:"processMicrophone",value:function(t,n,i,s){var a,o,l,u,c,d,f,h,p=ke({acceptedFormats:"audio/*"},((l=t.fileTypes.audio)==null?void 0:l.files)||{});i&&(navigator.mediaDevices.getUserMedia!==void 0?(t.recordAudio=e.parseConfig(t.connectSettings,p,n,i),Q(i)=="object"&&i.files&&((a=(u=t.recordAudio).files)!==null&&a!==void 0||(u.files={}),t.recordAudio.files.format=(c=i.files)==null?void 0:c.format,t.recordAudio.files.maxDurationSeconds=(d=i.files)==null?void 0:d.maxDurationSeconds,(f=t.fileTypes.audio)!=null&&f.files&&((o=(h=t.fileTypes.audio.files).maxNumberOfFiles)!==null&&o!==void 0||(h.maxNumberOfFiles=i.files.maxNumberOfFiles)))):s||(t.fileTypes.audio=e.parseConfig(t.connectSettings,p,n,i)))}},{key:"processAudioConfig",value:function(t,n,i,s){if(!(!i&&!s)){var a=ke({acceptedFormats:"audio/*"},s?.files||{});t.fileTypes.audio=e.parseConfig(t.connectSettings,a,n,i)}}},{key:"processGifConfig",value:function(t,n,i,s){if(!(!i&&!s)){var a=ke({acceptedFormats:"image/gif"},s?.files||{});t.fileTypes.gifs=e.parseConfig(t.connectSettings,a,n,i)}}},{key:"processCamera",value:function(t,n,i,s){var a,o,l,u,c,d=ke({acceptedFormats:"image/*"},((o=t.fileTypes.images)==null?void 0:o.files)||{});i&&(navigator.mediaDevices.getUserMedia!==void 0?(t.camera=e.parseConfig(t.connectSettings,d,n,i),Q(i)=="object"&&(t.camera.modalContainerStyle=i.modalContainerStyle,i.files&&((a=(l=t.camera).files)!==null&&a!==void 0||(l.files={}),t.camera.files.format=(u=i.files)==null?void 0:u.format,t.camera.files.dimensions=(c=i.files)==null?void 0:c.dimensions))):s||(t.fileTypes.images=e.parseConfig(t.connectSettings,d,n,i)))}},{key:"processImagesConfig",value:function(t,n,i,s){if(!(!i&&!s)){var a=ke({acceptedFormats:"image/*"},s?.files||{});t.fileTypes.images=e.parseConfig(t.connectSettings,a,n,i)}}},{key:"populateDefaultFileIO",value:function(t,n){var i,s,a,o,l;t&&((i=t.files)!==null&&i!==void 0||(t.files={}),(s=(o=t.files).acceptedFormats)!==null&&s!==void 0||(o.acceptedFormats=n),(a=(l=t.files).maxNumberOfFiles)!==null&&a!==void 0||(l.maxNumberOfFiles=1))}},{key:"set",value:function(t,n,i){e.populateDefaultFileIO(i?.audio,".4a,.mp3,.webm,.mp4,.mpga,.wav,.mpeg,.m4a"),e.populateDefaultFileIO(i?.images,".png,.jpg");var s=Qo.createNew(t.remarkable);e.processImagesConfig(n,s,t.images,i?.images),e.processCamera(n,s,t.camera,t.images),e.processGifConfig(n,s,t.gifs,i?.gifs),e.processAudioConfig(n,s,t.audio,i?.audio),e.processMicrophone(n,s,t.microphone,t.audio),e.processMixedFiles(n,s,t.mixedFiles)}}])}(),Gs=function(){function e(r,t,n){var i;T(this,e);var s,a,o,l,u;this.rawBody={},this.validateKeyProperty=!1,this.canSendMessage=e.canSendMessage,this.connectSettings={},this.fileTypes={},this.completionsHandlers={},this.streamHandlers={},this.deepChat=r,this.demo=n,Object.assign(this.rawBody,(s=r.connect)==null?void 0:s.additionalBodyProps),this.totalMessagesMaxCharLength=(a=r?.requestBodyLimits)==null?void 0:a.totalMessagesMaxCharLength,this.maxMessages=(o=r?.requestBodyLimits)==null?void 0:o.maxMessages,Mk.set(r,this,t),r.connect&&(this.connectSettings=r.connect),this.demo&&((i=(l=this.connectSettings).url)!==null&&i!==void 0||(l.url=Sn.URL)),this.connectSettings.websocket&&qi.setup(this),this.stream=((u=this.deepChat.connect)==null?void 0:u.stream)||xt.checkForStream(this.deepChat),r.loadHistory&&au.addErrorPrefix(this)}return A(e,[{key:"verifyKey",value:function(t,n){}},{key:"getServiceIOByType",value:function(t){if(t.type.startsWith("audio")&&this.fileTypes.audio)return this.fileTypes.audio;if(t.type.startsWith("image")){if(this.fileTypes.gifs&&t.type.endsWith("/gif"))return this.fileTypes.gifs;if(this.fileTypes.images)return this.fileTypes.images;if(this.camera)return this.camera}return this.fileTypes.mixedFiles}},{key:"request",value:function(){var r=O(g().mark(function n(i,s){var a,o=arguments;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=o.length>2&&o[2]!==void 0?o[2]:!0,u.abrupt("return",this.stream&&!et.isSimulation(this.stream)?et.request(this,i,s,a):je.request(this,i,s,a));case 2:case"end":return u.stop()}},n,this)}));function t(n,i){return r.apply(this,arguments)}return t}()},{key:"callAPIWithText",value:function(){var r=O(g().mark(function n(i,s){var a,o,l,u,c,d,f,h;return g().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return f=ke({messages:s},this.rawBody),h=!1,(l=this.connectSettings.headers)!=null&&l["Content-Type"]||((a=(u=this.connectSettings).headers)!==null&&a!==void 0||(u.headers={}),(o=(c=this.connectSettings.headers)["Content-Type"])!==null&&o!==void 0||(c["Content-Type"]="application/json"),h=!0),m.next=5,this.request(f,i);case 5:h&&((d=this.connectSettings.headers)==null||delete d["Content-Type"]);case 6:case"end":return m.stop()}},n,this)}));function t(n,i){return r.apply(this,arguments)}return t}()},{key:"callApiWithFiles",value:function(){var r=O(g().mark(function n(i,s,a){var o,l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=e.createCustomFormDataBody(this.rawBody,s,a),l=this.connectSettings,u=this.getServiceIOByType(a[0]),this.connectSettings=u?.connect||this.connectSettings,d.next=4,this.request(o,i,!1);case 4:this.connectSettings=l;case 5:case"end":return d.stop()}},n,this)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"callServiceAPI",value:function(){var r=O(g().mark(function n(i,s,a){return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:a?this.callApiWithFiles(i,s,a):this.callAPIWithText(i,s);case 1:case"end":return l.stop()}},n,this)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"callAPI",value:function(){var r=O(g().mark(function n(i,s){var a,o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(this.connectSettings){c.next=2;break}throw new Error("Request settings have not been set up");case 2:o=Sa.processMessages(s.messageToElements.map(function(d){var f=or(d,1),h=f[0];return h}),this.maxMessages,this.totalMessagesMaxCharLength),this.connectSettings.websocket&&(!this.connectSettings.handler||this.connectSettings.url!==Sn.URL)?(l=ke({messages:o},this.rawBody),i.files&&(a=this.getServiceIOByType(i.files[0]))!=null&&a.connect?this.callApiWithFiles(s,o,i.files):qi.sendWebsocket(this,l,s,!1)):this.callServiceAPI(s,o,i.files);case 4:case"end":return c.stop()}},n,this)}));function t(n,i){return r.apply(this,arguments)}return t}()},{key:"extractResultData",value:function(){var r=O(g().mark(function n(i){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!i.result){a.next=2;break}return a.abrupt("return",xt.handleResponseProperty(i));case 2:if(!me.validateResponseFormat(i,!!this.stream)){a.next=4;break}return a.abrupt("return",i);case 4:case"end":return a.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"isDirectConnection",value:function(){return!1}},{key:"isWebModel",value:function(){return!1}},{key:"isCustomView",value:function(){return!1}}],[{key:"canSendMessage",value:function(t,n,i){return i?!0:!!(t&&t.trim()!=="")||!!(n&&n.length>0)}},{key:"createCustomFormDataBody",value:function(t,n,i){var s=new FormData;i.forEach(function(l){return s.append("files",l)}),Object.keys(t).forEach(function(l){return s.append(l,String(t[l]))});var a=0;n.slice(0,n.length-1).forEach(function(l){s.append("message".concat(a+=1),JSON.stringify(l))});var o=n[n.length-1];return o.text&&(delete o.files,s.append("message".concat(a+=1),JSON.stringify(o))),s}}])}(),ft=function(e){function r(t,n,i,s,a){var o;T(this,r);var l;return o=le(this,r,[t,a]),o.insertKeyPlaceholderText="API Key",o.keyHelpUrl="",Object.assign(o.rawBody,(l=t.connect)==null?void 0:l.additionalBodyProps),o._keyVerificationDetails=n,o._buildHeadersFunc=i,s&&o.setApiKeyProperties(s),o.connectSettings=o.buildConnectSettings(o.key||"",t.connect),o}return ue(r,e),A(r,[{key:"setApiKeyProperties",value:function(n){this.key=n.key,n.validateKeyProperty&&(this.validateKeyProperty=n.validateKeyProperty)}},{key:"buildConnectSettings",value:function(n,i){var s,a=i??{};return(s=a.headers)!==null&&s!==void 0||(a.headers={}),Object.assign(a.headers,this._buildHeadersFunc(n)),a}},{key:"keyAuthenticated",value:function(n,i){this.connectSettings=this.buildConnectSettings(i,this.connectSettings),this.key=i,n()}},{key:"verifyKey",value:function(n,i){var s=this._keyVerificationDetails,a=s.url,o=s.method,l=s.handleVerificationResult,u=s.createHeaders,c=s.body,d=u?.(n)||this._buildHeadersFunc(n);je.verifyKey(n,a,d,o,this.keyAuthenticated.bind(this,i.onSuccess),i.onFail,i.onLoad,l,c)}},{key:"isDirectConnection",value:function(){return!0}}])}(Gs),xk=function(){function e(){T(this,e)}return A(e,null,[{key:"waitForPropertiesToBeUpdatedBeforeRender",value:function(t){t._propUpdated_=!1,setTimeout(function(){t._propUpdated_?e.waitForPropertiesToBeUpdatedBeforeRender(t):(t._waitingToRender_=!1,t.onRender())})}},{key:"attemptRender",value:function(t){t._propUpdated_=!0,t._waitingToRender_||(t._waitingToRender_=!0,e.waitForPropertiesToBeUpdatedBeforeRender(t))}}])}(),rl=function(e){function r(){var t;return T(this,r),t=le(this,r),t._waitingToRender_=!1,t._propUpdated_=!1,Object.keys(r._attributeToProperty_).forEach(function(n){var i=r._attributeToProperty_[n];t.constructPropertyAccessors(i),t.hasOwnProperty(n)||t.constructPropertyAccessors(i,n)}),t}return ue(r,e),A(r,[{key:"constructPropertyAccessors",value:function(n,i){var s;Object.defineProperty(this,i||n,{get:function(){return s},set:function(o){s=o,i?this[n]=o:xk.attemptRender(this)}})}},{key:"attributeChangedCallback",value:function(n,i,s){if(i!==s){var a=r._attributes_[n](s),o=r._attributeToProperty_[n];this[o]=a}}},{key:"onRender",value:function(){}}],[{key:"observedAttributes",get:function(){return Object.keys(r._attributes_)||[]}}])}(Vo(HTMLElement));rl._attributes_={},rl._attributeToProperty_={};var Ik=rl,Lk=`<?xml version="1.0" standalone="no"?>
<svg version="1.1"
	xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
	xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="0.9em" height="0.9em"
	viewBox="0 0 1200 1200" enable-background="new 0 0 1200 1200">
		<path d="
			M669.727,273.516c-22.891-2.476-46.15-3.895-69.727-4.248c-103.025,0.457-209.823,25.517-310.913,73.536
			c-75.058,37.122-148.173,89.529-211.67,154.174C46.232,529.978,6.431,577.76,0,628.74c0.76,44.162,48.153,98.67,77.417,131.764
			c59.543,62.106,130.754,113.013,211.67,154.174c2.75,1.335,5.51,2.654,8.276,3.955l-75.072,131.102l102.005,60.286l551.416-960.033
			l-98.186-60.008L669.727,273.516z M902.563,338.995l-74.927,129.857c34.47,44.782,54.932,100.006,54.932,159.888
			c0,149.257-126.522,270.264-282.642,270.264c-6.749,0-13.29-0.728-19.922-1.172l-49.585,85.84c22.868,2.449,45.99,4.233,69.58,4.541
			c103.123-0.463,209.861-25.812,310.84-73.535c75.058-37.122,148.246-89.529,211.743-154.174
			c31.186-32.999,70.985-80.782,77.417-131.764c-0.76-44.161-48.153-98.669-77.417-131.763
			c-59.543-62.106-130.827-113.013-211.743-154.175C908.108,341.478,905.312,340.287,902.563,338.995L902.563,338.995z
			M599.927,358.478c6.846,0,13.638,0.274,20.361,0.732l-58.081,100.561c-81.514,16.526-142.676,85.88-142.676,168.897
			c0,20.854,3.841,40.819,10.913,59.325c0.008,0.021-0.008,0.053,0,0.074l-58.228,100.854
			c-34.551-44.823-54.932-100.229-54.932-160.182C317.285,479.484,443.808,358.477,599.927,358.478L599.927,358.478z M768.896,570.513
			L638.013,797.271c81.076-16.837,141.797-85.875,141.797-168.603C779.81,608.194,775.724,588.729,768.896,570.513L768.896,570.513z"
			/>
</svg>
`,Ok=`<?xml version="1.0" standalone="no"?>
<svg version="1.1"
	xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
	xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="0.9em" height="0.9em"
	viewBox="0 0 1200 1200" enable-background="new 0 0 1200 1200">
		<path id="path6686" inkscape:connector-curvature="0" d="M779.843,599.925c0,95.331-80.664,172.612-180.169,172.612
			c-99.504,0-180.168-77.281-180.168-172.612c0-95.332,80.664-172.612,180.168-172.612
			C699.179,427.312,779.843,504.594,779.843,599.925z M600,240.521c-103.025,0.457-209.814,25.538-310.904,73.557
			c-75.058,37.122-148.206,89.496-211.702,154.141C46.208,501.218,6.431,549,0,599.981c0.76,44.161,48.13,98.669,77.394,131.763
			c59.543,62.106,130.786,113.018,211.702,154.179c94.271,45.751,198.616,72.092,310.904,73.557
			c103.123-0.464,209.888-25.834,310.866-73.557c75.058-37.122,148.243-89.534,211.74-154.179
			c31.185-32.999,70.962-80.782,77.394-131.763c-0.76-44.161-48.13-98.671-77.394-131.764
			c-59.543-62.106-130.824-112.979-211.74-154.141C816.644,268.36,712.042,242.2,600,240.521z M599.924,329.769
			c156.119,0,282.675,120.994,282.675,270.251c0,149.256-126.556,270.25-282.675,270.25S317.249,749.275,317.249,600.02
			C317.249,450.763,443.805,329.769,599.924,329.769L599.924,329.769z"/>
</svg>
`,mn=function(){function e(){T(this,e)}return A(e,null,[{key:"createSVGElement",value:function(t){return new DOMParser().parseFromString(t,"image/svg+xml").documentElement}}])}(),up=function(){function e(){T(this,e)}return A(e,null,[{key:"changeVisibility",value:function(t,n,i,s){s.target.id===e.VISIBLE_ICON_ID?(n.style.display="none",i.style.display="block",t.type="password"):(n.style.display="block",i.style.display="none",t.type="text")}},{key:"createIconElement",value:function(t,n){var i=mn.createSVGElement(t);return i.id=n,i.classList.add("visibility-icon"),i}},{key:"create",value:function(t){var n=document.createElement("div");n.id="visibility-icon-container";var i=e.createIconElement(Ok,e.VISIBLE_ICON_ID);i.style.display="none",n.appendChild(i);var s=e.createIconElement(Lk,"not-visible-icon");return n.appendChild(s),n.onclick=e.changeVisibility.bind(this,t,i,s),n}}])}();up.VISIBLE_ICON_ID="visible-icon";var Rk=up,Pk=function(){function e(){T(this,e)}return A(e,null,[{key:"createCautionText",value:function(){var t=document.createElement("a");return t.classList.add("insert-key-input-help-text"),t.innerText="Please exercise CAUTION when inserting your API key outside of deepchat.dev or localhost!!",t}},{key:"createHelpLink",value:function(t){var n=document.createElement("a");return n.classList.add("insert-key-input-help-text"),n.href=t,n.innerText="Find more info here",n.target="_blank",n}},{key:"createFailText",value:function(){var t=document.createElement("div");return t.id="insert-key-input-invalid-text",t.style.display="none",t}},{key:"createHelpTextContainer",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=document.createElement("div");i.id="insert-key-help-text-container";var s=document.createElement("div");s.id="insert-key-help-text-contents";var a=e.createFailText();if(s.appendChild(a),t){var o=e.createHelpLink(t);s.appendChild(o)}if(n===!0){var l=e.createCautionText();s.appendChild(l)}return i.appendChild(s),{helpTextContainerElement:i,failTextElement:a}}},{key:"onFail",value:function(t,n,i,s){t.classList.replace("insert-key-input-valid","insert-key-input-invalid"),i.innerText=s,i.style.display="block",n.innerText="Start",t.classList.remove("loading")}},{key:"onLoad",value:function(t,n){t.classList.add("loading"),n.innerHTML='<div id="loading-key"></div>'}},{key:"verifyKey",value:function(t,n,i){var s=t.value.trim();i.verifyKey(s,n)}},{key:"addVerificationEvents",value:function(t,n,i,s,a){var o={onSuccess:s,onFail:e.onFail.bind(this,t,n,i),onLoad:e.onLoad.bind(this,t,n)},l=e.verifyKey.bind(this,t,o,a);n.onclick=l,t.onkeydown=function(u){!t.classList.contains("loading")&&u.key===it.ENTER&&l()}}},{key:"createStartButton",value:function(){var t=document.createElement("div");return t.id="start-button",t.innerText="Start",t}},{key:"onInputFocus",value:function(t){t.target.classList.replace("insert-key-input-invalid","insert-key-input-valid")}},{key:"createInput",value:function(t){var n=document.createElement("div");n.id="insert-key-input-container";var i=document.createElement("input");return i.id="insert-key-input",i.placeholder=t||"API Key",i.type="password",i.classList.add("insert-key-input-valid"),i.onfocus=e.onInputFocus,n.appendChild(i),n}},{key:"createContents",value:function(t,n){var i,s=document.createElement("div");s.id="insert-key-contents";var a=e.createInput(n.insertKeyPlaceholderText),o=a.children[0],l=Rk.create(o);a.appendChild(l),s.appendChild(a);var u=e.createStartButton(),c=e.createHelpTextContainer(n.keyHelpUrl,(i=n.deepChat._insertKeyViewStyles)==null?void 0:i.displayCautionText),d=c.helpTextContainerElement,f=c.failTextElement;return s.appendChild(u),s.appendChild(d),e.addVerificationEvents(o,u,f,t,n),s}},{key:"createElements",value:function(t,n){var i=document.createElement("div");i.id="insert-key-view";var s=e.createContents(t,n);return i.appendChild(s),i}},{key:"render",value:function(t,n,i){var s=e.createElements(n,i);t.replaceChildren(s)}}])}(),di=function(){function e(){T(this,e)}return A(e,null,[{key:"enableButtons",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;window.webLLM?(t&&(t.disabled=!1),n&&(n.disabled=!1)):i<ou.MODULE_SEARCH_LIMIT_S*4&&setTimeout(function(){return e.enableButtons(t,n,i+1)},250)}},{key:"setUpInitial",value:function(t,n,i,s){var a=n?.downloadClass||e.DOWNLOAD_BUTTON_CLASS,o=n?.uploadClass||e.UPLOAD_BUTTON_CLASS,l=n?.fileInputClass||e.FILE_INPUT_CLASS;return setTimeout(function(){var u=i?.getElementsByClassName(a)[0],c=i?.getElementsByClassName(l)[0],d=i?.getElementsByClassName(o)[0];u&&(u.onclick=function(){return t()}),c&&(c.onchange=function(){c.files&&c.files.length>0&&t(c.files)}),d&&(d.onclick=function(){return c.click()}),(u||d)&&e.enableButtons(u,d)}),n?.initialHtml||`<div>
        Download or upload a web model that will run entirely on your browser: <br/> 
        <button disabled class="`.concat(a,` deep-chat-button deep-chat-web-model-button">Download</button>
        `).concat(s?"":'<input type="file" class="'.concat(l,`" hidden multiple />
          <button disabled class="`).concat(o,' deep-chat-button deep-chat-web-model-button">Upload</button>'),`
      </div>`)}},{key:"exportFile",value:function(t){for(var n=document.createElement("a"),i=4,s=function(l){setTimeout(function(){for(var u=l*i,c=u;c<Math.min(u+i,t.length);c+=1){var d=URL.createObjectURL(t[c]);n.href=d,n.download=t[c].name,document.body.appendChild(n),n.click(),URL.revokeObjectURL(d)}},500*l)},a=0;a<t.length/i;a+=1)s(a)}},{key:"setUpAfterLoad",value:function(t,n,i,s){var a=n?.exportFilesClass||e.EXPORT_BUTTON_CLASS;return setTimeout(function(){var o=i?.getElementsByClassName(a)[0];o&&(o.onclick=function(){return e.exportFile(t)})}),n?.afterLoadHtml||`<div>
        Model loaded successfully and has been cached for future requests.
        `.concat(s?"":'<br/> <button style="margin-top: 5px" class="'.concat(a,' deep-chat-button">Export</button>'),`
      </div>`)}}])}();di.DOWNLOAD_BUTTON_CLASS="deep-chat-download-button",di.UPLOAD_BUTTON_CLASS="deep-chat-upload-button",di.FILE_INPUT_CLASS="deep-chat-file-input",di.EXPORT_BUTTON_CLASS="deep-chat-export-button";var Gc=di,Kc={model_list:[{model_url:"https://huggingface.co/mlc-ai/Llama-2-7b-chat-hf-q4f32_1-MLC/resolve/main/",local_id:"Llama-2-7b-chat-hf-q4f32_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-7b-chat-hf/Llama-2-7b-chat-hf-q4f32_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:9109.03,low_resource_required:!1},{model_url:"https://huggingface.co/mlc-ai/Llama-2-7b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-7b-chat-hf-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-7b-chat-hf/Llama-2-7b-chat-hf-q4f16_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:6749.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Llama-2-7b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-7b-chat-hf-q4f16_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-7b-chat-hf/Llama-2-7b-chat-hf-q4f16_1-ctx1k-webgpu.wasm",vram_required_MB:4618.52,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Llama-2-13b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-13b-chat-hf-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-13b-chat-hf/Llama-2-13b-chat-hf-q4f16_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:11814.09,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Llama-2-70b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-70b-chat-hf-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-70b-chat-hf/Llama-2-70b-chat-hf-q4f16_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:43729.05,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f16_1-ctx2k-webgpu.wasm",vram_required_MB:2972.09,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f32_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f32_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f32_1-ctx2k-webgpu.wasm",vram_required_MB:3928.09,low_resource_required:!1},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f16_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f16_1-ctx1k-webgpu.wasm",vram_required_MB:2041.09,low_resource_required:!0,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f32_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f32_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f32_1-ctx1k-webgpu.wasm",vram_required_MB:2558.09,low_resource_required:!0},{model_url:"https://huggingface.co/mlc-ai/WizardMath-7B-V1.1-q4f16_1-MLC/resolve/main/",local_id:"WizardMath-7B-V1.1-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Mistral-7B-Instruct-v0.2-q4f16_1-MLC/resolve/main/",local_id:"Mistral-7B-Instruct-v0.2-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/OpenHermes-2.5-Mistral-7B-q4f16_1-MLC/resolve/main/",local_id:"OpenHermes-2.5-Mistral-7B-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/NeuralHermes-2.5-Mistral-7B-q4f16_1-MLC/resolve/main/",local_id:"NeuralHermes-2.5-Mistral-7B-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q0f16-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q0f16",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q0f16-ctx2k-webgpu.wasm",vram_required_MB:5063.52,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q0f32-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q0f32",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q0f32-ctx2k-webgpu.wasm",vram_required_MB:5394.53,low_resource_required:!1},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q4f16_1-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q4f16_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q4f16_1-ctx1k-webgpu.wasm",vram_required_MB:899.11,low_resource_required:!0,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q4f32_1-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q4f32_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q4f32_1-ctx1k-webgpu.wasm",vram_required_MB:992.11,low_resource_required:!0}],use_web_worker:!0},_r=function(e){function r(t){var n;T(this,r);var i,s;return n=le(this,r,[t]),n._isModelLoaded=!1,n._isModelLoading=!1,n._loadOnFirstMessage=!1,n._webModel={},n.permittedErrorPrefixes=[r.MULTIPLE_MODELS_ERROR,r.WEB_LLM_NOT_FOUND_ERROR,r.GENERIC_ERROR],n._conversationHistory=[],Q(t.webModel)=="object"&&(n._webModel=t.webModel),(i=n._webModel.load)!=null&&i.clearCache&&r.clearAllCache(),n.findModelInWindow(t),n.canSendMessage=n.canSubmit.bind(Pr(n)),n._chatEl=(s=t.shadowRoot)==null?void 0:s.children[0],t.history&&r.setUpHistory(n._conversationHistory,t.history),n}return ue(r,e),A(r,[{key:"setUpMessages",value:function(n){var i=this;this._messages=n,this._removeIntro=function(){n.removeIntroductoryMessage(),i._removeIntro=void 0}}},{key:"findModelInWindow",value:function(n){var i=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a;window.webLLM?this.configureInit(this.shouldAddIntroMessage(n.introMessage)):s>r.MODULE_SEARCH_LIMIT_S?((a=this._messages)==null||a.addNewErrorMessage("service",r.WEB_LLM_NOT_FOUND_ERROR),console.error("The deep-chat-web-llm module has not been attached to the window object. Please see the following guide:"),console.error("https://deepchat.dev/examples/externalModules")):setTimeout(function(){return i.findModelInWindow(n,s+1)},1e3)}},{key:"shouldAddIntroMessage",value:function(n){var i;return!n&&this._webModel&&((i=this._webModel.introMessage)==null?void 0:i.displayed)!==!1}},{key:"scrollToTop",value:function(n){var i=this,s;((s=this._webModel.introMessage)==null?void 0:s.autoScroll)!==!1&&setTimeout(function(){var a,o;(a=i._messages)!=null&&a.elementRef&&At.scrollToTop((o=i._messages)==null?void 0:o.elementRef)},n)}},{key:"getIntroMessage",value:function(n){if(!(!this.shouldAddIntroMessage(n)||!this._chatEl)){var i=Gc.setUpInitial(this.init.bind(this),this._webModel.introMessage,this._chatEl,!!this._webModel.worker);return this.scrollToTop(1),{role:ie.AI_ROLE,html:i,sendUpdate:!1}}}},{key:"configureInit",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=this._webModel.load,!a){l.next=8;break}if(!a.onInit){l.next=5;break}return this.init(),l.abrupt("return");case 5:if(!a.onMessage){l.next=8;break}return this._loadOnFirstMessage=!0,l.abrupt("return");case 8:s||this.init();case 9:case"end":return l.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"init",value:function(){var t=O(g().mark(function i(s){var a,o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if((a=this._messages)==null||a.removeError(),o=this.attemptToCreateChat(),u.t0=o,!u.t0){u.next=6;break}return u.next=6,this.loadModel(o,s);case 6:case"end":return u.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"attemptToCreateChat",value:function(){var n;if(r.chat){(n=this._messages)==null||n.addNewErrorMessage("service",r.MULTIPLE_MODELS_ERROR),console.error(r.MULTIPLE_MODELS_ERROR);return}if(!(this._isModelLoaded||this._isModelLoading)){var i=this._webModel.worker;return Kc.use_web_worker&&i?new window.webLLM.ChatWorkerClient(i):new window.webLLM.ChatModule}}},{key:"getConfig",value:function(){var n,i=r.DEFAULT_MODEL;this._webModel.model&&(i=this._webModel.model);var s=JSON.parse(JSON.stringify(Kc));if(this._webModel.urls){var a=s.model_list.find(function(o){return o.local_id=i});a&&(this._webModel.urls.model&&(a.model_url=this._webModel.urls.model),this._webModel.urls.wasm&&(a.model_lib_url=this._webModel.urls.wasm))}return(n=this._webModel.load)!=null&&n.skipCache&&(s.use_cache=!1),{model:i,appConfig:s}}},{key:"loadModel",value:function(){var t=O(g().mark(function i(s,a){var o=this,l,u,c,d,f,h,p,m,v,y,b,M,_,E,C;return g().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return this.scrollToTop(),r.chat=s,this._isModelLoading=!0,m=((l=this._webModel.introMessage)==null?void 0:l.displayed)===!1,v=function(L){var x;(x=o._messages)==null||x.addNewMessage({html:"<div>".concat(L.text,"</div>"),overwrite:!0,sendUpdate:!1}),m&&(setTimeout(function(){var k;return At.scrollToBottom((k=o._messages)==null?void 0:k.elementRef)}),m=!1)},r.chat.setInitProgressCallback(v),P.prev=4,b=this.getConfig(),M=b.model,_=b.appConfig,E={},this._webModel.instruction&&(E.conv_config={system:this._webModel.instruction}),this._conversationHistory.length>0&&(E.conversation_history=this._conversationHistory),P.next=10,r.chat.reload(M,E,_,a);case 10:y=P.sent,P.next=16;break;case 13:return P.prev=13,P.t0=P.catch(4),P.abrupt("return",this.unloadChat(P.t0));case 16:(c=(u=this.deepChat)._validationHandler)==null||c.call(u),(d=this._webModel.introMessage)!=null&&d.removeAfterLoad?this._webModel.introMessage.displayed===!1?(h=this._messages)==null||h.removeLastMessage():(p=this._removeIntro)==null||p.call(this):(C=Gc.setUpAfterLoad(y,this._webModel.introMessage,this._chatEl,!!this._webModel.worker),(f=this._messages)==null||f.addNewMessage({html:C,overwrite:!0,sendUpdate:!1})),this._isModelLoaded=!0,this._isModelLoading=!1;case 18:case"end":return P.stop()}},i,this,[[4,13]])}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"unloadChat",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if((a=this._messages)==null||a.addNewErrorMessage("service",r.GENERIC_ERROR),console.error(s),this._isModelLoaded=!1,this._isModelLoading=!1,l.t0=r.chat,!l.t0){l.next=9;break}return l.next=8,r.chat.unload();case 8:r.chat=void 0;case 9:case"end":return l.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"immediateResp",value:function(){var t=O(g().mark(function i(s,a,o){var l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,o.generate(a,void 0,0);case 2:return d.t0=d.sent,l={text:d.t0},d.next=6,r.processResponse(this.deepChat,s,l);case 6:u=d.sent,u&&u.forEach(function(f){return s.addNewMessage(f)}),this.completionsHandlers.onFinish();case 8:case"end":return d.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"streamResp",value:function(){var t=O(g().mark(function i(s,a,o){var l=this,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.streamHandlers.abortStream.abort=function(){o.interruptGenerate()},this.streamHandlers.onOpen(),u=new jn(s),d.next=4,o.generate(a,function(){var f=O(g().mark(function h(p,m){var v;return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,r.processResponse(l.deepChat,s,{text:m});case 2:v=b.sent,v&&u.upsertStreamedMessage({text:v[0].text,overwrite:!0});case 4:case"end":return b.stop()}},h)}));return function(h,p){return f.apply(this,arguments)}}());case 4:u.finaliseStreamedMessage(),this.streamHandlers.onClose();case 6:case"end":return d.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"generateRespByType",value:function(){var t=O(g().mark(function i(s,a,o,l){var u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(d.prev=0,!o){d.next=6;break}return d.next=4,this.streamResp(s,a,l);case 4:d.next=8;break;case 6:return d.next=8,this.immediateResp(s,a,l);case 8:d.next=13;break;case 10:d.prev=10,d.t0=d.catch(0),(u=this._messages)==null||u.addNewErrorMessage("service"),console.log(d.t0);case 13:case"end":return d.stop()}},i,this,[[0,10]])}));function n(i,s,a,o){return t.apply(this,arguments)}return n}()},{key:"generateResp",value:function(){var t=O(g().mark(function i(s,a,o){var l,u,c,d,f,h,p;return g().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return l=a[a.length-1].text,v.next=3,me.processRequestInterceptor(this.deepChat,{body:{text:l}});case 3:u=v.sent,c=u.body,d=u.error,f=!!this.stream;try{d?(me.displayError(s,new Error(d)),(f?this.streamHandlers.onClose:this.completionsHandlers.onFinish)()):!c||!c.text?(h=Pe.INVALID_MODEL_REQUEST({body:c},!1),console.error(h),p=f?this.streamHandlers.onClose:this.completionsHandlers.onFinish,me.onInterceptorError(s,h,p)):this.generateRespByType(s,c.text,!!this.stream,o)}catch(y){this.unloadChat(y)}case 8:case"end":return v.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(this._isModelLoaded){c.next=7;break}if(!this._loadOnFirstMessage){c.next=6;break}return c.next=4,this.init();case 4:c.next=7;break;case 6:return c.abrupt("return");case 7:!r.chat||this._isModelLoading||((o=this._webModel.introMessage)!=null&&o.removeAfterMessage&&((l=this._removeIntro)==null||l.call(this)),s.addLoadingMessage(),this.generateResp(s,a,r.chat));case 8:case"end":return c.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"canSubmit",value:function(n){return!(n!=null&&n.trim())||this._isModelLoading?!1:this._loadOnFirstMessage?!0:!!this._isModelLoaded}},{key:"isWebModel",value:function(){return!0}}],[{key:"setUpHistory",value:function(n,i){i.forEach(function(s,a){if(s.role===ie.USER_ROLE&&s.text){var o=i[a+1];o!=null&&o.text&&o.role!==ie.USER_ROLE&&n.push([s.text,o.text])}})}},{key:"processResponse",value:function(){var t=O(g().mark(function i(s,a,o){var l,u,c,d,f,h;return g().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(l=s.responseInterceptor)==null?void 0:l.call(s,o);case 2:if(m.t0=m.sent,m.t0){m.next=5;break}m.t0=o;case 5:if(c=m.t0,!((u=s.connect)!=null&&u.stream&&Array.isArray(c)&&c.length>1)){m.next=9;break}return console.error(Pe.INVALID_STREAM_ARRAY_RESPONSE),m.abrupt("return");case 9:if(d=Array.isArray(c)?c:[c],f=d.find(function(v){return typeof v.error=="string"}),!f){m.next=15;break}return me.displayError(a,new Error(f.error)),m.abrupt("return");case 15:if(!d.find(function(v){return!v||!v.text})){m.next=19;break}return h=Pe.INVALID_MODEL_RESPONSE(o,!!s.responseInterceptor,c),me.displayError(a,new Error(h)),m.abrupt("return");case 19:return m.abrupt("return",d);case 20:case"end":return m.stop()}},i)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"clearAllCache",value:function(){r.clearCache("webllm/model"),r.clearCache("webllm/wasm")}},{key:"clearCache",value:function(n){caches.open(n).then(function(i){i.keys().then(function(s){s.forEach(function(a){i.delete(a)})})})}}])}(Gs);_r.GENERIC_ERROR="Error, please check the [troubleshooting](https://deepchat.dev/docs/webModel#troubleshooting) section of documentation for help.",_r.MULTIPLE_MODELS_ERROR="Cannot run multiple web models",_r.WEB_LLM_NOT_FOUND_ERROR="WebLLM module not found",_r.DEFAULT_MODEL="Llama-2-7b-chat-hf-q4f32_1",_r.MODULE_SEARCH_LIMIT_S=5;var ou=_r,Jc=function(){function e(){T(this,e)}return A(e,null,[{key:"buildHeaders",value:function(t){return{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(t,n,i,s){var a=t;Array.isArray(a.error)&&a.error[0]==="Error in `parameters`: field required"?i(n):s(Pe.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api-inference.huggingface.co/models/gpt2",method:"POST",handleVerificationResult:e.handleVerificationResult}}}])}(),cp=function(e){function r(t,n,i,s,a,o){var l;return T(this,r),l=le(this,r,[t,Jc.buildKeyVerificationDetails(),Jc.buildHeaders,a,o]),l.insertKeyPlaceholderText="Hugging Face Token",l.keyHelpUrl="https://huggingface.co/settings/tokens",l.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Hugging Face</b></div>
    <p>First message may take an extented amount of time to complete as the model needs to be initialized.</p>`,l.permittedErrorPrefixes=["Authorization header"],l.url="".concat(r.URL_PREFIX).concat(i),l.textInputPlaceholderText=n,Q(s)=="object"&&(s.model&&(l.url="".concat(r.URL_PREFIX).concat(s.model)),s.options&&(l.rawBody.options=s.options),s.parameters&&(l.rawBody.parameters=s.parameters)),l}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i,s){var a,o=JSON.parse(JSON.stringify(n)),l=i[i.length-1].text;if(l)return(a=o.options)!==null&&a!==void 0||(o.options={}),o.options.wait_for_model=!0,ke({inputs:l},o)}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a,o){var l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(this.connectSettings){c.next=2;break}throw new Error("Request settings have not been set up");case 2:l=this.preprocessBody(this.rawBody,a,o),je.request(this,l,s);case 4:case"end":return c.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()}])}(ft);cp.URL_PREFIX="https://api-inference.huggingface.co/models/";var pr=cp,lu=function(e){function r(t,n,i,s,a,o){var l;return T(this,r),l=le(this,r,[t,n,i,s,a,o]),l.isTextInputDisabled=!0,l.canSendMessage=r.canSendFile,l}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i,s){return s[0]}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a,o){return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.connectSettings){u.next=2;break}throw new Error("Request settings have not been set up");case 2:if(o!=null&&o[0]){u.next=4;break}throw new Error("No file was added");case 4:je.poll(this,o[0],s,!1);case 5:case"end":return u.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()}],[{key:"canSendFile",value:function(n,i){return!!(i!=null&&i[0])}}])}(pr),Nk=function(e){function r(t){T(this,r);var n,i,s,a=(i=(n=t.directConnection)==null?void 0:n.huggingFace)==null?void 0:i.audioClassification,o=(s=t.directConnection)==null?void 0:s.huggingFace;return le(this,r,[t,"Attach an audio file","ehcalabres/wav2vec2-lg-xlsr-en-speech-emotion-recognition",a,o,{audio:{}}])}return ue(r,e),A(r,[{key:"extractPollResultData",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!s.estimated_time){l.next=2;break}return l.abrupt("return",{timeoutMS:(s.estimated_time+1)*1e3});case 2:if(!s.error){l.next=4;break}throw s.error;case 4:return l.abrupt("return",{text:((a=s[0])==null?void 0:a.label)||""});case 5:case"end":return l.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(lu),Bk=function(e){function r(t){T(this,r);var n,i,s,a=(i=(n=t.directConnection)==null?void 0:n.huggingFace)==null?void 0:i.imageClassification,o=(s=t.directConnection)==null?void 0:s.huggingFace;return le(this,r,[t,"Attach an image file","google/vit-base-patch16-224",a,o,{images:{}}])}return ue(r,e),A(r,[{key:"extractPollResultData",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!s.estimated_time){l.next=2;break}return l.abrupt("return",{timeoutMS:(s.estimated_time+1)*1e3});case 2:if(!s.error){l.next=4;break}throw s.error;case 4:return l.abrupt("return",{text:((a=s[0])==null?void 0:a.label)||""});case 5:case"end":return l.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(lu),Qi="data:image/png;base64,",Wn=function(){function e(){T(this,e)}return A(e,null,[{key:"buildHeaders",value:function(t){return{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(t,n,i,s){t.message?s(Pe.INVALID_KEY):i(n)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.stability.ai/v1/engines/list",method:"GET",handleVerificationResult:e.handleVerificationResult}}}])}(),ka=function(e){function r(t,n,i,s,a){var o;return T(this,r),o=le(this,r,[t,n,i,s,a]),o.insertKeyPlaceholderText="Stability AI API Key",o.keyHelpUrl="https://platform.stability.ai/docs/getting-started/authentication",o.permittedErrorPrefixes=["Incorrect","invalid_"],o}return ue(r,e),A(r)}(ft),Fk=function(e){function r(t){var n;T(this,r);var i,s=JSON.parse(JSON.stringify(t.directConnection)),a=s?.stabilityAI,o={images:{files:{acceptedFormats:".png",maxNumberOfFiles:1}}};n=le(this,r,[t,Wn.buildKeyVerificationDetails(),Wn.buildHeaders,a,o]),n.url="https://api.stability.ai/v1/generation/esrgan-v1-x2plus/image-to-image/upscale",n.textInputPlaceholderText="Describe image changes",n.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI</b></div>
    <div style="width: 100%; text-align: center; margin-left: -10px; margin-top: 5px"><b>Image to Image Upscale</b></div>
    <p>Upload an image to generate a new one with higher resolution.</p>
    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>`;var l=(i=s?.stabilityAI)==null?void 0:i.imageToImageUpscale;return Q(l)=="object"&&(l.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(l.engine_id,"/image-to-image/upscale")),r.cleanConfig(l),Object.assign(n.rawBody,l)),n.canSendMessage=r.canSendFileMessage,n}return ue(r,e),A(r,[{key:"createFormDataBody",value:function(n,i){var s=new FormData;return s.append("image",i),Object.keys(n).forEach(function(a){s.append(a,String(n[a]))}),s}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a,o){var l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(this.connectSettings){c.next=2;break}throw new Error("Request settings have not been set up");case 2:if(o){c.next=4;break}throw new Error("Image was not found");case 4:l=this.createFormDataBody(this.rawBody,o[0]),me.tempRemoveContentHeader(this.connectSettings,je.request.bind(this,this,l,s),!1);case 6:case"end":return c.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.message){o.next=2;break}throw s.message;case 2:return o.abrupt("return",{files:s.artifacts.map(function(l){return{src:"".concat(Qi).concat(l.base64),type:"image"}})});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}],[{key:"cleanConfig",value:function(n){delete n.engine_id}},{key:"canSendFileMessage",value:function(n,i){return!!(i!=null&&i[0])}}])}(ka),Dk=function(e){function r(t){var n;T(this,r);var i,s=JSON.parse(JSON.stringify(t.directConnection)),a=s?.stabilityAI,o={images:{files:{acceptedFormats:".png",maxNumberOfFiles:2}}};n=le(this,r,[t,Wn.buildKeyVerificationDetails(),Wn.buildHeaders,a,o]),n.url="https://api.stability.ai/v1/generation/stable-diffusion-xl-1024-v1-0/image-to-image/masking",n._maskSource="MASK_IMAGE_WHITE",n.textInputPlaceholderText="Describe image changes",n.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI</b></div>
    <div style="width: 100%; text-align: center; margin-left: -10px; margin-top: 5px"><b>Image to Image Masking</b></div>
    <p>Upload an image, its mask image to create a new one based on the changes you have described for the mask area.</p>
    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>`;var l=(i=s?.stabilityAI)==null?void 0:i.imageToImageMasking;return Q(l)=="object"&&(l.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(l.engine_id,"/image-to-image/masking")),l.weight!==void 0&&l.weight!==null&&(n._imageWeight=l.weight),l.mask_source!==void 0&&l.mask_source!==null&&(n._maskSource=l.mask_source),r.cleanConfig(l),Object.assign(n.rawBody,l)),n.canSendMessage=r.canSendFileTextMessage,n}return ue(r,e),A(r,[{key:"createFormDataBody",value:function(n,i,s,a){var o=new FormData;return o.append("init_image",i),o.append("mask_source",String(this._maskSource)),o.append("mask_image",s),a&&a!==""&&o.append("text_prompts[0][text]",a),this._imageWeight!==void 0&&this._imageWeight!==null&&o.append("text_prompts[0][weight]",String(this._imageWeight)),Object.keys(n).forEach(function(l){o.append(l,String(n[l]))}),o.get("weight")===void 0&&o.append("weight",String(1)),o}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a,o){var l,u,c,d;return g().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.connectSettings){h.next=2;break}throw new Error("Request settings have not been set up");case 2:if(!(!o||!o[0]||!o[1])){h.next=4;break}throw new Error("Image was not found");case 4:c=(u=(l=a[a.length-1])==null?void 0:l.text)==null?void 0:u.trim(),d=this.createFormDataBody(this.rawBody,o[0],o[1],c),me.tempRemoveContentHeader(this.connectSettings,je.request.bind(this,this,d,s),!1);case 6:case"end":return h.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.message){o.next=2;break}throw s.message;case 2:return o.abrupt("return",{files:s.artifacts.map(function(l){return{src:"".concat(Qi).concat(l.base64),type:"image"}})});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}],[{key:"cleanConfig",value:function(n){delete n.engine_id,delete n.weight}},{key:"canSendFileTextMessage",value:function(n,i){return!!(i!=null&&i[0])&&!!(n&&n.trim()!=="")}}])}(ka),$k=function(e){function r(t){T(this,r);var n,i,s,a=(i=(n=t.directConnection)==null?void 0:n.huggingFace)==null?void 0:i.audioSpeechRecognition,o=(s=t.directConnection)==null?void 0:s.huggingFace;return le(this,r,[t,"Attach an audio file","facebook/wav2vec2-large-960h-lv60-self",a,o,{audio:{}}])}return ue(r,e),A(r,[{key:"extractPollResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.estimated_time){o.next=2;break}return o.abrupt("return",{timeoutMS:(s.estimated_time+1)*1e3});case 2:if(!s.error){o.next=4;break}throw s.error;case 4:return o.abrupt("return",{text:s.text||""});case 5:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(lu),jk=function(e){function r(t){T(this,r);var n,i,s,a=(i=(n=t.directConnection)==null?void 0:n.huggingFace)==null?void 0:i.textGeneration,o=(s=t.directConnection)==null?void 0:s.huggingFace;return le(this,r,[t,"Once upon a time","gpt2",a,o])}return ue(r,e),A(r,[{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!s.error){l.next=2;break}throw s.error;case 2:return l.abrupt("return",{text:((a=s[0])==null?void 0:a.generated_text)||""});case 3:case"end":return l.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(pr),Uk=function(e){function r(t){var n;T(this,r);var i,s,a,o=(s=(i=t.directConnection)==null?void 0:i.huggingFace)==null?void 0:s.questionAnswer,l=(a=t.directConnection)==null?void 0:a.huggingFace;return n=le(this,r,[t,"Ask a question","bert-large-uncased-whole-word-masking-finetuned-squad",o,l]),n.permittedErrorPrefixes=["Authorization header","Error in"],n._context=o.context,n}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i){var s=i[i.length-1].text;if(s)return{inputs:{question:s,context:this._context,options:{wait_for_model:!0}}}}},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.error){o.next=2;break}throw s.error;case 2:return o.abrupt("return",{text:s.answer||""});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(pr),Hk=function(e){function r(t){T(this,r);var n,i,s,a=(i=(n=t.directConnection)==null?void 0:n.huggingFace)==null?void 0:i.summarization,o=(s=t.directConnection)==null?void 0:s.huggingFace;return le(this,r,[t,"Insert text to summarize","facebook/bart-large-cnn",a,o])}return ue(r,e),A(r,[{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!s.error){l.next=2;break}throw s.error;case 2:return l.abrupt("return",{text:((a=s[0])==null?void 0:a.summary_text)||""});case 3:case"end":return l.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(pr),zk=function(e){function r(t){var n,i;T(this,r);var s,a,o,l=(a=(s=t.directConnection)==null?void 0:s.huggingFace)==null?void 0:a.conversation,u=(o=t.directConnection)==null?void 0:o.huggingFace;return i=le(this,r,[t,"Ask me anything!","facebook/blenderbot-400M-distill",l,u]),(n=i.maxMessages)!==null&&n!==void 0||(i.maxMessages=-1),i}return ue(r,e),A(r,[{key:"processMessages",value:function(n){var i=n.filter(function(u){return u.text}),s=i[i.length-1].text,a=i.slice(0,i.length-1);if(s){var o=a.filter(function(u){return u.role==="user"}).map(function(u){return u.text}),l=a.filter(function(u){return u.role==="ai"}).map(function(u){return u.text});return{past_user_inputs:o,generated_responses:l,mostRecentMessageText:s}}}},{key:"preprocessBody",value:function(n,i){var s,a=JSON.parse(JSON.stringify(n)),o=this.processMessages(i);if(o)return(s=a.options)!==null&&s!==void 0||(a.options={}),a.options.wait_for_model=!0,ke({inputs:{past_user_inputs:o.past_user_inputs,generated_responses:o.generated_responses,text:o.mostRecentMessageText}},a)}},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.error){o.next=2;break}throw s.error;case 2:return o.abrupt("return",{text:s.generated_text||""});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(pr),Wk=function(e){function r(t){var n;T(this,r);var i,s=JSON.parse(JSON.stringify(t.directConnection)),a=s.stabilityAI,o={images:{files:{acceptedFormats:".png",maxNumberOfFiles:1}}};n=le(this,r,[t,Wn.buildKeyVerificationDetails(),Wn.buildHeaders,a,o]),n.url="https://api.stability.ai/v1/generation/stable-diffusion-v1-6/image-to-image",n.textInputPlaceholderText="Describe image changes",n.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI: Image to Image</b></div>
    <p>Upload an image to create a new one with the changes you have described.</p>
    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>`;var l=(i=s.stabilityAI)==null?void 0:i.imageToImage;return Q(l)=="object"&&(l.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(l.engine_id,"/text-to-image")),l.weight!==void 0&&l.weight!==null&&(n._imageWeight=l.weight),r.cleanConfig(l),Object.assign(n.rawBody,l)),n.canSendMessage=r.canSendFileTextMessage,n}return ue(r,e),A(r,[{key:"createFormDataBody",value:function(n,i,s){var a=new FormData;return a.append("init_image",i),s&&s!==""&&a.append("text_prompts[0][text]",s),this._imageWeight!==void 0&&this._imageWeight!==null&&a.append("text_prompts[0][weight]",String(this._imageWeight)),Object.keys(n).forEach(function(o){a.append(o,String(n[o]))}),a.get("weight")===void 0&&a.append("weight",String(1)),a}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a,o){var l,u,c,d;return g().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.connectSettings){h.next=2;break}throw new Error("Request settings have not been set up");case 2:if(o){h.next=4;break}throw new Error("Image was not found");case 4:c=(u=(l=a[a.length-1])==null?void 0:l.text)==null?void 0:u.trim(),d=this.createFormDataBody(this.rawBody,o[0],c),me.tempRemoveContentHeader(this.connectSettings,je.request.bind(this,this,d,s),!1);case 6:case"end":return h.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.message){o.next=2;break}throw s.message;case 2:return o.abrupt("return",{files:s.artifacts.map(function(l){return{src:"".concat(Qi).concat(l.base64),type:"image"}})});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}],[{key:"cleanConfig",value:function(n){delete n.engine_id,delete n.weight}},{key:"canSendFileTextMessage",value:function(n,i){return!!(i!=null&&i[0])&&!!(n&&n.trim()!=="")}}])}(ka),Vk=function(e){function r(t){T(this,r);var n,i,s,a=(i=(n=t.directConnection)==null?void 0:n.huggingFace)==null?void 0:i.translation,o=(s=t.directConnection)==null?void 0:s.huggingFace;return le(this,r,[t,"Insert text to translate","Helsinki-NLP/opus-tatoeba-en-ja",a,o])}return ue(r,e),A(r,[{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!s.error){l.next=2;break}throw s.error;case 2:return l.abrupt("return",{text:((a=s[0])==null?void 0:a.translation_text)||""});case 3:case"end":return l.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(pr),qk=function(e){function r(t){var n;T(this,r);var i,s=JSON.parse(JSON.stringify(t.directConnection)),a=s.stabilityAI;n=le(this,r,[t,Wn.buildKeyVerificationDetails(),Wn.buildHeaders,a]),n.url="https://api.stability.ai/v1/generation/stable-diffusion-v1-6/text-to-image",n.textInputPlaceholderText="Describe an image",n.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI: Text to Image</b></div>
    <p>Insert text to generate an image.</p>
    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>`;var o=(i=s.stabilityAI)==null?void 0:i.textToImage;return Q(o)=="object"&&(o.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(o.engine_id,"/text-to-image")),o.weight!==void 0&&o.weight!==null&&(n._imageWeight=o.weight),r.cleanConfig(o),Object.assign(n.rawBody,o)),n.canSendMessage=r.canSendTextMessage,n}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i){var s=JSON.parse(JSON.stringify(n)),a={text:i};return this._imageWeight&&(a.weight=this._imageWeight),s.text_prompts=[a],s}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.connectSettings){u.next=2;break}throw new Error("Request settings have not been set up");case 2:o=this.preprocessBody(this.rawBody,a[a.length-1].text),je.request(this,o,s);case 4:case"end":return u.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.message){o.next=2;break}throw s.message;case 2:return o.abrupt("return",{files:s.artifacts.map(function(l){return{src:"".concat(Qi).concat(l.base64),type:"image"}})});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}],[{key:"cleanConfig",value:function(n){delete n.engine_id,delete n.weight}},{key:"canSendTextMessage",value:function(n){return!!(n&&n.trim()!=="")}}])}(ka),Gk=function(e){function r(t){var n;T(this,r);var i,s,a,o=(s=(i=t.directConnection)==null?void 0:i.huggingFace)==null?void 0:s.fillMask,l=(a=t.directConnection)==null?void 0:a.huggingFace;return n=le(this,r,[t,"The goal of life is [MASK].","bert-base-uncased",o,l]),n.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Hugging Face</b></div>
    <p>Insert a sentence with the word [MASK] and the model will try to fill it for you. E.g. I want [MASK].</p>
    <p>First message may take an extented amount of time to complete as the model needs to be initialized.</p>`,n.permittedErrorPrefixes=["Authorization header","No mask_token"],n}return ue(r,e),A(r,[{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!s.error){l.next=2;break}throw s.error;case 2:return l.abrupt("return",{text:((a=s[0])==null?void 0:a.sequence)||""});case 3:case"end":return l.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(pr),il=function(){function e(){T(this,e)}return A(e,null,[{key:"buildHeaders",value:function(t){return{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(t,n,i,s){var a=t;a.error?a.error.code==="invalid_api_key"?s(Pe.INVALID_KEY):s(Pe.CONNECTION_FAILED):i(n)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.openai.com/v1/models",method:"GET",handleVerificationResult:e.handleVerificationResult}}},{key:"directFetch",value:function(){var r=O(g().mark(function n(i,s,a){var o,l,u=arguments;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=u.length>3&&u[3]!==void 0?u[3]:!0,i.connectSettings.method=a,d.next=4,me.fetch(i,i.connectSettings.headers,o,s).then(function(f){return me.processResponseByType(f)});case 4:if(l=d.sent,!l.error){d.next=7;break}throw l.error.message;case 7:return d.abrupt("return",l);case 8:case"end":return d.stop()}},n)}));function t(n,i,s){return r.apply(this,arguments)}return t}()}])}();il.FUNCTION_TOOL_RESP_ERROR="Response object must either be {response: string}[] for each individual function or {text: string} for a direct response, see https://deepchat.dev/docs/directConnection/OpenAI#FunctionHandler.",il.FUNCTION_TOOL_RESP_ARR_ERROR="Arrays are not accepted in handler responses";var Qe=il,sl=function(){function e(){T(this,e)}return A(e,null,[{key:"storeFiles",value:function(){var r=O(g().mark(function n(i,s,a,o){var l,u,c,d;return g().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l=i.connectSettings.headers,l){h.next=3;break}return h.abrupt("return");case 3:return i.url=o,u=l[me.CONTENT_TYPE],delete l[me.CONTENT_TYPE],c=a.map(function(){var p=O(g().mark(function m(v){var y;return g().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return y=new FormData,M.abrupt("return",(y.append("purpose","assistants"),y.append("file",v),new Promise(function(_){_(Qe.directFetch(i,y,"POST",!1))})));case 2:case"end":return M.stop()}},m)}));return function(m){return p.apply(this,arguments)}}()),h.prev=7,h.next=10,Promise.all(c);case 10:return d=h.sent.map(function(p){return{id:p.id,name:p.filename}}),h.abrupt("return",(l[me.CONTENT_TYPE]=u,d));case 14:throw h.prev=14,h.t0=h.catch(7),l[me.CONTENT_TYPE]=u,me.displayError(s,h.t0),i.completionsHandlers.onFinish(),h.t0;case 17:case"end":return h.stop()}},n,null,[[7,14]])}));function t(n,i,s,a){return r.apply(this,arguments)}return t}()},{key:"getType",value:function(t,n){var i=t[n].path;return!i||i.endsWith("png")?"image":"any"}},{key:"getFiles",value:function(){var r=O(g().mark(function n(i,s,a,o){var l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return l=s.map(function(f){var h=f.fileId;return i.url="".concat(a).concat(h).concat(o),new Promise(function(p){p(Qe.directFetch(i,void 0,"GET",!1))})}),d.next=3,Promise.all(l);case 3:return u=d.sent.map(function(f,h){return new Promise(function(p){var m=new FileReader;m.readAsDataURL(f),m.onload=function(v){p({src:v.target.result,name:s[h].name,type:e.getType(s,h)})}})}),d.next=6,Promise.all(u);case 6:return d.abrupt("return",d.sent);case 7:case"end":return d.stop()}},n)}));function t(n,i,s,a){return r.apply(this,arguments)}return t}()},{key:"getFileName",value:function(t){var n=t.split("/");return n[n.length-1]}},{key:"getFilesAndNewText",value:function(){var r=O(g().mark(function n(i,s,a,o,l){var u,c,d,f,h;return g().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(f=a.getFilesPrefix,h=a.getFilesPostfix,m.t0=s.length>0,!m.t0){m.next=7;break}return m.next=5,e.getFiles(i,s,f,h);case 5:d=m.sent,(u=l?.text)!=null&&u.value&&d.forEach(function(v,y){var b;if(v.src){var M=s[y].path;(b=l?.text)!=null&&b.value&&M&&(l.text.value=l.text.value.replace(M,v.src))}});case 7:return m.abrupt("return",(c=l?.text)!=null&&c.value?{text:l.text.value,role:o}:{files:d,role:o});case 8:case"end":return m.stop()}},n)}));function t(n,i,s,a,o){return r.apply(this,arguments)}return t}()},{key:"getFileDetails",value:function(t,n){var i,s=[];return(i=n?.text)!=null&&i.value&&t.content.forEach(function(a){var o,l;(l=(o=a.text)==null?void 0:o.annotations)==null||l.forEach(function(u){var c;u.text&&u.text.startsWith("sandbox:")&&(c=u.file_path)!=null&&c.file_id&&s.push({path:u.text,fileId:u.file_path.file_id,name:e.getFileName(u.text)})})}),n!=null&&n.image_file&&s.push({fileId:n.image_file.file_id}),s}},{key:"getFilesAndText",value:function(){var r=O(g().mark(function n(i,s,a,o){var l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return l=e.getFileDetails(s,o),c.next=3,e.getFilesAndNewText(i,l,a,s.role,o);case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},n)}));function t(n,i,s,a){return r.apply(this,arguments)}return t}()},{key:"parseResult",value:function(t,n){var i=[];if(n)i=t.data;else for(var s=0;s<t.data.length;s+=1){var a=t.data[s];if(a.role==="assistant")i.push(a);else break}return i.reverse()}},{key:"parseMessages",value:function(t,n,i){var s=[];return n.forEach(function(){var a=O(g().mark(function o(l){return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:l.content.filter(function(d){return!!d.text||!!d.image_file}).sort(function(d){return d.text?-1:d.image_file?1:0}).forEach(function(){var d=O(g().mark(function f(h){return g().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:s.push(e.getFilesAndText(t,l,i,h));case 1:case"end":return m.stop()}},f)}));return function(f){return d.apply(this,arguments)}}());case 1:case"end":return c.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),Promise.all(s)}},{key:"processStreamMessages",value:function(){var r=O(g().mark(function n(i,s,a){return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",e.parseMessages(i,[{content:s,role:"assistant"}],a));case 1:case"end":return l.stop()}},n)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"processAPIMessages",value:function(){var r=O(g().mark(function n(i,s,a,o){var l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return l=e.parseResult(s,a),c.abrupt("return",e.parseMessages(i,l,o));case 2:case"end":return c.stop()}},n)}));function t(n,i,s,a){return r.apply(this,arguments)}return t}()}])}();sl.FILES_WITH_TEXT_ERROR="content with type `text` must have `text` values",sl.FUNCTION_TOOL_RESP_ERROR="Response must contain an array of strings for each individual function/tool_call, see https://deepchat.dev/docs/directConnection/OpenAI/#assistant-functions.";var Xn=sl,dp=function(e){function r(t,n,i,s,a,o){var l;if(T(this,r),l=le(this,r,[t,s,a,o]),l.insertKeyPlaceholderText="OpenAI API Key",l.keyHelpUrl="https://platform.openai.com/account/api-keys",l.url="",l.permittedErrorPrefixes=["Incorrect","Please send text",au.FAILED_ERROR_MESSAGE],l.shouldFetchHistory=!1,l._searchedForThreadId=!1,l._config={},l._newAssistantDetails={model:"gpt-4"},l._waitingForStreamResponse=!1,l._isSSEStream=!1,l.urlSegments=i,Q(n)=="object"){l._config=n;var u=l._config,c=u.new_assistant,d=u.thread_id,f=u.load_thread_history;Object.assign(l._newAssistantDetails,c),d&&(l.sessionId=d),f&&(l.shouldFetchHistory=!0)}return l.maxMessages=1,l._isSSEStream=!!(l.stream&&(Q(l.stream)!="object"||!l.stream.simulation)),l}return ue(r,e),A(r,[{key:"fetchHistoryFunc",value:function(){var t=O(g().mark(function i(){var s=this,a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return setTimeout(function(){return s.deepChat.disableSubmitButton()},2),l.prev=1,l.next=4,this.getThreadMessages(this.sessionId,!0);case 4:return a=l.sent,l.abrupt("return",(this.deepChat.disableSubmitButton(!1),a));case 8:return l.prev=8,l.t0=l.catch(1),l.abrupt("return",[{error:"Failed to fetch history"}]);case 11:case"end":return l.stop()}},i,this,[[1,8]])}));function n(){return t.apply(this,arguments)}return n}()},{key:"processMessage",value:function(n,i){var s=this.totalMessagesMaxCharLength||-1,a=Sa.getCharacterLimitMessages(n,s)[0];if(i&&i.length>0){var o=this.filesToolType;if(typeof this.filesToolType=="function"){var l=this.filesToolType(i.map(function(c){var d=c.name;return d}));l==="code_interpreter"||l==="file_search"||l==="images"?o=l:(console.error('Tool type "'.concat(l,'" is not valid')),console.error('Expected "code_interpreter" or "file_search" or "images". Going to default to "images"'))}if(o==="file_search")return r.processAttachmentsMessage(a,i,"file_search");if(o==="code_interpreter")return r.processAttachmentsMessage(a,i,"code_interpreter");if(i.find(function(c){var d=c.name;return!Et.isImageFileExtension(d)}))console.error("The uploaded files contained a non-image file"),console.error('Make sure only images can be uploaded or define a "code_interpreter" or "file_search" value in the "files_tool_type" property'),console.warn('Make sure your existing assistant supports these "tools" or specify them in the "new_assistant" property');else{var u=r.processImageMessage(a,i);if(u)return u}}return{content:a.text||"",role:"user"}}},{key:"createNewThreadMessages",value:function(n,i,s){var a=JSON.parse(JSON.stringify(n)),o=this.processMessage(i,s);return a.thread={messages:[o]},a}},{key:"callService",value:function(n,i,s){if(this._messages=n,this.sessionId){this.url="".concat(this.urlSegments.threadsPrefix,"/").concat(this.sessionId,"/messages").concat(this.urlSegments.createMessagePostfix);var a=this.processMessage(i,s);je.request(this,a,n)}else{this.url="".concat(this.urlSegments.threadsPrefix,"/runs").concat(this.urlSegments.threadsPosfix);var o=this.createNewThreadMessages(this.rawBody,i,s);this._isSSEStream?this.createStreamRun(o):je.request(this,o,n)}}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a,o){var l,u,c;return g().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this._waitingForStreamResponse=!1,!!this.connectSettings){f.next=2;break}throw new Error("Request settings have not been set up");case 2:if(!((l=(u=this.rawBody).assistant_id)!==null&&l!==void 0)){f.next=6;break}f.next=12;break;case 6:if(f.t0=this._config.assistant_id,f.t0){f.next=11;break}return f.next=10,this.createNewAssistant();case 10:f.t0=f.sent;case 11:u.assistant_id=f.t0;case 12:if(this._searchedForThreadId||this.searchPreviousMessagesForThreadId(s.messageToElements),!o){f.next=19;break}return f.next=16,Xn.storeFiles(this,s,o,this.urlSegments.storeFiles);case 16:f.t1=f.sent,f.next=20;break;case 19:f.t1=void 0;case 20:c=f.t1,this.connectSettings.method="POST",this.callService(s,a,c);case 22:case"end":return f.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"createNewAssistant",value:function(){var t=O(g().mark(function i(){var s;return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,this.url=this.urlSegments.newAssistantUrl,o.next=4,Qe.directFetch(this,JSON.parse(JSON.stringify(this._newAssistantDetails)),"POST");case 4:return s=o.sent,o.abrupt("return",(this._config.assistant_id=s.id,this._config.assistant_id));case 8:o.prev=8,o.t0=o.catch(0),console.error(o.t0),console.error("Failed to create a new assistant");case 11:case"end":return o.stop()}},i,this,[[0,8]])}));function n(){return t.apply(this,arguments)}return n}()},{key:"searchPreviousMessagesForThreadId",value:function(n){var i=n.find(function(s){var a=or(s,1),o=a[0];return o._sessionId});i&&(this.sessionId=i[0]._sessionId),this._searchedForThreadId=!0}},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){var a,o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(this._waitingForStreamResponse||this._isSSEStream&&this.sessionId)){c.next=4;break}return c.next=3,this.handleStream(s);case 3:return c.abrupt("return",c.sent);case 4:if(!s.error){c.next=6;break}throw s.error.message.startsWith(Xn.FILES_WITH_TEXT_ERROR)?Error("Please send text with your file(s)"):s.error.message;case 6:return c.next=8,this.assignThreadAndRun(s);case 8:return o="".concat(this.urlSegments.threadsPrefix,"/").concat(this.sessionId,"/runs/").concat(this.run_id).concat(this.urlSegments.threadsPosfix),l={method:"GET",headers:(a=this.connectSettings)==null?void 0:a.headers},c.abrupt("return",(je.executePollRequest(this,o,l,this._messages),{makingAnotherRequest:!0}));case 10:case"end":return c.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"assignThreadAndRun",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.sessionId){l.next=8;break}return this.url="".concat(this.urlSegments.threadsPrefix,"/").concat(this.sessionId,"/runs").concat(this.urlSegments.threadsPosfix),l.next=4,Qe.directFetch(this,JSON.parse(JSON.stringify(this.rawBody)),"POST");case 4:a=l.sent,this.run_id=a.id,l.next=9;break;case 8:this.sessionId=s.thread_id,this.run_id=s.id,this._messages&&this._messages.messageToElements.length>0&&(this._messages.messageToElements[this._messages.messageToElements.length-1][0]._sessionId=this.sessionId);case 9:case"end":return l.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"getThreadMessages",value:function(){var t=O(g().mark(function i(s){var a,o,l,u,c=arguments;return g().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return a=c.length>1&&c[1]!==void 0?c[1]:!1,this.url="".concat(this.urlSegments.threadsPrefix,"/").concat(s,"/messages?").concat(this.urlSegments.listMessagesPostfix),f.next=4,Qe.directFetch(this,{},"GET");case 4:if(u=f.sent,f.t0=!a&&this.deepChat.responseInterceptor,!f.t0){f.next=10;break}return f.next=9,(l=(o=this.deepChat).responseInterceptor)==null?void 0:l.call(o,u);case 9:u=f.sent;case 10:return f.abrupt("return",Xn.processAPIMessages(this,u,a,this.urlSegments));case 11:case"end":return f.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"extractPollResultData",value:function(){var t=O(g().mark(function i(s){var a=this,o,l,u,c,d,f,h,p;return g().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(l=s.status,u=s.required_action,!(l==="queued"||l==="in_progress")){v.next=3;break}return v.abrupt("return",{timeoutMS:r.POLLING_TIMEOUT_MS});case 3:if(!(l==="completed"&&this._messages)){v.next=11;break}return v.next=6,this.getThreadMessages(s.thread_id);case 6:return c=v.sent,d=c.shift(),f=d.text,h=d.files,v.abrupt("return",(setTimeout(function(){c.forEach(function(y){return a.deepChat.addMessage(y)})}),{text:f,_sessionId:this.sessionId,files:h}));case 11:if(p=(o=u?.submit_tool_outputs)==null?void 0:o.tool_calls,!(l==="requires_action"&&p)){v.next=16;break}return v.next=15,this.handleTools(p);case 15:return v.abrupt("return",v.sent);case 16:throw Error("Thread run status: ".concat(l));case 17:case"end":return v.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"handleTools",value:function(){var t=O(g().mark(function i(s){var a,o,l,u,c,d;return g().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.functionHandler){h.next=2;break}throw Error("Please define the `function_handler` property inside the [openAI](https://deepchat.dev/docs/directConnection/openAI#Assistant) object.");case 2:return a=s.map(function(p){return{name:p.function.name,arguments:p.function.arguments}}),h.next=5,this.functionHandler(a);case 5:if(o=h.sent,!(!Array.isArray(o)||s.length!==o.length)){h.next=8;break}throw Error(Xn.FUNCTION_TOOL_RESP_ERROR);case 8:return h.next=10,Promise.all(o);case 10:if(l=h.sent,!l.find(function(p){return typeof p!="string"})){h.next=13;break}throw Error(Xn.FUNCTION_TOOL_RESP_ERROR);case 13:if(u=l.map(function(p,m){return{tool_call_id:s[m].id,output:p}}),c="".concat(this.urlSegments.threadsPrefix,"/").concat(this.sessionId),d="/runs/".concat(this.run_id,"/submit_tool_outputs").concat(this.urlSegments.threadsPosfix),this.url="".concat(c).concat(d),!this._isSSEStream){h.next=20;break}return h.next=18,this.createStreamRun({tool_outputs:u});case 18:h.next=22;break;case 20:return h.next=22,Qe.directFetch(this,{tool_outputs:u},"POST");case 22:return h.abrupt("return",{timeoutMS:r.POLLING_TIMEOUT_MS});case 23:case"end":return h.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"handleStream",value:function(){var t=O(g().mark(function i(s){var a,o,l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(l=(o=(a=s.required_action)==null?void 0:a.submit_tool_outputs)==null?void 0:o.tool_calls,!(s.status==="requires_action"&&l)){d.next=6;break}return this.run_id=s.id,d.next=5,this.handleTools(l);case 5:return d.abrupt("return",d.sent);case 6:if(!this._waitingForStreamResponse){d.next=8;break}return d.abrupt("return",this.parseStreamResult(s));case 8:return this._isSSEStream&&this.sessionId&&(this.url="".concat(this.urlSegments.threadsPrefix,"/").concat(this.sessionId,"/runs").concat(this.urlSegments.threadsPosfix),u=JSON.parse(JSON.stringify(this.rawBody)),this.createStreamRun(u)),d.abrupt("return",{makingAnotherRequest:!0});case 10:case"end":return d.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"parseStreamResult",value:function(){var t=O(g().mark(function i(s){var a,o,l,u,c,d,f,h,p,m;return g().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(s.content&&s.content.length>0&&this._messages)){y.next=5;break}if(d=s.content.find(function(b){return b.text}),!((a=d?.text)!=null&&a.annotations&&d.text.annotations.length>0)){y.next=5;break}return f=s.content.find(function(b){return!!b.text})||s.content[0],h=Xn.getFilesAndText.bind(this,this,{role:"assistant",content:s.content},this.urlSegments,f),y.abrupt("return",((o=this._messageStream)==null||o.endStreamAfterFileDownloaded(this._messages,h),{text:""}));case 5:if(!((l=s.delta)!=null&&l.content)){y.next=14;break}if(!(s.delta.content.length>1)){y.next=13;break}if(p=s.delta.content.find(function(b){return b.text}),!((u=p?.text)!=null&&u.annotations&&p.text.annotations.length===0)){y.next=13;break}return y.next=11,Xn.processStreamMessages(this,s.delta.content,this.urlSegments);case 11:return m=y.sent,y.abrupt("return",{text:m[0].text,files:m[1].files});case 13:return y.abrupt("return",{text:(c=s.delta.content[0].text)==null?void 0:c.value});case 14:return y.abrupt("return",(!this.sessionId&&s.thread_id&&(this.sessionId=s.thread_id),{makingAnotherRequest:!0}));case 15:case"end":return y.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"createStreamRun",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return s.stream=!0,this._waitingForStreamResponse=!0,o.next=4,et.request(this,s,this._messages,!0,!0);case 4:this._messageStream=o.sent;case 5:case"end":return o.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()}],[{key:"processImageMessage",value:function(n,i){var s=i?.filter(function(a){return Et.isImageFileExtension(a.name)}).map(function(a){return{type:"image_file",image_file:{file_id:a.id}}});if(s&&s.length>0)return n.text&&n.text.length>0&&s.push({type:"text",text:n.text}),{content:s,role:"user"}}},{key:"processAttachmentsMessage",value:function(n,i,s){return{attachments:i.map(function(a){return{tools:[{type:s}],file_id:a.id}}),content:[{type:"text",text:n.text}],role:"user"}}}])}(ft);dp.POLLING_TIMEOUT_MS=500;var fp=dp,Kk=function(e){function r(t){var n,i,s;T(this,r);var a,o,l,u,c,d=JSON.parse(JSON.stringify(t.directConnection)),f=d.openAI,h=(a=d.openAI)==null?void 0:a.assistant,p=r.buildUrlSegments(h);if(s=le(this,r,[t,h,p,Qe.buildKeyVerificationDetails(),Qe.buildHeaders,f]),(n=(o=s.connectSettings).headers)!==null&&n!==void 0||(o.headers={}),(i=(l=s.connectSettings.headers)["OpenAI-Beta"])!==null&&i!==void 0||(l["OpenAI-Beta"]="assistants=v2"),s.shouldFetchHistory&&s.sessionId&&(s.fetchHistory=s.fetchHistoryFunc.bind(Pr(s))),Q(h)=="object"){var m=(c=(u=t.directConnection)==null?void 0:u.openAI)==null?void 0:c.assistant,v=m.function_handler,y=m.files_tool_type;v&&(s.functionHandler=v),y&&(s.filesToolType=y)}return s}return ue(r,e),A(r,null,[{key:"buildUrlSegments",value:function(n){var i=Q(n)=="object"&&n.custom_base_url||"https://api.openai.com/v1";return{threadsPrefix:"".concat(i,"/threads"),threadsPosfix:"",newAssistantUrl:"".concat(i,"/assistants"),createMessagePostfix:"",listMessagesPostfix:"order=desc",storeFiles:"".concat(i,"/files"),getFilesPrefix:"".concat(i,"/files/"),getFilesPostfix:"/content"}}}])}(fp),Xc=function(){function e(){T(this,e)}return A(e,null,[{key:"buildHeaders",value:function(t){return{Authorization:"Bearer ".concat(t),"Content-Type":"application/json",accept:"application/json"}}},{key:"handleVerificationResult",value:function(t,n,i,s){var a;(a=t.message)!=null&&a.includes("invalid request: prompt must be at least 1 token long")?i(n):s(Pe.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.cohere.ai/v1/generate",method:"POST",handleVerificationResult:e.handleVerificationResult,body:JSON.stringify({prompt:""})}}}])}(),uu=function(e){function r(t,n,i,s,a){var o;return T(this,r),o=le(this,r,[t,Xc.buildKeyVerificationDetails(),Xc.buildHeaders,a]),o.insertKeyPlaceholderText="Cohere API Key",o.keyHelpUrl="https://dashboard.cohere.ai/api-keys",o.permittedErrorPrefixes=["invalid"],o.url=n,o.textInputPlaceholderText=i,s&&Q(s)=="object"&&Object.assign(o.rawBody,s),o}return ue(r,e),A(r)}(ft),Jk=function(e){function r(t){T(this,r);var n,i,s,a=(i=(n=t.directConnection)==null?void 0:n.cohere)==null?void 0:i.textGeneration,o=(s=t.directConnection)==null?void 0:s.cohere;return le(this,r,[t,"https://api.cohere.ai/v1/generate","Once upon a time",a,o])}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i){var s=JSON.parse(JSON.stringify(n)),a=i[i.length-1].text;if(a)return ke({prompt:a},s)}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.connectSettings){u.next=2;break}throw new Error("Request settings have not been set up");case 2:o=this.preprocessBody(this.rawBody,a),je.request(this,o,s);case 4:case"end":return u.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!s.message){l.next=2;break}throw s.message;case 2:return l.abrupt("return",{text:((a=s.generations)==null?void 0:a[0].text)||""});case 3:case"end":return l.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(uu),hp=function(){function e(){T(this,e)}return A(e,null,[{key:"buildHeaders",value:function(t){return{"api-key":t,"Content-Type":"application/json"}}},{key:"buildKeyVerificationDetails",value:function(t){return{url:"".concat(t.endpoint,"/openai/models?api-version=").concat(t.version),method:"GET",handleVerificationResult:Qe.handleVerificationResult}}},{key:"validateURLDetails",value:function(t){var n=t.endpoint,i=t.version,s=t.deploymentId;return n&&i&&s}}])}();hp.URL_DETAILS_ERROR_MESSAGE="Please define the Azure URL Details. [More Information](https://deepchat.dev/docs/directConnection/Azure)";var Yt=hp,al=function(e){function r(t){var n,i;T(this,r);var s,a,o,l,u,c,d,f,h=JSON.parse(JSON.stringify(t.directConnection)),p=h.azure,m=(s=h.azure)==null?void 0:s.openAI,v=m?.urlDetails||{},y="".concat((a=m?.urlDetails)==null?void 0:a.endpoint,"/openai/"),b="?api-version=".concat((o=m?.urlDetails)==null?void 0:o.version),M={threadsPrefix:"".concat(y).concat(r.THREAD_RESOURCE),threadsPosfix:b,newAssistantUrl:"".concat(y).concat(r.NEW_ASSISTANT_RESOURCE).concat(b),createMessagePostfix:b,listMessagesPostfix:"order=desc&api-version=".concat((l=m?.urlDetails)==null?void 0:l.version),storeFiles:"".concat(y,"files").concat(b),getFilesPrefix:"".concat(y,"files/"),getFilesPostfix:"/content".concat(b)};if(i=le(this,r,[t,m?.assistant,M,Yt.buildKeyVerificationDetails(v),Yt.buildHeaders,p]),i.permittedErrorPrefixes=[Yt.URL_DETAILS_ERROR_MESSAGE],i.insertKeyPlaceholderText="Azure OpenAI API Key",i.keyHelpUrl="https://learn.microsoft.com/en-us/answers/questions/1193991/how-to-get-the-value-of-openai-api-key",i.isTextInputDisabled=!1,Q(m?.assistant)=="object"){var _=(d=(c=(u=t.directConnection)==null?void 0:u.azure)==null?void 0:c.openAI)==null?void 0:d.assistant,E=_.function_handler,C=_.files_tool_type;E&&(i.functionHandler=E),C&&(i.filesToolType=C)}return Yt.validateURLDetails(v)?(n=(f=i.connectSettings).headers)!==null&&n!==void 0||(f.headers={}):(i.isTextInputDisabled=!0,i.canSendMessage=function(){return!1},setTimeout(function(){t.addMessage({error:Yt.URL_DETAILS_ERROR_MESSAGE})})),i}return ue(r,e),A(r)}(fp);al.THREAD_RESOURCE="threads",al.NEW_ASSISTANT_RESOURCE="assistants";var Xk=al,Yk=function(e){function r(t){T(this,r);var n,i,s,a=(i=(n=t.directConnection)==null?void 0:n.cohere)==null?void 0:i.summarization,o=(s=t.directConnection)==null?void 0:s.cohere;return le(this,r,[t,"https://api.cohere.ai/v1/summarize","Insert text to summarize",a,o])}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i){var s=JSON.parse(JSON.stringify(n)),a=i[i.length-1].text;if(a)return ke({text:a},s)}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.connectSettings){u.next=2;break}throw new Error("Request settings have not been set up");case 2:o=this.preprocessBody(this.rawBody,a),je.request(this,o,s);case 4:case"end":return u.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.message){o.next=2;break}throw s.message;case 2:return o.abrupt("return",{text:s.summary||""});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(uu),tt=function(){function e(){T(this,e)}return A(e,null,[{key:"addAttributes",value:function(t){t.role="button",t.setAttribute("tabindex","0")}},{key:"addAriaBusy",value:function(t){t.setAttribute("aria-busy","true")}},{key:"removeAriaBusy",value:function(t){t.removeAttribute("aria-busy")}},{key:"addAriaDisabled",value:function(t){t.setAttribute("aria-disabled","true")}},{key:"removeAriaDisabled",value:function(t){t.removeAttribute("aria-disabled")}},{key:"removeAriaAttributes",value:function(t){e.removeAriaBusy(t),e.removeAriaDisabled(t)}}])}(),pp=`<?xml version="1.0" encoding="iso-8859-1"?>
<svg height="1.4em" width="1.4em" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
	 viewBox="0 0 490.9 490.9" xml:space="preserve">
	<g>
		<g>
			<path d="M245.5,322.9c53,0,96.2-43.2,96.2-96.2V96.2c0-53-43.2-96.2-96.2-96.2s-96.2,43.2-96.2,96.2v130.5
				C149.3,279.8,192.5,322.9,245.5,322.9z M173.8,96.2c0-39.5,32.2-71.7,71.7-71.7s71.7,32.2,71.7,71.7v130.5
				c0,39.5-32.2,71.7-71.7,71.7s-71.7-32.2-71.7-71.7V96.2z"/>
			<path d="M94.4,214.5c-6.8,0-12.3,5.5-12.3,12.3c0,85.9,66.7,156.6,151.1,162.8v76.7h-63.9c-6.8,0-12.3,5.5-12.3,12.3
				s5.5,12.3,12.3,12.3h152.3c6.8,0,12.3-5.5,12.3-12.3s-5.5-12.3-12.3-12.3h-63.9v-76.7c84.4-6.3,151.1-76.9,151.1-162.8
				c0-6.8-5.5-12.3-12.3-12.3s-12.3,5.5-12.3,12.3c0,76.6-62.3,138.9-138.9,138.9s-138.9-62.3-138.9-138.9
				C106.6,220,101.2,214.5,94.4,214.5z"/>
		</g>
	</g>
</svg>
`,Ts=function(){function e(){T(this,e)}return A(e,null,[{key:"createTextElement",value:function(t){var n=document.createElement("div");return n.classList.add(e.INPUT_BUTTON_INNER_TEXT_CLASS),n.innerText=t,n}},{key:"tryAddSVGElement",value:function(t,n,i,s){i?t.push(mn.createSVGElement(i)):i!==""&&s&&t.push(n)}},{key:"createCustomElements",value:function(t,n,i){var s,a,o=i?.[t],l=(s=o?.text)==null?void 0:s.content,u=(a=o?.svg)==null?void 0:a.content,c=[];return e.tryAddSVGElement(c,n,u,l),l&&c.push(e.createTextElement(l)),c.length>0?c:void 0}},{key:"reassignClassBasedOnChildren",value:function(t,n){t.classList.remove(e.INPUT_BUTTON_SVG_CLASS,e.INPUT_BUTTON_SVG_TEXT_CLASS),n.find(function(i){return i.classList.contains(e.INPUT_BUTTON_INNER_TEXT_CLASS)})?n.length>1&&t.classList.add(e.INPUT_BUTTON_SVG_TEXT_CLASS):t.classList.add(e.INPUT_BUTTON_SVG_CLASS)}}])}();Ts.INPUT_BUTTON_SVG_TEXT_CLASS="input-button-svg-text",Ts.INPUT_BUTTON_INNER_TEXT_CLASS="text-button",Ts.INPUT_BUTTON_SVG_CLASS="input-button-svg";var Un=Ts,xi=function(){function e(){T(this,e)}return A(e,null,[{key:"parseSVGTextElements",value:function(t){return{svg:t.find(function(n){return n.tagName.toLowerCase()==="svg"}),text:t.find(function(n){return n.tagName.toLowerCase()==="div"})}}}])}(),wt=function(){function e(){T(this,e)}return A(e,null,[{key:"unsetAllCSS",value:function(t,n){var i,s;n.container&&nt.unsetAllCSSMouseStates(t,n.container);var a=xi.parseSVGTextElements(Array.from(t.children)),o=a.svg,l=a.text;(i=n.svg)!=null&&i.styles&&o&&nt.unsetAllCSSMouseStates(o,n.svg.styles),(s=n.text)!=null&&s.styles&&l&&nt.unsetAllCSSMouseStates(l,n.text.styles)}},{key:"unsetActionCSS",value:function(t,n){var i,s;n.container&&nt.unsetActivityCSSMouseStates(t,n.container);var a=xi.parseSVGTextElements(Array.from(t.children)),o=a.svg,l=a.text;(i=n.svg)!=null&&i.styles&&o&&nt.unsetActivityCSSMouseStates(o,n.svg.styles),(s=n.text)!=null&&s.styles&&l&&nt.unsetActivityCSSMouseStates(l,n.text.styles)}},{key:"setElementsCSS",value:function(t,n,i){var s,a,o,l,u;Object.assign(t.style,(s=n.container)==null?void 0:s[i]);var c=xi.parseSVGTextElements(Array.from(t.children)),d=c.svg,f=c.text;d&&Object.assign(d.style,(o=(a=n.svg)==null?void 0:a.styles)==null?void 0:o[i]),f&&Object.assign(f.style,(u=(l=n.text)==null?void 0:l.styles)==null?void 0:u[i])}},{key:"setElementCssUpToState",value:function(t,n,i){e.setElementsCSS(t,n,"default"),i!=="default"&&(e.setElementsCSS(t,n,"hover"),i!=="hover"&&e.setElementsCSS(t,n,"click"))}}])}(),mr=function(){function e(r,t,n,i,s,a){T(this,e),this._mouseState={state:"default"},this.isCustom=!1,tt.addAttributes(r),this.elementRef=r,this.svg=mn.createSVGElement(t),this.customStyles=s,this.position=n,this._tooltipSettings=i,this.dropupText=a}return A(e,[{key:"buttonMouseLeave",value:function(t){var n;this._mouseState.state="default",((n=this._activeTooltip)==null?void 0:n.element.style.visibility)==="visible"&&this._tooltipSettings&&bn.hide(this._activeTooltip,this._tooltipSettings),t&&(wt.unsetAllCSS(this.elementRef,t),wt.setElementsCSS(this.elementRef,t,"default"))}},{key:"buttonMouseEnter",value:function(t){var n;this._mouseState.state="hover",this._tooltipSettings&&(this._activeTooltip=bn.display(this.elementRef,this._tooltipSettings,(n=this._activeTooltip)==null?void 0:n.element)),t&&wt.setElementsCSS(this.elementRef,t,"hover")}},{key:"buttonMouseUp",value:function(t){t&&wt.unsetActionCSS(this.elementRef,t),this.buttonMouseEnter(t)}},{key:"buttonMouseDown",value:function(t){this._mouseState.state="click",t&&wt.setElementsCSS(this.elementRef,t,"click")}},{key:"setEvents",value:function(t){this.elementRef.onmousedown=this.buttonMouseDown.bind(this,t),this.elementRef.onmouseup=this.buttonMouseUp.bind(this,t),this.elementRef.onmouseenter=this.buttonMouseEnter.bind(this,t),this.elementRef.onmouseleave=this.buttonMouseLeave.bind(this,t)}},{key:"unsetCustomStateStyles",value:function(t){if(this.customStyles)for(var n=0;n<t.length;n+=1){var i=t[n],s=i&&this.customStyles[i];s&&wt.unsetActionCSS(this.elementRef,s)}}},{key:"reapplyStateStyle",value:function(t,n){if(this.customStyles){n&&this.unsetCustomStateStyles(n);var i=this.customStyles[t];i&&wt.setElementCssUpToState(this.elementRef,i,this._mouseState.state),this.setEvents(i)}}},{key:"changeElementsByState",value:function(t){var n;(n=this.elementRef).replaceChildren.apply(n,Zi(t)),Un.reassignClassBasedOnChildren(this.elementRef,t)}},{key:"buildDefaultIconElement",value:function(t){var n=this.svg.cloneNode(!0);return n.id=t,[n]}},{key:"createInnerElements",value:function(t,n,i){var s=Un.createCustomElements(n,this.svg,i);if(s&&s.length>0){if(this.position==="dropup-menu"){var a=this.svg.cloneNode(!0);a.id=s[0]===this.svg?t:"dropup-menu-item-icon-element-custom",s[0]=a}return s}return this.buildDefaultIconElement(t)}}])}(),mp=function(e){function r(t){var n;T(this,r);var i,s,a=((s=(i=t?.default)==null?void 0:i.svg)==null?void 0:s.content)||r.EMPTY_SVG;return n=le(this,r,[document.createElement("div"),a,void 0,void 0,t]),n.isActive=!1,n._innerElements=n.createInnerElementsForStates(n.customStyles),n.changeToDefault(),n}return ue(r,e),A(r,[{key:"createInnerElementsForStates",value:function(n){return{default:this.createInnerButtonElements("default",n),active:this.createInnerButtonElements("active",n),unavailable:this.createInnerButtonElements("unavailable",n)}}},{key:"createInnerButtonElements",value:function(n,i){return Un.createCustomElements(n,this.svg,i)||[this.svg]}},{key:"changeState",value:function(n){this.changeElementsByState(n),this.elementRef.classList.replace(Un.INPUT_BUTTON_SVG_CLASS,"deep-chat-openai-realtime-button")}},{key:"changeToActive",value:function(){this.changeState(this._innerElements.active),this.reapplyStateStyle("active",["unavailable","default"]),this.isActive=!0}},{key:"changeToDefault",value:function(){var n,i,s,a;this.changeState(this._innerElements.default),(n=this.customStyles)!=null&&n.active&&wt.unsetAllCSS(this.elementRef,(i=this.customStyles)==null?void 0:i.active),(s=this.customStyles)!=null&&s.unavailable&&wt.unsetAllCSS(this.elementRef,(a=this.customStyles)==null?void 0:a.unavailable),this.reapplyStateStyle("default",["active","unavailable"]),this.isActive=!1}},{key:"changeToUnavailable",value:function(){var n,i,s,a;this.changeState(this._innerElements.unavailable),(n=this.customStyles)!=null&&n.active&&wt.unsetAllCSS(this.elementRef,(i=this.customStyles)==null?void 0:i.active),(s=this.customStyles)!=null&&s.default&&wt.unsetAllCSS(this.elementRef,(a=this.customStyles)==null?void 0:a.default),this.reapplyStateStyle("unavailable",["default","active"]),this.isActive=!1}}])}(mr);mp.EMPTY_SVG='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"></svg>';var Yc=mp,on=function(){function e(){T(this,e)}return A(e,null,[{key:"setPropertyValueIfDoesNotExist",value:function(t,n,i){var s,a,o=n[0];n.length===1?(s=t[o])!==null&&s!==void 0||(t[o]=i):((a=t[o])!==null&&a!==void 0||(t[o]={}),n.shift(),e.setPropertyValueIfDoesNotExist(t[o],n,i))}},{key:"setPropertyValue",value:function(t,n,i){var s,a=n[0];n.length===1?t[a]=i:((s=t[a])!==null&&s!==void 0||(t[a]={}),n.shift(),e.setPropertyValue(t[a],n,i))}},{key:"getObjectValue",value:function(t,n){var i=n[0],s=t[i];return s===void 0||n.length===1?s:e.getObjectValue(s,n.slice(1))}},{key:"overwritePropertyObjectFromAnother",value:function(t,n,i){var s=e.getObjectValue(n,i);if(s){var a=ke(ke({},s),e.getObjectValue(t,i)||{});e.setPropertyValue(t,i,a)}}},{key:"isJson",value:function(t){try{return JSON.stringify(t),!0}catch{return!1}}},{key:"assignPropertyFromOneToAnother",value:function(t,n,i){var s;(s=n[t])!==null&&s!==void 0||(n[t]={}),Object.assign(n[t],i?.[t])}}])}(),ol=A(function e(){T(this,e)});ol.SESSION_STARTED="sts-session-started",ol.SESSION_STOPPED="sts-session-stopped";var Zc=ol,vp=`<?xml version="1.0" encoding="utf-8"?>
<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M5.92 24.096q0 1.088 0.928 1.728 0.512 0.288 1.088 0.288 0.448 0 0.896-0.224l16.16-8.064q0.48-0.256 0.8-0.736t0.288-1.088-0.288-1.056-0.8-0.736l-16.16-8.064q-0.448-0.224-0.896-0.224-0.544 0-1.088 0.288-0.928 0.608-0.928 1.728v16.16z"></path>
</svg>`,ll=`<?xml version="1.0" encoding="utf-8"?>
<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
<path d="M5.92 24.096q0 0.832 0.576 1.408t1.44 0.608h16.128q0.832 0 1.44-0.608t0.576-1.408v-16.16q0-0.832-0.576-1.44t-1.44-0.576h-16.128q-0.832 0-1.44 0.576t-0.576 1.44v16.16z"></path>
</svg>`,fi=function(e){function r(t){var n,i;T(this,r);var s,a,o,l,u=JSON.parse(JSON.stringify(t.directConnection)),c=r.getKey(t);i=le(this,r,[t,Qe.buildKeyVerificationDetails(),Qe.buildHeaders,{key:c}]),i.insertKeyPlaceholderText="OpenAI API Key",i.keyHelpUrl="https://platform.openai.com/account/api-keys",i._microphoneButton=null,i._toggleButton=null,i._errorElement=null,i._loadingElement=null,i._pc=null,i._mediaStream=null,i._isMuted=!1;var d=(s=u.openAI)==null?void 0:s.realtime;if(Q(d)=="object"){i._avatarConfig=d.avatar,i._ephemeralKey=d.ephemeralKey,i._errorConfig=d.error,i._loadingConfig=d.loading,Object.assign(i.rawBody,d.config);var f=(o=(a=t.directConnection)==null?void 0:a.openAI)==null?void 0:o.realtime,h=f.config||{},p=h.function_handler;p&&(i._functionHandler=p),i._events=d.events,f.methods=i.generateMethods()}return(n=(l=i.rawBody).model)!==null&&n!==void 0||(l.model="gpt-4o-realtime-preview-2024-12-17"),i._avatarConfig=r.buildAvatarConfig(d),i._buttonsConfig=r.buildButtonsConfig(d),i._avatarEl=r.createAvatar(i._avatarConfig),i._containerEl=i.createContainer(),i._deepChat=t,i}return ue(r,e),A(r,[{key:"setUpView",value:function(n,i){n.style.display="none",i.appendChild(this._containerEl),this.setup()}},{key:"setup",value:function(){var t=O(g().mark(function i(){var s,a,o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a=(s=this._deepChat.directConnection)==null?void 0:s.openAI,a){c.next=3;break}return c.abrupt("return");case 3:if(o=a?.realtime,!(Q(o)!="object"||!o.autoStart&&!o.autoFetchEphemeralKey)){c.next=6;break}return c.abrupt("return");case 6:l=this.key||a.key,(o.fetchEphemeralKey||l)&&o.autoStart&&(this.changeToUnavailable(),this.displayLoading()),this.fetchEphemeralKey(o.autoStart);case 8:case"end":return c.stop()}},i,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"fetchEphemeralKey",value:function(){var t=O(g().mark(function i(s){var a,o,l,u,c,d;return g().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(o=(a=this._deepChat.directConnection)==null?void 0:a.openAI,l=Q(o?.realtime)=="object"?o?.realtime.fetchEphemeralKey:void 0,u=o?.realtime,c=this.key||o.key,Q(u)!="object"){h.next=26;break}if(this._ephemeralKey){h.next=23;break}if(h.prev=3,!l){h.next=12;break}return d=l(),d.then&&(this._retrievingEphemeralKey=d),h.next=9,d;case 9:this._ephemeralKey=h.sent,h.next=18;break;case 12:if(h.t0=c,!h.t0){h.next=18;break}return this._retrievingEphemeralKey=this.getEphemeralKey(c),h.next=17,this._retrievingEphemeralKey;case 17:this._ephemeralKey=h.sent;case 18:h.next=23;break;case 20:h.prev=20,h.t1=h.catch(3),this.displayFailedToRetrieveEphemeralKey(h.t1);case 23:this._ephemeralKey&&(s?this.init(this._ephemeralKey):this.changeToAvailable()),h.next=38;break;case 26:if(!c){h.next=38;break}return h.prev=27,this._retrievingEphemeralKey=this.getEphemeralKey(c),h.next=31,this._retrievingEphemeralKey;case 31:this._ephemeralKey=h.sent,s&&this.init(this._ephemeralKey),h.next=38;break;case 35:h.prev=35,h.t2=h.catch(27),this.displayFailedToRetrieveEphemeralKey(h.t2);case 38:case"end":return h.stop()}},i,this,[[3,20],[27,35]])}));function n(i){return t.apply(this,arguments)}return n}()},{key:"getEphemeralKey",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,fetch("https://api.openai.com/v1/realtime/sessions",{method:"POST",body:JSON.stringify(this.rawBody),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});case 2:return o.next=4,o.sent.json();case 4:return o.abrupt("return",o.sent.client_secret.value);case 5:case"end":return o.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"generateMethods",value:function(){var n=this;return{updateConfig:function(s){var a;(a=n._dc)==null||a.send(JSON.stringify({type:"session.update",session:s}))},sendMessage:function(s,a){var o=a||"system",l={role:o,type:"message",content:[{type:o==="system"||o==="user"?"input_text":"text",text:s}]};n.sendMessage(l)}}}},{key:"createContainer",value:function(){var n=document.createElement("div");return n.id="deep-chat-openai-realtime-container",n.appendChild(this.createAvatarContainer()),n.appendChild(this.createButtonsContainer()),n.appendChild(this.createError()),n}},{key:"createAvatarContainer",value:function(){var n,i,s=document.createElement("div");return s.id="deep-chat-openai-realtime-avatar-container",Object.assign(s.style,(i=(n=this._avatarConfig)==null?void 0:n.styles)==null?void 0:i.container),s.appendChild(this._avatarEl),s}},{key:"createButtonsContainer",value:function(){var n,i=document.createElement("div");i.id="deep-chat-openai-realtime-buttons-container",Object.assign(i.style,(n=this._buttonsConfig)==null?void 0:n.container),this._microphoneButton=this.createMicophoneButton();var s=r.createButtonContainer(this._microphoneButton.elementRef);this._toggleButton=this.createToggleButton();var a=r.createButtonContainer(this._toggleButton.elementRef);return i.appendChild(s),i.appendChild(a),i.appendChild(this.createLoading()),i}},{key:"createMicophoneButton",value:function(){var n=this,i,s=new Yc((i=this._buttonsConfig)==null?void 0:i.microphone);return s.elementRef.classList.add(r.BUTTON_DEFAULT,"deep-chat-openai-realtime-microphone"),s.elementRef.onclick=function(){s.isActive?(n.toggleMicorphone(!0),s.elementRef.classList.replace(r.MICROPHONE_ACTIVE,r.BUTTON_DEFAULT),s.changeToDefault(),n._isMuted=!1):(n.toggleMicorphone(!1),s.elementRef.classList.replace(r.BUTTON_DEFAULT,r.MICROPHONE_ACTIVE),tt.removeAriaAttributes(s.elementRef),s.changeToActive(),n._isMuted=!0)},s}},{key:"toggleMicorphone",value:function(n){var i;(i=this._mediaStream)==null||i.getAudioTracks().forEach(function(s){return s.enabled=n})}},{key:"createToggleButton",value:function(){var n=this,i,s=new Yc((i=this._buttonsConfig)==null?void 0:i.toggle);return s.elementRef.classList.add(r.BUTTON_DEFAULT,"deep-chat-openai-realtime-toggle"),s.elementRef.onclick=O(g().mark(function a(){var o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!s.isActive){c.next=4;break}s.changeToDefault(),n.stop(),c.next=30;break;case 4:if(c.prev=4,!n._ephemeralKey){c.next=11;break}return n.displayLoading(),c.next=9,n.init(n._ephemeralKey);case 9:c.next=25;break;case 11:if(!n._retrievingEphemeralKey){c.next=22;break}return n.displayLoading(),c.next=15,n._retrievingEphemeralKey;case 15:if(l=c.sent,c.t0=(o=n._toggleButton)!=null&&o.isActive,!c.t0){c.next=20;break}return c.next=20,n.init(l);case 20:c.next=25;break;case 22:return n.displayLoading(),c.next=25,n.fetchEphemeralKey(!0);case 25:c.next=30;break;case 27:c.prev=27,c.t1=c.catch(4),console.error("Failed to start conversation:",c.t1),n.displayError(),n.hideLoading();case 30:case"end":return c.stop()}},a,null,[[4,27]])})),s}},{key:"init",value:function(){var t=O(g().mark(function i(s){var a=this,o,l,u,c,d,f,h,p;return g().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=new RTCPeerConnection,this._pc=o,l=document.createElement("audio"),l.autoplay=!0,u=new AudioContext,c=u.createAnalyser(),c.fftSize=256,d=new Uint8Array(c.frequencyBinCount),this._pc.ontrack=function(){var y=O(g().mark(function b(M){var _;return g().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(!M.streams[0]){C.next=11;break}if(l.srcObject=M.streams[0],_=u.createMediaStreamSource(M.streams[0]),C.t0=u.state==="suspended",!C.t0){C.next=7;break}return C.next=7,u.resume();case 7:_.connect(c),a.monitorFrequencies(c,d),C.next=12;break;case 11:console.error("No streams found in the ontrack event."),a.displayError();case 12:case"end":return C.stop()}},b)}));return function(b){return y.apply(this,arguments)}}(),v.next=10,navigator.mediaDevices.getUserMedia({audio:!0}).then(function(y){var b;o===a._pc&&(a._mediaStream=y,(b=a._pc)==null||b.addTrack(a._mediaStream.getTracks()[0]),a._isMuted&&a.toggleMicorphone(!1))}).catch(function(y){console.error("Error accessing microphone:",y),a.displayError()});case 10:return this._dc=this._pc.createDataChannel("oai-events"),this._dc.addEventListener("message",function(){var y=O(g().mark(function b(M){var _,E,C,B,P,R,L;return g().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(B=JSON.parse(M.data),B.type!=="session.created"){k.next=5;break}a.removeUnavailable(),a._toggleButton&&(tt.removeAriaAttributes(a._toggleButton.elementRef),a._toggleButton.changeToActive()),(E=(_=a._events)==null?void 0:_.started)==null||E.call(_),a._deepChat.dispatchEvent(new CustomEvent(Zc.SESSION_STARTED)),a.hideLoading(),k.next=20;break;case 5:if(B.type!=="response.done"){k.next=19;break}if(P=(C=JSON.parse(M.data).response.output)==null?void 0:C[0],P?.type!=="function_call"){k.next=17;break}return R=P.name,L=P.call_id,k.prev=9,k.next=12,a.handleTool(R,P.arguments,L);case 12:k.next=17;break;case 14:k.prev=14,k.t0=k.catch(9),a.stopOnError(k.t0);case 17:k.next=20;break;case 19:B.type==="error"?a.stopOnError(B.error.message):B.type==="invalid_request_error"?a.stopOnError(B.message):B.type;case 20:case"end":return k.stop()}},b,null,[[9,14]])}));return function(b){return y.apply(this,arguments)}}()),v.prev=12,v.next=15,this._pc.createOffer();case 15:if(f=v.sent,v.t0=o!==this._pc,v.t0){v.next=21;break}return v.next=20,this._pc.setLocalDescription(f);case 20:v.t0=o!==this._pc;case 21:if(!v.t0){v.next=23;break}return v.abrupt("return");case 23:return v.next=25,fetch("https://api.openai.com/v1/realtime",{method:"POST",body:f.sdp,headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/sdp"}});case 25:if(h=v.sent,o===this._pc){v.next=28;break}return v.abrupt("return");case 28:return v.next=30,h.text();case 30:if(v.t1=v.sent,p={type:"answer",sdp:v.t1},v.t2=o!==this._pc,v.t2){v.next=37;break}return v.next=36,this._pc.setRemoteDescription(p);case 36:v.t2=o!==this._pc;case 37:if(!v.t2){v.next=39;break}return v.abrupt("return");case 39:v.next=44;break;case 41:v.prev=41,v.t3=v.catch(12),console.error(v.t3),this.displayError();case 44:case"end":return v.stop()}},i,this,[[12,41]])}));function n(i){return t.apply(this,arguments)}return n}()},{key:"monitorFrequencies",value:function(n,i){var s=this,a=function(o){function l(){return o.apply(this,arguments)}return l.toString=function(){return o.toString()},l}(function(){var o;n.getByteFrequencyData(i);var l=i.reduce(function(h,p){return h+p},0),u=i.length*255,c=l/u*100,d=1,f=d+c/100*(((o=s._avatarConfig)==null?void 0:o.maxScale)-d);s._avatarEl.style.transform="scale(".concat(f,")"),requestAnimationFrame(a)});a()}},{key:"stopOnError",value:function(n){this.stop(),console.error(n),this.displayError()}},{key:"stop",value:function(){var n,i,s;(n=this._mediaStream)==null||n.getTracks().forEach(function(a){return a.stop()}),this._mediaStream=null,this._pc&&(this._pc.close(),this._pc=null,(s=(i=this._events)==null?void 0:i.stopped)==null||s.call(i),this._deepChat.dispatchEvent(new CustomEvent(Zc.SESSION_STOPPED)),this._dc=void 0)}},{key:"changeToUnavailable",value:function(){this._microphoneButton&&r.changeButtonToUnavailable(this._microphoneButton),this._toggleButton&&r.changeButtonToUnavailable(this._toggleButton)}},{key:"changeToAvailable",value:function(){this._microphoneButton&&r.changeButtonToAvailable(this._microphoneButton),this._toggleButton&&r.changeButtonToAvailable(this._toggleButton)}},{key:"removeUnavailable",value:function(){this._microphoneButton&&r.removeButtonUnavailable(this._microphoneButton),this._toggleButton&&r.removeButtonUnavailable(this._toggleButton)}},{key:"createError",value:function(){var n,i=document.createElement("div");return i.id="deep-chat-openai-realtime-error",Object.assign(i.style,(n=this._errorConfig)==null?void 0:n.style),this._errorElement=i,i}},{key:"displayFailedToRetrieveEphemeralKey",value:function(n){console.error("Failed to retrieve ephemeral key"),console.error(n),this.displayError()}},{key:"displayError",value:function(){var n;this._errorElement&&(this._errorElement.style.display="block",this._errorElement.textContent=((n=this._errorConfig)==null?void 0:n.text)||"Error",this.changeToUnavailable()),this.hideLoading()}},{key:"createLoading",value:function(){var n,i,s=document.createElement("div");return s.id="deep-chat-openai-realtime-loading",this._loadingElement=s,(n=this._loadingConfig)!=null&&n.html&&(this._loadingElement.innerHTML=this._loadingConfig.html),Object.assign(s.style,(i=this._loadingConfig)==null?void 0:i.style),s.style.display="none",s}},{key:"displayLoading",value:function(){var n,i,s;this._toggleButton&&(this._toggleButton.changeToActive(),this._toggleButton.elementRef.classList.add(r.BUTTON_LOADING),tt.removeAriaDisabled(this._toggleButton.elementRef),tt.addAriaBusy(this._toggleButton.elementRef)),(typeof((n=this._loadingConfig)==null?void 0:n.display)!="boolean"||this._loadingConfig.display)&&this._loadingElement&&(this._loadingElement.style.display="block",(i=this._loadingConfig)!=null&&i.html||(this._loadingElement.textContent=((s=this._loadingConfig)==null?void 0:s.text)||"Loading"))}},{key:"hideLoading",value:function(){this._toggleButton&&(this._toggleButton.elementRef.classList.remove(r.BUTTON_LOADING),tt.removeAriaBusy(this._toggleButton.elementRef)),this._loadingElement&&(this._loadingElement.style.display="none")}},{key:"handleTool",value:function(){var t=O(g().mark(function i(s,a,o){var l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this._functionHandler){d.next=2;break}throw Error("Please define the `function_handler` property inside the [openAI](https://deepchat.dev/docs/directConnection/OpenAI/OpenAIRealtime#OpenAIRealtimeFunction) object.");case 2:return d.next=4,this._functionHandler({name:s,arguments:a});case 4:if(l=d.sent,!(Q(l)!="object"||!on.isJson(l))){d.next=7;break}throw Error('The `function_handler` response must be a JSON object, e.g. {response: "My response"}');case 7:u={type:"function_call_output",call_id:o,output:JSON.stringify(l)},this.sendMessage(u);case 9:case"end":return d.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"sendMessage",value:function(n){if(this._dc){var i=JSON.stringify({type:"conversation.item.create",item:n});this._dc.send(i);var s={type:"response.create"};this._dc.send(JSON.stringify(s))}}},{key:"isCustomView",value:function(){return!0}}],[{key:"getKey",value:function(n){var i=n.directConnection.openAI;if(i!=null&&i.key)return i.key;var s=i?.realtime;if(Q(s)=="object"&&(s.ephemeralKey||s.fetchEphemeralKey))return"placeholder"}},{key:"buildAvatarConfig",value:function(n){var i=Q(n)=="object"&&n.avatar?JSON.parse(JSON.stringify(n.avatar)):{};return i.maxScale=i.maxScale&&i.maxScale>=1?i.maxScale:2.5,i}},{key:"buildButtonsConfig",value:function(n){var i,s,a,o,l,u,c,d,f,h,p,m,v,y,b,M,_,E,C,B,P,R,L,x,k,F,I=Q(n)=="object"&&n.buttons?JSON.parse(JSON.stringify(n.buttons)):{};return(y=(v=(m=I.microphone)==null?void 0:m.default)==null?void 0:v.text)!=null&&y.content||((i=I.microphone)!==null&&i!==void 0||(I.microphone={}),(s=(b=I.microphone).default)!==null&&s!==void 0||(b.default={}),(a=(M=I.microphone.default).svg)!==null&&a!==void 0||(M.svg={}),(o=(_=I.microphone.default.svg).content)!==null&&o!==void 0||(_.content=pp)),(B=(C=(E=I.toggle)==null?void 0:E.default)==null?void 0:C.text)!=null&&B.content||((l=I.toggle)!==null&&l!==void 0||(I.toggle={}),(u=(P=I.toggle).default)!==null&&u!==void 0||(P.default={}),(c=(R=I.toggle.default).svg)!==null&&c!==void 0||(R.svg={}),(d=(L=I.toggle.default.svg).content)!==null&&d!==void 0||(L.content=vp),(f=(x=I.toggle).active)!==null&&f!==void 0||(x.active={}),(h=(k=I.toggle.active).svg)!==null&&h!==void 0||(k.svg={}),(p=(F=I.toggle.active.svg).content)!==null&&p!==void 0||(F.content=ll)),I}},{key:"createAvatar",value:function(n){var i,s=document.createElement("img");return s.id="deep-chat-openai-realtime-avatar",Object.assign(s.style,(i=n?.styles)==null?void 0:i.image),s.src=n?.src||el,s}},{key:"createButtonContainer",value:function(n){var i=document.createElement("div");return i.classList.add("deep-chat-openai-realtime-button-container"),i.appendChild(n),i}},{key:"changeButtonToUnavailable",value:function(n){n.elementRef.classList.add(r.UNAVAILABLE),tt.removeAriaBusy(n.elementRef),tt.addAriaDisabled(n.elementRef),n.changeToUnavailable()}},{key:"changeButtonToAvailable",value:function(n){r.removeButtonUnavailable(n),n.changeToDefault()}},{key:"removeButtonUnavailable",value:function(n){tt.removeAriaDisabled(n.elementRef),n.elementRef.classList.remove(r.UNAVAILABLE)}}])}(ft);fi.BUTTON_DEFAULT="deep-chat-openai-realtime-button-default",fi.BUTTON_LOADING="deep-chat-openai-realtime-button-loading",fi.MICROPHONE_ACTIVE="deep-chat-openai-realtime-microphone-active",fi.UNAVAILABLE="deep-chat-openai-realtime-button-unavailable";var Zk=fi,ul=function(e){function r(t){var n,i,s;T(this,r);var a,o,l,u=JSON.parse(JSON.stringify(t.directConnection)),c=u?.openAI;s=le(this,r,[t,Qe.buildKeyVerificationDetails(),Qe.buildHeaders,c]),s.insertKeyPlaceholderText="OpenAI API Key",s.keyHelpUrl="https://platform.openai.com/account/api-keys",s.url="https://api.openai.com/v1/audio/speech",s.permittedErrorPrefixes=["Invalid"],s.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI : Text To Speech</b></div>
    <p>Generate an audio file based on your text input.</p>
    <p>Click <a href="https://platform.openai.com/docs/guides/text-to-speech">here</a> for more information.</p>`;var d=(a=u?.openAI)==null?void 0:a.textToSpeech;return Q(d)=="object"&&Object.assign(s.rawBody,d),(n=(o=s.rawBody).model)!==null&&n!==void 0||(o.model=r.DEFAULT_MODEL),(i=(l=s.rawBody).voice)!==null&&i!==void 0||(l.voice=r.DEFAULT_VOIDE),s.textInputPlaceholderText="Insert text to generate audio",s.rawBody.response_format="mp3",s}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i){var s,a,o=JSON.parse(JSON.stringify(n)),l=(a=(s=i[i.length-1])==null?void 0:s.text)==null?void 0:a.trim();return l&&l!==""&&(o.input=l),o}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if((o=this.connectSettings)!=null&&o.headers){c.next=2;break}throw new Error("Request settings have not been set up");case 2:this.url=this.connectSettings.url||this.url,l=this.preprocessBody(this.rawBody,a),je.request(this,l,s);case 5:case"end":return c.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!(s instanceof Blob)){o.next=2;break}return o.abrupt("return",new Promise(function(l){var u=new FileReader;u.readAsDataURL(s),u.onload=function(c){l({files:[{src:c.target.result,type:"audio"}]})}}));case 2:if(!s.error){o.next=4;break}throw s.error.message;case 4:return o.abrupt("return",{error:"error"});case 5:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(ft);ul.DEFAULT_MODEL="tts-1",ul.DEFAULT_VOIDE="alloy";var Qk=ul,As=function(e){function r(t){var n,i;T(this,r);var s,a,o=JSON.parse(JSON.stringify(t.directConnection)),l=o?.openAI;i=le(this,r,[t,Qe.buildKeyVerificationDetails(),Qe.buildHeaders,l,{audio:{}}]),i.insertKeyPlaceholderText="OpenAI API Key",i.keyHelpUrl="https://platform.openai.com/account/api-keys",i.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI : Speech To Text</b></div>
    <p><b>Upload an audio file</b> to transcribe it into text. You can optionally provide text to guide the audio
      processing.
    <p>Click <a href="https://platform.openai.com/docs/guides/speech-to-text">here</a> for more info.</p>`,i.url="",i.permittedErrorPrefixes=["Invalid"],i.textInputPlaceholderText="Upload an audio file",i._service_url=r.AUDIO_TRANSCRIPTIONS_URL;var u=(s=o?.openAI)==null?void 0:s.audio;return Q(u)=="object"&&(i.processConfig(u),r.cleanConfig(u),Object.assign(i.rawBody,u)),(n=(a=i.rawBody).model)!==null&&n!==void 0||(a.model=r.DEFAULT_MODEL),i.rawBody.response_format="json",i.canSendMessage=r.canSendFileMessage,i}return ue(r,e),A(r,[{key:"processConfig",value:function(n){n!=null&&n.type&&n.type==="translation"&&(this._service_url=r.AUDIO_TRANSLATIONS_URL,delete n.language)}},{key:"preprocessBody",value:function(n,i){var s,a,o=JSON.parse(JSON.stringify(n)),l=(a=(s=i[i.length-1])==null?void 0:s.text)==null?void 0:a.trim();return l&&l!==""&&(o.prompt=l),o}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a,o){var l,u,c;return g().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if((l=this.connectSettings)!=null&&l.headers){f.next=2;break}throw new Error("Request settings have not been set up");case 2:if(o!=null&&o[0]){f.next=4;break}throw new Error("No file was added");case 4:this.url=this.connectSettings.url||this._service_url,u=this.preprocessBody(this.rawBody,a),c=r.createFormDataBody(u,o[0]),me.tempRemoveContentHeader(this.connectSettings,je.request.bind(this,this,c,s),!1);case 7:case"end":return f.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.error){o.next=2;break}throw s.error.message;case 2:return o.abrupt("return",{text:s.text});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}],[{key:"canSendFileMessage",value:function(n,i){return!!(i!=null&&i[0])}},{key:"cleanConfig",value:function(n){delete n.type}},{key:"createFormDataBody",value:function(n,i){var s=new FormData;return s.append("file",i),Object.keys(n).forEach(function(a){s.append(a,String(n[a]))}),s}}])}(ft);As.AUDIO_TRANSCRIPTIONS_URL="https://api.openai.com/v1/audio/transcriptions",As.AUDIO_TRANSLATIONS_URL="https://api.openai.com/v1/audio/translations",As.DEFAULT_MODEL="whisper-1";var e_=As,ur=function(){function e(){T(this,e)}return A(e,null,[{key:"buildTextToSpeechHeaders",value:function(t,n){return{"Ocp-Apim-Subscription-Key":n,"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":t}}},{key:"buildSpeechToTextHeaders",value:function(t){return{"Ocp-Apim-Subscription-Key":t,Accept:"application/json"}}},{key:"handleSpeechVerificationResult",value:function(t,n,i,s){t.error?s(Pe.INVALID_KEY):i(n)}},{key:"buildSpeechKeyVerificationDetails",value:function(t){return{url:"https://".concat(t,".api.cognitive.microsoft.com/sts/v1.0/issuetoken"),method:"POST",createHeaders:function(i){return{"Ocp-Apim-Subscription-Key":"".concat(i)}},handleVerificationResult:e.handleSpeechVerificationResult}}},{key:"buildSummarizationHeader",value:function(t){return{"Ocp-Apim-Subscription-Key":t,"Content-Type":"application/json"}}},{key:"handleLanguageVerificationResult",value:function(t,n,i,s){var a;((a=t.error)==null?void 0:a.code)==="401"?s(Pe.INVALID_KEY):i(n)}},{key:"buildLanguageKeyVerificationDetails",value:function(t){return{url:"".concat(t,"/language/analyze-text/jobs?api-version=2022-10-01-preview"),method:"POST",createHeaders:function(i){return{"Ocp-Apim-Subscription-Key":"".concat(i)}},handleVerificationResult:e.handleLanguageVerificationResult}}},{key:"handleTranslationVerificationResult",value:function(t,n,i,s){t.json().then(function(a){!Array.isArray(a)&&a.error.code===401e3?s(Pe.INVALID_KEY):i(n)})}},{key:"buildTranslationKeyVerificationDetails",value:function(t){return{url:"https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&to=es",method:"POST",createHeaders:function(i){return e.buildTranslationHeaders(t,i)},handleVerificationResult:e.handleTranslationVerificationResult}}},{key:"buildTranslationHeaders",value:function(t,n){var i={"Ocp-Apim-Subscription-Key":n,"Content-Type":"application/json"};return t&&(i["Ocp-Apim-Subscription-Region"]=t),i}}])}(),t_=function(e){function r(t,n,i,s,a){var o;return T(this,r),o=le(this,r,[t,ur.buildLanguageKeyVerificationDetails(i),n,s,a]),o.insertKeyPlaceholderText="Azure Language Subscription Key",o.keyHelpUrl="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",o.permittedErrorPrefixes=["Access"],o}return ue(r,e),A(r)}(ft),gp=function(e){function r(t){var n,i;T(this,r);var s,a,o,l,u=(a=(s=t.directConnection)==null?void 0:s.azure)==null?void 0:a.summarization,c=(o=t.directConnection)==null?void 0:o.azure;return i=le(this,r,[t,ur.buildSummarizationHeader,u.endpoint,c]),i.permittedErrorPrefixes=[r.ENDPOINT_ERROR_MESSAGE],i.url="",i.textInputPlaceholderText="Insert text to summarize",i.isTextInputDisabled=!1,u.endpoint?((n=(l=i.rawBody).language)!==null&&n!==void 0||(l.language="en"),Object.assign(i.rawBody,u),i.url="".concat(u.endpoint,"/language/analyze-text/jobs?api-version=2022-10-01-preview")):(i.isTextInputDisabled=!0,i.canSendMessage=function(){return!1},setTimeout(function(){t.addMessage({error:r.ENDPOINT_ERROR_MESSAGE})})),i}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i){var s=i[i.length-1].text;if(s)return{analysisInput:{documents:[{id:"1",language:n.language,text:s}]},tasks:[{kind:"ExtractiveSummarization"}]}}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.connectSettings){u.next=2;break}throw new Error("Request settings have not been set up");case 2:o=this.preprocessBody(this.rawBody,a),je.request(this,o,s),this.messages=s;case 4:case"end":return u.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){var a,o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!s.error){c.next=2;break}throw s.error.message;case 2:return this.messages&&this.completionsHandlers&&(o=s.headers.get("operation-location"),l={method:"GET",headers:(a=this.connectSettings)==null?void 0:a.headers},je.executePollRequest(this,o,l,this.messages)),c.abrupt("return",{makingAnotherRequest:!0});case 4:case"end":return c.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"extractPollResultData",value:function(){var t=O(g().mark(function i(s){var a,o,l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!s.error){d.next=2;break}throw s.error;case 2:if(s.status!=="running"){d.next=4;break}return d.abrupt("return",{timeoutMS:2e3});case 4:if(!(s.errors.length>0)){d.next=6;break}throw s.errors[0];case 6:if(!(s.tasks.items[0].results.errors.length>0)){d.next=8;break}throw s.tasks.items[0].results.errors[0];case 8:a="",o=m1(s.tasks.items[0].results.documents[0].sentences);try{for(o.s();!(l=o.n()).done;)u=l.value,a+=u.text}catch(f){o.e(f)}finally{o.f()}return d.abrupt("return",{text:a||""});case 12:case"end":return d.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(t_);gp.ENDPOINT_ERROR_MESSAGE="Please define the azure endpoint. [More Information](https://deepchat.dev/docs/directConnection/Azure#Summarization)";var n_=gp,bo=function(){function e(){T(this,e)}return A(e,null,[{key:"poll",value:function(){var r=O(g().mark(function n(i,s){var a,o,l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a={authorization:i,"content-type":"application/json"},d.t0="https://api.assemblyai.com/v2/transcript/",d.next=4,fetch("https://api.assemblyai.com/v2/transcript",{method:"POST",body:JSON.stringify({audio_url:s}),headers:a});case 4:return d.next=6,d.sent.json();case 6:d.t1=d.sent.id,o=d.t0.concat.call(d.t0,d.t1);case 8:if(l){d.next=24;break}return d.next=11,fetch(o,{headers:a});case 11:return d.next=13,d.sent.json();case 13:if(u=d.sent,u.status!=="completed"){d.next=18;break}l=u,d.next=22;break;case 18:if(u.status!=="error"){d.next=20;break}throw new Error("Transcription failed: ".concat(u.error));case 20:return d.next=22,new Promise(function(f){return setTimeout(f,3e3)});case 22:d.next=8;break;case 24:return d.abrupt("return",l);case 25:case"end":return d.stop()}},n)}));function t(n,i){return r.apply(this,arguments)}return t}()},{key:"buildHeaders",value:function(t){return{Authorization:t,"Content-Type":"application/octet-stream"}}},{key:"handleVerificationResult",value:function(t,n,i,s){var a=t;a.error?a.error.code==="invalid_api_key"?s(Pe.INVALID_KEY):s(Pe.CONNECTION_FAILED):i(n)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.assemblyai.com/v2/upload",method:"POST",handleVerificationResult:e.handleVerificationResult}}}])}(),r_=function(e){function r(t){var n;T(this,r);var i,s=(i=t.directConnection)==null?void 0:i.assemblyAI;return n=le(this,r,[t,bo.buildKeyVerificationDetails(),bo.buildHeaders,s,{audio:{}}]),n.insertKeyPlaceholderText="AssemblyAI API Key",n.keyHelpUrl="https://www.assemblyai.com/app/account",n.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>AssemblyAI Audio</b></div>
    <p><b>Upload an audio file</b> to transcribe it into text.
    <p>
      Click <a href="https://www.assemblyai.com/docs/Guides/transcribing_an_audio_file#get-started">here</a> for more info.
    </p>`,n.url="https://api.assemblyai.com/v2/upload",n.isTextInputDisabled=!0,n.textInputPlaceholderText="Upload an audio file",n.permittedErrorPrefixes=["Authentication","Invalid"],n.canSendMessage=r.canFileSendMessage,n}return ue(r,e),A(r,[{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a,o){var l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if((l=this.connectSettings)!=null&&l.headers){c.next=2;break}throw new Error("Request settings have not been set up");case 2:if(o!=null&&o[0]){c.next=4;break}throw new Error("No file was added");case 4:je.request(this,o[0],s,!1);case 5:case"end":return c.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){var a,o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!s.error){c.next=2;break}throw s.error;case 2:return l=(o=(a=this.connectSettings)==null?void 0:a.headers)==null?void 0:o.Authorization,c.next=5,bo.poll(l,s.upload_url);case 5:return c.t0=c.sent.text,c.abrupt("return",{text:c.t0});case 7:case"end":return c.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()}],[{key:"canFileSendMessage",value:function(n,i){return!!(i!=null&&i[0])}}])}(ft),yp=function(e){function r(t,n,i,s,a){var o;return T(this,r),o=le(this,r,[t,ur.buildSpeechKeyVerificationDetails(i),n,s,a]),o.insertKeyPlaceholderText="Azure Speech Subscription Key",o.keyHelpUrl="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",o}return ue(r,e),A(r)}(ft),cl=function(e){function r(t){var n,i,s,a;T(this,r);var o,l,u,c,d,f,h=(l=(o=t.directConnection)==null?void 0:o.azure)==null?void 0:l.textToSpeech,p=(u=t.directConnection)==null?void 0:u.azure;return a=le(this,r,[t,ur.buildTextToSpeechHeaders.bind({},h?.outputFormat||"audio-16khz-128kbitrate-mono-mp3"),h.region,p]),a.permittedErrorPrefixes=[r.REGION_ERROR_MESSAGE],a.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Azure Text To Speech</b></div>
    <p>Insert text to synthesize it to audio.
    <p>
      Click <a href="`.concat(r.HELP_LINK,`">here</a> for more info.
    </p>`),a.isTextInputDisabled=!1,a.url="",h.region?(Object.assign(a.rawBody,h),(n=(c=a.rawBody).lang)!==null&&n!==void 0||(c.lang="en-US"),(i=(d=a.rawBody).name)!==null&&i!==void 0||(d.name="en-US-JennyNeural"),(s=(f=a.rawBody).gender)!==null&&s!==void 0||(f.gender="Female"),a.url="https://".concat(h.region,".tts.speech.microsoft.com/cognitiveservices/v1")):(a.isTextInputDisabled=!0,a.canSendMessage=function(){return!1},setTimeout(function(){t.addMessage({error:r.REGION_ERROR_MESSAGE})})),a}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i){var s=i[i.length-1].text;if(s)return"<speak version='1.0' xml:lang='".concat(n.lang,`'>
      <voice xml:lang='`).concat(n.lang,"' xml:gender='").concat(n.gender,"' name='").concat(n.name,`'>
        `).concat(s,`
      </voice>
    </speak>`)}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.connectSettings){u.next=2;break}throw new Error("Request settings have not been set up");case 2:o=this.preprocessBody(this.rawBody,a),je.request(this,o,s,!1);case 4:case"end":return u.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",new Promise(function(l){var u=new FileReader;u.readAsDataURL(s),u.onload=function(c){l({files:[{src:c.target.result,type:"audio"}]})}}));case 1:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(yp);cl.HELP_LINK="https://learn.microsoft.com/en-GB/azure/cognitive-services/speech-service/get-started-text-to-speech?tabs=windows%2Cterminal&pivots=programming-language-rest",cl.REGION_ERROR_MESSAGE="Please define a region config property. [More Information](https://deepchat.dev/docs/directConnection/Azure#TextToSpeech)";var i_=cl,dl=function(e){function r(t){var n;T(this,r);var i,s,a,o=(s=(i=t.directConnection)==null?void 0:i.azure)==null?void 0:s.speechToText,l=(a=t.directConnection)==null?void 0:a.azure,u={audio:{files:{acceptedFormats:".wav,.ogg"}}};if(n=le(this,r,[t,ur.buildSpeechToTextHeaders,o.region,l,u]),n.permittedErrorPrefixes=[r.REGION_ERROR_MESSAGE],n.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Azure Speech To Text</b></div>
    <p><b>Upload a .wav or .ogg audio file</b> to transcribe it into text.
    <p>
      Click <a href="`.concat(r.HELP_LINK,`">here</a> for more info.
    </p>`),n.url="",n.isTextInputDisabled=!0,n.textInputPlaceholderText="Upload an audio file",!o.region)n.isTextInputDisabled=!0,n.canSendMessage=function(){return!1},setTimeout(function(){t.addMessage({error:r.REGION_ERROR_MESSAGE})});else{n.canSendMessage=r.canFileSendMessage;var c=o.lang||"en-US";n.url="https://".concat(o.region,".stt.speech.microsoft.com/speech/recognition/conversation/cognitiveservices/v1?language=").concat(c,"&format=detailed"),n.recordAudio=void 0}return n}return ue(r,e),A(r,[{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a,o){var l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if((l=this.connectSettings)!=null&&l.headers){d.next=2;break}throw new Error("Request settings have not been set up");case 2:if(o!=null&&o[0]){d.next=4;break}throw new Error("No file was added");case 4:(u=this.connectSettings)!=null&&u.headers&&(this.connectSettings.headers["Content-Type"]=o[0].name.toLocaleLowerCase().endsWith(".wav")?"audio/wav; codecs=audio/pcm; samplerate=16000":"audio/ogg; codecs=opus"),je.request(this,o[0],s,!1);case 5:case"end":return d.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.error){o.next=2;break}throw s.error;case 2:return o.abrupt("return",{text:s.DisplayText||""});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}],[{key:"canFileSendMessage",value:function(n,i){return!!(i!=null&&i[0])}}])}(yp);dl.HELP_LINK="https://learn.microsoft.com/en-GB/azure/cognitive-services/speech-service/get-started-text-to-speech?tabs=windows%2Cterminal&pivots=programming-language-rest",dl.REGION_ERROR_MESSAGE="Please define a region config property. [More Information](https://deepchat.dev/docs/directConnection/Azure#SpeechToText)";var s_=dl,a_=function(e){function r(t){var n;T(this,r);var i,s,a,o=(s=(i=t.directConnection)==null?void 0:i.azure)==null?void 0:s.translation,l=(a=t.directConnection)==null?void 0:a.azure;return n=le(this,r,[t,ur.buildTranslationKeyVerificationDetails(o.region),ur.buildTranslationHeaders.bind({},o?.region),l]),n.insertKeyPlaceholderText="Azure Translate Subscription Key",n.keyHelpUrl="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",n.url="",n.url="https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&to=".concat(o.language||"es"),n}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n){var i=n[n.length-1].text;if(i)return[{Text:i}]}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.connectSettings){u.next=2;break}throw new Error("Request settings have not been set up");case 2:o=this.preprocessBody(a),je.request(this,o,s);case 4:case"end":return u.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){var a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!Array.isArray(s)){l.next=2;break}return l.abrupt("return",{text:((a=s[0].translations)==null?void 0:a[0].text)||""});case 2:throw s.error;case 3:case"end":return l.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(ft),bp=function(e){function r(t,n,i,s,a){var o,l,u;T(this,r);var c,d,f,h,p,m=JSON.parse(JSON.stringify(t.directConnection)),v=n||Qe.buildKeyVerificationDetails(),y=i||Qe.buildHeaders,b=s||m.openAI;u=le(this,r,[t,v,y,b]),u.insertKeyPlaceholderText="OpenAI API Key",u.keyHelpUrl="https://platform.openai.com/account/api-keys",u.url="https://api.openai.com/v1/chat/completions",u.permittedErrorPrefixes=["Incorrect"],u.asyncCallInProgress=!1,u._systemMessage=r.generateSystemMessage("You are a helpful assistant.");var M=a||((c=m.openAI)==null?void 0:c.chat);if(Q(M)=="object"){M.system_prompt&&(u._systemMessage=r.generateSystemMessage(M.system_prompt));var _=(h=(f=(d=t.directConnection)==null?void 0:d.openAI)==null?void 0:f.chat)==null?void 0:h.function_handler;_&&(u._functionHandler=_),u.cleanConfig(M),Object.assign(u.rawBody,M)}return(o=u.maxMessages)!==null&&o!==void 0||(u.maxMessages=-1),(l=(p=u.rawBody).model)!==null&&l!==void 0||(p.model="gpt-4o"),u}return ue(r,e),A(r,[{key:"cleanConfig",value:function(n){delete n.system_prompt,delete n.function_handler}},{key:"preprocessBody",value:function(n,i){var s,a=JSON.parse(JSON.stringify(n)),o=Sa.getCharacterLimitMessages(i,this.totalMessagesMaxCharLength?this.totalMessagesMaxCharLength-this._systemMessage.content.length:-1).map(function(l){return{content:r.getContent(l),role:l.role===ie.USER_ROLE?"user":"assistant"}});return i.find(function(l){return l.files&&l.files.length>0})&&((s=a.max_tokens)!==null&&s!==void 0||(a.max_tokens=300)),a.messages=[this._systemMessage].concat(Zi(o)),a}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(this.connectSettings){c.next=2;break}throw new Error("Request settings have not been set up");case 2:o=this.preprocessBody(this.rawBody,a),l=this.stream,l&&(Q(l)!="object"||!l.simulation)||o.stream?(o.stream=!0,et.request(this,o,s)):je.request(this,o,s);case 4:case"end":return c.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s,a,o){var l,u,c,d;return g().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!s.error){h.next=2;break}throw s.error.message;case 2:return h.abrupt("return",(u=(l=s.choices)==null?void 0:l[0])!=null&&u.delta?this.extractStreamResult(s.choices[0],a,o):(d=(c=s.choices)==null?void 0:c[0])!=null&&d.message?s.choices[0].message.tool_calls?this.handleTools(s.choices[0].message,a,o):{text:s.choices[0].message.content}:{text:""});case 3:case"end":return h.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"extractStreamResult",value:function(){var t=O(g().mark(function i(s,a,o){var l=this,u,c,d;return g().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(u=s.delta,c=s.finish_reason,c!=="tool_calls"){h.next=7;break}return this.asyncCallInProgress=!0,d={tool_calls:this._streamToolCalls},h.abrupt("return",(this._streamToolCalls=void 0,this.handleTools(d,a,o)));case 7:u!=null&&u.tool_calls&&(this._streamToolCalls?u.tool_calls.forEach(function(p,m){l._streamToolCalls&&(l._streamToolCalls[m].function.arguments+=p.function.arguments)}):this._streamToolCalls=u.tool_calls);case 8:return h.abrupt("return",{text:u?.content||""});case 9:case"end":return h.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"handleTools",value:function(){var t=O(g().mark(function i(s,a,o){var l,u,c,d,f,h,p,m,v,y,b,M;return g().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(!s.tool_calls||!a||!o||!this._functionHandler)){E.next=2;break}throw Error("Please define the `function_handler` property inside the [openAI](https://deepchat.dev/docs/directConnection/openAI#Chat) object.");case 2:return h=JSON.parse(JSON.stringify(o)),p=s.tool_calls.map(function(C){return{name:C.function.name,arguments:C.function.arguments}}),E.next=6,(l=this._functionHandler)==null?void 0:l.call(this,p);case 6:if(m=E.sent,Array.isArray(m)){E.next=20;break}if(!m.text){E.next=19;break}return v={text:m.text},E.next=12,(c=(u=this.deepChat).responseInterceptor)==null?void 0:c.call(u,v);case 12:if(E.t0=E.sent,E.t0){E.next=15;break}E.t0=v;case 15:if(y=E.t0,!Array.isArray(y)){E.next=18;break}throw Error(Qe.FUNCTION_TOOL_RESP_ARR_ERROR);case 18:return E.abrupt("return",y);case 19:throw Error(Qe.FUNCTION_TOOL_RESP_ERROR);case 20:return E.next=22,Promise.all(m);case 22:if(b=E.sent,h.messages.push({tool_calls:s.tool_calls,role:"assistant",content:null}),!(!b.find(function(C){var B=C.response;return typeof B!="string"})&&p.length===b.length)){E.next=43;break}return b.forEach(function(C,B){var P,R=(P=s.tool_calls)==null?void 0:P[B];h?.messages.push({role:"tool",tool_call_id:R?.id,name:R?.function.name,content:C.response})}),delete h.tools,delete h.tool_choice,delete h.stream,E.prev=25,E.next=28,a?.(h).then(function(C){return me.processResponseByType(C)});case 28:return M=E.sent,E.next=31,(f=(d=this.deepChat).responseInterceptor)==null?void 0:f.call(d,M);case 31:if(E.t1=E.sent,E.t1){E.next=34;break}E.t1=M;case 34:if(M=E.t1,!M.error){E.next=37;break}throw M.error.message;case 37:return E.abrupt("return",{text:M.choices[0].message.content||""});case 40:throw E.prev=40,E.t2=E.catch(25),this.asyncCallInProgress=!1,E.t2;case 43:throw Error(Qe.FUNCTION_TOOL_RESP_ERROR);case 44:case"end":return E.stop()}},i,this,[[25,40]])}));function n(i,s,a){return t.apply(this,arguments)}return n}()}],[{key:"generateSystemMessage",value:function(n){return{role:"system",content:n}}},{key:"getContent",value:function(n){if(n.files&&n.files.length>0){var i=n.files.map(function(s){return{type:"image_url",image_url:{url:s.src}}});return n.text&&n.text.trim().length>0&&i.unshift({type:"text",text:n.text}),i}return n.text}}])}(ft),o_=function(e){function r(t){var n;T(this,r);var i,s,a,o,l,u,c,d=JSON.parse(JSON.stringify(t.directConnection)),f=d.azure,h=((s=(i=d.azure)==null?void 0:i.openAI)==null?void 0:s.urlDetails)||{},p=(o=(a=d.azure)==null?void 0:a.openAI)==null?void 0:o.chat;if(n=le(this,r,[t,Yt.buildKeyVerificationDetails(h),Yt.buildHeaders,f,p]),n.permittedErrorPrefixes=[Yt.URL_DETAILS_ERROR_MESSAGE],n.isTextInputDisabled=!1,Q(p)=="object"){var m=(c=(u=(l=t.directConnection)==null?void 0:l.azure)==null?void 0:u.openAI)==null?void 0:c.chat,v=m.function_handler;v&&(n._functionHandler=v)}return Yt.validateURLDetails(h)?n.url=r.buildURL(h):(n.isTextInputDisabled=!0,n.canSendMessage=function(){return!1},setTimeout(function(){t.addMessage({error:Yt.URL_DETAILS_ERROR_MESSAGE})})),n}return ue(r,e),A(r,null,[{key:"buildURL",value:function(n){var i=n.endpoint,s=n.deploymentId,a=n.version;return"".concat(i,"/openai/deployments/").concat(s,"/chat/completions?api-version=").concat(a)}}])}(bp),Ms=function(e){function r(t){var n;T(this,r);var i,s=t.directConnection,a=s?.openAI,o={images:{files:{acceptedFormats:".png",maxNumberOfFiles:2}}};n=le(this,r,[t,Qe.buildKeyVerificationDetails(),Qe.buildHeaders,a,o]),n.insertKeyPlaceholderText="OpenAI API Key",n.keyHelpUrl="https://platform.openai.com/account/api-keys",n.introPanelMarkUp=`
    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI DALL·E</b></div>
    <p><b>Insert text</b> to generate an image.</p>
    <p><b>Upload 1</b> PNG image to generate its variation and optionally insert text to specify the change.</p>
    <p><b>Upload 2</b> PNG images where the second is a copy of the first with a transparent area where the edit should
      take place and text to specify the edit.</p>
    <p>Click <a href="https://platform.openai.com/docs/guides/images/introduction">here</a> for more info.</p>`,n.url="",n.permittedErrorPrefixes=["Incorrect","Invalid input image"];var l=(i=s?.openAI)==null?void 0:i.images;if(n.camera){var u=Q(l)=="object"&&l.size?Number.parseInt(l.size):1024;n.camera.files={dimensions:{width:u,height:u}}}return Q(l)=="object"&&Object.assign(n.rawBody,l),n.canSendMessage=r.canFileSendMessage,n}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i){var s=JSON.parse(JSON.stringify(n));return i&&i!==""&&(s.prompt=i),s}},{key:"callApiWithImage",value:function(n,i,s){var a,o,l,u=(o=(a=i[i.length-1])==null?void 0:a.text)==null?void 0:o.trim();if(s[1]||u&&u!==""){this.url=r.IMAGE_EDIT_URL;var c=this.preprocessBody(this.rawBody,u);l=r.createFormDataBody(c,s[0],s[1])}else this.url=r.IMAGE_VARIATIONS_URL,l=r.createFormDataBody(this.rawBody,s[0]);me.tempRemoveContentHeader(this.connectSettings,je.request.bind(this,this,l,n),!1)}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a,o){var l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if((l=this.connectSettings)!=null&&l.headers){d.next=2;break}throw new Error("Request settings have not been set up");case 2:if(!(o!=null&&o[0])){d.next=6;break}this.callApiWithImage(s,a,o),d.next=11;break;case 6:if(this.connectSettings){d.next=8;break}throw new Error("Request settings have not been set up");case 8:this.url=r.IMAGE_GENERATION_URL,u=this.preprocessBody(this.rawBody,a[a.length-1].text),je.request(this,u,s);case 11:case"end":return d.stop()}},i,this)}));function n(i,s,a){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.error){o.next=2;break}throw s.error.message;case 2:return o.abrupt("return",{files:s.data.map(function(l){return l.url?{src:l.url,type:"image"}:{src:"".concat(Qi).concat(l.b64_json),type:"image"}})});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}],[{key:"canFileSendMessage",value:function(n,i){return!!(i!=null&&i[0])||!!(n&&n.trim()!=="")}},{key:"createFormDataBody",value:function(n,i,s){var a=new FormData;return a.append("image",i),s&&a.append("mask",s),Object.keys(n).forEach(function(o){a.append(o,String(n[o]))}),a}}])}(ft);Ms.IMAGE_GENERATION_URL="https://api.openai.com/v1/images/generations",Ms.IMAGE_VARIATIONS_URL="https://api.openai.com/v1/images/variations",Ms.IMAGE_EDIT_URL="https://api.openai.com/v1/images/edits";var l_=Ms,u_=function(e){function r(t){var n,i;T(this,r);var s,a=JSON.parse(JSON.stringify(t.directConnection)),o=(s=a.cohere)==null?void 0:s.chat,l=a.cohere;return i=le(this,r,[t,"https://api.cohere.ai/v1/chat","Ask me anything!",o,l]),Q(o)=="object"&&Object.assign(i.rawBody,o),(n=i.maxMessages)!==null&&n!==void 0||(i.maxMessages=-1),i}return ue(r,e),A(r,[{key:"preprocessBody",value:function(n,i){var s=JSON.parse(JSON.stringify(n)),a=i.filter(function(o){return o.text});return s.query=a[a.length-1].text,s.chat_history=a.slice(0,a.length-1).map(function(o){return{text:o.text,user_name:o.role==="ai"?"CHATBOT":"USER"}}),s}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.connectSettings){u.next=2;break}throw new Error("Request settings have not been set up");case 2:o=this.preprocessBody(this.rawBody,a),je.request(this,o,s);case 4:case"end":return u.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.message){o.next=2;break}throw s.message;case 2:return o.abrupt("return",{text:s.text});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(uu),Qc=function(){function e(){T(this,e)}return A(e,null,[{key:"buildHeaders",value:function(t){return{Authorization:"Bearer ".concat(t),"Content-Type":"application/json",accept:"application/json"}}},{key:"handleVerificationResult",value:function(t,n,i,s){var a;(a=t.message)!=null&&a.includes("invalid request: prompt must be at least 1 token long")?i(n):s(Pe.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.mistral.ai/v1/models",method:"GET",handleVerificationResult:e.handleVerificationResult}}}])}(),c_=function(e){function r(t){var n,i,s;T(this,r);var a,o=JSON.parse(JSON.stringify(t.directConnection)).mistral;return s=le(this,r,[t,Qc.buildKeyVerificationDetails(),Qc.buildHeaders,o]),s.insertKeyPlaceholderText="Mistral API Key",s.keyHelpUrl="https://console.mistral.ai/api-keys/",s.url="https://api.mistral.ai/v1/chat/completions",s.permittedErrorPrefixes=["invalid"],o&&(s.cleanConfig(o),Object.assign(s.rawBody,o)),(n=s.maxMessages)!==null&&n!==void 0||(s.maxMessages=-1),(i=(a=s.rawBody).model)!==null&&i!==void 0||(a.model="open-mistral-7b"),s}return ue(r,e),A(r,[{key:"cleanConfig",value:function(n){delete n.key}},{key:"preprocessBody",value:function(n,i){var s=JSON.parse(JSON.stringify(n)),a=i.filter(function(o){return o.text});return s.messages=a.slice(0,a.length-1).map(function(o){return{text:o.text,user_name:o.role==="ai"?"system":"user"}}),s}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.connectSettings){u.next=2;break}throw new Error("Request settings have not been set up");case 2:o=this.preprocessBody(this.rawBody,a),je.request(this,o,s);case 4:case"end":return u.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){return g().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!s.message){o.next=2;break}throw s.message;case 2:return o.abrupt("return",{text:s.text});case 3:case"end":return o.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}])}(ft),ed=function(){function e(){T(this,e)}return A(e,null,[{key:"buildHeaders",value:function(){return{"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(t,n,i,s){var a,o=t;o.error?o.error.code===403||(a=o.error.message)!=null&&a.includes("API key")?s(Pe.INVALID_KEY):s(Pe.CONNECTION_FAILED):i(n)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://generativelanguage.googleapis.com/v1beta/models?key=",method:"GET",handleVerificationResult:e.handleVerificationResult}}},{key:"directFetch",value:function(){var r=O(g().mark(function n(i,s,a){var o,l,u=arguments;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=u.length>3&&u[3]!==void 0?u[3]:!0,i.connectSettings.method=a,d.next=4,me.fetch(i,i.connectSettings.headers,o,s).then(function(f){return me.processResponseByType(f)});case 4:if(l=d.sent,!l.error){d.next=7;break}throw l.error.message;case 7:return d.abrupt("return",l);case 8:case"end":return d.stop()}},n)}));function t(n,i,s){return r.apply(this,arguments)}return t}()}])}(),d_=function(e){function r(t){var n,i;T(this,r);var s,a=JSON.parse(JSON.stringify(t.directConnection)),o=a.gemini,l=(s=a.gemini)==null?void 0:s.chat,u;i=le(this,r,[t,ed.buildKeyVerificationDetails(),ed.buildHeaders,o]),i.insertKeyPlaceholderText="Gemini API Key",i.keyHelpUrl="https://aistudio.google.com/app/apikey",i.url="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent",i.permittedErrorPrefixes=["API_KEY_INVALID"],Q(l)=="object"&&(l.systemInstruction&&(u=l.systemInstruction),l.model&&(i.url="https://generativelanguage.googleapis.com/v1beta/models/".concat(l.model,":generateContent")));var c="".concat(i.url,"?key=").concat(o?.key);return i.url=c,Object.defineProperty(i,"_systemInstruction",{value:u,writable:!1}),Q(l)=="object"&&(i.cleanConfig(l),Object.assign(i.rawBody,l)),(n=i.maxMessages)!==null&&n!==void 0||(i.maxMessages=-1),i}return ue(r,e),A(r,[{key:"cleanConfig",value:function(n){delete n.systemInstruction,delete n.model}},{key:"preprocessBody",value:function(n,i){var s,a=JSON.parse(JSON.stringify(n)),o=Sa.getCharacterLimitMessages(i,this.totalMessagesMaxCharLength?this.totalMessagesMaxCharLength-(((s=this._systemInstruction)==null?void 0:s.length)||0):-1).map(function(l){return r.getContent(l)});return a.contents=o,this._systemInstruction&&(a.systemInstruction={parts:[{text:this._systemInstruction}]}),a}},{key:"callServiceAPI",value:function(){var t=O(g().mark(function i(s,a){var o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(this.connectSettings){c.next=2;break}throw new Error("Request settings have not been set up");case 2:o=this.preprocessBody(this.rawBody,a),l=this.stream,l&&(Q(l)!="object"||!l.simulation)||o.stream?(o.stream=!0,et.request(this,o,s)):je.request(this,o,s);case 4:case"end":return c.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"extractResultData",value:function(){var t=O(g().mark(function i(s){var a,o,l,u,c;return g().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!s.error){f.next=2;break}throw s.error.message||"Gemini API Error";case 2:return f.abrupt("return",(c=(u=(l=(o=(a=s.candidates)==null?void 0:a[0])==null?void 0:o.content)==null?void 0:l.parts)==null?void 0:u[0])!=null&&c.text?{text:s.candidates[0].content.parts[0].text}:{text:""});case 3:case"end":return f.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()}],[{key:"getContent",value:function(n){var i=[];return n.text&&n.text.trim().length>0&&i.push({text:n.text}),n.files&&n.files.length>0&&n.files.forEach(function(s){if(s.src&&s.src.includes("data:")){var a=s.src.split(","),o=or(a,2),l=o[0],u=o[1];i.push({inlineData:{mimeType:l.replace("data:","").replace(";base64",""),data:u}})}}),{parts:i,role:n.role===ie.USER_ROLE?"user":"model"}}}])}(ft),f_=function(){function e(){T(this,e)}return A(e,null,[{key:"create",value:function(t){var n=t.directConnection,i=t.connect,s=t.demo,a=t.webModel;if(a)return new ou(t);if(n){if(n.openAI)return n.openAI.images?new l_(t):n.openAI.speechToText?new e_(t):n.openAI.textToSpeech?new Qk(t):n.openAI.assistant?new Kk(t):n.openAI.realtime?new Zk(t):new bp(t);if(n.assemblyAI)return new r_(t);if(n.cohere)return n.cohere.textGeneration?new Jk(t):n.cohere.summarization?new Yk(t):new u_(t);if(n.huggingFace)return n.huggingFace.textGeneration?new jk(t):n.huggingFace.summarization?new Hk(t):n.huggingFace.translation?new Vk(t):n.huggingFace.fillMask?new Gk(t):n.huggingFace.questionAnswer?new Uk(t):n.huggingFace.audioSpeechRecognition?new $k(t):n.huggingFace.audioClassification?new Nk(t):n.huggingFace.imageClassification?new Bk(t):new zk(t);if(n.azure){if(n.azure.openAI){if(n.azure.openAI.chat)return new o_(t);if(n.azure.openAI.assistant)return new Xk(t)}if(n.azure.speechToText)return new s_(t);if(n.azure.textToSpeech)return new i_(t);if(n.azure.summarization)return new n_(t);if(n.azure.translation)return new a_(t)}if(n.stabilityAI)return n.stabilityAI.imageToImage?new Wk(t):n.stabilityAI.imageToImageUpscale?new Fk(t):n.stabilityAI.imageToImageMasking?new Dk(t):new qk(t);if(n.mistral)return new c_(t);if(n.gemini)return new d_(t)}return i&&Object.keys(i).length>0&&!s?new Gs(t):new Gs(t,void 0,s||!0)}}])}(),Sp=A(function e(){T(this,e)});Sp.attibutes={string:function(r){return r},number:function(r){return parseFloat(r)},boolean:function(r){return r==="true"},object:function(r){return JSON.parse(r)},array:function(r){return JSON.parse(r)},function:function(r){return new Function("return ".concat(r))()}};var h_=Sp;function ye(e){return function(r,t){Object.defineProperty(r,t,{});var n=r.constructor,i=t.toLocaleLowerCase();n._attributes_[i]=h_.attibutes[e],n._attributeToProperty_[i]=t}}var p_=function(){function e(r,t,n){T(this,e),this._isDisplayed=!1,r?(this._elementRef=this.createIntroPanelWithChild(r,n),this._isDisplayed=!0):t&&(this._elementRef=this.createInternalIntroPanel(t,n),this._isDisplayed=!0)}return A(e,[{key:"createIntroPanelWithChild",value:function(t,n){var i=e.createIntroPanel(n);return t.style.display==="none"&&(t.style.display="block"),i.appendChild(t),i}},{key:"createInternalIntroPanel",value:function(t,n){var i=e.createIntroPanel(n);return i.id="internal-intro-panel",i.innerHTML=t,i}},{key:"hide",value:function(){this._isDisplayed&&this._elementRef&&(this._elementRef.style.display="none",this._isDisplayed=!1)}},{key:"display",value:function(){!this._isDisplayed&&this._elementRef&&(this._elementRef.style.display="",this._isDisplayed=!0)}}],[{key:"createIntroPanel",value:function(t){var n=document.createElement("div");return n.classList.add("intro-panel"),Object.assign(n.style,t),n}}])}(),m_=`<?xml version="1.0" encoding="iso-8859-1"?>
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	 viewBox="50 30 420 450" xml:space="preserve">
<g filter="brightness(0) saturate(100%) invert(16%) sepia(0%) saturate(1942%) hue-rotate(215deg) brightness(99%) contrast(93%)">
	<g>
		<path d="M447.933,103.629c-0.034-3.076-1.224-6.09-3.485-8.352L352.683,3.511c-0.004-0.004-0.007-0.005-0.011-0.008
			C350.505,1.338,347.511,0,344.206,0H89.278C75.361,0,64.04,11.32,64.04,25.237v461.525c0,13.916,11.32,25.237,25.237,25.237
			h333.444c13.916,0,25.237-11.32,25.237-25.237V103.753C447.96,103.709,447.937,103.672,447.933,103.629z M356.194,40.931
			l50.834,50.834h-49.572c-0.695,0-1.262-0.567-1.262-1.262V40.931z M423.983,486.763c0,0.695-0.566,1.261-1.261,1.261H89.278
			c-0.695,0-1.261-0.566-1.261-1.261V25.237c0-0.695,0.566-1.261,1.261-1.261h242.94v66.527c0,13.916,11.322,25.239,25.239,25.239
			h66.527V486.763z"/>
	</g>
</g>
<g>
	<g>
		<path d="M362.088,164.014H149.912c-6.62,0-11.988,5.367-11.988,11.988c0,6.62,5.368,11.988,11.988,11.988h212.175
			c6.62,0,11.988-5.368,11.988-11.988C374.076,169.381,368.707,164.014,362.088,164.014z"/>
	</g>
</g>
<g>
	<g>
		<path d="M362.088,236.353H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.62,5.368,11.988,11.988,11.988h212.175
			c6.62,0,11.988-5.368,11.988-11.988C374.076,241.721,368.707,236.353,362.088,236.353z"/>
	</g>
</g>
<g>
	<g>
		<path d="M362.088,308.691H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.621,5.368,11.988,11.988,11.988h212.175
			c6.62,0,11.988-5.367,11.988-11.988C374.076,314.06,368.707,308.691,362.088,308.691z"/>
	</g>
</g>
<g>
	<g>
		<path d="M256,381.031H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.621,5.368,11.988,11.988,11.988H256
			c6.62,0,11.988-5.367,11.988-11.988C267.988,386.398,262.62,381.031,256,381.031z"/>
	</g>
</g>
</svg>`,xs=function(){function e(){T(this,e)}return A(e,null,[{key:"createImage",value:function(t,n,i){var s=new Image;return s.src=t.src,i&&Et.scrollDownOnImageLoad(s.src,n),Et.processContent("image",s,s.src,t.name)}},{key:"createImageMessage",value:function(t,n,i,s){var a=e.createImage(n,t.elementRef,!s&&!t.focusMode),o=t.createNewMessageElement("",i);return o.bubbleElement.appendChild(a),o.bubbleElement.classList.add(e.IMAGE_BUBBLE_CLASS),{type:"image",elements:o}}},{key:"createAudioElement",value:function(t,n){var i=document.createElement("audio");return i.src=t.src,i.classList.add("audio-player"),i.controls=!0,rr.IS_SAFARI&&(i.classList.add("audio-player-safari"),i.classList.add(n===ie.USER_ROLE?"audio-player-safari-right":"audio-player-safari-left")),i}},{key:"createNewAudioMessage",value:function(t,n,i,s){var a=e.createAudioElement(n,i),o=t.createMessageElementsOnOrientation("",i,s);return o.bubbleElement.appendChild(a),o.bubbleElement.classList.add(e.AUDIO_BUBBLE_CLASS),{type:"audio",elements:o}}},{key:"createAnyFile",value:function(t){var n=document.createElement("div");n.classList.add("any-file-message-contents");var i=document.createElement("div");i.classList.add("any-file-message-icon-container");var s=mn.createSVGElement(m_);s.classList.add("any-file-message-icon"),i.appendChild(s);var a=document.createElement("div");return a.classList.add("any-file-message-text"),a.textContent=t.name||Et.DEFAULT_FILE_NAME,n.appendChild(i),n.appendChild(a),Et.processContent("any",n,t.src,a.textContent)}},{key:"createNewAnyFileMessage",value:function(t,n,i,s){var a=t.createMessageElementsOnOrientation("",i,s),o=e.createAnyFile(n);return a.bubbleElement.classList.add(e.ANY_FILE_BUBBLE_CLASS),a.bubbleElement.appendChild(o),{type:"file",elements:a}}},{key:"createMessages",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return n.map(function(a){return a.ref&&(a=Et.removeFileRef(a)),Et.isAudioFile(a)?e.createNewAudioMessage(t,a,i,s):Et.isImageFile(a)?e.createImageMessage(t,a,i,s):e.createNewAnyFileMessage(t,a,i,s)})}},{key:"addMessages",value:function(t,n,i,s){e.createMessages(t,n,i,s).forEach(function(a){var o=a.type,l=a.elements;Et.addMessage(t,l,o,i,s)})}}])}();xs.IMAGE_BUBBLE_CLASS="image-message",xs.AUDIO_BUBBLE_CLASS="audio-message",xs.ANY_FILE_BUBBLE_CLASS="any-file-message";var kp=xs,v_=function(){function e(){T(this,e)}return A(e,null,[{key:"removeElements",value:function(t,n){if(n){var i=t.findIndex(function(s){return s===n});t.splice(i,1),n?.outerContainer.remove()}}},{key:"removeFilesMessages",value:function(t,n){var i;(i=n[1].files)==null||i.forEach(function(s){e.removeElements(t.messageElementRefs,s)}),delete n[0].files,delete n[1].files}},{key:"removeTextHTMLMessage",value:function(t,n,i){var s=n[1][i];e.removeElements(t.messageElementRefs,s),delete n[0][i],delete n[1][i]}},{key:"updateHTMLMessage",value:function(t,n,i){var s,a,o;if(n[1].html)$n.overwriteElements(t,i,n[1].html);else{var l=$n.create(t,i,n[0].role),u=((a=n[1].files)==null?void 0:a[((s=n[1].files)==null?void 0:s.length)-1])||n[1].text,c=u.outerContainer.nextSibling;(o=c?.parentElement)==null||o.insertBefore(l.outerContainer,c),t.messageElementRefs.splice(t.messageElementRefs.length-1,1);var d=t.messageElementRefs.findIndex(function(f){return f===u});t.messageElementRefs.splice(d+1,0,l),n[1].html=l}n[0].html=i}},{key:"updateFileMessages",value:function(t,n,i){var s,a,o=n[0].role,l=kp.createMessages(t,i,o),u=n[1].html,c=((a=n[1].files)==null?void 0:a[((s=n[1].files)==null?void 0:s.length)-1])||n[1].text,d=u||c,f=t.messageElementRefs.findIndex(function(p){return p===d});c&&(f+=1);var h=u?.outerContainer||c?.outerContainer.nextSibling;l.forEach(function(p,m){var v=p.type,y=p.elements,b;Et.setElementProps(t,y,v,o),(b=h.parentElement)==null||b.insertBefore(y.outerContainer,h),t.messageElementRefs.splice(t.messageElementRefs.length-1,1),t.messageElementRefs.splice(f+m,0,y)}),e.removeFilesMessages(t,n),n[1].files=l.map(function(p){var m=p.elements;return m}),n[0].files=i}},{key:"updateTextMessage",value:function(t,n,i){var s,a;if(n[1].text)t.renderText(n[1].text.bubbleElement,i);else{var o=t.createElements(i,n[0].role),l=((s=n[1].files)==null?void 0:s[0])||n[1].html;(a=l.outerContainer.parentElement)==null||a.insertBefore(o.outerContainer,l.outerContainer);var u=t.messageElementRefs.findIndex(function(c){return c===l});t.messageElementRefs.splice(u,0,o),n[1].text=o}n[0].text=i}},{key:"isElementActive",value:function(t){var n,i;return fl.isActiveElement((n=t.text)==null?void 0:n.bubbleElement.classList)||fl.isActiveElement((i=t.html)==null?void 0:i.bubbleElement.classList)}},{key:"update",value:function(t,n,i){var s=t.messageToElements[i];if(s){if(e.isElementActive(s[1]))return console.error("Cannot update a message that is being streamed");n.text&&e.updateTextMessage(t,s,n.text),n.files?e.updateFileMessages(t,s,n.files):e.removeFilesMessages(t,s),n.html&&e.updateHTMLMessage(t,s,n.html),!n.text&&s[1].text&&e.removeTextHTMLMessage(t,s,"text"),!n.html&&s[1].html&&e.removeTextHTMLMessage(t,s,"html");var a=t.messageElementRefs,o=t.avatar,l=t.name;ie.classifyRoleMessages(a),ie.resetAllRoleElements(a,o,l)}else console.error("Message index not found. Please use the `getMessages` method to find the correct index")}}])}(),g_=function(){function e(){T(this,e)}return A(e,null,[{key:"getText",value:function(t,n){var i;if(!t.directConnection&&!t.connect&&!t.webModel&&!t.demo)return`Connect to any API using the [connect](https://deepchat.dev/docs/connect#connect-1) property or a popular service via [directConnection](https://deepchat.dev/docs/directConnection/#directConnection).
 Host AI entirely on your browser via a [webModel](https://deepchat.dev/docs/webModel).
 To get started checkout the [Start](https://deepchat.dev/start) page and live code [examples](https://deepchat.dev/examples/frameworks).
 To remove this message set the [demo](https://deepchat.dev/docs/modes#demo) property to true.`;if(t.directConnection){if(!n.isDirectConnection())return`Please define a valid service inside
          the [directConnection](https://deepchat.dev/docs/directConnection/#directConnection) object.`;var s=(i=t.directConnection.openAI)==null?void 0:i.chat;if(Q(s)=="object"&&s.tools&&!s.function_handler)return"Please define the `function_handler` property inside the openAI [chat](https://deepchat.dev/docs/directConnection/openAI#Chat) object."}else if(t.connect&&!t.connect.url&&!t.connect.handler)return"Please define a `url` or a `handler` property inside the [connect](https://deepchat.dev/docs/connect#connect-1) object.";return null}}])}(),fl=function(e){function r(t,n,i){var s;T(this,r);var a,o;s=le(this,r,[t]);var l=n.permittedErrorPrefixes,u=n.introPanelMarkUp,c=n.demo;return s._errorMessageOverrides=(a=t.errorMessages)==null?void 0:a.overrides,s._onClearMessages=Vi.onClearMessages.bind(s,t),s._onError=Vi.onError.bind(s,t),s._isLoadingMessageAllowed=r.getDefaultDisplayLoadingMessage(t,n),Q(t.displayLoadingBubble)=="object"&&t.displayLoadingBubble.toggle&&(t.displayLoadingBubble.toggle=s.setLoadingToggle.bind(s)),s._permittedErrorPrefixes=l,s.addSetupMessageIfNeeded(t,n)||s.populateIntroPanel(i,u,t.introPanelStyle),c&&s.prepareDemo(xt.processDemo(c),t.loadHistory),s.addIntroductoryMessages(t,n),new au(t,s,n),s._displayServiceErrorMessages=(o=t.errorMessages)==null?void 0:o.displayServiceErrorMessages,t.getMessages=function(){return ie.deepCloneMessagesWithReferences(s.messageToElements.map(function(d){var f=or(d,1),h=f[0];return h}))},t.clearMessages=s.clearMessages.bind(s,n),t.refreshMessages=s.refreshTextMessages.bind(s,t.remarkable),t.scrollToBottom=At.scrollToBottom.bind(s,s.elementRef),t.addMessage=function(d,f){s.addAnyMessage(ke(ke({},d),{},{sendUpdate:!!f}),!f)},t.updateMessage=function(d,f){return v_.update(s,d,f)},n.isWebModel()&&n.setUpMessages(s),t.textToSpeech&&ks.processConfig(t.textToSpeech,function(d){s.textToSpeech=d}),s}return ue(r,e),A(r,[{key:"setLoadingToggle",value:function(){var n=this.messageElementRefs[this.messageElementRefs.length-1];Xt.isLoadingMessage(n)?this.removeLastMessage():this.addLoadingMessage(!0)}},{key:"prepareDemo",value:function(n,i){var s;if(Q(n)=="object"){if(!i&&n.displayLoading){var a=n.displayLoading.history;a!=null&&a.small&&ir.addMessage(this,!1),a!=null&&a.full&&ir.addMessage(this)}n.displayErrors&&(n.displayErrors.default&&this.addNewErrorMessage("",""),n.displayErrors.service&&this.addNewErrorMessage("service",""),n.displayErrors.speechToText&&this.addNewErrorMessage("speechToText","")),(s=n.displayLoading)!=null&&s.message&&this.addLoadingMessage(),n.response&&(this.customDemoResponse=n.response)}}},{key:"addSetupMessageIfNeeded",value:function(n,i){var s=g_.getText(n,i);if(s){var a=this.createAndAppendNewMessageElement(s,ie.AI_ROLE);this.applyCustomStyles(a,ie.AI_ROLE,!1)}return!!s}},{key:"addIntroductoryMessages",value:function(n,i){var s=this;n!=null&&n.shadowRoot&&(this._introMessage=n.introMessage);var a=this._introMessage;i!=null&&i.isWebModel()&&(a??(a=i.getIntroMessage(a)));var o=!(n!=null&&n.history)&&!!(n!=null&&n.loadHistory||i!=null&&i.fetchHistory);a&&(Array.isArray(a)?a.forEach(function(l,u){if(u!==0){var c=s.messageElementRefs[s.messageElementRefs.length-1].innerContainer;ie.hideRoleElements(c,s.avatar,s.name)}s.addIntroductoryMessage(l,o)}):this.addIntroductoryMessage(a,o))}},{key:"addIntroductoryMessage",value:function(n,i){var s,a;return n!=null&&n.text?a=this.createAndAppendNewMessageElement(n.text,ie.AI_ROLE):n!=null&&n.html&&(a=$n.add(this,n.html,ie.AI_ROLE)),a&&(this.applyCustomStyles(a,ie.AI_ROLE,!1,(s=this.messageStyles)==null?void 0:s.intro),a.outerContainer.classList.add(Xt.INTRO_CLASS),i&&(a.outerContainer.style.display="none")),a}},{key:"removeIntroductoryMessage",value:function(){var n=this.messageElementRefs[0];n.outerContainer.classList.contains(Xt.INTRO_CLASS)&&(n.outerContainer.remove(),this.messageElementRefs.shift())}},{key:"addAnyMessage",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return n.error?this.addNewErrorMessage("service",n.error,s):this.addNewMessage(n,i,s)}},{key:"tryAddTextMessage",value:function(n,i,s){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;!s.ignoreText&&n.text!==void 0&&s.text!==null&&(this.addNewTextMessage(n.text,n.role,i,o),!a&&this.textToSpeech&&n.role!==ie.USER_ROLE&&ks.speak(n.text,this.textToSpeech))}},{key:"tryAddFileMessages",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n.files&&Array.isArray(n.files)&&kp.addMessages(this,n.files,n.role,i)}},{key:"tryAddHTMLMessage",value:function(n,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n.html!==void 0&&n.html!==null){var a=$n.add(this,n.html,n.role,i,s);!s&&xr.isElementTemporary(a)&&delete n.html}}},{key:"addNewMessage",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a,o;n.role!==ie.USER_ROLE&&((a=this._hiddenAttachments)==null||a.removeHiddenFiles());var l=r.createMessageContent(n),u={status:n.overwrite};return s?(this.tryAddHTMLMessage(l,u,s),this.tryAddFileMessages(l,s),this.tryAddTextMessage(l,u,n,i,s)):(this.tryAddTextMessage(l,u,n,i,s),this.tryAddFileMessages(l,s),this.tryAddHTMLMessage(l,u,s)),this.isValidMessageContent(l)&&!s&&(this.updateStateOnMessage(l,n.overwrite,n.sendUpdate,i),i||(o=this.browserStorage)==null||o.addMessages(this.messageToElements.map(function(c){var d=or(c,1),f=d[0];return f}))),l}},{key:"isValidMessageContent",value:function(n){return n.text||n.html||n.files&&n.files.length>0}},{key:"updateStateOnMessage",value:function(n,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!i){var o=ie.generateMessageBody(n,this.messageElementRefs);this.messageToElements.push([n,o])}s&&this.sendClientUpdate(n,a)}},{key:"removeMessageOnError",value:function(){var n=this.messageElementRefs[this.messageElementRefs.length-1],i=n?.bubbleElement;(i!=null&&i.classList.contains(jn.MESSAGE_CLASS)&&i.textContent===""||r.isTemporaryElement(n))&&this.removeLastMessage()}},{key:"addNewErrorMessage",value:function(n,i){var s=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o,l,u,c,d,f;(o=this._hiddenAttachments)==null||o.readdHiddenFiles(),this.removeMessageOnError();var h=this.getPermittedMessage(i)||((l=this._errorMessageOverrides)==null?void 0:l[n])||((u=this._errorMessageOverrides)==null?void 0:u.default)||"Error, please try again.",p=this.createMessageElementsOnOrientation(h,"error",a);ie.hideRoleElements(p.innerContainer,this.avatar,this.name);var m=p.bubbleElement,v=p.outerContainer;m.classList.add(ie.ERROR_MESSAGE_TEXT_CLASS),this.renderText(m,h);var y=_s.extractParticularSharedStyles(["fontSize","fontFamily"],(c=this.messageStyles)==null?void 0:c.default);_s.applyCustomStylesToElements(p,!1,y),_s.applyCustomStylesToElements(p,!1,(d=this.messageStyles)==null?void 0:d.error),a||this.appendOuterContainerElemet(v),this.textToSpeech&&ks.speak(h,this.textToSpeech),(f=this._onError)==null||f.call(this,h),setTimeout(function(){return At.scrollToBottom(s.elementRef)})}},{key:"getPermittedMessage",value:function(n){if(n)for(var i=r.extractErrorMessages(n),s=0;s<i.length;s+=1){var a=i[s];if(typeof a=="string"){if(this._displayServiceErrorMessages)return a;if(this._permittedErrorPrefixes){var o=r.checkPermittedErrorPrefixes(this._permittedErrorPrefixes,a);if(o)return o}}}}},{key:"removeError",value:function(){this.isLastMessageError()&&ie.getLastMessageElement(this.elementRef).remove()}},{key:"addDefaultLoadingMessage",value:function(){var n=this.createMessageElements("",ie.AI_ROLE),i=n.bubbleElement;n.bubbleElement.classList.add(Qn.DOTS_CONTAINER_CLASS);var s=document.createElement("div");return s.classList.add("loading-message-dots"),i.appendChild(s),Qn.setDots(i,this.messageStyles),n}},{key:"addLoadingMessage",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i,s,a,o,l,u,c=this.messageElementRefs[this.messageElementRefs.length-1];if(!(Xt.isLoadingMessage(c)||!n&&!this._isLoadingMessageAllowed)){var d=(a=(s=(i=this.messageStyles)==null?void 0:i.loading)==null?void 0:s.message)==null?void 0:a.html,f=d?$n.createElements(this,d,ie.AI_ROLE,!1):this.addDefaultLoadingMessage();this.appendOuterContainerElemet(f.outerContainer),f.bubbleElement.classList.add(Qn.BUBBLE_CLASS),this.applyCustomStyles(f,ie.AI_ROLE,!1,(u=(l=(o=this.messageStyles)==null?void 0:o.loading)==null?void 0:l.message)==null?void 0:u.styles),this.focusMode||At.scrollToBottom(this.elementRef)}}},{key:"populateIntroPanel",value:function(n,i,s){(n||i)&&(this._introPanel=new p_(n,i,s),this._introPanel._elementRef&&(pn.apply(this,this._introPanel._elementRef),this.elementRef.appendChild(this._introPanel._elementRef)))}},{key:"addMultipleFiles",value:function(){var t=O(g().mark(function i(s,a){return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(this._hiddenAttachments=a,Promise.all((s||[]).map(function(u){return new Promise(function(c){if(!u.type||u.type==="any"){var d=u.file.name||Et.DEFAULT_FILE_NAME;c({name:d,type:"any",ref:u.file})}else{var f=new FileReader;f.readAsDataURL(u.file),f.onload=function(){c({src:f.result,type:u.type,ref:u.file})}}})}))));case 1:case"end":return l.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"clearMessages",value:function(n,i){var s,a,o,l,u=[];this.messageElementRefs.forEach(function(d){r.isActiveElement(d.bubbleElement.classList)?u.push(d):d.outerContainer.remove()}),Array.from(this.elementRef.children).forEach(function(d){var f,h=(f=d.children[0])==null?void 0:f.children[0];h!=null&&h.classList.contains(ie.ERROR_MESSAGE_TEXT_CLASS)&&d.remove()}),this.messageElementRefs=u;var c=this.messageToElements.filter(function(d){return d[1].text&&r.isActiveElement(d[1].text.bubbleElement.classList)||d[1].html&&r.isActiveElement(d[1].html.bubbleElement.classList)});(s=this.messageToElements).splice.apply(s,[0,this.messageToElements.length].concat(Zi(c))),i!==!1&&((a=this._introPanel)!=null&&a._elementRef&&this._introPanel.display(),this.addIntroductoryMessages()),(o=this.browserStorage)==null||o.clear(),(l=this._onClearMessages)==null||l.call(this),delete n.sessionId}}],[{key:"getDefaultDisplayLoadingMessage",value:function(n,i){var s;return i.websocket?!!n.displayLoadingBubble:(s=Q(n.displayLoadingBubble)=="object"||n.displayLoadingBubble)!==null&&s!==void 0?s:!0}},{key:"checkPermittedErrorPrefixes",value:function(n,i){for(var s=0;s<n.length;s+=1)if(i.startsWith(n[s]))return i}},{key:"extractErrorMessages",value:function(n){return Array.isArray(n)?n:n instanceof Error?[n.message]:typeof n=="string"?[n]:Q(n)=="object"&&n.error?[n.error]:[]}},{key:"isActiveElement",value:function(n){return n?n.contains(Qn.BUBBLE_CLASS)||n.contains(ir.CLASS)||n.contains(jn.MESSAGE_CLASS):!1}}])}(Xt),hi=function(){function e(){T(this,e)}return A(e,null,[{key:"adjustInputPadding",value:function(t,n){n["inside-left"].length>0&&t.classList.add("text-input-inner-left-adjustment"),n["inside-right"].length>0&&t.classList.add("text-input-inner-right-adjustment")}},{key:"adjustForOutsideButton",value:function(t,n,i){i["outside-right"].length===0&&i["outside-left"].length>0?(t[0].classList.add(e.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS)):i["outside-left"].length===0&&i["outside-right"].length>0&&(t[3].classList.add(e.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS))}},{key:"adjustOutsideSubmit",value:function(t,n,i){if(!(i["inside-left"].length>0||i["inside-right"].length>0)){if(i["outside-right"].length===0&&i["outside-left"].length>0)return t[0].classList.add(e.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS),i["outside-left"].map(function(s){return s.button.elementRef.classList.add("submit-button-enlarged")});if(i["outside-left"].length===0&&i["outside-right"].length>0)return t[3].classList.add(e.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS),i["outside-right"].map(function(s){return s.button.elementRef.classList.add("submit-button-enlarged")})}}},{key:"set",value:function(t,n,i,s){e.adjustOutsideSubmit(n,i,s)||e.adjustForOutsideButton(n,i,s),e.adjustInputPadding(t,s)}}])}();hi.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS="text-input-container-left-adjustment",hi.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS="text-input-container-right-adjustment",hi.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS="text-input-container-left-small-adjustment",hi.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS="text-input-container-right-small-adjustment";var y_=hi,Ks=function(){function e(){T(this,e)}return A(e,null,[{key:"create",value:function(){return Array.from({length:4}).map(function(t,n){var i=document.createElement("div");return i.classList.add("input-button-container"),(n===0||n===3)&&i.classList.add("outer-button-container"),(n===1||n===2)&&i.classList.add("inner-button-container"),i})}},{key:"add",value:function(t,n){t.insertBefore(n[1],t.firstChild),t.insertBefore(n[0],t.firstChild),t.appendChild(n[2]),t.appendChild(n[3])}},{key:"getContainerIndex",value:function(t){return t==="outside-left"?0:t==="inside-left"?1:t==="inside-right"?2:3}},{key:"addButton",value:function(t,n,i){n.classList.add(i);var s=e.getContainerIndex(i);t[s].appendChild(n),s===3&&n.classList.add("outside-right")}}])}(),td=["camera","gifs","images","audio","mixedFiles","submit","microphone"],b_=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22" fill="none">
  <rect x="2.5" y="2.5" width="17" height="17" rx="2" stroke="#000000" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,Is=function(){function e(){T(this,e)}return A(e,null,[{key:"addItemEvents",value:function(t,n,i,s){tu.add(n,s),n.addEventListener("click",function(){i.click()}),n.addEventListener("mouseenter",function(a){t.highlightedItem=a.target}),n.addEventListener("mouseleave",function(){t.highlightedItem=void 0})}},{key:"createItemText",value:function(t,n){var i=document.createElement("div");return Object.assign(i.style,n),i.classList.add(e.TEXT_CLASS),i.textContent=t||"File",i}},{key:"createItemIcon",value:function(t,n){var i=document.createElement("div");return Object.assign(i.style,n),i.classList.add(e.ICON_CLASS),i.appendChild(t),i}},{key:"populateItem",value:function(t,n,i){var s=t.elementRef,a=t.dropupText,o=t.svg,l=t.customStyles,u=s.children[0],c=l&&Object.values(l).find(function(d){var f;return((f=d.svg)==null?void 0:f.content)===""});u.classList.contains(Un.INPUT_BUTTON_INNER_TEXT_CLASS)?(c||n.appendChild(e.createItemIcon(o,i?.iconContainer)),n.appendChild(e.createItemText(u.textContent,i?.text))):(c||n.appendChild(e.createItemIcon(s.children[0],i?.iconContainer)),n.appendChild(e.createItemText(a,i?.text)))}},{key:"createItem",value:function(t,n,i){var s,a=document.createElement("div");Object.assign(a.style,(s=i?.item)==null?void 0:s.default),e.populateItem(n,a,i),a.classList.add(e.MENU_ITEM_CLASS);var o=n.elementRef;if(n.isCustom)n.setDropupItem(a);else{var l=nt.processStateful(i?.item||{});e.addItemEvents(t,a,o,l)}return a}}])}();Is.MENU_ITEM_CLASS="dropup-menu-item",Is.TEXT_CLASS="dropup-menu-item-text",Is.ICON_CLASS="dropup-menu-item-icon";var Ln=Is,Er=function(e){function r(t,n,i,s){var a;T(this,r);var o,l,u,c,d,f,h=((c=(u=(l=(o=t?.styles)==null?void 0:o.button)==null?void 0:l.default)==null?void 0:u.text)==null?void 0:c.content)||"Custom ".concat(n),p=b_,m=bn.tryCreateConfig("Custom ".concat(n),t?.tooltip);return a=le(this,r,[r.createButtonElement(),p,t?.position,m,((d=t?.styles)==null?void 0:d.button)||m&&{},h]),a._state="default",a.isCustom=!0,a._innerElements=a.createInnerElementsForStates(a.customStyles),a._menuStyles=s,a._onClick=t.onClick,a._dropupStyles=(f=t.styles)==null?void 0:f.dropup,a.setSetState(t),a.addClickListener(i),a.changeState(t.initialState,!0),a}return ue(r,e),A(r,[{key:"createInnerElementsForStates",value:function(n){var i="custom-icon",s=this.createInnerElements(i,"default",n);return{default:s,active:this.genStateInnerElements(i,"active",s,n),disabled:this.genStateInnerElements(i,"disabled",s,n)}}},{key:"setSetState",value:function(n){var i=this;n.setState=function(s){s==="default"&&i.changeToDefault(),s==="active"&&i.changeToActive(),s==="disabled"&&i.changeToDisabled()}}},{key:"addClickListener",value:function(n){var i=this;this.elementRef.addEventListener("click",function(){var s,a=(s=i._onClick)==null?void 0:s.call(i,i._state);n?.(),(a==="default"||a==="active"||a==="disabled")&&i.changeState(a)})}},{key:"changeState",value:function(n,i){n==="disabled"?this.changeToDisabled(i):n==="active"?this.changeToActive(i):this.changeToDefault(i)}},{key:"applyDropupContentStyles",value:function(n){var i=Array.from(this.elementRef.children);if(n!=null&&n.text){var s=i.find(function(o){return o.classList.contains(Ln.TEXT_CLASS)});s&&Object.assign(s.style,n.text)}if(n!=null&&n.iconContainer){var a=i.find(function(o){return o.classList.contains(Ln.ICON_CLASS)});a&&Object.assign(a.style,n.iconContainer)}}},{key:"resetDropupItem",value:function(n){var i,s,a;this.elementRef=pn.replaceElementWithNewClone(this.elementRef,this._originalElementRef),this.elementRef.innerHTML="",((i=n?.svg)==null?void 0:i.content)===""||this.elementRef.appendChild(Ln.createItemIcon(this.svg,(s=this._menuStyles)==null?void 0:s.iconContainer)),this.elementRef.appendChild(Ln.createItemText(this.dropupText,(a=this._menuStyles)==null?void 0:a.text))}},{key:"assignDropupItemStyle",value:function(n,i){var s;this.elementRef.parentElement&&this._originalElementRef&&this.resetDropupItem(i),this.applyDropupContentStyles(n),Object.assign(this.elementRef.style,(s=n?.item)==null?void 0:s.default);var a=nt.processStateful(n?.item||{});tu.add(this.elementRef,a),this.addClickListener()}},{key:"changeToDefault",value:function(n){var i,s,a,o,l,u;!n&&this._state==="default"||(this.elementRef.classList.contains(Ln.MENU_ITEM_CLASS)?this.assignDropupItemStyle((i=this._dropupStyles)==null?void 0:i.default,(s=this.customStyles)==null?void 0:s.default):(this.changeElementsByState(this._innerElements.default),(a=this.customStyles)!=null&&a.active&&wt.unsetAllCSS(this.elementRef,(o=this.customStyles)==null?void 0:o.active),(l=this.customStyles)!=null&&l.disabled&&wt.unsetAllCSS(this.elementRef,(u=this.customStyles)==null?void 0:u.disabled),this.reapplyStateStyle("default",["active","disabled"])),this.elementRef.classList.remove(r.DISABLED_CONTAINER_CLASS,r.ACTIVE_CONTAINER_CLASS),this.elementRef.classList.add(r.DEFAULT_CONTAINER_CLASS),tt.removeAriaDisabled(this.elementRef),this._state="default")}},{key:"changeToActive",value:function(n){var i,s;!n&&this._state==="active"||(this.elementRef.classList.contains(Ln.MENU_ITEM_CLASS)?this.assignDropupItemStyle((i=this._dropupStyles)==null?void 0:i.active,(s=this.customStyles)==null?void 0:s.active):(this.changeElementsByState(this._innerElements.active),this.reapplyStateStyle("active",["disabled","default"])),this.elementRef.classList.remove(r.DISABLED_CONTAINER_CLASS,r.DEFAULT_CONTAINER_CLASS),this.elementRef.classList.add(r.ACTIVE_CONTAINER_CLASS),tt.removeAriaDisabled(this.elementRef),this._state="active")}},{key:"changeToDisabled",value:function(n){var i,s,a,o,l,u;!n&&this._state==="disabled"||(this.elementRef.classList.contains(Ln.MENU_ITEM_CLASS)?this.assignDropupItemStyle((i=this._dropupStyles)==null?void 0:i.disabled,(s=this.customStyles)==null?void 0:s.disabled):(this.changeElementsByState(this._innerElements.disabled),(a=this.customStyles)!=null&&a.active&&wt.unsetAllCSS(this.elementRef,(o=this.customStyles)==null?void 0:o.active),(l=this.customStyles)!=null&&l.default&&wt.unsetAllCSS(this.elementRef,(u=this.customStyles)==null?void 0:u.default),this.reapplyStateStyle("disabled",["default","active"])),this.elementRef.classList.remove(r.ACTIVE_CONTAINER_CLASS,r.DEFAULT_CONTAINER_CLASS),this.elementRef.classList.add(r.DISABLED_CONTAINER_CLASS),tt.addAriaDisabled(this.elementRef),this._state="disabled")}},{key:"setDropupItem",value:function(n){this.elementRef=n,this._originalElementRef=n.cloneNode(!0),this.changeState(this._state,!0)}},{key:"genStateInnerElements",value:function(n,i,s,a){var o,l,u,c,d=this.createInnerElements(n,i,a),f=(l=(o=a?.[i])==null?void 0:o.svg)==null?void 0:l.content,h=(c=(u=a?.[i])==null?void 0:u.text)==null?void 0:c.content;if(f===void 0||h===void 0){var p=xi.parseSVGTextElements(s),m=p.svg,v=p.text,y=xi.parseSVGTextElements(d),b=y.svg,M=y.text,_=[];r.addToInnerElements(_,f,m,b),r.addToInnerElements(_,h,v,M),d=_}return d}}],[{key:"createButtonElement",value:function(){var n=document.createElement("div");return n.classList.add("input-button",r.BUTTON_CLASS),n}},{key:"addToInnerElements",value:function(n,i,s,a){i===void 0&&s?n.push(s.cloneNode(!0)):a&&n.push(a)}},{key:"add",value:function(n,i){var s=n.customButtons,a=n.focusInput,o=n.dropupStyles;s?.forEach(function(l,u){var c={button:new r(l,u+1,a,o?.menu)};i["".concat(r.INDICATOR_PREFIX).concat(u+1)]=c})}}])}(mr);Er.INDICATOR_PREFIX="custom",Er.BUTTON_CLASS="custom-button",Er.DISABLED_CONTAINER_CLASS="custom-button-container-disabled",Er.DEFAULT_CONTAINER_CLASS="custom-button-container-default",Er.ACTIVE_CONTAINER_CLASS="custom-button-container-active";var Ii=Er,S_=`<?xml version="1.0" encoding="utf-8"?>
<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <path d="M16 0c-8.836 0-16 7.163-16 16s7.163 16 16 16c8.837 0 16-7.163 16-16s-7.163-16-16-16zM16 30.032c-7.72 0-14-6.312-14-14.032s6.28-14 14-14 14 6.28 14 14-6.28 14.032-14 14.032zM23 15h-6v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1v6h-6c-0.552 0-1 0.448-1 1s0.448 1 1 1h6v6c0 0.552 0.448 1 1 1s1-0.448 1-1v-6h6c0.552 0 1-0.448 1-1s-0.448-1-1-1z"></path>
</svg>`,nd=function(){function e(){T(this,e)}return A(e,null,[{key:"focusItemWhenOnEdge",value:function(t,n){var i=n?t.children[0]:t.children[t.children.length-1];e.focusSiblingItem(i,t,n,!0)}},{key:"focusSiblingItem",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=s?t:t[i?"nextSibling":"previousSibling"];a?(t.dispatchEvent(new MouseEvent("mouseleave")),a.dispatchEvent(new MouseEvent("mouseenter"))):(t.dispatchEvent(new MouseEvent("mouseleave")),e.focusItemWhenOnEdge(n,i))}}])}(),k_=function(){function e(r,t){var n=this;T(this,e);var i;this._isOpen=!0,this._styles=t,this.elementRef=e.createElement((i=this._styles)==null?void 0:i.container),this.close(),setTimeout(function(){return n.addWindowEvents(r)})}return A(e,[{key:"open",value:function(){this.elementRef.style.display="block",this._isOpen=!0}},{key:"close",value:function(){this._isOpen&&(this.elementRef.style.display="none",this._isOpen=!1)}},{key:"toggle",value:function(){this._isOpen?this.close():this.open()}},{key:"addItem",value:function(t){var n=Ln.createItem(this,t,this._styles);this.elementRef.appendChild(n)}},{key:"addWindowEvents",value:function(t){this.clickEvent=this.windowClick.bind(this,t),window.addEventListener("click",this.clickEvent),this.keyDownEvent=this.windowKeyDown.bind(this,t),window.addEventListener("keydown",this.keyDownEvent)}},{key:"windowClick",value:function(t,n){var i;!t.isConnected&&this.clickEvent?window.removeEventListener("click",this.clickEvent):t.parentElement!==((i=n.target.shadowRoot)==null?void 0:i.children[0])&&this.close()}},{key:"windowKeyDown",value:function(t,n){var i,s,a;!t.isConnected&&this.keyDownEvent?window.removeEventListener("keydown",this.keyDownEvent):this._isOpen&&(n.key===it.ESCAPE?(this.close(),(i=this.highlightedItem)==null||i.dispatchEvent(new MouseEvent("mouseleave"))):n.key===it.ENTER?((s=this.highlightedItem)==null||s.click(),(a=this.highlightedItem)==null||a.dispatchEvent(new MouseEvent("mouseleave"))):n.key===it.ARROW_DOWN?nd.focusSiblingItem(this.highlightedItem||this.elementRef.children[this.elementRef.children.length-1],this.elementRef,!0):n.key===it.ARROW_UP&&nd.focusSiblingItem(this.highlightedItem||this.elementRef.children[0],this.elementRef,!1))}}],[{key:"createElement",value:function(t){var n=document.createElement("div");return n.id="dropup-menu",Object.assign(n.style,t),n}}])}(),_p=function(e){function r(t,n){var i;T(this,r);var s,a,o=bn.tryCreateConfig("Options",(s=n?.button)==null?void 0:s.tooltip);i=le(this,r,[r.createButtonElement(),S_,void 0,o,{styles:(a=n?.button)==null?void 0:a.styles}]);var l=i.createInnerElementsForStates(i.customStyles);return i._menu=new k_(t,n?.menu),i.addClickEvent(),i.buttonContainer=r.createButtonContainer(),i.changeElementsByState(l.styles),i.buttonContainer.appendChild(i.elementRef),i.elementRef.classList.add(r.BUTTON_ICON_CLASS),i.buttonContainer.appendChild(i._menu.elementRef),i.reapplyStateStyle("styles"),i.addContainerEvents(t),i}return ue(r,e),A(r,[{key:"createInnerElementsForStates",value:function(n){return{styles:this.createInnerElements("dropup-icon","styles",n)}}},{key:"addClickEvent",value:function(){this.elementRef.onclick=this._menu.toggle.bind(this._menu)}},{key:"addItem",value:function(n){this._menu.addItem(n)}},{key:"addContainerEvents",value:function(n){var i=this;n.addEventListener("click",function(s){var a=s.target.classList;!a.contains(r.BUTTON_ICON_CLASS)&&!a.contains(Ii.DISABLED_CONTAINER_CLASS)&&i._menu.close()})}}],[{key:"createButtonElement",value:function(){var n=document.createElement("div");return n.classList.add("input-button"),n}},{key:"createButtonContainer",value:function(){var n=document.createElement("div");return n.id="dropup-container",n}},{key:"getPosition",value:function(n,i){var s,a;return(s=i?.button)!=null&&s.position?(a=i?.button)==null?void 0:a.position:n["outside-left"].length>0&&n["outside-right"].length===0?"outside-right":"outside-left"}}])}(mr);_p.BUTTON_ICON_CLASS="dropup-button";var rd=_p,__=function(){function e(){T(this,e)}return A(e,null,[{key:"addToDropup",value:function(t,n,i,s){var a=new rd(i,s);td.forEach(function(l){var u=n["dropup-menu"].findIndex(function(d){return d.buttonType===l}),c=n["dropup-menu"][u];c&&(a.addItem(c.button),n["dropup-menu"].splice(u,1))}),n["dropup-menu"].forEach(function(l){var u=l.button;return a.addItem(u)});var o=rd.getPosition(n,s);Ks.addButton(t,a.buttonContainer,o),n[o].push({})}},{key:"addToSideContainer",value:function(t,n){["inside-left","inside-right","outside-left","outside-right"].forEach(function(i){var s=i;n[s].forEach(function(a){Ks.addButton(t,a.button.elementRef,s)})})}},{key:"setPosition",value:function(t,n,i){var s=ke(ke({},t[n]),{},{buttonType:n});i.push(s),delete t[n]}},{key:"createPositionsToButtonsObj",value:function(){return{"dropup-menu":[],"outside-left":[],"inside-left":[],"inside-right":[],"outside-right":[]}}},{key:"generatePositionToButtons",value:function(t){var n=e.createPositionsToButtonsObj();Object.keys(t).forEach(function(s){var a,o=(a=t[s])==null?void 0:a.button.position;o&&e.setPosition(t,s,n[o])}),n["inside-right"].length===0&&t.submit&&e.setPosition(t,"submit",n["inside-right"]),n["outside-right"].length===0&&(t.submit?e.setPosition(t,"submit",n["outside-right"]):t.microphone?e.setPosition(t,"microphone",n["outside-right"]):t.camera?e.setPosition(t,"camera",n["outside-right"]):t["".concat(Ii.INDICATOR_PREFIX,"1")]&&e.setPosition(t,"".concat(Ii.INDICATOR_PREFIX,"1"),n["outside-right"])),t.submit&&e.setPosition(t,"submit",n["outside-left"].length===0?n["outside-left"]:n["inside-right"]),t.microphone&&e.setPosition(t,"microphone",n["outside-left"].length===0?n["outside-left"]:n["inside-right"]);var i=Object.keys(t);return i.length>1||n["dropup-menu"].length>0?(td.forEach(function(s){t[s]&&n["dropup-menu"].push(ke(ke({},t[s]),{},{buttonType:s}))}),i.forEach(function(s){var a=s;a.startsWith(Ii.INDICATOR_PREFIX)&&t[a]&&n["dropup-menu"].push(ke(ke({},t[a]),{},{customType:a}))})):i.length===1&&e.setPosition(t,i[0],n["outside-right"].length===0?n["outside-right"]:n["outside-left"]),n}},{key:"addButtons",value:function(t,n,i,s){var a=e.generatePositionToButtons(n);return e.addToSideContainer(t,a),a["dropup-menu"].length>0&&e.addToDropup(t,a,i,s),a}}])}(),E_=`<?xml version="1.0" encoding="utf-8"?>
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20 10.9696L11.9628 18.5497C10.9782 19.4783 9.64274 20 8.25028 20C6.85782 20 5.52239 19.4783 4.53777 18.5497C3.55315 17.6211 3 16.3616 3 15.0483C3 13.7351 3.55315 12.4756 4.53777 11.547L12.575 3.96687C13.2314 3.34779 14.1217 3 15.05 3C15.9783 3 16.8686 3.34779 17.525 3.96687C18.1814 4.58595 18.5502 5.4256 18.5502 6.30111C18.5502 7.17662 18.1814 8.01628 17.525 8.63535L9.47904 16.2154C9.15083 16.525 8.70569 16.6989 8.24154 16.6989C7.77738 16.6989 7.33224 16.525 7.00403 16.2154C6.67583 15.9059 6.49144 15.4861 6.49144 15.0483C6.49144 14.6106 6.67583 14.1907 7.00403 13.8812L14.429 6.88674" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`,w_=`<?xml version="1.0" encoding="utf-8"?>
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
  <path d="M20,15.2928932 L20,5.5 C20,4.67157288 19.3284271,4 18.5,4 L5.5,4 C4.67157288,4 4,4.67157288 4,5.5 L4,12.2928932 L7.14644661,9.14644661 C7.34170876,8.95118446 7.65829124,8.95118446 7.85355339,9.14644661 L13.5,14.7928932 L16.1464466,12.1464466 C16.3417088,11.9511845 16.6582912,11.9511845 16.8535534,12.1464466 L20,15.2928932 Z M20,16.7071068 L16.5,13.2071068 L13.8535534,15.8535534 C13.6582912,16.0488155 13.3417088,16.0488155 13.1464466,15.8535534 L7.5,10.2071068 L4,13.7071068 L4,18.5 C4,19.3284271 4.67157288,20 5.5,20 L18.5,20 C19.3284271,20 20,19.3284271 20,18.5 L20,16.7071068 Z M3,5.5 C3,4.11928813 4.11928813,3 5.5,3 L18.5,3 C19.8807119,3 21,4.11928813 21,5.5 L21,18.5 C21,19.8807119 19.8807119,21 18.5,21 L5.5,21 C4.11928813,21 3,19.8807119 3,18.5 L3,5.5 Z M15,6 L17,6 C17.5522847,6 18,6.44771525 18,7 L18,9 C18,9.55228475 17.5522847,10 17,10 L15,10 C14.4477153,10 14,9.55228475 14,9 L14,7 C14,6.44771525 14.4477153,6 15,6 Z M15,7 L15,9 L17,9 L17,7 L15,7 Z"/>
</svg>
`,C_=`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-49.49 -49.49 593.87 593.87" stroke-width="3.95908" transform="rotate(0)">
  <g stroke-width="0"></g>
  <g stroke-linecap="round" stroke-linejoin="round" stroke-width="0.98977"></g>
  <g>
    <g>
      <g>
        <path d="M163.205,76.413v293.301c-3.434-3.058-7.241-5.867-11.486-8.339c-21.38-12.452-49.663-15.298-77.567-7.846 c-49.038,13.096-80.904,54.519-71.038,92.337c4.019,15.404,14.188,28.221,29.404,37.087c13.553,7.894,29.87,11.933,47.115,11.933 c9.962,0,20.231-1.356,30.447-4.087c42.74-11.406,72.411-44.344,72.807-77.654h0.011v-0.162c0.002-0.166,0-0.331,0-0.496V187.072 l290.971-67.3v178.082c-3.433-3.055-7.238-5.863-11.481-8.334c-21.385-12.452-49.654-15.308-77.567-7.846 c-49.038,13.087-80.904,54.519-71.038,92.356c4.019,15.385,14.183,28.212,29.404,37.067c13.548,7.894,29.875,11.933,47.115,11.933 c9.962,0,20.231-1.356,30.452-4.087c42.74-11.413,72.411-44.346,72.804-77.654h0.004v-0.065c0.003-0.236,0.001-0.469,0-0.704V0 L163.205,76.413z M104.999,471.779c-22.543,6.038-45.942,3.846-62.572-5.846c-10.587-6.163-17.591-14.817-20.255-25.038 c-7.144-27.375,18.452-58.029,57.062-68.346c8.409-2.25,16.938-3.346,25.188-3.346c13.87,0,26.962,3.115,37.389,9.192 c10.587,6.163,17.591,14.817,20.255,25.029c0.809,3.102,1.142,6.248,1.139,9.4v0.321h0.014 C162.99,437.714,139.082,462.678,104.999,471.779z M182.898,166.853V92.067l290.971-67.298v74.784L182.898,166.853z M415.677,399.923c-22.558,6.038-45.942,3.837-62.587-5.846c-10.587-6.163-17.587-14.817-20.25-25.019 c-7.144-27.385,18.452-58.058,57.058-68.365c8.414-2.25,16.942-3.346,25.192-3.346c13.875,0,26.962,3.115,37.385,9.192 c10.596,6.163,17.596,14.817,20.26,25.029v0.01c0.796,3.05,1.124,6.144,1.135,9.244v0.468h0.02 C473.668,365.851,449.763,390.814,415.677,399.923z">
        </path>
      </g>
    </g>
  </g>
</svg>`,T_=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 5.9266752 5.6408391" height="21.31971" width="22.4">
  <g>
    <path d="m 5.2564627,1.548212 c -3.1136005,-0.4796804 -1.5568006,-0.2398402 0,0 z M 2.0001198,2.0922063 c 0.1556781,0 0.2657489,0.020893 0.3917849,0.080366 0.081154,0.038347 0.1153492,0.134065 0.076377,0.2138602 -0.038973,0.07979 -0.1363527,0.1134129 -0.2175069,0.075091 -0.078199,-0.036919 -0.1407455,-0.048792 -0.250655,-0.048792 -0.2260486,0 -0.3921482,0.2042182 -0.3921482,0.4801409 0,0.2761822 0.1663188,0.4810688 0.3921482,0.4810688 0.1117901,0 0.2064255,-0.046133 0.255659,-0.1284198 l 0.00162,-0.00389 V 3.0534032 l -0.098011,1.75e-4 c -0.081844,0 -0.1495979,-0.059305 -0.1612403,-0.1365887 l -0.00175,-0.023683 c 0,-0.08047 0.060311,-0.1470874 0.1389194,-0.1585331 l 0.024085,-0.00195 h 0.2612303 c 0.081842,0 0.149598,0.059305 0.1612404,0.1365891 l 0.00175,0.023683 -3.398e-4,0.3968809 v 0 l -0.00168,0.014211 v 0 l -0.00553,0.023034 v 0 l -0.00532,0.014145 c -0.098178,0.22826 -0.3236506,0.3528713 -0.5706303,0.3528713 -0.4240855,0 -0.7181621,-0.3622714 -0.7181621,-0.8016063 0,-0.4391857 0.2940275,-0.8006848 0.7181621,-0.8006848 z m 1.2034759,0.031275 c 0.081843,0 0.1495977,0.059305 0.1612403,0.1365891 l 0.00175,0.023683 v 1.2211775 c 0,0.088516 -0.07298,0.1602721 -0.1630073,0.1602721 -0.081841,0 -0.1495972,-0.059305 -0.1612397,-0.1365892 L 3.040589,3.5049308 V 2.2837527 c 0,-0.088516 0.07298,-0.1602721 0.1630067,-0.1602714 z m 0.7813442,0 0.5209469,0.00195 c 0.090025,3.048e-4 0.1627543,0.072306 0.1624458,0.1608234 -2.809e-4,0.08047 -0.06083,0.1468798 -0.1394772,0.158066 l -0.024092,0.00195 -0.3575326,-0.0013 v 0.4497782 l 0.2928918,2.27e-4 c 0.081842,0 0.1495979,0.059305 0.1612403,0.136589 l 0.00175,0.023683 c 0,0.080469 -0.06031,0.1470871 -0.1389193,0.1585393 l -0.024092,0.00195 -0.2928919,-2.336e-4 1.563e-4,0.2860316 c 0,0.080471 -0.06031,0.1470873 -0.1389193,0.1585395 l -0.024085,0.00195 c -0.081843,0 -0.1495979,-0.059305 -0.1612403,-0.1365826 l -0.00175,-0.023691 V 2.2841354 c 2.798e-4,-0.08047 0.060829,-0.1468797 0.1394758,-0.1580594 z"/>
    <path d="m 5.0894191,1.0943261 c 0,-0.21918999 -0.177687,-0.39686999 -0.396876,-0.39686999 h -3.43959 c -0.2191879,0 -0.391262,0.1777519 -0.3968759,0.39686999 l -0.027082,3.4379266 c 0.040152,0.2939927 0.4235456,0.409415 0.4235456,0.409415 l 3.4785583,-0.00851 c 0,0 0.3008506,-0.1402998 0.3236271,-0.4201576 0.042911,-0.5272495 0.034693,-1.6106146 0.034693,-3.4186761 z m -4.49792494,0 c 0,-0.36530999 0.29614504,-0.66145999 0.66145894,-0.66145999 h 3.43959 c 0.365314,0 0.66146,0.29615 0.66146,0.66145999 v 3.43959 c 0,0.36532 -0.296146,0.66146 -0.66146,0.66146 h -3.43959 c -0.3653139,0 -0.66145894,-0.29614 -0.66145894,-0.66146 z"/>
  </g>
</svg>
`,A_={images:{id:"upload-images-icon",svgString:w_,dropupText:"Image"},gifs:{id:"upload-gifs-icon",svgString:T_,dropupText:"GIF"},audio:{id:"upload-audio-icon",svgString:C_,dropupText:"Audio"},mixedFiles:{id:"upload-mixed-files-icon",svgString:E_,dropupText:"File"}},Ep=function(e){function r(t){var n;T(this,r),t?.position==="dropup-menu"&&(t.position="outside-right");var i=bn.tryCreateConfig("Microphone",t?.tooltip);return n=le(this,r,[r.createMicrophoneElement(),pp,t?.position,i,t]),n.isActive=!1,n._innerElements=n.createInnerElementsForStates(n.customStyles),n.changeToDefault(),n}return ue(r,e),A(r,[{key:"createInnerElementsForStates",value:function(n){var i="microphone-icon";return{default:this.createInnerElements(i,"default",n),active:this.createInnerElements(i,"active",n),unsupported:this.createInnerElements(i,"unsupported",n),commandMode:this.createInnerElements(i,"commandMode",n)}}},{key:"changeToActive",value:function(){this.changeElementsByState(this._innerElements.active),this.toggleIconFilter("active"),this.reapplyStateStyle("active",["default","commandMode"]),this.isActive=!0}},{key:"changeToDefault",value:function(){this.changeElementsByState(this._innerElements.default),this.toggleIconFilter("default"),this.reapplyStateStyle("default",["active","commandMode"]),this.isActive=!1}},{key:"changeToCommandMode",value:function(){this.changeElementsByState(this._innerElements.commandMode),this.toggleIconFilter("command"),this.reapplyStateStyle("commandMode",["active"])}},{key:"changeToUnsupported",value:function(){this.changeElementsByState(this._innerElements.unsupported),this.elementRef.classList.add("unsupported-microphone"),this.reapplyStateStyle("unsupported",["active"])}},{key:"toggleIconFilter",value:function(n){var i=this.elementRef.children[0];if(i.tagName.toLocaleLowerCase()==="svg")switch(n){case"default":i.classList.remove("active-microphone-icon","command-microphone-icon"),i.classList.add("default-microphone-icon");break;case"active":i.classList.remove("default-microphone-icon","command-microphone-icon"),i.classList.add("active-microphone-icon");break;case"command":i.classList.remove("active-microphone-icon","default-microphone-icon"),i.classList.add("command-microphone-icon");break}}}],[{key:"createMicrophoneElement",value:function(){var n=document.createElement("div");return n.id="microphone-button",n.classList.add("input-button"),n}}])}(mr);function M_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ds={},Ur={},Hr={},zr={},Wr={},id;function _a(){if(id)return Wr;id=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.Text=void 0;var e=function(){function r(){T(this,r)}return A(r,null,[{key:"capitalize",value:function(n){return n.replace(r.FIRST_CHAR_REGEX,function(i){return i.toUpperCase()})}},{key:"lineBreak",value:function(n){return n.replace(r.DOUBLE_LINE,"<p></p>").replace(r.ONE_LINE,"<br>")}},{key:"isCharDefined",value:function(n){return n!==void 0&&n!==" "&&n!==" "&&n!==`
`&&n!==""}},{key:"breakupIntoWordsArr",value:function(n){return n.split(/(\W+)/)}}])}();return Wr.Text=e,e.FIRST_CHAR_REGEX=/\S/,e.DOUBLE_LINE=/\n\n/g,e.ONE_LINE=/\n/g,Wr}var sd;function wp(){if(sd)return zr;sd=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.Translate=void 0;var e=_a(),r=function(){function t(){T(this,t)}return A(t,null,[{key:"translate",value:function(i,s){for(var a=e.Text.breakupIntoWordsArr(i),o=0;o<a.length;o+=1)s[a[o]]&&(a[o]=s[a[o]]);return a.join("")}}])}();return zr.Translate=r,zr}var ad;function x_(){if(ad)return Hr;ad=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.WebSpeechTranscript=void 0;var e=wp(),r=function(){function t(){T(this,t)}return A(t,null,[{key:"extract",value:function(i,s,a){for(var o="",l=i.resultIndex;l<i.results.length;++l){var u=i.results[l][0].transcript;a&&(u=e.Translate.translate(u,a)),i.results[l].isFinal?s+=u:o+=u}return{interimTranscript:o,finalTranscript:s,newText:o||s}}},{key:"extractSafari",value:function(i,s,a){for(var o="",l="",u=i.resultIndex;u<i.results.length;++u){var c=i.results[u][0].transcript;a&&(c=e.Translate.translate(c,a)),o+=c}return{interimTranscript:l,finalTranscript:o,newText:l||o}}}])}();return Hr.WebSpeechTranscript=r,Hr}var Vr={},od;function cu(){if(od)return Vr;od=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.Browser=void 0;var e=A(function r(){T(this,r)});return Vr.Browser=e,e.IS_SAFARI=function(){return e._IS_SAFARI===void 0&&(e._IS_SAFARI=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),e._IS_SAFARI},Vr}var qr={},Gr={},ld;function I_(){if(ld)return Gr;ld=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.EventListeners=void 0;var e=function(){function r(){T(this,r)}return A(r,null,[{key:"getElementIfFocusedOnAvailable",value:function(n,i){return Array.isArray(n)?n.find(function(s){return i===s}):i===n?n:void 0}},{key:"keyDownWindow",value:function(n){var i=this;n.element&&r.getElementIfFocusedOnAvailable(n.element,document.activeElement)&&(r.KEY_DOWN_TIMEOUT!==null&&clearTimeout(r.KEY_DOWN_TIMEOUT),r.KEY_DOWN_TIMEOUT=setTimeout(function(){r.KEY_DOWN_TIMEOUT=null,i.resetRecording(n)},500))}},{key:"mouseDownWindow",value:function(n,i){this.mouseDownElement=r.getElementIfFocusedOnAvailable(n,i.target)}},{key:"mouseUpWindow",value:function(n){this.mouseDownElement&&this.resetRecording(n),this.mouseDownElement=void 0}},{key:"add",value:function(n,i){var s=i?.insertInCursorLocation===void 0||i?.insertInCursorLocation;i!=null&&i.element&&s&&(n.mouseDownEvent=r.mouseDownWindow.bind(n,i.element),document.addEventListener("mousedown",n.mouseDownEvent),n.mouseUpEvent=r.mouseUpWindow.bind(n,i),document.addEventListener("mouseup",n.mouseUpEvent),n.keyDownEvent=r.keyDownWindow.bind(n,i),document.addEventListener("keydown",n.keyDownEvent))}},{key:"remove",value:function(n){document.removeEventListener("mousedown",n.mouseDownEvent),document.removeEventListener("mouseup",n.mouseUpEvent),document.removeEventListener("keydown",n.keyDownEvent)}}])}();return Gr.EventListeners=e,e.KEY_DOWN_TIMEOUT=null,Gr}var Kr={},ud;function L_(){if(ud)return Kr;ud=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.PreResultUtils=void 0;var e=function(){function r(){T(this,r)}return A(r,null,[{key:"process",value:function(n,i,s,a,o){var l=a?.(i,s);return l?(setTimeout(function(){l.restart?n.resetRecording(o):l.stop&&n.stop()}),(l.stop||l.restart)&&l.removeNewText):!1}}])}();return Kr.PreResultUtils=e,Kr}var Jr={},Xr={},cd;function Cp(){if(cd)return Xr;cd=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.AutoScroll=void 0;var e=function(){function r(){T(this,r)}return A(r,null,[{key:"changeStateIfNeeded",value:function(n,i){i&&!n.isCursorAtEnd&&(n.endPadding="",n.scrollingSpan.innerHTML="&nbsp;")}},{key:"scrollGeneric",value:function(n,i){n.isCursorAtEnd?i.scrollTop=i.scrollHeight:n.scrollingSpan.scrollIntoView({block:"nearest"})}},{key:"scrollSafariPrimitiveToEnd",value:function(n){n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight}},{key:"isElementOverflown",value:function(n){return n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth}},{key:"isRequired",value:function(n,i){return n&&r.isElementOverflown(i)}}])}();return Xr.AutoScroll=e,Xr}var Yr={},dd;function Ea(){if(dd)return Yr;dd=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.Elements=void 0;var e=function(){function r(){T(this,r)}return A(r,null,[{key:"isPrimitiveElement",value:function(n){return n.tagName==="INPUT"||n.tagName==="TEXTAREA"}},{key:"createInterimSpan",value:function(){var n=document.createElement("span");return n.style.color="grey",n.style.pointerEvents="none",n}},{key:"createGenericSpan",value:function(){var n=document.createElement("span");return n.style.pointerEvents="none",n}},{key:"appendSpans",value:function(n,i){if(n.spansPopulated=!0,n.insertInCursorLocation&&document.activeElement===i){var s=window.getSelection();if(s!=null&&s.focusNode){var a=s.getRangeAt(0);a.insertNode(n.scrollingSpan),a.insertNode(n.interimSpan),a.insertNode(n.finalSpan),a.collapse(!1),s.removeAllRanges(),s.addRange(a);return}}i.appendChild(n.finalSpan),i.appendChild(n.interimSpan),i.appendChild(n.scrollingSpan)}},{key:"applyCustomColors",value:function(n,i){i.interim&&(n.interimSpan.style.color=i.interim),i.final&&(n.finalSpan.style.color=i.final)}},{key:"isInsideShadowDOM",value:function(n){return n.getRootNode()instanceof ShadowRoot}}])}();return Yr.Elements=e,Yr}var Zr={},fd;function wa(){if(fd)return Zr;fd=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.Cursor=void 0;var e=function(){function r(){T(this,r)}return A(r,null,[{key:"setOffsetForGeneric",value:function(n,i){for(var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=0,o=0;o<n.childNodes.length;o+=1){var l=n.childNodes[o];if(l.childNodes.length>0){var u=r.setOffsetForGeneric(l,i,s);if(u===-1)return-1;s+=u}else if(l.textContent!==null){if(s+l.textContent.length>i){var c=document.createRange();c.setStart(l,i-s),c.collapse(!0);var d=window.getSelection();return d?.removeAllRanges(),d?.addRange(c),n.focus(),-1}s+=l.textContent.length,a+=l.textContent.length}}return a}},{key:"focusEndOfGeneric",value:function(n){var i=document.createRange();i.selectNodeContents(n),i.collapse(!1);var s=window.getSelection();s&&(s.removeAllRanges(),s.addRange(i))}},{key:"setOffsetForSafariGeneric",value:function(n,i){var s=window.getSelection();if(s){var a=r.getGenericElementCursorOffset(n,s,!0);r.setOffsetForGeneric(n,a+i)}}},{key:"setOffsetForPrimitive",value:function(n,i,s){s&&n.blur(),n.setSelectionRange(i,i),n.focus()}},{key:"getGenericElementCursorOffset",value:function(n,i,s){var a=0;if(i.rangeCount>0){var o=i.getRangeAt(0),l=o.cloneRange();l.selectNodeContents(n),s?l.setEnd(o.startContainer,o.startOffset):l.setEnd(o.endContainer,o.endOffset),a=l.toString().length}return a}}])}();return Zr.Cursor=e,Zr}var hd;function Tp(){if(hd)return Jr;hd=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.CommandUtils=void 0;var e=Cp(),r=Ea(),t=cu(),n=wa(),i=_a(),s=function(){function a(){T(this,a)}return A(a,null,[{key:"processCommand",value:function(l,u){return(!u||!u.caseSensitive)&&(l=l.toLowerCase()),u?.substrings===!1?i.Text.breakupIntoWordsArr(l):l}},{key:"process",value:function(l){var u;return((u=l.settings)===null||u===void 0?void 0:u.caseSensitive)===!0?l:Object.keys(l).reduce(function(c,d){var f=l[d];return c[d]=typeof f=="string"?a.processCommand(f,l.settings):f,c},{})}},{key:"toggleCommandModeOn",value:function(l){var u;l.isWaitingForCommand=!0,(u=l.onCommandModeTrigger)===null||u===void 0||u.call(l,!0)}},{key:"toggleCommandModeOff",value:function(l){var u;l.isWaitingForCommand&&((u=l.onCommandModeTrigger)===null||u===void 0||u.call(l,!1),l.isWaitingForCommand=!1)}},{key:"setText",value:function(l,u,c,d){a.toggleCommandModeOff(l),r.Elements.isPrimitiveElement(d)?(d.value=c,l.isTargetInShadow||n.Cursor.setOffsetForPrimitive(d,c.length,!0),t.Browser.IS_SAFARI()&&l.autoScroll&&e.AutoScroll.scrollSafariPrimitiveToEnd(d)):(d.textContent=c,l.isTargetInShadow||n.Cursor.focusEndOfGeneric(d),setTimeout(function(){return e.AutoScroll.scrollGeneric(l,d)})),l.resetRecording(u)}},{key:"checkIfMatchesSubstring",value:function(l,u){return u.includes(l)}},{key:"checkIfMatchesWord",value:function(l,u,c){for(var d=l,f=c.length-1;f>=0;f-=1){for(var h=f,p=d.length-1;c[h]===d[p]&&p>=0;)h-=1,p-=1;if(p<0)return!0}return!1}},{key:"execCommand",value:function(l,u,c,d,f){var h,p,m,v=l.commands;if(!(!v||!d||!c)){var y=((h=v.settings)===null||h===void 0?void 0:h.caseSensitive)===!0?u:u.toLowerCase(),b=i.Text.breakupIntoWordsArr(y),M=((p=v.settings)===null||p===void 0?void 0:p.substrings)===!1?a.checkIfMatchesWord:a.checkIfMatchesSubstring;if(v.commandMode&&M(v.commandMode,y,b))return l.setInterimColorToFinal(),setTimeout(function(){return a.toggleCommandModeOn(l)}),{doNotProcessTranscription:!1};if(!(v.commandMode&&!l.isWaitingForCommand)){if(v.stop&&M(v.stop,y,b))return a.toggleCommandModeOff(l),setTimeout(function(){return l.stop()}),{doNotProcessTranscription:!1};if(v.pause&&M(v.pause,y,b))return a.toggleCommandModeOff(l),l.setInterimColorToFinal(),setTimeout(function(){var _;l.isPaused=!0,(_=l.onPauseTrigger)===null||_===void 0||_.call(l,!0)}),{doNotProcessTranscription:!1};if(v.resume&&M(v.resume,y,b))return l.isPaused=!1,(m=l.onPauseTrigger)===null||m===void 0||m.call(l,!1),a.toggleCommandModeOff(l),l.resetRecording(c),{doNotProcessTranscription:!0};if(v.reset&&M(v.reset,y,b))return f!==void 0&&a.setText(l,c,f,d),{doNotProcessTranscription:!0};if(v.removeAllText&&M(v.removeAllText,y,b))return a.setText(l,c,"",d),{doNotProcessTranscription:!0}}}}}])}();return Jr.CommandUtils=s,Jr}var Qr={},pd;function O_(){if(pd)return Qr;pd=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.Highlight=void 0;var e=Ea(),r=wa(),t=function(){function n(){T(this,n)}return A(n,null,[{key:"setStateForPrimitive",value:function(s,a){var o,l;a.selectionStart!==null&&(o=a.selectionStart),a.selectionEnd!==null&&(l=a.selectionEnd),s.isHighlighted=o!==l}},{key:"setStateForGeneric",value:function(s,a){var o=window.getSelection();if(o!=null&&o.focusNode){var l=r.Cursor.getGenericElementCursorOffset(a,o,!0),u=r.Cursor.getGenericElementCursorOffset(a,o,!1);s.isHighlighted=l!==u}}},{key:"setState",value:function(s,a){document.activeElement===a&&(e.Elements.isPrimitiveElement(a)?n.setStateForPrimitive(s,a):n.setStateForGeneric(s,a))}},{key:"removeForGeneric",value:function(s,a){var o=window.getSelection();if(o){var l=r.Cursor.getGenericElementCursorOffset(a,o,!0);o.deleteFromDocument(),r.Cursor.setOffsetForGeneric(a,l),s.isHighlighted=!1}}},{key:"removeForPrimitive",value:function(s,a){var o=a.selectionStart,l=a.selectionEnd,u=a.value;if(o&&l){var c=u.substring(0,o)+u.substring(l);a.value=c,r.Cursor.setOffsetForPrimitive(a,o,s.autoScroll)}s.isHighlighted=!1}}])}();return Qr.Highlight=t,Qr}var ei={},md;function R_(){if(md)return ei;md=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.Padding=void 0;var e=Ea(),r=wa(),t=_a(),n=function(){function i(){T(this,i)}return A(i,null,[{key:"setStateForPrimitiveElement",value:function(a,o){if(document.activeElement===o&&o.selectionStart!==null){var l=o.selectionStart,u=o.value[l-1],c=o.selectionEnd===null?l:o.selectionEnd,d=o.value[c];t.Text.isCharDefined(u)&&(a.startPadding=" ",a.numberOfSpacesBeforeNewText=1),t.Text.isCharDefined(d)&&(a.endPadding=" ",a.numberOfSpacesAfterNewText=1),a.isCursorAtEnd=o.value.length===c;return}var f=o.value[o.value.length-1];t.Text.isCharDefined(f)&&(a.startPadding=" ",a.numberOfSpacesBeforeNewText=1),a.isCursorAtEnd=!0}},{key:"setStateForGenericElement",value:function(a,o){var l,u,c;if(document.activeElement===o){var d=window.getSelection();if(d!=null&&d.focusNode){var f=r.Cursor.getGenericElementCursorOffset(o,d,!0),h=(l=o.textContent)===null||l===void 0?void 0:l[f-1],p=r.Cursor.getGenericElementCursorOffset(o,d,!1),m=(u=o.textContent)===null||u===void 0?void 0:u[p];t.Text.isCharDefined(h)&&(a.startPadding=" "),t.Text.isCharDefined(m)&&(a.endPadding=" "),a.isCursorAtEnd=((c=o.textContent)===null||c===void 0?void 0:c.length)===p;return}}var v=o.innerText.charAt(o.innerText.length-1);t.Text.isCharDefined(v)&&(a.startPadding=" "),a.isCursorAtEnd=!0}},{key:"setState",value:function(a,o){e.Elements.isPrimitiveElement(o)?i.setStateForPrimitiveElement(a,o):i.setStateForGenericElement(a,o)}},{key:"adjustStateAfterRecodingPrimitiveElement",value:function(a,o){if(a.primitiveTextRecorded=!0,a.insertInCursorLocation&&document.activeElement===o&&(o.selectionEnd!==null&&(a.endPadding=a.endPadding+o.value.slice(o.selectionEnd)),o.selectionStart!==null)){a.startPadding=o.value.slice(0,o.selectionStart)+a.startPadding;return}a.startPadding=o.value+a.startPadding}},{key:"adjustSateForNoTextPrimitiveElement",value:function(a){a.numberOfSpacesBeforeNewText===1&&(a.startPadding=a.startPadding.substring(0,a.startPadding.length-1),a.numberOfSpacesBeforeNewText=0),a.numberOfSpacesAfterNewText===1&&(a.endPadding=a.endPadding.substring(1),a.numberOfSpacesAfterNewText=0)}}])}();return ei.Padding=n,ei}var vd;function Ap(){if(vd)return qr;vd=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.Speech=void 0;var e=I_(),r=L_(),t=Tp(),n=Cp(),i=O_(),s=Ea(),a=R_(),o=cu(),l=wa(),u=_a(),c=function(){function d(){T(this,d),this.finalTranscript="",this.interimSpan=s.Elements.createInterimSpan(),this.finalSpan=s.Elements.createGenericSpan(),this.scrollingSpan=s.Elements.createGenericSpan(),this.isCursorAtEnd=!1,this.spansPopulated=!1,this.startPadding="",this.endPadding="",this.numberOfSpacesBeforeNewText=0,this.numberOfSpacesAfterNewText=0,this.isHighlighted=!1,this.primitiveTextRecorded=!1,this.recognizing=!1,this._displayInterimResults=!0,this.insertInCursorLocation=!0,this.autoScroll=!0,this.isRestarting=!1,this.isPaused=!1,this.isWaitingForCommand=!1,this.isTargetInShadow=!1,this.cannotBeStopped=!1,this.resetState()}return A(d,[{key:"prepareBeforeStart",value:function(h){var p,m;if(h!=null&&h.element)if(e.EventListeners.add(this,h),Array.isArray(h.element)){var v=h.element.find(function(y){return y===document.activeElement})||h.element[0];if(!v)return;this.prepare(v)}else this.prepare(h.element);h?.displayInterimResults!==void 0&&(this._displayInterimResults=h.displayInterimResults),h!=null&&h.textColor&&(this._finalTextColor=(p=h?.textColor)===null||p===void 0?void 0:p.final,s.Elements.applyCustomColors(this,h.textColor)),h?.insertInCursorLocation!==void 0&&(this.insertInCursorLocation=h.insertInCursorLocation),h?.autoScroll!==void 0&&(this.autoScroll=h.autoScroll),this._onResult=h?.onResult,this._onPreResult=h?.onPreResult,this._onStart=h?.onStart,this._onStop=h?.onStop,this._onError=h?.onError,this.onCommandModeTrigger=h?.onCommandModeTrigger,this.onPauseTrigger=h?.onPauseTrigger,this._options=h,!((m=this._options)===null||m===void 0)&&m.commands&&(this.commands=t.CommandUtils.process(this._options.commands))}},{key:"prepare",value:function(h){a.Padding.setState(this,h),i.Highlight.setState(this,h),this.isTargetInShadow=s.Elements.isInsideShadowDOM(h),s.Elements.isPrimitiveElement(h)?(this._primitiveElement=h,this._originalText=this._primitiveElement.value):(this._genericElement=h,this._originalText=this._genericElement.textContent)}},{key:"resetRecording",value:function(h){this.isRestarting=!0,this.stop(!0),this.resetState(!0),this.start(h,!0)}},{key:"updateElements",value:function(h,p,m){var v,y=u.Text.capitalize(p);if(!(this.finalTranscript===y&&h==="")){r.PreResultUtils.process(this,m,h==="",this._onPreResult,this._options)&&(h="",m="");var b=this.commands&&t.CommandUtils.execCommand(this,m,this._options,this._primitiveElement||this._genericElement,this._originalText);if(b){if(b.doNotProcessTranscription)return;h="",m=""}if(!(this.isPaused||this.isWaitingForCommand)){(v=this._onResult)===null||v===void 0||v.call(this,m,h===""),this.finalTranscript=y,this._displayInterimResults||(h="");var M=this.finalTranscript===""&&h==="";this._primitiveElement?this.updatePrimitiveElement(this._primitiveElement,h,M):this._genericElement&&this.updateGenericElement(this._genericElement,h,M)}}}},{key:"updatePrimitiveElement",value:function(h,p,m){this.isHighlighted&&i.Highlight.removeForPrimitive(this,h),this.primitiveTextRecorded||a.Padding.adjustStateAfterRecodingPrimitiveElement(this,h),m&&a.Padding.adjustSateForNoTextPrimitiveElement(this);var v=this.startPadding+this.finalTranscript+p;if(h.value=v+this.endPadding,!this.isTargetInShadow){var y=v.length+this.numberOfSpacesAfterNewText;l.Cursor.setOffsetForPrimitive(h,y,this.autoScroll)}this.autoScroll&&o.Browser.IS_SAFARI()&&this.isCursorAtEnd&&n.AutoScroll.scrollSafariPrimitiveToEnd(h)}},{key:"updateGenericElement",value:function(h,p,m){this.isHighlighted&&i.Highlight.removeForGeneric(this,h),this.spansPopulated||s.Elements.appendSpans(this,h);var v=(m?"":this.startPadding)+u.Text.lineBreak(this.finalTranscript);this.finalSpan.innerHTML=v;var y=n.AutoScroll.isRequired(this.autoScroll,h);n.AutoScroll.changeStateIfNeeded(this,y);var b=u.Text.lineBreak(p)+(m?"":this.endPadding);this.interimSpan.innerHTML=b,o.Browser.IS_SAFARI()&&this.insertInCursorLocation&&l.Cursor.setOffsetForSafariGeneric(h,v.length+b.length),y&&n.AutoScroll.scrollGeneric(this,h),m&&(this.scrollingSpan.innerHTML="")}},{key:"finalise",value:function(h){this._genericElement&&(h?(this.finalSpan=s.Elements.createGenericSpan(),this.setInterimColorToFinal(),this.interimSpan=s.Elements.createInterimSpan(),this.scrollingSpan=s.Elements.createGenericSpan()):this._genericElement.textContent=this._genericElement.textContent,this.spansPopulated=!1),e.EventListeners.remove(this)}},{key:"setInterimColorToFinal",value:function(){this.interimSpan.style.color=this._finalTextColor||"black"}},{key:"resetState",value:function(h){this._primitiveElement=void 0,this._genericElement=void 0,this.finalTranscript="",this.finalSpan.innerHTML="",this.interimSpan.innerHTML="",this.scrollingSpan.innerHTML="",this.startPadding="",this.endPadding="",this.isHighlighted=!1,this.primitiveTextRecorded=!1,this.numberOfSpacesBeforeNewText=0,this.numberOfSpacesAfterNewText=0,h||(this.stopTimeout=void 0)}},{key:"setStateOnStart",value:function(){var h;this.recognizing=!0,this.isRestarting?this.isRestarting=!1:(h=this._onStart)===null||h===void 0||h.call(this)}},{key:"setStateOnStop",value:function(){var h;this.recognizing=!1,this.isRestarting||(h=this._onStop)===null||h===void 0||h.call(this)}},{key:"setStateOnError",value:function(h){var p;(p=this._onError)===null||p===void 0||p.call(this,h),this.recognizing=!1}}])}();return qr.Speech=c,qr}var gd;function P_(){if(gd)return Ur;gd=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.WebSpeech=void 0;var e=x_(),r=cu(),t=Ap(),n=function(i){function s(){return T(this,s),le(this,s)}return ue(s,i),A(s,[{key:"start",value:function(o){var l;this._extractText===void 0&&(this._extractText=r.Browser.IS_SAFARI()?e.WebSpeechTranscript.extractSafari:e.WebSpeechTranscript.extract),this.validate()&&(this.prepareBeforeStart(o),this.instantiateService(o),(l=this._service)===null||l===void 0||l.start(),this._translations=o?.translations)}},{key:"validate",value:function(){return s.getAPI()?!0:(this.error("Speech Recognition is unsupported"),!1)}},{key:"instantiateService",value:function(o){var l,u,c=s.getAPI();this._service=new c,this._service.continuous=!0,this._service.interimResults=(l=o?.displayInterimResults)!==null&&l!==void 0?l:!0,this._service.lang=((u=o?.language)===null||u===void 0?void 0:u.trim())||"en-US",this.setEvents()}},{key:"setEvents",value:function(){var o=this;this._service&&(this._service.onstart=function(){o.setStateOnStart()},this._service.onerror=function(l){r.Browser.IS_SAFARI()&&l.message==="Another request is started"||l.error==="aborted"&&o.isRestarting||l.error!=="no-speech"&&o.error(l.message||l.error)},this._service.onaudioend=function(){o.setStateOnStop()},this._service.onend=function(){o._stopping=!1},this._service.onresult=function(l){if(Q(l.results)>"u"&&o._service)o._service.onend=null,o._service.stop();else if(o._extractText&&!o._stopping){var u=o._extractText(l,o.finalTranscript,o._translations),c=u.interimTranscript,d=u.finalTranscript,f=u.newText;o.updateElements(c,d,f)}})}},{key:"stop",value:function(o){var l;this._stopping=!0,(l=this._service)===null||l===void 0||l.stop(),this.finalise(o)}},{key:"error",value:function(o){console.error(o),this.setStateOnError(o),this.stop()}}],[{key:"getAPI",value:function(){return window.webkitSpeechRecognition||window.SpeechRecognition}}])}(t.Speech);return Ur.WebSpeech=n,Ur}var ti={},yd;function N_(){if(yd)return ti;yd=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.GlobalState=void 0;var e=function(){function r(){T(this,r)}return A(r,null,[{key:"doubleClickDetector",value:function(){return r.doubleClickPending?!0:(r.doubleClickPending=!0,setTimeout(function(){r.doubleClickPending=!1},300),!1)}}])}();return ti.GlobalState=e,e.doubleClickPending=!1,ti}var ni={},ri={},bd;function B_(){if(bd)return ri;bd=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.PreventConnectionStop=void 0;var e=function(){function r(){T(this,r)}return A(r,null,[{key:"applyPrevention",value:function(n){clearTimeout(n._manualConnectionStopPrevention),n.cannotBeStopped=!0,n._manualConnectionStopPrevention=setTimeout(function(){n.cannotBeStopped=!1},800)}},{key:"clearPrevention",value:function(n){clearTimeout(n._manualConnectionStopPrevention),n.cannotBeStopped=!1}}])}();return ri.PreventConnectionStop=e,ri}var ii={},fs={},Sd;function F_(){return Sd||(Sd=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.README_URL=void 0,fs.README_URL="https://github.com/OvidijusParsiunas/speech-to-element"),fs}var kd;function D_(){if(kd)return ii;kd=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.AzureSpeechConfig=void 0;var e=F_(),r=function(){function t(){T(this,t)}return A(t,null,[{key:"validateOptions",value:function(i,s){return s?!s.subscriptionKey&&!s.token&&!s.retrieveToken?(i("Please define a 'subscriptionKey', 'token' or 'retrieveToken' property - more info: ".concat(e.README_URL)),!1):s.region?!0:(i("Please define a 'region' property - more info: ".concat(e.README_URL)),!1):(i("Please provide subscription details - more info: ".concat(e.README_URL)),!1)}},{key:"getNewSpeechConfig",value:function(){var n=O(g().mark(function s(a,o){return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!o.region){u.next=2;break}return u.abrupt("return",o.subscriptionKey?a.fromSubscription(o.subscriptionKey.trim(),o.region.trim()):o.token?a.fromAuthorizationToken(o.token.trim(),o.region.trim()):o.retrieveToken?o.retrieveToken().then(function(c){return o.region?a.fromAuthorizationToken(c?.trim()||"",o.region.trim()):null}).catch(function(c){return console.error(c),null}):null);case 2:case"end":return u.stop()}},s)}));function i(s,a){return n.apply(this,arguments)}return i}()},{key:"process",value:function(i,s){s.endpointId&&(i.endpointId=s.endpointId.trim()),s.language&&(i.speechRecognitionLanguage=s.language.trim())}},{key:"get",value:function(){var n=O(g().mark(function s(a,o){var l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.getNewSpeechConfig(a,o);case 2:return l=c.sent,c.abrupt("return",(l&&t.process(l,o),l));case 4:case"end":return c.stop()}},s)}));function i(s,a){return n.apply(this,arguments)}return i}()}])}();return ii.AzureSpeechConfig=r,ii}var si={},_d;function $_(){if(_d)return si;_d=1,Object.defineProperty(si,"__esModule",{value:!0}),si.StopTimeout=void 0;var e=function(){function r(){T(this,r)}return A(r,null,[{key:"set",value:function(n){n.stopTimeout=setTimeout(function(){return n.stop()},n.stopTimeoutMS)}},{key:"reset",value:function(n,i){n.stopTimeoutMS=i||r.DEFAULT_MS,r.stop(n),r.set(n)}},{key:"stop",value:function(n){n.stopTimeout&&clearTimeout(n.stopTimeout)}}])}();return si.StopTimeout=e,e.DEFAULT_MS=2e4,si}var ai={},Ed;function j_(){if(Ed)return ai;Ed=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.AzureAudioConfig=void 0;var e=function(){function r(){T(this,r)}return A(r,null,[{key:"get",value:function(n,i){return i?n.fromMicrophoneInput(i):n.fromDefaultMicrophoneInput()}}])}();return ai.AzureAudioConfig=e,ai}var oi={},wd;function U_(){if(wd)return oi;wd=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.AzureTranscript=void 0;var e=wp(),r=function(){function t(){T(this,t)}return A(t,null,[{key:"extract",value:function(i,s,a,o){return o&&(i=e.Translate.translate(i,o)),a?{interimTranscript:"",finalTranscript:s+i,newText:i}:{interimTranscript:i,finalTranscript:s,newText:i}}}])}();return oi.AzureTranscript=r,oi}var Cd;function H_(){if(Cd)return ni;Cd=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.Azure=void 0;var e=B_(),r=D_(),t=$_(),n=j_(),i=U_(),s=Ap(),a=function(o){function l(){var u;return T(this,l),u=le(this,l,arguments),u._newTextPadding="",u}return ue(l,o),A(l,[{key:"start",value:function(c,d){this._newTextPadding="",this.stopTimeout===void 0&&t.StopTimeout.reset(this,c?.stopAfterSilenceMs),this.prepareBeforeStart(c),this.startAsync(c),d||e.PreventConnectionStop.applyPrevention(this)}},{key:"startAsync",value:function(){var u=O(g().mark(function d(f){var h;return g().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(m.t0=this.validate(f),!m.t0){m.next=6;break}return m.next=4,this.instantiateService(f);case 4:this._translations=f?.translations,(h=this._service)===null||h===void 0||h.startContinuousRecognitionAsync(function(){},this.error);case 6:case"end":return m.stop()}},d,this)}));function c(d){return u.apply(this,arguments)}return c}()},{key:"validate",value:function(c){return l.getAPI()?r.AzureSpeechConfig.validateOptions(this.error.bind(this),c):(this.moduleNotFound(),!1)}},{key:"instantiateService",value:function(){var u=O(g().mark(function d(f){var h,p,m,v,y,b,M,_,E;return g().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return h=l.getAPI(),p=n.AzureAudioConfig.get(h.AudioConfig,f.deviceId),B.next=4,r.AzureSpeechConfig.get(h.SpeechConfig,f);case 4:m=B.sent,m?(f.autoLanguage&&f.autoLanguage.languages.length>0?(y=f.autoLanguage,b=y.type,M=y.languages,_=M.slice(0,b==="Continuous"?10:4),E=h.AutoDetectSourceLanguageConfig.fromLanguages(_),b==="Continuous"&&(E.mode=1),v=h.SpeechRecognizer.FromConfig(m,E,p)):v=new h.SpeechRecognizer(m,p),this.setEvents(v),this._service=v,f.retrieveToken&&this.retrieveTokenInterval(f.retrieveToken)):this.error("Unable to contact Azure server");case 6:case"end":return B.stop()}},d,this)}));function c(d){return u.apply(this,arguments)}return c}()},{key:"setEvents",value:function(c){c.recognizing=this.onRecognizing.bind(this),c.recognized=this.onRecognized.bind(this),c.sessionStarted=this.onSessionStarted.bind(this),c.canceled=this.onCanceled.bind(this),c.sessionStopped=this.onSessionStopped.bind(this)}},{key:"onRecognizing",value:function(c,d){if(!this._stopping){var f=i.AzureTranscript.extract(this._newTextPadding+d.result.text,this.finalTranscript,!1,this._translations),h=f.interimTranscript,p=f.finalTranscript,m=f.newText;t.StopTimeout.reset(this,this.stopTimeoutMS),this.updateElements(h,p,m)}}},{key:"onRecognized",value:function(c,d){var f=d.result;switch(f.reason){case window.SpeechSDK.ResultReason.Canceled:break;case window.SpeechSDK.ResultReason.RecognizedSpeech:if(f.text&&!this._stopping){var h=i.AzureTranscript.extract(this._newTextPadding+f.text,this.finalTranscript,!0,this._translations),p=h.interimTranscript,m=h.finalTranscript,v=h.newText;t.StopTimeout.reset(this,this.stopTimeoutMS),this.updateElements(p,m,v),m!==""&&(this._newTextPadding=" ")}break}}},{key:"onCanceled",value:function(c,d){d.reason===window.SpeechSDK.CancellationReason.Error&&this.error(d.errorDetails)}},{key:"onSessionStarted",value:function(){e.PreventConnectionStop.clearPrevention(this),this.setStateOnStart()}},{key:"onSessionStopped",value:function(){this._retrieveTokenInterval||clearInterval(this._retrieveTokenInterval),this._stopping=!1,this.setStateOnStop()}},{key:"retrieveTokenInterval",value:function(c){var d=this;this._retrieveTokenInterval=setInterval(function(){c?.().then(function(f){d._service&&(d._service.authorizationToken=f?.trim()||"")}).catch(function(f){d.error(f)})},1e4)}},{key:"stop",value:function(c){var d;!c&&this._retrieveTokenInterval&&clearInterval(this._retrieveTokenInterval),this._stopping=!0,(d=this._service)===null||d===void 0||d.stopContinuousRecognitionAsync(),t.StopTimeout.stop(this),this.finalise(c)}},{key:"moduleNotFound",value:function(){console.error("speech recognition module not found:"),console.error(`please install the 'microsoft-cognitiveservices-speech-sdk' npm package or add a script tag: <script src="https://aka.ms/csspeech/jsbrowserpackageraw"><\/script>`),this.setStateOnError("speech recognition module not found")}},{key:"error",value:function(c){this._retrieveTokenInterval&&clearInterval(this._retrieveTokenInterval),console.error(c),this.setStateOnError(c),this.stop()}}],[{key:"getAPI",value:function(){return window.SpeechSDK}}])}(s.Speech);return ni.Azure=a,ni}var Td;function z_(){if(Td)return ds;Td=1,Object.defineProperty(ds,"__esModule",{value:!0});var e=P_(),r=Tp(),t=N_(),n=H_(),i=function(){function s(){T(this,s)}return A(s,null,[{key:"toggle",value:function(o,l){var u,c,d=o.toLocaleLowerCase().trim();!((u=t.GlobalState.service)===null||u===void 0)&&u.recognizing?this.stop():d==="webspeech"?s.startWebSpeech(l):d==="azure"?s.startAzure(l):(console.error("service not found - must be either 'webspeech' or 'azure'"),(c=l?.onError)===null||c===void 0||c.call(l,"service not found - must be either 'webspeech' or 'azure'"))}},{key:"startWebSpeech",value:function(o){s.stop()||(t.GlobalState.service=new e.WebSpeech,t.GlobalState.service.start(o))}},{key:"isWebSpeechSupported",value:function(){return!!e.WebSpeech.getAPI()}},{key:"startAzure",value:function(o){var l;s.stop()||!((l=t.GlobalState.service)===null||l===void 0)&&l.cannotBeStopped||(t.GlobalState.service=new n.Azure,t.GlobalState.service.start(o))}},{key:"stop",value:function(){var o;return t.GlobalState.doubleClickDetector()?!0:(!((o=t.GlobalState.service)===null||o===void 0)&&o.recognizing&&t.GlobalState.service.stop(),!1)}},{key:"endCommandMode",value:function(){t.GlobalState.service&&r.CommandUtils.toggleCommandModeOff(t.GlobalState.service)}}])}();return ds.default=i,ds}var W_=z_(),Ls=M_(W_),V_=function(){function e(r,t){T(this,e),this._silenceMS=2e3,this._stop=!0,typeof t=="boolean"&&t===!1&&(this._stop=!1),typeof r=="number"&&(this._silenceMS=r)}return A(e,[{key:"setSilenceTimeout",value:function(t,n){var i=this;this._silenceTimeout=setTimeout(function(){var s;(s=t.submit)==null||s.call(t),Ls.stop(),i._stop||setTimeout(n,du.MICROPHONE_RESET_TIMEOUT_MS)},this._silenceMS)}},{key:"clearSilenceTimeout",value:function(){this._silenceTimeout&&clearTimeout(this._silenceTimeout)}},{key:"resetSilenceTimeout",value:function(t,n){this.clearSilenceTimeout(),this.setSilenceTimeout(t,n)}},{key:"onPause",value:function(t,n,i){t?this.resetSilenceTimeout(n,i):this.clearSilenceTimeout()}}])}(),Mp=function(e){function r(t,n,i){var s;T(this,r);var a=Q(t.speechToText)=="object"?t.speechToText:{};s=le(this,r,[a?.button]);var o=s.processConfiguration(n,t.speechToText),l=o.serviceName,u=o.processedConfig;if(s._addErrorMessage=i,l==="webspeech"&&!Ls.isWebSpeechSupported())s.changeToUnsupported();else{var c=!t.textInput||!t.textInput.disabled;s.elementRef.onclick=s.buttonClick.bind(s,n,c,l,u)}return setTimeout(function(){s._validationHandler=t._validationHandler}),s}return ue(r,e),A(r,[{key:"processConfiguration",value:function(n,i){var s,a,o,l,u,c,d=Q(i)=="object"?i:{},f=Q(d.webSpeech)=="object"?d.webSpeech:{},h=d.azure||{},p=ke(ke({displayInterimResults:(s=d.displayInterimResults)!==null&&s!==void 0?s:void 0,textColor:(a=d.textColor)!==null&&a!==void 0?a:void 0,translations:(o=d.translations)!==null&&o!==void 0?o:void 0,commands:(l=d.commands)!==null&&l!==void 0?l:void 0,events:(u=d.events)!==null&&u!==void 0?u:void 0},f),h),m=(c=d.commands)==null?void 0:c.submit;return m&&(p.onPreResult=function(v){return v.toLowerCase().includes(m)?(setTimeout(function(){var y;return(y=n.submit)==null?void 0:y.call(n)}),Ls.endCommandMode(),{restart:!0,removeNewText:!0}):null}),d.submitAfterSilence&&(this._silenceSubmit=new V_(d.submitAfterSilence,d.stopAfterSubmit)),{serviceName:r.getServiceName(d),processedConfig:p}}},{key:"buttonClick",value:function(n,i,s,a){var o=this,l=a?.events;n.removePlaceholderStyle(),Ls.toggle(s,ke({insertInCursorLocation:!1,element:i?n.inputElementRef:void 0,onError:function(){var c;o.onError(),(c=o._silenceSubmit)==null||c.clearSilenceTimeout()},onStart:function(){var c;o.changeToActive(),(c=l?.onStart)==null||c.call(l)},onStop:function(){var c,d,f;(c=o._validationHandler)==null||c.call(o),(d=o._silenceSubmit)==null||d.clearSilenceTimeout(),o.changeToDefault(),(f=l?.onStop)==null||f.call(l)},onPauseTrigger:function(c){var d,f;(d=o._silenceSubmit)==null||d.onPause(c,n,o.elementRef.onclick),(f=l?.onPauseTrigger)==null||f.call(l,c)},onPreResult:function(c,d){var f;(f=l?.onPreResult)==null||f.call(l,c,d)},onResult:function(c,d){var f,h,p;d&&((f=o._validationHandler)==null||f.call(o)),(h=o._silenceSubmit)==null||h.resetSilenceTimeout(n,o.elementRef.onclick),(p=l?.onResult)==null||p.call(l,c,d)},onCommandModeTrigger:function(c){var d;o.onCommandModeTrigger(c),(d=l?.onCommandModeTrigger)==null||d.call(l,c)}},a))}},{key:"onCommandModeTrigger",value:function(n){n?this.changeToCommandMode():this.changeToActive()}},{key:"onError",value:function(){this._addErrorMessage("speechToText","speech input error")}}],[{key:"getServiceName",value:function(n){return n.azure?"azure":"webspeech"}},{key:"toggleSpeechAfterSubmit",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;n.click(),i||setTimeout(function(){return n.click()},r.MICROPHONE_RESET_TIMEOUT_MS)}}])}(Ep);Mp.MICROPHONE_RESET_TIMEOUT_MS=300;var du=Mp,fu=function(){function e(r,t,n,i,s){var a=this;T(this,e),this._attachments=[],this._fileCountLimit=99,this._acceptedFormat="",this._hiddenAttachments=new Set,n.maxNumberOfFiles&&(this._fileCountLimit=n.maxNumberOfFiles),this._toggleContainerDisplay=i,this._fileAttachmentsContainerRef=s,n.acceptedFormats&&(this._acceptedFormat=n.acceptedFormats),setTimeout(function(){a._validationHandler=r._validationHandler,a._onInput=t.onInput})}return A(e,[{key:"attemptAddFile",value:function(t,n){var i;return e.isFileTypeValid(t,this._acceptedFormat)?(this.addAttachmentBasedOnType(t,n,!0),(i=this._onInput)==null||i.call(this,!0),!0):!1}},{key:"addAttachmentBasedOnType",value:function(t,n,i){var s=e.getTypeFromBlob(t);if(s==="image"){var a=e.createImageAttachment(n);this.addFileAttachment(t,"image",a,i)}else if(s==="audio"){var o=hl.createAudioAttachment(n);this.addFileAttachment(t,"audio",o,i)}else{var l=e.createAnyFileAttachment(t.name);this.addFileAttachment(t,"any",l,i)}}},{key:"addFileAttachment",value:function(t,n,i,s){var a,o=e.createContainer(i);if(this._attachments.length>=this._fileCountLimit){var l=this._attachments[this._attachments.length-1].removeButton;l?.click();var u=this._fileAttachmentsContainerRef.children;this._fileAttachmentsContainerRef.insertBefore(o,u[0])}else this._fileAttachmentsContainerRef.appendChild(o);var c={file:t,attachmentContainerElement:o,fileType:n};return s&&(c.removeButton=this.createRemoveAttachmentButton(c),o.appendChild(c.removeButton)),this._toggleContainerDisplay(!0),this._attachments.push(c),this._fileAttachmentsContainerRef.scrollTop=this._fileAttachmentsContainerRef.scrollHeight,(a=this._validationHandler)==null||a.call(this),c}},{key:"createRemoveAttachmentButton",value:function(t){var n=document.createElement("div");n.classList.add("remove-file-attachment-button"),n.onclick=this.removeAttachment.bind(this,t);var i=document.createElement("div");return i.classList.add("x-icon"),i.innerText="×",n.appendChild(i),n}},{key:"removeAttachment",value:function(t,n){var i,s;(i=this._onInput)==null||i.call(this,!!(n!=null&&n.isTrusted));var a=this._attachments.findIndex(function(l){return l===t}),o=this._attachments[a].attachmentContainerElement;this._attachments.splice(a,1),hl.stopAttachmentPlayback(o),o.remove(),this._toggleContainerDisplay(!1),(s=this._validationHandler)==null||s.call(this)}},{key:"getFiles",value:function(){return Array.from(this._attachments).map(function(t){return{file:t.file,type:t.fileType}})}},{key:"hideAttachments",value:function(){var t=this;this._hiddenAttachments.clear(),this._attachments.forEach(function(n){setTimeout(function(){var i;return(i=n.removeButton)==null?void 0:i.click()}),t._hiddenAttachments.add(n)})}},{key:"removeAttachments",value:function(){this._attachments.forEach(function(t){setTimeout(function(){var n;return(n=t.removeButton)==null?void 0:n.click()})}),this._hiddenAttachments.clear()}},{key:"readdAttachments",value:function(){var t=this,n;Array.from(this._hiddenAttachments).forEach(function(i){t._fileAttachmentsContainerRef.appendChild(i.attachmentContainerElement),t._attachments.push(i)}),(n=this._onInput)==null||n.call(this,!1),this._hiddenAttachments.clear()}}],[{key:"isFileTypeValid",value:function(t,n){if(n==="")return!0;for(var i=n.split(","),s=0;s<i.length;s++){var a=i[s].trim();if(t.type===a)return!0;if(a.startsWith(".")){var o=a.slice(1);if(t.name.endsWith(o))return!0}else if(t.name.endsWith(a)||a.endsWith("/*")&&t.type.startsWith(a.slice(0,-2)))return!0}return!1}},{key:"getTypeFromBlob",value:function(t){var n=t.type;return n.startsWith("image")?"image":n.startsWith("audio")?"audio":"any"}},{key:"createImageAttachment",value:function(t){var n=new Image;return n.src=t,n.classList.add("image-attachment"),n}},{key:"createAnyFileAttachment",value:function(t){var n=document.createElement("div");n.classList.add("border-bound-attachment"),rr.IS_SAFARI&&n.classList.add("border-bound-attachment-safari");var i=document.createElement("div");i.classList.add("any-file-attachment-text");var s=document.createElement("div");return s.classList.add("file-attachment-text-container"),s.appendChild(i),i.textContent=t,n.appendChild(s),n}},{key:"createContainer",value:function(t){var n=document.createElement("div");return n.classList.add("file-attachment"),n.appendChild(t),n}}])}(),xp=function(e){function r(t,n,i,s,a){return T(this,r),le(this,r,[t,n,i,s,a])}return ue(r,e),A(r,[{key:"createTimer",value:function(n,i){var s=this,a=0,o=i!==void 0&&i<r.TIMER_LIMIT_S?i:r.TIMER_LIMIT_S;return setInterval(function(){var l;a+=1,a===o&&((l=s.stopPlaceholderCallback)==null||l.call(s),s.clearTimer()),a===600&&n.classList.add("audio-placeholder-text-4-digits");var u=Math.floor(a/60),c=(a%60).toString().padStart(2,"0");n.textContent="".concat(u,":").concat(c)},1e3)}},{key:"createPlaceholderAudioAttachment",value:function(n){var i=r.createAudioContainer(),s=document.createElement("div");s.classList.add("audio-placeholder-text-3-digits");var a=document.createElement("div");a.classList.add("file-attachment-text-container","audio-placeholder-text-3-digits-container"),a.appendChild(s);var o=mn.createSVGElement(ll);return o.classList.add("attachment-icon","stop-icon","not-removable-attachment-icon"),s.textContent="0:00",this._activePlaceholderTimer=this.createTimer(s,n),i.appendChild(a),this.addPlaceholderAudioAttachmentEvents(i,o,a),i}},{key:"addPlaceholderAudioAttachmentEvents",value:function(n,i,s){var a=this,o=function(){return n.replaceChildren(i)};n.addEventListener("mouseenter",o);var l=function(){return n.replaceChildren(s)};n.addEventListener("mouseleave",l);var u=function(){var d;return(d=a.stopPlaceholderCallback)==null?void 0:d.call(a)};n.addEventListener("click",u)}},{key:"addPlaceholderAttachment",value:function(n,i){var s=this.createPlaceholderAudioAttachment(i);this._activePlaceholderAttachment=this.addFileAttachment(new File([],""),"audio",s,!1),this.stopPlaceholderCallback=n}},{key:"completePlaceholderAttachment",value:function(n,i){var s=this._activePlaceholderAttachment;s&&(s.file=n,r.addAudioElements(s.attachmentContainerElement.children[0],i),s.removeButton=this.createRemoveAttachmentButton(s),s.attachmentContainerElement.appendChild(s.removeButton),this._activePlaceholderAttachment=void 0,this.clearTimer())}},{key:"removePlaceholderAttachment",value:function(){this._activePlaceholderAttachment&&(this.removeAttachment(this._activePlaceholderAttachment),this._activePlaceholderAttachment=void 0,this.clearTimer())}},{key:"clearTimer",value:function(){this._activePlaceholderTimer!==void 0&&(clearInterval(this._activePlaceholderTimer),this._activePlaceholderTimer=void 0,this.stopPlaceholderCallback=void 0)}}],[{key:"createAudioContainer",value:function(){var n=document.createElement("div");return n.classList.add("border-bound-attachment","audio-attachment-icon-container"),rr.IS_SAFARI&&n.classList.add("border-bound-attachment-safari"),n}},{key:"addAudioElements",value:function(n,i){var s=n.parentElement?At.cloneElement(n):n,a=document.createElement("audio");a.src=i;var o=mn.createSVGElement(vp);o.classList.add("attachment-icon","play-icon");var l=mn.createSVGElement(ll);l.classList.add("attachment-icon","stop-icon"),s.replaceChildren(o),a.onplay=function(){s.replaceChildren(l)},a.onpause=function(){s.replaceChildren(o),a.currentTime=0},a.onended=function(){s.replaceChildren(o)},s.onclick=function(){a.paused?a.play():a.pause()}}},{key:"createAudioAttachment",value:function(n){var i=r.createAudioContainer();return r.addAudioElements(i,n),i}},{key:"stopAttachmentPlayback",value:function(n){var i,s,a;(a=(s=(i=n.children[0])==null?void 0:i.children)==null?void 0:s[0])!=null&&a.classList.contains("stop-icon")&&n.children[0].click()}}])}(fu);xp.TIMER_LIMIT_S=5999;var hl=xp,q_=function(){function e(){T(this,e)}return A(e,null,[{key:"create",value:function(t,n,i,s,a,o){return o==="audio"?new hl(t,n,i,s,a):new fu(t,n,i,s,a)}}])}(),hu=function(){function e(r,t,n){T(this,e),this._fileAttachmentsTypes=[],this.elementRef=this.createAttachmentContainer();var i=Q(n)=="object"&&!!n.displayFileAttachmentContainer;this.toggleContainerDisplay(i),r.appendChild(this.elementRef),t&&Object.assign(this.elementRef.style,t)}return A(e,[{key:"addType",value:function(t,n,i,s){var a=q_.create(t,n,i,this.toggleContainerDisplay.bind(this),this.elementRef,s);return this._fileAttachmentsTypes.push(a),a}},{key:"createAttachmentContainer",value:function(){var t=document.createElement("div");return t.id="file-attachment-container",t}},{key:"toggleContainerDisplay",value:function(t){t?this.elementRef.style.display="block":this.elementRef.children.length===0&&(this.elementRef.style.display="none")}},{key:"getAllFileData",value:function(){var t=this._fileAttachmentsTypes.map(function(n){return n.getFiles()}).flat();return t.length>0?t:void 0}},{key:"completePlaceholders",value:function(){var r=O(g().mark(function n(){return g().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Promise.all(this._fileAttachmentsTypes.map(function(){var a=O(g().mark(function o(l){var u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(u=l.stopPlaceholderCallback)==null?void 0:u.call(l));case 1:case"end":return d.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()));case 2:case"end":return s.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"addFilesToAnyType",value:function(t){e.addFilesToType(t,this._fileAttachmentsTypes)}},{key:"hideFiles",value:function(){this._fileAttachmentsTypes.forEach(function(t){return t.hideAttachments()}),this.elementRef.replaceChildren(),this.toggleContainerDisplay(!1)}},{key:"removeHiddenFiles",value:function(){this._fileAttachmentsTypes.forEach(function(t){return t.removeAttachments()})}},{key:"readdHiddenFiles",value:function(){this._fileAttachmentsTypes.forEach(function(t){return t.readdAttachments()}),this.toggleContainerDisplay(!0)}},{key:"getNumberOfTypes",value:function(){return this._fileAttachmentsTypes.length}}],[{key:"addFilesToType",value:function(t,n){t.forEach(function(i){var s=new FileReader;s.readAsDataURL(i),s.onload=function(a){for(var o=0;o<n.length&&!n[o].attemptAddFile(i,a.target.result);o+=1);}})}}])}(),Ip=function(){function e(r,t,n){T(this,e),this._isOpen=!1,this._contentRef=e.createModalContent(t,n?.backgroundColor),this._buttonPanel=e.createButtonPanel(n?.backgroundColor),this._elementRef=e.createContainer(this._contentRef,n),this._elementRef.appendChild(this._buttonPanel),r.appendChild(this._elementRef),this._backgroundPanelRef=e.createDarkBackgroundPanel(),r.appendChild(this._backgroundPanelRef),this.addWindowEvents(r)}return A(e,[{key:"isOpen",value:function(){return this._isOpen}},{key:"addButtons",value:function(){for(var t=this,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];i.forEach(function(a){tt.addAttributes(a),t._buttonPanel.appendChild(a)})}},{key:"close",value:function(){var t=this;this._elementRef.classList.remove("show-modal"),this._elementRef.classList.add("hide-modal"),this._backgroundPanelRef.classList.remove("show-modal-background"),this._backgroundPanelRef.classList.add("hide-modal-background"),this._isOpen=!1,setTimeout(function(){t._elementRef.style.display="none",t._backgroundPanelRef.style.display="none"},e.MODAL_CLOSE_TIMEOUT_MS)}},{key:"displayModalElements",value:function(){this._elementRef.style.display="flex",this._elementRef.classList.remove("hide-modal"),this._elementRef.classList.add("show-modal"),this._backgroundPanelRef.style.display="block",this._backgroundPanelRef.classList.remove("hide-modal-background"),this._backgroundPanelRef.classList.add("show-modal-background"),this._isOpen=!0}},{key:"openTextModal",value:function(t){this._contentRef.innerHTML=t,this.displayModalElements()}},{key:"addCloseButton",value:function(t,n,i){var s=this,a=n?e.createSVGButton(t):e.createTextButton(t);return this.addButtons(a),a.onclick=function(){s.close(),setTimeout(function(){i?.()},140)},a}},{key:"addWindowEvents",value:function(t){this.keyDownEvent=this.windowKeyDown.bind(this,t),window.addEventListener("keydown",this.keyDownEvent)}},{key:"windowKeyDown",value:function(t,n){var i,s;!t.isConnected&&this.keyDownEvent?window.removeEventListener("keydown",this.keyDownEvent):this._isOpen&&(n.key===it.ESCAPE?(this.close(),(i=this.extensionCloseCallback)==null||i.call(this)):n.key===it.ENTER&&(this.close(),(s=this.extensionCloseCallback)==null||s.call(this)))}}],[{key:"createContainer",value:function(t,n){var i=document.createElement("div");return i.classList.add("modal"),i.appendChild(t),n&&delete n.backgroundColor,Object.assign(i.style,n),i}},{key:"createModalContent",value:function(t,n){var i,s=document.createElement("div");return(i=s.classList).add.apply(i,Zi(t)),n&&(s.style.backgroundColor=n),document.createElement("div").appendChild(s),s}},{key:"createButtonPanel",value:function(t){var n=document.createElement("div");return n.classList.add("modal-button-panel"),t&&(n.style.backgroundColor=t),n}},{key:"createDarkBackgroundPanel",value:function(){var t=document.createElement("div");return t.id="modal-background-panel",t}},{key:"createTextButton",value:function(t){var n=document.createElement("div");return n.classList.add("modal-button"),n.textContent=t,n}},{key:"createSVGButton",value:function(t){var n=document.createElement("div");n.classList.add("modal-button","modal-svg-button");var i=mn.createSVGElement(t);return i.classList.add("modal-svg-button-icon"),n.appendChild(i),n}},{key:"createTextModalFunc",value:function(t,n,i){var s;if(Q(n)=="object"&&(s=n.files)!=null&&s.infoModal){var a=new e(t,["modal-content"],n.files.infoModal.containerStyle);return a.addCloseButton("OK",!1,i),a.openTextModal.bind(a,n.infoModalTextMarkUp||"")}}}])}();Ip.MODAL_CLOSE_TIMEOUT_MS=190;var pi=Ip,G_=function(e){function r(t,n,i,s,a,o){var l;T(this,r);var u,c,d,f,h,p,m,v,y,b,M=(u=i?.button)==null?void 0:u.position,_=((f=(d=(c=i?.button)==null?void 0:c.styles)==null?void 0:d.text)==null?void 0:f.content)||o,E=bn.tryCreateConfig("Upload File",(h=i?.button)==null?void 0:h.tooltip);l=le(this,r,[r.createButtonElement(),a,M,E,i.button,_]);var C=l.createInnerElementsForStates(s,l.customStyles);return l._inputElement=r.createInputElement((p=i?.files)==null?void 0:p.acceptedFormats),l.addClickEvent(t,i),l.changeElementsByState(C.styles),l.reapplyStateStyle("styles"),l._fileAttachmentsType=n,l._openModalOnce=((v=(m=i.files)==null?void 0:m.infoModal)==null?void 0:v.openModalOnce)===!1||(b=(y=i.files)==null?void 0:y.infoModal)==null?void 0:b.openModalOnce,l}return ue(r,e),A(r,[{key:"createInnerElementsForStates",value:function(n,i){return{styles:this.createInnerElements(n,"styles",i)}}},{key:"triggerImportPrompt",value:function(n){n.onchange=this.import.bind(this,n),n.click()}},{key:"import",value:function(n){hu.addFilesToType(Array.from(n.files||[]),[this._fileAttachmentsType]),n.value=""}},{key:"addClickEvent",value:function(n,i){var s=this.triggerImportPrompt.bind(this,this._inputElement),a=pi.createTextModalFunc(n,i,s);this.elementRef.onclick=this.click.bind(this,a)}},{key:"click",value:function(n){n&&(this._openModalOnce===void 0||this._openModalOnce===!0)?(n(),this._openModalOnce===!0&&(this._openModalOnce=!1)):this.triggerImportPrompt(this._inputElement)}}],[{key:"createInputElement",value:function(n){var i=document.createElement("input");return i.type="file",i.accept=n||"",i.hidden=!0,i.multiple=!0,i}},{key:"createButtonElement",value:function(){var n=document.createElement("div");return n.classList.add("input-button"),n}}])}(mr),Ad=function(){function e(){T(this,e)}return A(e,null,[{key:"create",value:function(t,n,i){var s=e.createElement(i);e.addEvents(s,t,n),t.appendChild(s)}},{key:"createElement",value:function(t){var n=document.createElement("div");return n.id="drag-and-drop",Q(t)=="object"&&Object.assign(n.style,t),n}},{key:"addEvents",value:function(t,n,i){n.ondragenter=function(s){s.preventDefault(),e.display(t)},t.ondragleave=function(s){s.preventDefault(),e.hide(t)},t.ondragover=function(s){s.preventDefault()},t.ondrop=function(s){s.preventDefault(),e.uploadFile(i,s),e.hide(t)}}},{key:"uploadFile",value:function(t,n){var i,s=(i=n.dataTransfer)==null?void 0:i.files;s&&t.addFilesToAnyType(Array.from(s))}},{key:"display",value:function(t){t.style.display="block"}},{key:"hide",value:function(t){t.style.display="none"}},{key:"isEnabled",value:function(t,n){return n!==void 0&&n===!1?!1:!!n||t.getNumberOfTypes()>0}}])}(),K_=function(){function e(){T(this,e)}return A(e,null,[{key:"validate",value:function(t,n,i,s,a){var o=t(i,s,a);return o?n.changeToSubmitIcon():n.changeToDisabledIcon(),o}},{key:"useValidationFunc",value:function(){var r=O(g().mark(function n(i,s,a,o){var l,u,c;return g().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return l=s.isTextInputEmpty()?"":s.inputElementRef.textContent,f.next=3,a.completePlaceholders();case 3:return u=a.getAllFileData(),c=u?.map(function(h){return h.file}),f.abrupt("return",e.validate(i,o,l,c));case 5:case"end":return f.stop()}},n)}));function t(n,i,s,a){return r.apply(this,arguments)}return t}()},{key:"useValidationFuncProgrammatic",value:function(){var r=O(g().mark(function n(i,s,a){var o,l;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return l=(o=s.files)==null?void 0:o.map(function(d){return d.file}),c.abrupt("return",e.validate(i,a,s.text,l,!0));case 2:case"end":return c.stop()}},n)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"validateWebsocket",value:function(t,n){var i=t.websocket,s=t.connectSettings;return i&&s.url!==Sn.URL&&!qi.canSendMessage(i)?(n.changeToDisabledIcon(),!1):!0}},{key:"attach",value:function(t,n,i,s,a){var o=t.validateInput||xt.processValidateInput(t);t._validationHandler=function(){var l=O(g().mark(function u(c){var d;return g().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(a.status.loadingActive||a.status.requestInProgress||n.isSubmitProgrammaticallyDisabled===!0||!e.validateWebsocket(n,a))){h.next=2;break}return h.abrupt("return",!1);case 2:return d=o||n.canSendMessage,h.abrupt("return",d?c?e.useValidationFuncProgrammatic(d,c,a):e.useValidationFunc(d,i,s,a):null);case 4:case"end":return h.stop()}},u)}));return function(u){return l.apply(this,arguments)}}()}}])}(),Lp=function(){function e(){T(this,e)}return A(e,null,[{key:"getFileName",value:function(t,n){var i=new Date,s=String(i.getHours()).padStart(2,"0"),a=String(i.getMinutes()).padStart(2,"0"),o=String(i.getSeconds()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(a,"-").concat(o,".").concat(n)}}])}(),J_=function(e){function r(t,n){var i;T(this,r);var s,a;return i=le(this,r,[n.button]),i._waitingForBrowserApproval=!1,i._audioType=t,i._extension=((s=n.files)==null?void 0:s.format)||"mp3",i._maxDurationSeconds=(a=n.files)==null?void 0:a.maxDurationSeconds,i.elementRef.onclick=i.buttonClick.bind(Pr(i)),i}return ue(r,e),A(r,[{key:"buttonClick",value:function(){this._waitingForBrowserApproval||(this.isActive?this.stop():(this._waitingForBrowserApproval=!0,this.record()))}},{key:"stop",value:function(){var n=this;return new Promise(function(i){var s,a;n.changeToDefault(),(s=n._mediaRecorder)==null||s.stop(),(a=n._mediaStream)==null||a.getTracks().forEach(function(o){return o.stop()}),setTimeout(function(){i()},10)})}},{key:"record",value:function(){var n=this;navigator.mediaDevices.getUserMedia({audio:!0}).then(function(i){n.changeToActive(),n._mediaRecorder=new MediaRecorder(i),n._audioType.addPlaceholderAttachment(n.stop.bind(n),n._maxDurationSeconds),n._mediaStream=i,n._mediaRecorder.addEventListener("dataavailable",function(s){n.createFile(s)}),n._mediaRecorder.start()}).catch(function(i){console.error(i),n.stop()}).finally(function(){n._waitingForBrowserApproval=!1})}},{key:"createFile",value:function(n){var i=this,s=new Blob([n.data],{type:"audio/".concat(this._extension)}),a=Lp.getFileName(this._newFilePrefix||"audio",this._extension),o=new File([s],a,{type:s.type}),l=new FileReader;l.readAsDataURL(o),l.onload=function(u){i._audioType.completePlaceholderAttachment(o,u.target.result)}}}])}(Ep),X_=`<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">
<svg xmlns="http://www.w3.org/2000/svg" stroke="currentColor" fill="none" stroke-width="1" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
  <line x1="22" y1="2" x2="11" y2="14"></line>
  <polygon points="22 2 15 22 11 14 2 10 22 2"></polygon>
</svg>
`,Md=function(){function e(){T(this,e)}return A(e,null,[{key:"resetSubmit",value:function(t,n){n?t.unsetCustomStateStyles(["loading","submit"]):t.unsetCustomStateStyles(["stop","loading","submit"]),t.reapplyStateStyle("submit")}},{key:"overwriteDefaultStyleWithSubmit",value:function(t,n){if(t.submit){var i=JSON.parse(JSON.stringify(t[n]||{}));on.overwritePropertyObjectFromAnother(i,t.submit,["container","default"]),on.overwritePropertyObjectFromAnother(i,t.submit,["text","styles","default"]),on.overwritePropertyObjectFromAnother(i,t.submit,["svg","styles","default"]),t[n]=i}}},{key:"setUpDisabledButton",value:function(t){on.setPropertyValueIfDoesNotExist(t,["submit","container","default","backgroundColor"],""),on.setPropertyValueIfDoesNotExist(t,["disabled","container","default","backgroundColor"],"unset"),on.setPropertyValueIfDoesNotExist(t.submit,["svg","styles","default","filter"],""),on.setPropertyValueIfDoesNotExist(t.disabled,["svg","styles","default","filter"],"brightness(0) saturate(100%) invert(70%) sepia(0%) saturate(5564%) hue-rotate(207deg) brightness(100%) contrast(97%)"),on.setPropertyValueIfDoesNotExist(t.disabled,["text","styles","default","color"],"grey"),e.overwriteDefaultStyleWithSubmit(t,"disabled")}},{key:"process",value:function(t){var n=JSON.parse(JSON.stringify(t||{}));return e.overwriteDefaultStyleWithSubmit(n,"loading"),e.overwriteDefaultStyleWithSubmit(n,"stop"),t!=null&&t.alwaysEnabled||e.setUpDisabledButton(n),n}}])}(),Os=function(e){function r(t,n,i,s,a,o){var l;T(this,r);var u=Md.process(t.submitButtonStyles),c=X_,d=bn.tryCreateConfig("Submit",u?.tooltip);return l=le(this,r,[r.createButtonContainerElement(),c,u?.position,d,u]),l._isSVGLoadingIconOverriden=!1,l.status={requestInProgress:!1,loadingActive:!1},l._messages=i,l._textInput=n,l._fileAttachments=a,l._innerElements=l.createInnerElementsForStates(),l._abortStream=new AbortController,l._stopClicked={listener:function(){}},l._serviceIO=s,l._alwaysEnabled=!!(u!=null&&u.alwaysEnabled),t.disableSubmitButton=l.disableSubmitButton.bind(Pr(l),s),l.attemptOverwriteLoadingStyle(t),o.microphone&&l.setUpSpeechToText(o.microphone.button,t.speechToText),setTimeout(function(){var f;l._validationHandler=t._validationHandler,l.assignHandlers(l._validationHandler),(f=l._validationHandler)==null||f.call(Pr(l))}),l}return ue(r,e),A(r,[{key:"createInnerElementsForStates",value:function(){var n=this.createCustomElements(),i=n.submit,s=n.loading,a=n.stop;return{submit:i,loading:s||[r.createLoadingIconElement()],stop:a||[r.createStopIconElement()],disabled:this.createDisabledIconElement(i)}}},{key:"createCustomElements",value:function(){var n=this,i=Un.createCustomElements("submit",this.svg,this.customStyles),s={loading:void 0,stop:void 0};return Object.keys(s).forEach(function(a){var o=a,l=Un.createCustomElements(o,n.svg,n.customStyles);l&&(s[o]=l)}),s.submit=i||this.buildDefaultIconElement("submit-icon"),s}},{key:"createDisabledIconElement",value:function(n){return Un.createCustomElements("disabled",this.svg,this.customStyles)||[n[0].cloneNode(!0)]}},{key:"attemptOverwriteLoadingStyle",value:function(n){var i,s,a,o,l,u,c,d,f;if(!((s=(i=this.customStyles)==null?void 0:i.submit)!=null&&s.svg||(l=(o=(a=this.customStyles)==null?void 0:a.loading)==null?void 0:o.svg)!=null&&l.content||(d=(c=(u=this.customStyles)==null?void 0:u.loading)==null?void 0:c.text)!=null&&d.content)&&(n.displayLoadingBubble===void 0||n.displayLoadingBubble===!0)){var h=document.createElement("style");h.textContent=`
        .loading-button > * {
          filter: brightness(0) saturate(100%) invert(72%) sepia(0%) saturate(3044%) hue-rotate(322deg) brightness(100%)
            contrast(96%) !important;
        }`,(f=n.shadowRoot)==null||f.appendChild(h),this._isSVGLoadingIconOverriden=!0}}},{key:"assignHandlers",value:function(n){this._serviceIO.completionsHandlers={onFinish:this.resetSubmit.bind(this,n)},this._serviceIO.streamHandlers={onOpen:this.changeToStopIcon.bind(this),onClose:this.resetSubmit.bind(this,n),abortStream:this._abortStream,stopClicked:this._stopClicked};var i=this._serviceIO.stream;Q(i)=="object"&&typeof i.simulation=="number"&&(this._serviceIO.streamHandlers.simulationInterim=i.simulation)}},{key:"setUpSpeechToText",value:function(n,i){this._microphoneButton=n,this._stopSTTAfterSubmit=Q(i)=="object"?i.stopAfterSubmit:!1}},{key:"resetSubmit",value:function(n){this.status.requestInProgress=!1,this.status.loadingActive=!1,n()}},{key:"submitFromInput",value:function(){var t=O(g().mark(function i(){var s,a;return g().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._fileAttachments.completePlaceholders();case 2:s=this._fileAttachments.getAllFileData(),this._textInput.isTextInputEmpty()?this.attemptSubmit({text:"",files:s}):(a=this._textInput.inputElementRef.innerText.trim(),this.attemptSubmit({text:a,files:s}));case 4:case"end":return l.stop()}},i,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"programmaticSubmit",value:function(){var t=O(g().mark(function i(s){var a=this,o;return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:typeof s=="string"&&(s=xt.processSubmitUserMessage(s)),o={text:s.text},s.files&&(o.files=Array.from(s.files).map(function(c){return{file:c,type:fu.getTypeFromBlob(c)}})),s.custom&&(o.custom=s.custom),setTimeout(function(){return a.attemptSubmit(o,!0)});case 3:case"end":return u.stop()}},i)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"attemptSubmit",value:function(){var t=O(g().mark(function i(s){var a,o,l,u,c,d,f,h=arguments;return g().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return a=h.length>1&&h[1]!==void 0?h[1]:!1,m.next=3,(o=this._validationHandler)==null?void 0:o.call(this,a?s:void 0);case 3:if(m.t0=m.sent,m.t1=!1,m.t0!==m.t1){m.next=7;break}return m.abrupt("return");case 7:if(this.changeToLoadingIcon(),this._textInput.clear(),m.t2=typeof this._messages.focusMode!="boolean"&&(l=this._messages.focusMode)!=null&&l.fade,!m.t2){m.next=13;break}return m.next=13,ip.fadeAnimation(this._messages.elementRef,this._messages.focusMode.fade);case 13:return m.next=15,this.addNewMessage(s);case 15:return this._serviceIO.isWebModel()||this._messages.addLoadingMessage(),d=(u=s.files)==null?void 0:u.map(function(v){return v.file}),f={text:s.text===""?void 0:s.text,files:d},m.next=19,this._serviceIO.callAPI(f,this._messages);case 19:(c=this._fileAttachments)==null||c.hideFiles();case 20:case"end":return m.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"addNewMessage",value:function(){var t=O(g().mark(function i(s){var a,o,l,u;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(a=s.text,o=s.files,l=s.custom,u={role:ie.USER_ROLE,custom:l},a&&(u.text=a),d.t0=o,!d.t0){d.next=8;break}return d.next=7,this._messages.addMultipleFiles(o,this._fileAttachments);case 7:u.files=d.sent;case 8:this._serviceIO.sessionId&&(u._sessionId=this._serviceIO.sessionId),Object.keys(u).length>0&&this._messages.addNewMessage(u);case 10:case"end":return d.stop()}},i,this)}));function n(i){return t.apply(this,arguments)}return n}()},{key:"stopStream",value:function(){var n;this._abortStream.abort(),(n=this._stopClicked)==null||n.listener(),this._validationHandler&&this.resetSubmit(this._validationHandler)}},{key:"changeToStopIcon",value:function(){this._serviceIO.websocket||(this.elementRef.classList.remove(r.LOADING_CLASS,r.DISABLED_CLASS,r.SUBMIT_CLASS),tt.removeAriaAttributes(this.elementRef),this.changeElementsByState(this._innerElements.stop),this.reapplyStateStyle("stop",["loading","submit"]),this.elementRef.onclick=this.stopStream.bind(this),this.status.loadingActive=!1)}},{key:"changeToLoadingIcon",value:function(){this._serviceIO.websocket||(this._isSVGLoadingIconOverriden||this.changeElementsByState(this._innerElements.loading),this.elementRef.classList.remove(r.SUBMIT_CLASS,r.DISABLED_CLASS),tt.removeAriaDisabled(this.elementRef),this.elementRef.classList.add(r.LOADING_CLASS),tt.addAriaBusy(this.elementRef),this.reapplyStateStyle("loading",["submit"]),this.elementRef.onclick=function(){},this.status.requestInProgress=!0,this.status.loadingActive=!0)}},{key:"changeToSubmitIcon",value:function(){var n=this;this.elementRef.classList.contains(r.SUBMIT_CLASS)||(this.elementRef.classList.remove(r.LOADING_CLASS,r.DISABLED_CLASS),tt.removeAriaAttributes(this.elementRef),this.elementRef.classList.add(r.SUBMIT_CLASS),this.changeElementsByState(this._innerElements.submit),Md.resetSubmit(this,this.status.loadingActive),this.elementRef.onclick=function(){var i;n.submitFromInput(),(i=n._microphoneButton)!=null&&i.isActive&&du.toggleSpeechAfterSubmit(n._microphoneButton.elementRef,!!n._stopSTTAfterSubmit)})}},{key:"changeToDisabledIcon",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this._alwaysEnabled&&!n?this.changeToSubmitIcon():this.elementRef.classList.contains(r.DISABLED_CLASS)||(this.elementRef.classList.remove(r.LOADING_CLASS,r.SUBMIT_CLASS),tt.removeAriaBusy(this.elementRef),this.elementRef.classList.add(r.DISABLED_CLASS),tt.addAriaDisabled(this.elementRef),this.changeElementsByState(this._innerElements.disabled),this.reapplyStateStyle("disabled",["submit"]),this.elementRef.onclick=function(){})}},{key:"disableSubmitButton",value:function(n,i){var s;n.isSubmitProgrammaticallyDisabled=i!==!1,!(this.status.requestInProgress||this.status.loadingActive)&&(i===!1?(s=this._validationHandler)==null||s.call(this):this.changeToDisabledIcon(!0))}}],[{key:"createButtonContainerElement",value:function(){var n=document.createElement("div");return n.classList.add("input-button"),n}},{key:"createLoadingIconElement",value:function(){var n=document.createElement("div");return n.classList.add("loading-submit-button"),n}},{key:"createStopIconElement",value:function(){var n=document.createElement("div");return n.id="stop-icon",n}}])}(mr);Os.SUBMIT_CLASS="submit-button",Os.LOADING_CLASS="loading-button",Os.DISABLED_CLASS="disabled-button";var Y_=Os,Z_=`<?xml version="1.0" encoding="utf-8"?>
<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
  <path d="M27.1 14.313V5.396L24.158 8.34c-2.33-2.325-5.033-3.503-8.11-3.503C9.902 4.837 4.901 9.847 4.899 16c.001 6.152 5.003 11.158 11.15 11.16 4.276 0 9.369-2.227 10.836-8.478l.028-.122h-3.23l-.022.068c-1.078 3.242-4.138 5.421-7.613 5.421a8 8 0 0 1-5.691-2.359A7.993 7.993 0 0 1 8 16.001c0-4.438 3.611-8.049 8.05-8.049 2.069 0 3.638.58 5.924 2.573l-3.792 3.789H27.1z"/>
</svg>
`,Q_=`<?xml version="1.0" encoding="utf-8"?>
<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 16q0 3.264 1.28 6.208t3.392 5.12 5.12 3.424 6.208 1.248 6.208-1.248 5.12-3.424 3.392-5.12 1.28-6.208-1.28-6.208-3.392-5.12-5.088-3.392-6.24-1.28q-3.264 0-6.208 1.28t-5.12 3.392-3.392 5.12-1.28 6.208zM4 16q0-3.264 1.6-6.016t4.384-4.352 6.016-1.632 6.016 1.632 4.384 4.352 1.6 6.016-1.6 6.048-4.384 4.352-6.016 1.6-6.016-1.6-4.384-4.352-1.6-6.048z"></path>
</svg>
`,eE=`<?xml version="1.0" encoding="utf-8"?>
<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
  <path d="M195.2 195.2a64 64 0 0 1 90.496 0L512 421.504 738.304 195.2a64 64 0 0 1 90.496 90.496L602.496 512 828.8 738.304a64 64 0 0 1-90.496 90.496L512 602.496 285.696 828.8a64 64 0 0 1-90.496-90.496L421.504 512 195.2 285.696a64 64 0 0 1 0-90.496z"/>
</svg>`,tE=`<?xml version="1.0" encoding="utf-8"?>
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M4.89163 13.2687L9.16582 17.5427L18.7085 8" stroke="#000000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`,nE=function(e){function r(t,n,i,s){var a;T(this,r),a=le(this,r,[t,["modal-content","modal-camera-content"],i]),a._stopped=!1,a._format="image/png",a._canvas=document.createElement("canvas"),a._canvas.classList.add("camera-modal-canvas");var o=a.addButtonsAndTheirEvents(n),l=o.captureButton,u=o.submitButton;return a._captureButton=l,a._submitButton=u,a._captureIcon=a._captureButton.children[0],a._refreshIcon=mn.createSVGElement(Z_),a._refreshIcon.classList.add("modal-svg-button-icon","modal-svg-refresh-icon"),s?.format==="jpeg"&&(a._format="image/jpeg"),s!=null&&s.dimensions&&(a._dimensions=s.dimensions),a._contentRef.appendChild(a._canvas),a.extensionCloseCallback=a.stop,a}return ue(r,e),A(r,[{key:"addButtonsAndTheirEvents",value:function(n){var i=pi.createSVGButton(Q_);i.classList.add("modal-svg-camera-button"),i.children[0].classList.add("modal-svg-camera-icon");var s=this.addCloseButton(eE,!0);s.classList.add("modal-svg-close-button"),s.children[0].classList.add("modal-svg-close-icon");var a=pi.createSVGButton(tE);return a.classList.add("modal-svg-submit-button"),this.addButtons(i,a),this.addButtonEvents(i,s,a,n),{captureButton:i,submitButton:a}}},{key:"addButtonEvents",value:function(n,i,s,a){var o=this;n.onclick=function(){o.capture()},i.addEventListener("click",this.stop.bind(this)),s.onclick=function(){var l=o.getFile();l&&hu.addFilesToType([l],[a]),o.stop(),o.close()}}},{key:"stop",value:function(){var n=this;this._mediaStream&&this._mediaStream.getTracks().forEach(function(i){return i.stop()}),this._stopped=!0,setTimeout(function(){n._captureButton.replaceChildren(n._captureIcon),n._captureButton.classList.replace("modal-svg-refresh-button","modal-svg-camera-button");var i=n._canvas.getContext("2d");i?.clearRect(0,0,n._canvas.width,n._canvas.height)},pi.MODAL_CLOSE_TIMEOUT_MS)}},{key:"start",value:function(){var n=this;this._dataURL=void 0,this._submitButton.classList.add("modal-svg-submit-disabled"),this._stopped=!1,navigator.mediaDevices.getUserMedia({video:this._dimensions||!0}).then(function(i){if(n._mediaStream=i,!n.isOpen())return n.stop();var s=document.createElement("video");s.srcObject=i,s.play(),requestAnimationFrame(n.updateCanvas.bind(n,s,n._canvas))}).catch(function(i){console.error(i),n.stop(),n.close()})}},{key:"capture",value:function(){this._dataURL?(this._captureButton.replaceChildren(this._captureIcon),this._captureButton.classList.replace("modal-svg-refresh-button","modal-svg-camera-button"),this._submitButton.classList.add("modal-svg-submit-disabled"),this._dataURL=void 0):(this._captureButton.replaceChildren(this._refreshIcon),this._captureButton.classList.replace("modal-svg-camera-button","modal-svg-refresh-button"),this._submitButton.classList.remove("modal-svg-submit-disabled"),this._dataURL=this._canvas.toDataURL())}},{key:"getFile",value:function(){if(this._dataURL){for(var n=atob(this._dataURL.split(",")[1]),i=new Array(n.length),s=0;s<n.length;s++)i[s]=n.charCodeAt(s);var a=new Uint8Array(i),o=new Blob([a],{type:this._format}),l=this._format==="image/jpeg"?"jpeg":"png",u=Lp.getFileName(this._newFilePrefix||"photo",l);return new File([o],u,{type:o.type})}}},{key:"updateCanvas",value:function(n,i){if(!this._stopped){if(!this._dataURL){i.width=n.videoWidth,i.height=n.videoHeight;var s=i.getContext("2d");s?.drawImage(n,0,0,i.width,i.height)}requestAnimationFrame(this.updateCanvas.bind(this,n,i))}}},{key:"openCameraModal",value:function(n){this.displayModalElements(),n.start()}}],[{key:"createCameraModalFunc",value:function(n,i,s,a){var o=new r(n,i,s,a);return o.openCameraModal.bind(o,o)}}])}(pi),rE=`<?xml version="1.0" encoding="utf-8"?>
<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M29 7h-4.599l-2.401-4h-12l-2.4 4h-4.6c-1 0-3 1-3 2.969v16.031c0 1.657 1.5 3 2.792 3h26.271c1.313 0 2.938-1.406 2.938-2.968v-16.032c0-1-1-3-3-3zM30 26.032c0 0.395-0.639 0.947-0.937 0.969h-26.265c-0.232-0.019-0.797-0.47-0.797-1v-16.031c0-0.634 0.851-0.953 1-0.969h5.732l2.4-4h9.802l1.785 3.030 0.55 0.97h5.731c0.705 0 0.99 0.921 1 1v16.032zM16 10c-3.866 0-7 3.134-7 7s3.134 7 7 7 7-3.134 7-7-3.134-7-7-7zM16 22c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z"></path>
</svg>`,iE=function(e){function r(t,n,i){var s;T(this,r);var a,o,l,u,c,d,f=(a=i?.button)==null?void 0:a.position,h=((u=(l=(o=i?.button)==null?void 0:o.styles)==null?void 0:l.text)==null?void 0:u.content)||"Photo",p=bn.tryCreateConfig("Camera",(c=i?.button)==null?void 0:c.tooltip),m=((d=i?.button)==null?void 0:d.styles)||{};s=le(this,r,[r.createButtonElement(),rE,f,p,m,h]);var v=s.createInnerElementsForStates(s.customStyles);return i&&s.addClickEvent(t,n,i.modalContainerStyle,i.files),s.changeElementsByState(v.styles),s.reapplyStateStyle("styles"),s}return ue(r,e),A(r,[{key:"createInnerElementsForStates",value:function(n){return{styles:this.createInnerElements("camera-icon","styles",n)}}},{key:"addClickEvent",value:function(n,i,s,a){var o=nE.createCameraModalFunc(n,i,s,a);this.elementRef.onclick=o}}],[{key:"createButtonElement",value:function(){var n=document.createElement("div");return n.classList.add("input-button"),n}}])}(mr),sE=function(){function e(r,t,n,i){T(this,e),this.elementRef=e.createPanelElement(r.inputAreaStyle);var s={},a=this.createFileUploadComponents(r,n,i,s),o=new Hh(r,n,a);r.speechToText&&!s.microphone&&(s.microphone={button:new du(r,o,t.addNewErrorMessage.bind(t))});var l=new Y_(r,o,t,n,a,s);o.submit=l.submitFromInput.bind(l),K_.attach(r,n,o,a,l),r.submitUserMessage=l.programmaticSubmit.bind(l),s.submit={button:l},r.customButtons&&Ii.add(r,s),e.addElements(this.elementRef,o,s,i,a,r.dropupStyles),e.assignOnInput(r,n,a,o)}return A(e,[{key:"createFileUploadComponents",value:function(t,n,i,s){var a,o,l,u,c=new hu(this.elementRef,t.attachmentContainerStyle,n.demo);if(e.createUploadButtons(t,n,n.fileTypes||{},c,i,s),(a=n.camera)!=null&&a.files){var d=((o=s.images)==null?void 0:o.fileType)||c.addType(t,n,n.camera.files,"images");s.camera={button:new iE(i,d,n.camera)}}if((l=n.recordAudio)!=null&&l.files){var f=((u=s.audio)==null?void 0:u.fileType)||c.addType(t,n,n.recordAudio.files,"audio");s.microphone={button:new J_(f,n.recordAudio)}}return Ad.isEnabled(c,t.dragAndDrop)&&Ad.create(i,c,t.dragAndDrop),c}}],[{key:"createPanelElement",value:function(t){var n=document.createElement("div");return n.id="input",Object.assign(n.style,t),n}},{key:"createUploadButtons",value:function(t,n,i,s,a,o){Object.keys(i).forEach(function(l){var u=l,c=i[u];if(c.files){var d=s.addType(t,n,c.files,u),f=A_[u],h=f.id,p=f.svgString,m=f.dropupText,v=new G_(a,d,c,h,p,m);o[u]={button:v,fileType:d}}})}},{key:"addElements",value:function(t,n,i,s,a,o){At.addElements(t,n.elementRef);var l=Ks.create(),u=__.addButtons(l,i,s,o);y_.set(n.inputElementRef,l,a.elementRef,u),Ks.add(t,l)}},{key:"assignOnInput",value:function(t,n,i,s){n.onInput=function(a){setTimeout(function(){var o=i.getAllFileData(),l={text:s.inputElementRef.innerText.trim()};o&&(l.files=o.map(function(u){return u.file})),Vi.onInput(t,l,a)})}}}])}(),aE=function(){function e(){T(this,e)}return A(e,null,[{key:"createElements",value:function(t,n,i){var s=document.createElement("div");s.id="chat-view";var a=new fl(t,n,i);n.websocket&&qi.createConnection(n,a);var o=new sE(t,a,n,s);return At.addElements(s,a.elementRef,o.elementRef),s}},{key:"render",value:function(t,n,i,s){var a=e.createElements(t,i,s);n.replaceChildren(a),i.isCustomView()&&i.setUpView(a,n)}}])}(),oE=`#validate-property-key-view{height:100%;position:relative;display:flex;justify-content:center;align-items:center;padding:8px}#loading-validate-key-property{display:inline-block;width:50px;height:50px}#loading-validate-key-property:after{content:" ";display:block;width:38px;height:38px;margin:1px;border-radius:50%;border:5px solid #5fb2ff;border-color:#5fb2ff transparent #5fb2ff transparent;animation:loading-spinner 1.4s linear infinite}#deep-chat-openai-realtime-container{height:100%;width:100%}#deep-chat-openai-realtime-avatar-container{height:60%;width:100%;display:flex;justify-content:center;align-items:center}#deep-chat-openai-realtime-avatar{border-radius:50%;height:110px;border:1px solid rgb(215,215,215);padding:8px;-webkit-user-select:none;user-select:none;margin-top:20px}#deep-chat-openai-realtime-buttons-container{height:40%;display:flex;position:relative}.deep-chat-openai-realtime-button-container{height:100%;width:50%;display:flex;justify-content:center;align-items:center}.deep-chat-openai-realtime-button{width:70px;height:70px;border-radius:50%;display:flex;justify-content:center;align-items:center;cursor:pointer}.deep-chat-openai-realtime-button-default{background-color:#e3e3e3}.deep-chat-openai-realtime-button-default:hover{background-color:#d4d4d4}.deep-chat-openai-realtime-button-default:active{background-color:#c5c5c5}.deep-chat-openai-realtime-button-loading{opacity:.7;pointer-events:none}.deep-chat-openai-realtime-microphone-active{background-color:#ffe7e7}.deep-chat-openai-realtime-microphone-active:hover{background-color:#ffdede}.deep-chat-openai-realtime-microphone-active:active{background-color:#ffd2d2}.deep-chat-openai-realtime-microphone>*{height:30px;width:30px}.deep-chat-openai-realtime-microphone-active>*{filter:brightness(0) saturate(100%) invert(35%) sepia(60%) saturate(1360%) hue-rotate(325deg) brightness(95%) contrast(92%)}.deep-chat-openai-realtime-toggle>*{height:32px;width:32px;padding-left:3px;filter:brightness(0) saturate(100%) invert(22%) sepia(0%) saturate(4537%) hue-rotate(208deg) brightness(105%) contrast(91%)}.deep-chat-openai-realtime-button-unavailable{opacity:.45;pointer-events:none}#deep-chat-openai-realtime-error{color:red;position:absolute;top:calc(50% + 40px);left:50%;transform:translate(-50%,-50%);font-size:17px}#deep-chat-openai-realtime-loading{position:absolute;font-size:15px;top:50%;left:50%;transform:translate(-50%,-50%)}#insert-key-view{height:100%;position:relative}#insert-key-contents{text-align:center;position:absolute;top:44%;left:50%;transform:translate(-50%,-50%);width:82%;display:flex;max-width:700px}#insert-key-title{margin-bottom:15px}#insert-key-input-container{margin-right:2.7em;width:calc(100% - 80px)}#insert-key-input{padding:.3em 1.7em .3em .3em;border-width:1px;border-style:solid;border-radius:3px;width:100%;font-size:inherit}.insert-key-input-valid{border-color:gray}.insert-key-input-invalid{border-color:red}#visibility-icon-container{position:relative;float:right;cursor:pointer;-webkit-user-select:none;user-select:none}.visibility-icon{filter:brightness(0) saturate(100%) invert(63%) sepia(1%) saturate(9%) hue-rotate(43deg) brightness(98%) contrast(92%);position:absolute;right:-1.7em;top:-1.43em}#visible-icon{top:-1.4em}.visibility-icon:hover{filter:unset}.visibility-icon>*{pointer-events:none}#start-button{border:1px solid grey;color:#454545;border-radius:4px;width:3em;display:flex;justify-content:center;align-items:center;cursor:pointer;padding:.28em .3em;-webkit-user-select:none;user-select:none;background-color:#fff}#start-button:hover{background-color:#f2f2f2}#start-button:active{background-color:#d2d2d2}#insert-key-help-text-container{width:100%;position:absolute;margin-top:32px;margin-bottom:20px}#insert-key-help-text-contents{width:100%;position:absolute}#insert-key-input-invalid-text{display:block;margin-top:1em;margin-bottom:.5em;color:red}.insert-key-input-help-text{display:block;margin-top:16px}#loading-key{display:inline-block;width:16px;height:16px}#loading-key:after{content:" ";display:block;width:11px;height:11px;margin:1px;border-radius:50%;border:2px solid #0084ff;border-color:#0084ff transparent #0084ff transparent;animation:loading-spinner 1.2s linear infinite}#error-view{color:red;font-size:1.2em;line-height:1.3em;margin-top:-5px;text-align:center;height:100%;display:flex;justify-content:center;align-items:center;padding-left:8px;padding-right:8px}@keyframes loading-spinner{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.intro-panel{position:absolute;display:flex;justify-content:center;right:0;bottom:0;left:0;margin:auto;height:fit-content;top:-2.5em}#internal-intro-panel{width:250px;height:min-content;display:block;border-radius:5px;overflow:auto;border:1px solid rgb(203,203,203);padding:10px;max-height:calc(100% - 6.8em)}#internal-intro-panel>p{margin-block-start:.8em;margin-block-end:.8em}pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}/*!
  Theme: a11y-dark
  Author: @ericwbailey
  Maintainer: @ericwbailey

  Based on the Tomorrow Night Eighties theme: https://github.com/isagalaev/highlight.js/blob/master/src/styles/tomorrow-night-eighties.css
*/.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast: active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}#messages{overflow:auto}.outer-message-container:last-child{margin-bottom:5px}.inner-message-container{display:flex;margin-left:auto;margin-right:auto;width:calc(97.5% - 24px);max-width:100%}.message-bubble{margin-top:10px;word-wrap:break-word;width:fit-content;max-width:60%;border-radius:10px;padding:.42em .55em;height:fit-content;line-height:1.26em}.user-message-text{color:#fff;background-color:#0084ff;margin-right:0;margin-left:auto}.ai-message-text{color:#000;background-color:#e4e6eb;margin-left:0;margin-right:auto}.deep-chat-last-group-messages-active{height:100%}.loading-history-message-full-view{position:absolute;height:70%;width:100%;display:flex;align-items:center}.loading-history-message-small{height:20px;margin-bottom:30px}.loading-history-message-small>div>div{scale:.6}.loading-history-message{margin-top:0;width:100%;max-width:100%;display:flex;justify-content:center;background-color:unset}.loading-history{width:70px}.loading-history div{position:absolute;width:var(--loading-history-width);height:var(--loading-history-height);margin:var(--loading-history-margin);border:var(--loading-history-border);border-radius:50%;animation:loading-spinner 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:var(--loading-history-color) transparent transparent transparent}.loading-history div:nth-child(1){animation-delay:-.45s}.loading-history div:nth-child(2){animation-delay:-.3s}.loading-history div:nth-child(3){animation-delay:-.15s}.html-message{max-width:unset}.error-message-text{margin:14px auto 10px;background-color:#f4c0c0;color:#474747;text-align:center;max-width:95%}.deep-chat-loading-message-dots-container{width:1em;padding:.6em .75em .6em 1.3em}.loading-message-dots{position:relative;width:.45em;height:.45em;border-radius:5px;background-color:var(--loading-message-color);color:var(--loading-message-color);animation:loading-message-dots 1s infinite linear alternate;animation-delay:.5s}.loading-message-dots:before,.loading-message-dots:after{content:"";display:inline-block;position:absolute;top:0}.loading-message-dots:before{left:-.7em;width:.45em;height:.45em;border-radius:5px;background-color:var(--loading-message-color);color:var(--loading-message-color);animation:loading-message-dots 1s infinite alternate;animation-delay:0s}.loading-message-dots:after{left:.7em;width:.45em;height:.45em;border-radius:5px;background-color:var(--loading-message-color);color:var(--loading-message-color);animation:loading-message-dots 1s infinite alternate;animation-delay:1s}@keyframes loading-message-dots{0%{background-color:var(--loading-message-color)}50%,to{background-color:var(--loading-message-color-fade)}}.message-bubble>p:first-child,.message-bubble>.partial-render-message>p:first-child,.stream-wrapper>p:first-child{margin-top:0}.message-bubble>p:last-child,.message-bubble>.partial-render-message:last-child>p,.stream-wrapper>p:last-child{margin-bottom:0}pre{overflow:auto;display:block;word-break:break-all;word-wrap:break-word;border-radius:7px;background:#2b2b2b;color:#f8f8f2;margin-top:.8em;margin-bottom:.8em;padding:.6em;font-size:.9em;line-height:1.5em}.image-message{padding:0;display:flex;background-color:#ddd}.image-message>*,.image-message>*>*{width:100%;border-radius:8px;display:flex}.audio-message{width:60%;max-width:300px;height:2.2em;max-height:54px;padding:0;background-color:unset}.audio-player{width:100%;height:100%}.audio-player-safari{height:fit-content;width:40px}.audio-player-safari-left{float:left}.audio-player-safari-right{float:right}.any-file-message{padding:1px}.any-file-message-contents{display:flex}.any-file-message-icon-container{width:1.3em;min-width:1.3em;position:relative;border-radius:4px;margin-left:6px;margin-right:2px}.any-file-message-icon{background-color:#fff;border-radius:4px;position:absolute;width:1em;height:1.25em;padding:1px;margin-top:auto;margin-bottom:auto;top:0;bottom:0}.any-file-message-text{padding-top:5px;overflow-wrap:anywhere;padding-bottom:5px;padding-right:7px}.message-bubble>a{color:inherit}.left-item-position{margin-right:10px}.right-item-position{margin-left:10px}.role-hidden{display:none}.avatar{padding-top:5px;width:1.5em;height:1.5em;border-radius:1px}.avatar-container{margin-top:9px}.name{margin-top:16px;font-size:15px}#drag-and-drop{position:absolute;display:none;z-index:10;height:calc(100% - 10px);width:calc(100% - 10px);background-color:#70c6ff4d;border:5px dashed #6dafff}#file-attachment-container{position:absolute;height:3.6em;width:calc(80% - 4px);top:-2.5em;border-radius:5px;overflow:auto;text-align:left;background-color:#d7d7d73b;padding-left:4px}.file-attachment{width:2.85em;height:2.85em;display:inline-flex;margin-right:.6em;margin-bottom:.44em;margin-top:4px;position:relative;background-color:#fff;border-radius:5px}.image-attachment{width:100%;height:100%;object-fit:cover;border-radius:5px}.border-bound-attachment{width:calc(100% - 2px);height:calc(100% - 2px);border:1px solid #c3c3c3;border-radius:5px;overflow:hidden}.border-bound-attachment-safari{width:calc(100% - 1px);height:calc(100% - 1px)}.audio-attachment-icon-container{cursor:pointer}.audio-attachment-icon-container:hover{background-color:#f8f8f8}.attachment-icon{left:0;right:0;bottom:0;top:2px;margin:auto;position:absolute;width:25px;-webkit-user-select:none;user-select:none}.not-removable-attachment-icon{top:0;right:0;bottom:0;left:0}.play-icon{filter:brightness(0) saturate(100%) invert(17%) sepia(0%) saturate(1392%) hue-rotate(67deg) brightness(98%) contrast(97%)}.stop-icon{filter:brightness(0) saturate(100%) invert(29%) sepia(90%) saturate(1228%) hue-rotate(198deg) brightness(93%) contrast(98%)}.audio-placeholder-text-3-digits{padding-left:.26rem}.audio-placeholder-text-4-digits{padding-left:.1rem}.any-file-attachment{padding:2px 0}.file-attachment-text-container{position:absolute;width:inherit;display:flex;align-items:center;height:100%;top:-1px}.audio-placeholder-text-3-digits-container{padding-top:1px;cursor:default}.any-file-attachment-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;padding-left:.13em;margin-left:auto;margin-right:auto}.remove-file-attachment-button{height:1.25em;width:1.25em;border:1px solid #cfcfcf;border-radius:25px;background-color:#fff;top:-4px;right:-5px;position:absolute;display:flex;justify-content:center;cursor:pointer;-webkit-user-select:none;user-select:none}.remove-file-attachment-button:hover{background-color:#e4e4e4}.remove-file-attachment-button:active{background-color:#d7d7d7}.x-icon{color:#4e4e4e;top:-.075em;position:relative;font-size:1.05em}.modal{display:none;flex-direction:column;align-items:center;justify-content:center;position:absolute;width:80%;max-width:420px;max-height:80%;margin:auto;top:0;right:0;bottom:0;left:0;z-index:3}.modal-content{border-top:1px solid rgb(217,217,217);border-left:1px solid rgb(217,217,217);border-right:1px solid rgb(217,217,217);border-top-left-radius:inherit;border-top-right-radius:inherit;background-color:#fff;overflow-y:auto;height:fit-content;max-height:calc(100% - 3.3em);width:100%}.modal-content>p{margin-left:1em;margin-right:1em}.modal-content>ul{margin-right:1em}.modal-button-panel{height:3.3em;border:1px solid;border-color:rgb(223,223,223) rgb(217,217,217) rgb(217,217,217);border-bottom-left-radius:inherit;border-bottom-right-radius:inherit;background-color:#fff;text-align:center;justify-content:center;display:flex;width:100%}.modal-button{min-width:2.5em;text-align:center;color:#fff;border-radius:5px;padding:.4em .4em .3em;height:1.25em;background-color:#3279b2;top:0;bottom:0;cursor:pointer;-webkit-user-select:none;user-select:none;margin:auto .31em}.modal-button:hover{background-color:#276da7}.modal-button:active{background-color:#1b5687}.modal-svg-button{padding:0 0 2px;width:2em;height:1.8em}.modal-svg-button-icon{width:100%;height:100%;filter:brightness(0) saturate(100%) invert(100%) sepia(15%) saturate(4%) hue-rotate(346deg) brightness(101%) contrast(102%)}#modal-background-panel{position:absolute;width:100%;height:100%;background-color:#00000042;z-index:2;display:none}.show-modal-background{animation:fadeInBackground .3s ease-in-out}@keyframes fadeInBackground{0%{opacity:0}to{opacity:1}}.show-modal{animation:fadeInModal .3s ease-in-out}@keyframes fadeInModal{0%{opacity:0;scale:.95}to{opacity:1;scale:1}}.hide-modal-background{animation:fadeOutBackground .2s ease-in-out}@keyframes fadeOutBackground{0%{opacity:1}to{opacity:0}}.hide-modal{animation:fadeOutModal .2s ease-in-out}@keyframes fadeOutModal{0%{opacity:1;scale:1}to{opacity:0;scale:.95}}.modal-camera-content{overflow:hidden;text-align:center;border:unset;height:100%;background-color:#2a2a2a;display:flex;justify-content:center}.camera-modal-canvas{max-width:100%;max-height:100%;margin-top:auto;margin-bottom:auto}.modal-svg-submit-button{background-color:green}.modal-svg-submit-button:hover{background-color:#007500}.modal-svg-submit-button:active{background-color:#006500}.modal-svg-submit-disabled{pointer-events:none;background-color:#747474}.modal-svg-close-button{height:1.56em;padding-top:.37em;padding-bottom:0;background-color:#c13e3e}.modal-svg-close-button:hover{background-color:#b43434}.modal-svg-close-button:active{background-color:#972929}.modal-svg-close-icon{width:80%;height:80%}.modal-svg-camera-button{height:1.6em;padding-top:.38em;padding-bottom:0}.modal-svg-camera-icon{height:76%}.modal-svg-refresh-icon{height:105%}.modal-svg-refresh-button{height:1.66em;padding-top:.11em;padding-bottom:.21em}.input-button-container{position:relative;z-index:1}.inside-right{position:absolute;right:calc(10% + .35em);bottom:.85em}.inside-left{position:absolute;left:calc(10% + .35em);bottom:.85em}.outside-left{position:absolute;right:calc(11px - .55em);bottom:.88em}.outside-right{position:absolute;left:calc(11px - .55em);bottom:.88em}#upload-images-icon{position:absolute;pointer-events:none;width:1.45em;height:1.45em;left:.11em;bottom:.08em;filter:brightness(0) saturate(100%) invert(43%) sepia(0%) saturate(740%) hue-rotate(77deg) brightness(99%) contrast(92%)}#upload-gifs-icon{position:absolute;pointer-events:none;width:1.5em;height:1.48em;left:.07em;bottom:.08em;filter:brightness(0) saturate(100%) invert(49%) sepia(0%) saturate(2586%) hue-rotate(12deg) brightness(93%) contrast(90%)}#upload-audio-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.17em;bottom:.2em;filter:brightness(0) saturate(100%) invert(15%) sepia(0%) saturate(337%) hue-rotate(125deg) brightness(91%) contrast(94%);transform:scaleX(.95)}#camera-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.23em;bottom:.2em;filter:brightness(0) saturate(100%) invert(52%) sepia(0%) saturate(161%) hue-rotate(164deg) brightness(91%) contrast(92%);transform:scaleX(.95)}#upload-mixed-files-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.25em;bottom:.2em;filter:brightness(0) saturate(100%) invert(53%) sepia(0%) saturate(36%) hue-rotate(74deg) brightness(98%) contrast(93%);transform:scaleX(.95)}#interim-text{color:gray}#microphone-button{padding-top:.5px}.outer-button-container>#microphone-button{padding-bottom:1px}#microphone-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.25em;bottom:.25em}.default-microphone-icon{filter:brightness(0) saturate(100%) invert(32%) sepia(0%) saturate(924%) hue-rotate(46deg) brightness(95%) contrast(99%)}.active-microphone-icon{filter:brightness(0) saturate(100%) invert(10%) sepia(97%) saturate(7495%) hue-rotate(0deg) brightness(101%) contrast(107%);border-radius:10px}.command-microphone-icon{filter:brightness(0) saturate(100%) invert(42%) sepia(96%) saturate(1067%) hue-rotate(77deg) brightness(99%) contrast(102%)}.unsupported-microphone{display:none}#submit-icon{height:100%;filter:brightness(0) saturate(100%) invert(32%) sepia(0%) saturate(924%) hue-rotate(46deg) brightness(95%) contrast(99%);width:1.21em}#stop-icon{background-color:#acacac;position:absolute;width:.95em;height:.95em;left:.35em;bottom:.35em;border-radius:2px}.submit-button-enlarged{scale:1.1;margin-right:.3em;margin-left:.3em}.loading-submit-button{position:relative;left:calc(-9990px + .275em);width:.22em;height:.22em;border-radius:5px;background-color:#848484;color:#848484;box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484;animation:loading-submit-button 1.5s infinite linear;bottom:-.75em}@keyframes loading-submit-button{0%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}16.667%{box-shadow:9990px -6px #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}33.333%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}50%{box-shadow:9990px 0 #848484,calc(9990px + .44em) -6px 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}66.667%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}83.333%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) -6px 0 0 #848484}to{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}}.tooltip{position:absolute;visibility:hidden;z-index:1;pointer-events:none;padding:5px 7px;background-color:#333;border-radius:5px;width:max-content}.tooltip-text{color:#fff;font-size:13px}.input-button{border-radius:4px;cursor:pointer;margin-bottom:.2em;-webkit-user-select:none;user-select:none}.input-button-svg{width:1.65em;height:1.65em}.input-button-svg-text{padding:1px;height:1.65em;display:flex}.input-button-svg-text>svg{padding:.22rem}.input-button-svg-text>div{margin-left:2px}.input-button:hover,.input-button:focus-visible{background-color:#9c9c9c2e}.input-button:active{background-color:#9c9c9c5e}.input-button:active:not(:hover){background-color:transparent}.loading-button{cursor:auto}.loading-button:hover{background-color:unset}.text-button{filter:unset!important;display:flex;justify-content:center;align-items:center;margin-left:4px;margin-right:4px;height:1.6em;width:max-content}#custom-icon{height:100%;width:1.2em}.custom-button-container-default{color:#505050}.custom-button-container-default>.dropup-menu-item-icon{color:unset}.custom-button-container-default>svg{filter:brightness(0) saturate(100%) invert(39%) sepia(1%) saturate(0%) hue-rotate(83deg) brightness(93%) contrast(90%)}.custom-button-container-default>.dropup-menu-item-icon>svg{position:absolute;left:.2em}.custom-button-container-active{background-color:#edf7ff;color:#0285ff}.custom-button-container-active:hover,.custom-button-container-active:focus-visible{background-color:#def0ff}.custom-button-container-active:active{background-color:#d2eaff}.custom-button-container-active>svg{filter:brightness(0) saturate(100%) invert(32%) sepia(34%) saturate(4196%) hue-rotate(196deg) brightness(107%) contrast(104%)}.custom-button-container-disabled{color:#aeaeae;cursor:auto}.custom-button-container-disabled>div{pointer-events:none}.custom-button-container-disabled:hover,.custom-button-container-disabled:focus-visible{background-color:transparent}.custom-button-container-disabled:active{background-color:transparent}.custom-button-container-disabled>svg{filter:brightness(0) saturate(100%) invert(67%) sepia(0%) saturate(818%) hue-rotate(28deg) brightness(102%) contrast(100%)}#text-input-container{background-color:#fff;width:80%;display:flex;border:1px solid #0000001a;border-radius:5px;margin-top:.8em;margin-bottom:.8em;box-shadow:#959da533 0 1px 12px;overflow-y:auto;max-height:200px;position:relative}.text-input-container-left-adjustment{margin-left:1.5em}.text-input-container-right-adjustment{margin-right:1.5em}.text-input-container-left-small-adjustment{margin-left:1.1em}.text-input-container-left-small-adjustment>.outside-left{right:calc(14px - .55em)}.text-input-container-right-small-adjustment{margin-right:1.1em}.text-input-container-right-small-adjustment>.outside-right{left:calc(14px - .55em)}#text-input{text-align:left;outline:none;word-wrap:break-word;line-break:auto}.text-input-styling{padding:.4em .5em;overflow:overlay;width:100%}.text-input-inner-left-adjustment{padding-left:2.2em}.text-input-inner-right-adjustment{padding-right:2em}.text-input-disabled{pointer-events:none;-webkit-user-select:none;user-select:none}[contenteditable]:empty:before{content:attr(deep-chat-placeholder-text);pointer-events:none}[contenteditable][textcolor]:empty:before{color:gray}.outside-right>#dropup-menu,.inside-right>#dropup-menu{right:0}#dropup-icon{position:absolute;pointer-events:none;width:1.16em;height:1.2em;left:.265em;bottom:.43em;filter:brightness(0) saturate(100%) invert(54%) sepia(0%) saturate(724%) hue-rotate(6deg) brightness(92%) contrast(90%)}.dropup-button>*{pointer-events:none}#dropup-menu{background-color:#fff;position:absolute;transform:translateY(-100%);border-radius:5px;z-index:1;top:-.49em;box-shadow:#0003 -1px 2px 10px,#0000001a 0 2px 4px;cursor:pointer;-webkit-user-select:none;user-select:none}.dropup-menu-item{height:1.4em;padding:.28em .84em .28em .35em;display:flex;position:relative}.dropup-menu-item:hover,.dropup-menu-item:focus-visible{background-color:#f3f3f3}.dropup-menu-item:active{background-color:#ebebeb}.dropup-menu-item:active:not(:hover){background-color:transparent}.dropup-menu-item:first-child{padding-top:.49em;border-top-left-radius:inherit;border-top-right-radius:inherit}.dropup-menu-item:last-child{padding-bottom:.45em;border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.dropup-menu-item-icon{width:1.39em;position:relative}.dropup-menu-item-icon>svg{bottom:0!important;top:0!important;margin-bottom:auto;margin-top:auto}#dropup-menu-item-icon-element-custom{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.28em;filter:brightness(0) saturate(100%) invert(15%) sepia(0%) saturate(337%) hue-rotate(125deg) brightness(91%) contrast(94%)}.dropup-menu-item-text{margin-left:.56em;margin-top:.08em;width:max-content}#input{width:100%;display:inline-flex;text-align:center;margin-left:auto;margin-right:auto;margin-top:auto;position:relative;justify-content:center}#chat-view{height:100%;display:grid;grid-template-columns:100%}::-webkit-scrollbar{width:9px;height:9px}::-webkit-scrollbar-thumb{background-color:#d0d0d0;border-radius:5px}::-webkit-scrollbar-track{background-color:#f2f2f2}.deep-chat-web-model-button{margin-top:10px;margin-bottom:5px;margin-left:1px}:host{all:initial;display:table-cell}#container{height:inherit;width:inherit;overflow:hidden}`,lE=Object.defineProperty,be=function(r,t,n,i){for(var s=void 0,a=r.length-1,o;a>=0;a--)(o=r[a])&&(s=o(t,n,s)||s);return s&&lE(t,n,s),s},ge=function(e){function r(){var t;T(this,r);var n;return t=le(this,r),t.getMessages=function(){return[]},t.submitUserMessage=function(){return console.warn("submitUserMessage failed - please wait for chat view to render before calling this property.")},t.addMessage=function(){return console.warn("addMessage failed - please wait for chat view to render before calling this property.")},t.updateMessage=function(){},t.clearMessages=function(){},t.focusInput=function(){return Ql.focusFromParentElement(t._elementRef)},t.refreshMessages=function(){},t.scrollToBottom=function(){},t.disableSubmitButton=function(){},t.setPlaceholderText=function(){},t._hasBeenRendered=!1,t._auxiliaryStyleApplied=!1,t._elementRef=document.createElement("div"),t._elementRef.id="container",t.attachShadow({mode:"open"}).appendChild(t._elementRef),(n=t.shadowRoot)==null||n.appendChild(bn.buildElement()),po.apply(oE,t.shadowRoot),setTimeout(function(){t._hasBeenRendered||t.onRender()},20),t}return ue(r,e),A(r,[{key:"changeToChatView",value:function(){this._activeService&&(this._activeService.validateKeyProperty=!1),this.onRender()}},{key:"onRender",value:function(){var n;Fh.attemptAppendStyleSheetToHead(this.style),xt.processConnect(this),(!this._activeService||this._activeService.demo)&&(this._activeService=f_.create(this)),this.auxiliaryStyle&&!this._auxiliaryStyleApplied&&(po.apply(this.auxiliaryStyle,this.shadowRoot),this._auxiliaryStyleApplied=!0),po.applyDefaultStyleToComponent(this.style,this.chatStyle),xt.checkForContainerStyles(this,this._elementRef),this._activeService.key&&this._activeService.validateKeyProperty?A1.render(this._elementRef,this.changeToChatView.bind(this),this._activeService):!(this._activeService instanceof ft)||this._activeService.key?((n=this._childElement)!==null&&n!==void 0||(this._childElement=this.children[0]),aE.render(this,this._elementRef,this._activeService,this._childElement)):this._activeService instanceof ft&&Pk.render(this._elementRef,this.changeToChatView.bind(this),this._activeService),this._hasBeenRendered||Vi.onRender(this),this._hasBeenRendered=!0}},{key:"disconnectedCallback",value:function(){ou.chat=void 0}}])}(Ik);be([ye("object")],ge.prototype,"connect");be([ye("object")],ge.prototype,"directConnection");be([ye("object")],ge.prototype,"webModel");be([ye("object")],ge.prototype,"requestBodyLimits");be([ye("function")],ge.prototype,"requestInterceptor");be([ye("function")],ge.prototype,"responseInterceptor");be([ye("function")],ge.prototype,"validateInput");be([ye("function")],ge.prototype,"loadHistory");be([ye("object")],ge.prototype,"chatStyle");be([ye("object")],ge.prototype,"attachmentContainerStyle");be([ye("object")],ge.prototype,"dropupStyles");be([ye("object")],ge.prototype,"inputAreaStyle");be([ye("object")],ge.prototype,"textInput");be([ye("object")],ge.prototype,"submitButtonStyles");be([ye("object")],ge.prototype,"customButtons");be([ye("string")],ge.prototype,"auxiliaryStyle");be([ye("array")],ge.prototype,"history");be([ye("object")],ge.prototype,"browserStorage");be([ye("object")],ge.prototype,"introMessage");be([ye("object")],ge.prototype,"avatars");be([ye("object")],ge.prototype,"names");be([ye("object")],ge.prototype,"displayLoadingBubble");be([ye("object")],ge.prototype,"errorMessages");be([ye("object")],ge.prototype,"messageStyles");be([ye("object")],ge.prototype,"textToSpeech");be([ye("object")],ge.prototype,"speechToText");be([ye("object")],ge.prototype,"images");be([ye("object")],ge.prototype,"gifs");be([ye("object")],ge.prototype,"camera");be([ye("object")],ge.prototype,"audio");be([ye("object")],ge.prototype,"microphone");be([ye("object")],ge.prototype,"mixedFiles");be([ye("object")],ge.prototype,"dragAndDrop");be([ye("object")],ge.prototype,"introPanelStyle");be([ye("object")],ge.prototype,"htmlClassUtilities");be([ye("object")],ge.prototype,"remarkable");be([ye("object")],ge.prototype,"focusMode");be([ye("function")],ge.prototype,"onMessage");be([ye("function")],ge.prototype,"onClearMessages");be([ye("function")],ge.prototype,"onComponentRender");be([ye("function")],ge.prototype,"onInput");be([ye("function")],ge.prototype,"onError");be([ye("object")],ge.prototype,"demo");be([ye("object")],ge.prototype,"_insertKeyViewStyles");customElements.define("deep-chat",ge);const Op=(e,r)=>{const t=e.__vccOpts||e;for(const[n,i]of r)t[n]=i;return t},uE={};function cE(e,r){const t=Kl,n=Mi,i=Rh;return q(),Le(i,{"expand-icon-position":"right"},{default:Te(()=>[ne(n,null,{header:Te(()=>r[0]||(r[0]=[he("strong",null,"任务说明",-1)])),"expand-icon":Te(({active:s})=>[s?(q(),Le(t,{key:0,type:"text",size:"small"},{default:Te(()=>r[1]||(r[1]=[dt("隐藏",-1)])),_:1,__:[1]})):(q(),Le(t,{key:1,type:"text",size:"small"},{default:Te(()=>r[2]||(r[2]=[dt("显示",-1)])),_:1,__:[2]}))]),_:1})]),_:1})}const dE=Op(uE,[["render",cE]]),fE=_e({__name:"ServerStatus",props:{status:{}},setup(e){const r={CONNECTING:"连接中",OPEN:"网络正常",CLOSED:"网络断开"},t={CONNECTING:"gold",OPEN:"green",CLOSED:"red"};return(n,i)=>{const s=mb;return q(),Le(s,{color:t[n.status],loading:n.status==="CONNECTING"},{default:Te(()=>[dt(Ht(r[n.status]),1)]),_:1},8,["color","loading"])}}}),hE=_e({__name:"ProgressScreen",props:{progress:{}},setup(e){const r=e,t=j(()=>Math.floor(r.progress*100)/100);return(n,i)=>{const s=f1,a=Wo;return q(),Le(a,{visible:n.progress<1,closable:!1,footer:!1},{title:Te(()=>i[0]||(i[0]=[dt(" 正在加载场景… ",-1)])),default:Te(()=>[ne(s,{size:"large",percent:t.value},null,8,["percent"])]),_:1},8,["visible"])}}});function Js(e){return ta()?(yl(e),!0):!1}const So=new WeakMap,pE=(...e)=>{var r;const t=e[0],n=(r=Vn())==null?void 0:r.proxy;if(n==null&&!Tl())throw new Error("injectLocal must be called in setup");return n&&So.has(n)&&t in So.get(n)?So.get(n)[t]:Tt(...e)},Ir=typeof window<"u"&&typeof document<"u",xd=typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope,mE=Object.prototype.toString,vE=e=>mE.call(e)==="[object Object]",Rp=()=>{};function Pp(...e){if(e.length!==1)return Ao(...e);const r=e[0];return typeof r=="function"?Nr(km(()=>({get:r,set:Rp}))):ee(r)}function gE(e,r){function t(...n){return new Promise((i,s)=>{Promise.resolve(e(()=>r.apply(this,n),{fn:r,thisArg:this,args:n})).then(i).catch(s)})}return t}const Np=e=>e();function yE(e=Np,r={}){const{initialState:t="active"}=r,n=Pp(t==="active");function i(){n.value=!1}function s(){n.value=!0}const a=(...o)=>{n.value&&e(...o)};return{isActive:Nr(n),pause:i,resume:s,eventFilter:a}}function Id(e){return e.endsWith("rem")?Number.parseFloat(e)*16:Number.parseFloat(e)}function bE(e){return Object.entries(e)}function ko(e){return Array.isArray(e)?e:[e]}function SE(e){return Vn()}function kE(e,r,t={}){const{eventFilter:n=Np,...i}=t;return Ve(e,gE(n,r),i)}function _E(e,r,t={}){const{eventFilter:n,initialState:i="active",...s}=t,{eventFilter:a,pause:o,resume:l,isActive:u}=yE(n,{initialState:i});return{stop:kE(e,r,{...s,eventFilter:a}),pause:o,resume:l,isActive:u}}function EE(e,r=!0,t){SE()?Rt(e,t):r?e():sr(e)}function wE(e,r=1e3,t={}){const{immediate:n=!0,immediateCallback:i=!1}=t;let s=null;const a=Dt(!1);function o(){s&&(clearInterval(s),s=null)}function l(){a.value=!1,o()}function u(){const c=Qt(r);c<=0||(a.value=!0,i&&e(),o(),a.value&&(s=setInterval(e,c)))}if(n&&Ir&&u(),Ke(r)||typeof r=="function"){const c=Ve(r,()=>{a.value&&Ir&&u()});Js(c)}return Js(l),{isActive:gm(a),pause:l,resume:u}}function Bp(e,r,t){return Ve(e,r,{...t,immediate:!0})}const vr=Ir?window:void 0;function CE(e){var r;const t=Qt(e);return(r=t?.$el)!=null?r:t}function kn(...e){const r=[],t=()=>{r.forEach(o=>o()),r.length=0},n=(o,l,u,c)=>(o.addEventListener(l,u,c),()=>o.removeEventListener(l,u,c)),i=j(()=>{const o=ko(Qt(e[0])).filter(l=>l!=null);return o.every(l=>typeof l!="string")?o:void 0}),s=Bp(()=>{var o,l;return[(l=(o=i.value)==null?void 0:o.map(u=>CE(u)))!=null?l:[vr].filter(u=>u!=null),ko(Qt(i.value?e[1]:e[0])),ko(Lr(i.value?e[2]:e[1])),Qt(i.value?e[3]:e[2])]},([o,l,u,c])=>{if(t(),!o?.length||!l?.length||!u?.length)return;const d=vE(c)?{...c}:c;r.push(...o.flatMap(f=>l.flatMap(h=>u.map(p=>n(f,h,p,d)))))},{flush:"post"}),a=()=>{s(),t()};return Js(t),a}function TE(){const e=Dt(!1),r=Vn();return r&&Rt(()=>{e.value=!0},r),e}function AE(e){const r=TE();return j(()=>(r.value,!!e()))}function ME(e){return typeof e=="function"?e:typeof e=="string"?r=>r.key===e:Array.isArray(e)?r=>e.includes(r.key):()=>!0}function xn(...e){let r,t,n={};e.length===3?(r=e[0],t=e[1],n=e[2]):e.length===2?typeof e[1]=="object"?(r=!0,t=e[0],n=e[1]):(r=e[0],t=e[1]):(r=!0,t=e[0]);const{target:i=vr,eventName:s="keydown",passive:a=!1,dedupe:o=!1}=n,l=ME(r);return kn(i,s,c=>{c.repeat&&Qt(o)||l(c)&&t(c)},a)}const xE=Symbol("vueuse-ssr-width");function IE(){const e=Tl()?pE(xE,null):null;return typeof e=="number"?e:void 0}function Fp(e,r={}){const{window:t=vr,ssrWidth:n=IE()}=r,i=AE(()=>t&&"matchMedia"in t&&typeof t.matchMedia=="function"),s=Dt(typeof n=="number"),a=Dt(),o=Dt(!1),l=u=>{o.value=u.matches};return ua(()=>{if(s.value){s.value=!i.value;const u=Qt(e).split(",");o.value=u.some(c=>{const d=c.includes("not all"),f=c.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),h=c.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let p=!!(f||h);return f&&p&&(p=n>=Id(f[1])),h&&p&&(p=n<=Id(h[1])),d?!p:p});return}i.value&&(a.value=t.matchMedia(Qt(e)),o.value=a.value.matches)}),kn(a,"change",l,{passive:!0}),j(()=>o.value)}const Ld=["hash","host","hostname","href","pathname","port","protocol","search"];function pu(e={}){const{window:r=vr}=e,t=Object.fromEntries(Ld.map(s=>[s,ee()]));for(const[s,a]of bE(t))Ve(a,o=>{!r?.location||r.location[s]===o||(r.location[s]=o)});const n=s=>{var a;const{state:o,length:l}=r?.history||{},{origin:u}=r?.location||{};for(const c of Ld)t[c].value=(a=r?.location)==null?void 0:a[c];return jt({trigger:s,state:o,length:l,origin:u,...t})},i=ee(n("load"));if(r){const s={passive:!0};kn(r,"popstate",()=>i.value=n("popstate"),s),kn(r,"hashchange",()=>i.value=n("hashchange"),s)}return i}function LE(e={}){const{window:r=vr}=e,t=Dt(1),n=Fp(()=>`(resolution: ${t.value}dppx)`,e);let i=Rp;return r&&(i=Bp(n,()=>t.value=r.devicePixelRatio)),{pixelRatio:Nr(t),stop:i}}function OE(e="history",r={}){const{initialValue:t={},removeNullishValues:n=!0,removeFalsyValues:i=!1,write:s=!0,writeMode:a="replace",window:o=vr,stringify:l=_=>_.toString()}=r;if(!o)return jt(t);const u=jt({});function c(){if(e==="history")return o.location.search||"";if(e==="hash"){const _=o.location.hash||"",E=_.indexOf("?");return E>0?_.slice(E):""}else return(o.location.hash||"").replace(/^#/,"")}function d(_){const E=l(_);if(e==="history")return`${E?`?${E}`:""}${o.location.hash||""}`;if(e==="hash-params")return`${o.location.search||""}${E?`#${E}`:""}`;const C=o.location.hash||"#",B=C.indexOf("?");return B>0?`${o.location.search||""}${C.slice(0,B)}${E?`?${E}`:""}`:`${o.location.search||""}${C}${E?`?${E}`:""}`}function f(){return new URLSearchParams(c())}function h(_){const E=new Set(Object.keys(u));for(const C of _.keys()){const B=_.getAll(C);u[C]=B.length>1?B:_.get(C)||"",E.delete(C)}Array.from(E).forEach(C=>delete u[C])}const{pause:p,resume:m}=_E(u,()=>{const _=new URLSearchParams("");Object.keys(u).forEach(E=>{const C=u[E];Array.isArray(C)?C.forEach(B=>_.append(E,B)):n&&C==null||i&&!C?_.delete(E):_.set(E,C)}),v(_,!1)},{deep:!0});function v(_,E){p(),E&&h(_),a==="replace"?o.history.replaceState(o.history.state,o.document.title,o.location.pathname+d(_)):o.history.pushState(o.history.state,o.document.title,o.location.pathname+d(_)),m()}function y(){s&&v(f(),!0)}const b={passive:!0};kn(o,"popstate",y,b),e!=="history"&&kn(o,"hashchange",y,b);const M=f();return M.keys().next().value?h(M):Object.assign(u,t),u}const Od="ping";function _o(e){return e===!0?{}:e}function RE(e,r={}){const{onConnected:t,onDisconnected:n,onError:i,onMessage:s,immediate:a=!0,autoConnect:o=!0,autoClose:l=!0,protocols:u=[]}=r,c=ee(null),d=Dt("CLOSED"),f=ee(),h=Pp(e);let p,m,v=!1,y=0,b=[],M,_;const E=()=>{if(b.length&&f.value&&d.value==="OPEN"){for(const k of b)f.value.send(k);b=[]}},C=()=>{M!=null&&(clearTimeout(M),M=void 0)},B=()=>{clearTimeout(_),_=void 0},P=(k=1e3,F)=>{C(),!(!Ir&&!xd||!f.value)&&(v=!0,B(),p?.(),f.value.close(k,F),f.value=void 0)},R=(k,F=!0)=>!f.value||d.value!=="OPEN"?(F&&b.push(k),!1):(E(),f.value.send(k),!0),L=()=>{if(v||typeof h.value>"u")return;const k=new WebSocket(h.value,u);f.value=k,d.value="CONNECTING",k.onopen=()=>{d.value="OPEN",y=0,t?.(k),m?.(),E()},k.onclose=F=>{if(d.value="CLOSED",B(),p?.(),n?.(k,F),!v&&r.autoReconnect&&(f.value==null||k===f.value)){const{retries:I=-1,delay:G=1e3,onFailed:Z}=_o(r.autoReconnect);(typeof I=="function"?I:()=>typeof I=="number"&&(I<0||y<I))(y)?(y+=1,M=setTimeout(L,G)):Z?.()}},k.onerror=F=>{i?.(k,F)},k.onmessage=F=>{if(r.heartbeat){B();const{message:I=Od,responseMessage:G=I}=_o(r.heartbeat);if(F.data===Qt(G))return}c.value=F.data,s?.(k,F)}};if(r.heartbeat){const{message:k=Od,interval:F=1e3,pongTimeout:I=1e3}=_o(r.heartbeat),{pause:G,resume:Z}=wE(()=>{R(Qt(k),!1),_==null&&(_=setTimeout(()=>{P(),v=!1},I))},F,{immediate:!1});p=G,m=Z}l&&(Ir&&kn("beforeunload",()=>P(),{passive:!0}),Js(P));const x=()=>{!Ir&&!xd||(P(),v=!1,y=0,L())};return a&&x(),o&&Ve(h,x),{data:c,status:d,close:P,send:R,open:x,ws:f}}function PE(e={}){const{window:r=vr,initialWidth:t=Number.POSITIVE_INFINITY,initialHeight:n=Number.POSITIVE_INFINITY,listenOrientation:i=!0,includeScrollbar:s=!0,type:a="inner"}=e,o=Dt(t),l=Dt(n),u=()=>{if(r)if(a==="outer")o.value=r.outerWidth,l.value=r.outerHeight;else if(a==="visual"&&r.visualViewport){const{width:d,height:f,scale:h}=r.visualViewport;o.value=Math.round(d*h),l.value=Math.round(f*h)}else s?(o.value=r.innerWidth,l.value=r.innerHeight):(o.value=r.document.documentElement.clientWidth,l.value=r.document.documentElement.clientHeight)};u(),EE(u);const c={passive:!0};if(kn("resize",u,c),r&&a==="visual"&&r.visualViewport&&kn(r.visualViewport,"resize",u,c),i){const d=Fp("(orientation: portrait)");Ve(d,()=>u())}return{width:o,height:l}}const mu=vg("state",()=>{const e=ee("'ws://localhost:8000/api/ws'"),r=()=>!1,t=void 0;return pu().value.hostname?.endsWith("talkingrobots.org")&&(e.value="wss://api.study.talkingrobots.org/api/ws"),{server:e,send:r,signals:t}}),NE=["connect"],BE=_e({__name:"ChatInterface",setup(e){const r=mu();function t(n,i){r.signals=i;const s={action:"UserUtterance",...n};r.send(JSON.stringify(s))}return(n,i)=>(q(),de("deep-chat",{ref:"chat",connect:{handler:t},onKeydown:i[0]||(i[0]=Hs(()=>{},["stop"]))},null,40,NE))}});function FE(){const e=OE("hash-params");return e.experiment||(e.experiment="demo"),e}function ln(e,r){window.Unity?.SendMessage("FPSController","Step",JSON.stringify({action:e,agentId:0,renderImage:!0,onlyEmitOnAction:!0,...r}))}function DE(e){Array.isArray(e)&&e.length>0&&(e=e[0]);const r=pu();let t="ws://localhost:8000/api/ws";r.value.hostname?.endsWith("talkingrobots.org")&&(t="wss://api.study.talkingrobots.org/api/ws");const n=mu(),i=RE(t,{autoReconnect:{delay:3e3},heartbeat:{message:"ping",interval:2e3,pongTimeout:3e3},onConnected(){i.send(JSON.stringify({action:"DeclareRole",role:"simulator",experiment:e,robots:["demo_robot"]}))},onMessage(s,a){if(a.data!=="pong")try{const o=JSON.parse(a.data);if(o.action==="RobotUtterance"){if(!n.signals)return;n.signals.onResponse(o)}else ln(o.action,o.params)}catch{}}});return i}function $E(e){return{all:e=e||new Map,on:function(r,t){var n=e.get(r);n?n.push(t):e.set(r,[t])},off:function(r,t){var n=e.get(r);n&&(t?n.splice(n.indexOf(t)>>>0,1):e.set(r,[]))},emit:function(r,t){var n=e.get(r);n&&n.slice().map(function(i){i(t)}),(n=e.get("*"))&&n.slice().map(function(i){i(r,t)})}}}function jE(e,r,t){if(!window.createUnityInstance){console.error("Can't find createUnityInstance(). Is /Build/Unity.loader.js correctly loaded?");return}const n=document.querySelector("#unity-canvas");if(!n){console.error("Could not get the canvas element for Unity (#unity-canvas)");return}window.createUnityInstance(n,{dataUrl:e,frameworkUrl:"Build/Unity.framework.js",codeUrl:r,streamingAssetsUrl:"StreamingAssets",companyName:"CDI",productName:"AI2THOR",productVersion:"1.0"},t).then(async i=>{console.log("Unity loaded!",i),window.Unity=i,window.ai2thor={metadata:"",images:{}}}).catch(i=>{console.error("Failed to load Unity:",i)})}function UE(){window.Unity?.SendMessage("FPSController","SetController","HRI"),window.Unity?.SendMessage("FPSController","Step",JSON.stringify({action:"Initialize",gridSize:.25,agentCount:2,fieldOfView:90,renderImage:!0,onlyEmitOnAction:!0}))}function HE(e){const r=new Uint8Array(4);return new DataView(r.buffer).setUint32(0,e,!1),r}async function zE(e){const r=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(r)).map(t=>t.toString(16).padStart(2,"0")).join("")}async function WE(e,r){const t=Object.keys(r.images),n=[];for(const f of t){const{image:h,width:p,height:m}=r.images[f],v=p*m*3,b=new Uint8Array(h.buffer,h.byteOffset,Math.min(h.byteLength,v)).slice(0,v);n.push({id:f,width:p,height:m,bytes:b,sha256:""})}await Promise.all(n.map(async f=>{f.sha256=await zE(f.bytes.buffer)}));const i=n.map(f=>({id:f.id,width:f.width,height:f.height,byteLength:f.bytes.byteLength,sha256:f.sha256})),s={ai2thor:{metadata:r.metadata,images:i}},a=new TextEncoder().encode(JSON.stringify(s)),o=HE(a.byteLength),l=n.reduce((f,h)=>f+h.bytes.byteLength,0),u=4+a.byteLength+l,c=new Uint8Array(u);let d=0;c.set(o,d),d+=o.length,c.set(a,d),d+=a.length;for(const f of n)c.set(f.bytes,d),d+=f.bytes.byteLength;e(c.buffer)}function VE(e){const{width:r,height:t}=PE(),{pixelRatio:n}=LE(),i=ee(0),s=pu();let a="Build/Unity.data",o="Build/Unity.wasm";return s.value.hostname?.endsWith("talkingrobots.org")&&(a="https://pub-3148e96478af47728b95d59923c06bdd.r2.dev/Unity.data.unityweb",o="https://pub-3148e96478af47728b95d59923c06bdd.r2.dev/Unity.wasm.unityweb"),Rt(()=>{jE(a,o,l=>{console.log(l),i.value=l})}),window.onGameLoaded=UE,window.onAssetsLoaded=()=>{console.log("Remote Assets Loaded!")},window.onUnityMetadata=async l=>{window.ai2thor.metadata=l,await WE(e,window.ai2thor)},window.onUnityImage=(l,u)=>{const d=(u instanceof Uint8Array?u:new Uint8Array(u)).slice(0);window.ai2thor.images[l]={image:d,width:r.value*n.value,height:t.value*n.value}},window.UnityEvents=$E(),window.onUnityEvent=(l,u)=>{window.UnityEvents.emit(l,JSON.parse(u))},i}function qE(){xn(["w","W"],e=>{e.preventDefault(),ln("MoveAhead",{moveMagnitude:.25,forceAction:!0,allowAgentsToIntersect:!0,renderImage:!0,onlyEmitOnAction:!0})}),xn(["a","A"],e=>{e.preventDefault(),ln("MoveLeft",{moveMagnitude:.25,forceAction:!0,allowAgentsToIntersect:!0,renderImage:!0,onlyEmitOnAction:!0})}),xn(["s","S"],e=>{e.preventDefault(),ln("MoveBack",{moveMagnitude:.25,forceAction:!0,allowAgentsToIntersect:!0,renderImage:!0,onlyEmitOnAction:!0})}),xn(["d","D"],e=>{e.preventDefault(),ln("MoveRight",{moveMagnitude:.25,forceAction:!0,allowAgentsToIntersect:!0,renderImage:!0,onlyEmitOnAction:!0})}),xn(["ArrowUp"],e=>{e.preventDefault(),ln("LookUp",{degrees:30,forceAction:!0,renderImage:!0,onlyEmitOnAction:!0})}),xn(["ArrowDown"],e=>{e.preventDefault(),ln("LookDown",{degrees:30,forceAction:!0,renderImage:!0,onlyEmitOnAction:!0})}),xn(["ArrowLeft"],e=>{e.preventDefault(),ln("RotateLeft",{degrees:45,forceAction:!0,renderImage:!0,onlyEmitOnAction:!0})}),xn(["ArrowRight"],e=>{e.preventDefault(),ln("RotateRight",{degrees:45,forceAction:!0,renderImage:!0,onlyEmitOnAction:!0})})}const GE={class:"header-container float top left"},KE={class:"header"},JE={class:"header-container float bottom left",style:{width:"30%"}},XE={class:"header-container float bottom right"},YE=_e({__name:"App",setup(e){const r=FE(),{status:t,send:n}=DE(r.experiment),i=VE(n);qE();const s=mu();s.send=n;const a={启动机器人(){n(JSON.stringify({action:"RequestRobots",robots:["demo_robot"]}))},实验结束(){n(JSON.stringify({action:"ExperimentEnd"}))}};return(o,l)=>{const u=fb,c=h1,d=Kl,f=Mi,h=Rh;return q(),de(Ge,null,[l[5]||(l[5]=he("div",{class:"unity-container"},[he("canvas",{id:"unity-canvas"})],-1)),he("div",GE,[he("div",KE,[ne(c,null,{default:Te(()=>[ne(c,null,{default:Te(()=>[ne(u,{size:32,style:{backgroundColor:"transparent"}},{default:Te(()=>l[0]||(l[0]=[he("img",{src:p1},null,-1)])),_:1,__:[0]}),l[1]||(l[1]=he("strong",null,"CDI-AI2THOR",-1))]),_:1,__:[1]}),ne(fE,{status:Lr(t)},null,8,["status"]),(q(),de(Ge,null,Cl(a,(p,m)=>ne(d,{key:m,type:"text",onClick:p},{default:Te(()=>[dt(Ht(m),1)]),_:2},1032,["onClick"])),64))]),_:1})])]),he("div",JE,[ne(dE)]),he("div",XE,[ne(h,{"expand-icon-position":"right","default-active-key":[0]},{default:Te(()=>[(q(),Le(f,{key:0},{header:Te(()=>l[2]||(l[2]=[he("div",{style:{"min-width":"10em"}},[he("strong",null,"对话区域")],-1)])),"expand-icon":Te(({active:p})=>[p?(q(),Le(d,{key:0,type:"text",size:"small"},{default:Te(()=>l[3]||(l[3]=[dt("隐藏",-1)])),_:1,__:[3]})):(q(),Le(d,{key:1,type:"text",size:"small"},{default:Te(()=>l[4]||(l[4]=[dt("显示",-1)])),_:1,__:[4]}))]),default:Te(()=>[ne(BE)]),_:1}))]),_:1})]),ne(hE,{progress:Lr(i)},null,8,["progress"])],64)}}}),ZE=Op(YE,[["__scopeId","data-v-51a13773"]]),vu=og(ZE);vu.use(cg());vu.use(Ty);vu.mount("#app");
